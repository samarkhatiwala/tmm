/* Generated by Cython 3.1.3 */

/* BEGIN: Cython Metadata
{
    "distutils": {
        "define_macros": [
            [
                "NPY_NO_DEPRECATED_API",
                "NPY_1_9_API_VERSION"
            ]
        ],
        "depends": [
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/_core/include/numpy/arrayobject.h",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/_core/include/numpy/arrayscalars.h",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/_core/include/numpy/ndarrayobject.h",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/_core/include/numpy/ndarraytypes.h",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/_core/include/numpy/ufuncobject.h",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/tmmlib/include/tmm.h",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/tmmlib/include/tmm_forcing_utils.h",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/tmmlib/include/tmm_petsc_matvec_utils.h",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/tmmlib/include/tmm_profile_utils.h",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/tmmlib/include/tmm_share.h",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/tmmlib/include/tmm_timer.h"
        ],
        "extra_compile_args": [
            "-fPIC"
        ],
        "extra_link_args": [
            "-Wl,-rpath,/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/petsc/lib",
            "-Wl,-rpath,/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/tmmlib/lib"
        ],
        "include_dirs": [
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/_core/include",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/petsc/include",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/petsc/include",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/tmmlib/include",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/tmmlib/lib"
        ],
        "libraries": [
            "petsc",
            "tmm"
        ],
        "library_dirs": [
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/petsc/lib",
            "/private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/tmmlib/lib"
        ],
        "name": "tmm4py.tmm4py_core",
        "sources": [
            "tmm4py/tmm4py_core.pyx"
        ]
    },
    "module_name": "tmm4py.tmm4py_core"
}
END: Cython Metadata */

#ifndef PY_SSIZE_T_CLEAN
#define PY_SSIZE_T_CLEAN
#endif /* PY_SSIZE_T_CLEAN */
/* InitLimitedAPI */
#if defined(Py_LIMITED_API) && !defined(CYTHON_LIMITED_API)
  #define CYTHON_LIMITED_API 1
#endif

#include "Python.h"
#ifndef Py_PYTHON_H
    #error Python headers needed to compile C extensions, please install development version of Python.
#elif PY_VERSION_HEX < 0x03080000
    #error Cython requires Python 3.8+.
#else
#define __PYX_ABI_VERSION "3_1_3"
#define CYTHON_HEX_VERSION 0x030103F0
#define CYTHON_FUTURE_DIVISION 1
/* CModulePreamble */
#include <stddef.h>
#ifndef offsetof
  #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
#endif
#if !defined(_WIN32) && !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
  #ifndef __fastcall
    #define __fastcall
  #endif
#endif
#ifndef DL_IMPORT
  #define DL_IMPORT(t) t
#endif
#ifndef DL_EXPORT
  #define DL_EXPORT(t) t
#endif
#define __PYX_COMMA ,
#ifndef HAVE_LONG_LONG
  #define HAVE_LONG_LONG
#endif
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifndef Py_HUGE_VAL
  #define Py_HUGE_VAL HUGE_VAL
#endif
#define __PYX_LIMITED_VERSION_HEX PY_VERSION_HEX
#if defined(GRAALVM_PYTHON)
  /* For very preliminary testing purposes. Most variables are set the same as PyPy.
     The existence of this section does not imply that anything works or is even tested */
  #define CYTHON_COMPILING_IN_PYPY 0
  #define CYTHON_COMPILING_IN_CPYTHON 0
  #define CYTHON_COMPILING_IN_LIMITED_API 0
  #define CYTHON_COMPILING_IN_GRAAL 1
  #define CYTHON_COMPILING_IN_CPYTHON_FREETHREADING 0
  #undef CYTHON_USE_TYPE_SLOTS
  #define CYTHON_USE_TYPE_SLOTS 0
  #undef CYTHON_USE_TYPE_SPECS
  #define CYTHON_USE_TYPE_SPECS 0
  #undef CYTHON_USE_PYTYPE_LOOKUP
  #define CYTHON_USE_PYTYPE_LOOKUP 0
  #undef CYTHON_USE_PYLIST_INTERNALS
  #define CYTHON_USE_PYLIST_INTERNALS 0
  #undef CYTHON_USE_UNICODE_INTERNALS
  #define CYTHON_USE_UNICODE_INTERNALS 0
  #undef CYTHON_USE_UNICODE_WRITER
  #define CYTHON_USE_UNICODE_WRITER 0
  #undef CYTHON_USE_PYLONG_INTERNALS
  #define CYTHON_USE_PYLONG_INTERNALS 0
  #undef CYTHON_AVOID_BORROWED_REFS
  #define CYTHON_AVOID_BORROWED_REFS 1
  #undef CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS
  #define CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS 1
  #undef CYTHON_ASSUME_SAFE_MACROS
  #define CYTHON_ASSUME_SAFE_MACROS 0
  #undef CYTHON_ASSUME_SAFE_SIZE
  #define CYTHON_ASSUME_SAFE_SIZE 0
  #undef CYTHON_UNPACK_METHODS
  #define CYTHON_UNPACK_METHODS 0
  #undef CYTHON_FAST_THREAD_STATE
  #define CYTHON_FAST_THREAD_STATE 0
  #undef CYTHON_FAST_GIL
  #define CYTHON_FAST_GIL 0
  #undef CYTHON_METH_FASTCALL
  #define CYTHON_METH_FASTCALL 0
  #undef CYTHON_FAST_PYCALL
  #define CYTHON_FAST_PYCALL 0
  #ifndef CYTHON_PEP487_INIT_SUBCLASS
    #define CYTHON_PEP487_INIT_SUBCLASS 1
  #endif
  #undef CYTHON_PEP489_MULTI_PHASE_INIT
  #define CYTHON_PEP489_MULTI_PHASE_INIT 1
  #undef CYTHON_USE_MODULE_STATE
  #define CYTHON_USE_MODULE_STATE 0
  #undef CYTHON_USE_SYS_MONITORING
  #define CYTHON_USE_SYS_MONITORING 0
  #undef CYTHON_USE_TP_FINALIZE
  #define CYTHON_USE_TP_FINALIZE 0
  #undef CYTHON_USE_AM_SEND
  #define CYTHON_USE_AM_SEND 0
  #undef CYTHON_USE_DICT_VERSIONS
  #define CYTHON_USE_DICT_VERSIONS 0
  #undef CYTHON_USE_EXC_INFO_STACK
  #define CYTHON_USE_EXC_INFO_STACK 1
  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
    #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
  #endif
  #undef CYTHON_USE_FREELISTS
  #define CYTHON_USE_FREELISTS 0
#elif defined(PYPY_VERSION)
  #define CYTHON_COMPILING_IN_PYPY 1
  #define CYTHON_COMPILING_IN_CPYTHON 0
  #define CYTHON_COMPILING_IN_LIMITED_API 0
  #define CYTHON_COMPILING_IN_GRAAL 0
  #define CYTHON_COMPILING_IN_CPYTHON_FREETHREADING 0
  #undef CYTHON_USE_TYPE_SLOTS
  #define CYTHON_USE_TYPE_SLOTS 1
  #ifndef CYTHON_USE_TYPE_SPECS
    #define CYTHON_USE_TYPE_SPECS 0
  #endif
  #undef CYTHON_USE_PYTYPE_LOOKUP
  #define CYTHON_USE_PYTYPE_LOOKUP 0
  #undef CYTHON_USE_PYLIST_INTERNALS
  #define CYTHON_USE_PYLIST_INTERNALS 0
  #undef CYTHON_USE_UNICODE_INTERNALS
  #define CYTHON_USE_UNICODE_INTERNALS 0
  #undef CYTHON_USE_UNICODE_WRITER
  #define CYTHON_USE_UNICODE_WRITER 0
  #undef CYTHON_USE_PYLONG_INTERNALS
  #define CYTHON_USE_PYLONG_INTERNALS 0
  #undef CYTHON_AVOID_BORROWED_REFS
  #define CYTHON_AVOID_BORROWED_REFS 1
  #undef CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS
  #define CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS 1
  #undef CYTHON_ASSUME_SAFE_MACROS
  #define CYTHON_ASSUME_SAFE_MACROS 0
  #ifndef CYTHON_ASSUME_SAFE_SIZE
    #define CYTHON_ASSUME_SAFE_SIZE 1
  #endif
  #undef CYTHON_UNPACK_METHODS
  #define CYTHON_UNPACK_METHODS 0
  #undef CYTHON_FAST_THREAD_STATE
  #define CYTHON_FAST_THREAD_STATE 0
  #undef CYTHON_FAST_GIL
  #define CYTHON_FAST_GIL 0
  #undef CYTHON_METH_FASTCALL
  #define CYTHON_METH_FASTCALL 0
  #undef CYTHON_FAST_PYCALL
  #define CYTHON_FAST_PYCALL 0
  #ifndef CYTHON_PEP487_INIT_SUBCLASS
    #define CYTHON_PEP487_INIT_SUBCLASS 1
  #endif
  #if PY_VERSION_HEX < 0x03090000
    #undef CYTHON_PEP489_MULTI_PHASE_INIT
    #define CYTHON_PEP489_MULTI_PHASE_INIT 0
  #elif !defined(CYTHON_PEP489_MULTI_PHASE_INIT)
    #define CYTHON_PEP489_MULTI_PHASE_INIT 1
  #endif
  #undef CYTHON_USE_MODULE_STATE
  #define CYTHON_USE_MODULE_STATE 0
  #undef CYTHON_USE_SYS_MONITORING
  #define CYTHON_USE_SYS_MONITORING 0
  #ifndef CYTHON_USE_TP_FINALIZE
    #define CYTHON_USE_TP_FINALIZE (PYPY_VERSION_NUM >= 0x07030C00)
  #endif
  #undef CYTHON_USE_AM_SEND
  #define CYTHON_USE_AM_SEND 0
  #undef CYTHON_USE_DICT_VERSIONS
  #define CYTHON_USE_DICT_VERSIONS 0
  #undef CYTHON_USE_EXC_INFO_STACK
  #define CYTHON_USE_EXC_INFO_STACK 0
  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
    #define CYTHON_UPDATE_DESCRIPTOR_DOC (PYPY_VERSION_NUM >= 0x07031100)
  #endif
  #undef CYTHON_USE_FREELISTS
  #define CYTHON_USE_FREELISTS 0
#elif defined(CYTHON_LIMITED_API)
  #ifdef Py_LIMITED_API
    #undef __PYX_LIMITED_VERSION_HEX
    #define __PYX_LIMITED_VERSION_HEX Py_LIMITED_API
  #endif
  #define CYTHON_COMPILING_IN_PYPY 0
  #define CYTHON_COMPILING_IN_CPYTHON 0
  #define CYTHON_COMPILING_IN_LIMITED_API 1
  #define CYTHON_COMPILING_IN_GRAAL 0
  #define CYTHON_COMPILING_IN_CPYTHON_FREETHREADING 0
  #undef CYTHON_CLINE_IN_TRACEBACK
  #define CYTHON_CLINE_IN_TRACEBACK 0
  #undef CYTHON_USE_TYPE_SLOTS
  #define CYTHON_USE_TYPE_SLOTS 0
  #undef CYTHON_USE_TYPE_SPECS
  #define CYTHON_USE_TYPE_SPECS 1
  #undef CYTHON_USE_PYTYPE_LOOKUP
  #define CYTHON_USE_PYTYPE_LOOKUP 0
  #undef CYTHON_USE_PYLIST_INTERNALS
  #define CYTHON_USE_PYLIST_INTERNALS 0
  #undef CYTHON_USE_UNICODE_INTERNALS
  #define CYTHON_USE_UNICODE_INTERNALS 0
  #ifndef CYTHON_USE_UNICODE_WRITER
    #define CYTHON_USE_UNICODE_WRITER 0
  #endif
  #undef CYTHON_USE_PYLONG_INTERNALS
  #define CYTHON_USE_PYLONG_INTERNALS 0
  #ifndef CYTHON_AVOID_BORROWED_REFS
    #define CYTHON_AVOID_BORROWED_REFS 0
  #endif
  #ifndef CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS
    #define CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS 0
  #endif
  #undef CYTHON_ASSUME_SAFE_MACROS
  #define CYTHON_ASSUME_SAFE_MACROS 0
  #undef CYTHON_ASSUME_SAFE_SIZE
  #define CYTHON_ASSUME_SAFE_SIZE 0
  #undef CYTHON_UNPACK_METHODS
  #define CYTHON_UNPACK_METHODS 0
  #undef CYTHON_FAST_THREAD_STATE
  #define CYTHON_FAST_THREAD_STATE 0
  #undef CYTHON_FAST_GIL
  #define CYTHON_FAST_GIL 0
  #undef CYTHON_METH_FASTCALL
  #define CYTHON_METH_FASTCALL (__PYX_LIMITED_VERSION_HEX >= 0x030C0000)
  #undef CYTHON_FAST_PYCALL
  #define CYTHON_FAST_PYCALL 0
  #ifndef CYTHON_PEP487_INIT_SUBCLASS
    #define CYTHON_PEP487_INIT_SUBCLASS 1
  #endif
  #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
    #define CYTHON_PEP489_MULTI_PHASE_INIT 1
  #endif
  #ifndef CYTHON_USE_MODULE_STATE
    #define CYTHON_USE_MODULE_STATE 0
  #endif
  #undef CYTHON_USE_SYS_MONITORING
  #define CYTHON_USE_SYS_MONITORING 0
  #ifndef CYTHON_USE_TP_FINALIZE
    #define CYTHON_USE_TP_FINALIZE 0
  #endif
  #ifndef CYTHON_USE_AM_SEND
    #define CYTHON_USE_AM_SEND (__PYX_LIMITED_VERSION_HEX >= 0x030A0000)
  #endif
  #undef CYTHON_USE_DICT_VERSIONS
  #define CYTHON_USE_DICT_VERSIONS 0
  #undef CYTHON_USE_EXC_INFO_STACK
  #define CYTHON_USE_EXC_INFO_STACK 0
  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
    #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
  #endif
  #undef CYTHON_USE_FREELISTS
  #define CYTHON_USE_FREELISTS 0
#else
  #define CYTHON_COMPILING_IN_PYPY 0
  #define CYTHON_COMPILING_IN_CPYTHON 1
  #define CYTHON_COMPILING_IN_LIMITED_API 0
  #define CYTHON_COMPILING_IN_GRAAL 0
  #ifdef Py_GIL_DISABLED
    #define CYTHON_COMPILING_IN_CPYTHON_FREETHREADING 1
  #else
    #define CYTHON_COMPILING_IN_CPYTHON_FREETHREADING 0
  #endif
  #if PY_VERSION_HEX < 0x030A0000
    #undef CYTHON_USE_TYPE_SLOTS
    #define CYTHON_USE_TYPE_SLOTS 1
  #elif !defined(CYTHON_USE_TYPE_SLOTS)
    #define CYTHON_USE_TYPE_SLOTS 1
  #endif
  #ifndef CYTHON_USE_TYPE_SPECS
    #define CYTHON_USE_TYPE_SPECS 0
  #endif
  #ifndef CYTHON_USE_PYTYPE_LOOKUP
    #define CYTHON_USE_PYTYPE_LOOKUP 1
  #endif
  #ifndef CYTHON_USE_PYLONG_INTERNALS
    #define CYTHON_USE_PYLONG_INTERNALS 1
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
    #undef CYTHON_USE_PYLIST_INTERNALS
    #define CYTHON_USE_PYLIST_INTERNALS 0
  #elif !defined(CYTHON_USE_PYLIST_INTERNALS)
    #define CYTHON_USE_PYLIST_INTERNALS 1
  #endif
  #ifndef CYTHON_USE_UNICODE_INTERNALS
    #define CYTHON_USE_UNICODE_INTERNALS 1
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING || PY_VERSION_HEX >= 0x030B00A2
    #undef CYTHON_USE_UNICODE_WRITER
    #define CYTHON_USE_UNICODE_WRITER 0
  #elif !defined(CYTHON_USE_UNICODE_WRITER)
    #define CYTHON_USE_UNICODE_WRITER 1
  #endif
  #ifndef CYTHON_AVOID_BORROWED_REFS
    #define CYTHON_AVOID_BORROWED_REFS 0
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
    #undef CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS
    #define CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS 1
  #elif !defined(CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS)
    #define CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS 0
  #endif
  #ifndef CYTHON_ASSUME_SAFE_MACROS
    #define CYTHON_ASSUME_SAFE_MACROS 1
  #endif
  #ifndef CYTHON_ASSUME_SAFE_SIZE
    #define CYTHON_ASSUME_SAFE_SIZE 1
  #endif
  #ifndef CYTHON_UNPACK_METHODS
    #define CYTHON_UNPACK_METHODS 1
  #endif
  #ifndef CYTHON_FAST_THREAD_STATE
    #define CYTHON_FAST_THREAD_STATE 1
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
    #undef CYTHON_FAST_GIL
    #define CYTHON_FAST_GIL 0
  #elif !defined(CYTHON_FAST_GIL)
    #define CYTHON_FAST_GIL (PY_VERSION_HEX < 0x030C00A6)
  #endif
  #ifndef CYTHON_METH_FASTCALL
    #define CYTHON_METH_FASTCALL 1
  #endif
  #ifndef CYTHON_FAST_PYCALL
    #define CYTHON_FAST_PYCALL 1
  #endif
  #ifndef CYTHON_PEP487_INIT_SUBCLASS
    #define CYTHON_PEP487_INIT_SUBCLASS 1
  #endif
  #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
    #define CYTHON_PEP489_MULTI_PHASE_INIT 1
  #endif
  #ifndef CYTHON_USE_MODULE_STATE
    #define CYTHON_USE_MODULE_STATE 0
  #endif
  #ifndef CYTHON_USE_SYS_MONITORING
    #define CYTHON_USE_SYS_MONITORING (PY_VERSION_HEX >= 0x030d00B1)
  #endif
  #ifndef CYTHON_USE_TP_FINALIZE
    #define CYTHON_USE_TP_FINALIZE 1
  #endif
  #ifndef CYTHON_USE_AM_SEND
    #define CYTHON_USE_AM_SEND 1
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
    #undef CYTHON_USE_DICT_VERSIONS
    #define CYTHON_USE_DICT_VERSIONS 0
  #elif !defined(CYTHON_USE_DICT_VERSIONS)
    #define CYTHON_USE_DICT_VERSIONS  (PY_VERSION_HEX < 0x030C00A5 && !CYTHON_USE_MODULE_STATE)
  #endif
  #ifndef CYTHON_USE_EXC_INFO_STACK
    #define CYTHON_USE_EXC_INFO_STACK 1
  #endif
  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
  #endif
  #ifndef CYTHON_USE_FREELISTS
    #define CYTHON_USE_FREELISTS (!CYTHON_COMPILING_IN_CPYTHON_FREETHREADING)
  #endif
#endif
#ifndef CYTHON_FAST_PYCCALL
#define CYTHON_FAST_PYCCALL  CYTHON_FAST_PYCALL
#endif
#ifndef CYTHON_VECTORCALL
#if CYTHON_COMPILING_IN_LIMITED_API
#define CYTHON_VECTORCALL  (__PYX_LIMITED_VERSION_HEX >= 0x030C0000)
#else
#define CYTHON_VECTORCALL  (CYTHON_FAST_PYCCALL && PY_VERSION_HEX >= 0x030800B1)
#endif
#endif
#define CYTHON_BACKPORT_VECTORCALL (CYTHON_METH_FASTCALL && PY_VERSION_HEX < 0x030800B1)
#if CYTHON_USE_PYLONG_INTERNALS
  #undef SHIFT
  #undef BASE
  #undef MASK
  #ifdef SIZEOF_VOID_P
    enum { __pyx_check_sizeof_voidp = 1 / (int)(SIZEOF_VOID_P == sizeof(void*)) };
  #endif
#endif
#ifndef CYTHON_LOCK_AND_GIL_DEADLOCK_AVOIDANCE_TIME
  #define CYTHON_LOCK_AND_GIL_DEADLOCK_AVOIDANCE_TIME 100
#endif
#ifndef __has_attribute
  #define __has_attribute(x) 0
#endif
#ifndef __has_cpp_attribute
  #define __has_cpp_attribute(x) 0
#endif
#ifndef CYTHON_RESTRICT
  #if defined(__GNUC__)
    #define CYTHON_RESTRICT __restrict__
  #elif defined(_MSC_VER) && _MSC_VER >= 1400
    #define CYTHON_RESTRICT __restrict
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_RESTRICT restrict
  #else
    #define CYTHON_RESTRICT
  #endif
#endif
#ifndef CYTHON_UNUSED
  #if defined(__cplusplus)
    /* for clang __has_cpp_attribute(maybe_unused) is true even before C++17
     * but leads to warnings with -pedantic, since it is a C++17 feature */
    #if ((defined(_MSVC_LANG) && _MSVC_LANG >= 201703L) || __cplusplus >= 201703L)
      #if __has_cpp_attribute(maybe_unused)
        #define CYTHON_UNUSED [[maybe_unused]]
      #endif
    #endif
  #endif
#endif
#ifndef CYTHON_UNUSED
# if defined(__GNUC__)
#   if !(defined(__cplusplus)) || (__GNUC__ > 3 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
#     define CYTHON_UNUSED __attribute__ ((__unused__))
#   else
#     define CYTHON_UNUSED
#   endif
# elif defined(__ICC) || (defined(__INTEL_COMPILER) && !defined(_MSC_VER))
#   define CYTHON_UNUSED __attribute__ ((__unused__))
# else
#   define CYTHON_UNUSED
# endif
#endif
#ifndef CYTHON_UNUSED_VAR
#  if defined(__cplusplus)
     template<class T> void CYTHON_UNUSED_VAR( const T& ) { }
#  else
#    define CYTHON_UNUSED_VAR(x) (void)(x)
#  endif
#endif
#ifndef CYTHON_MAYBE_UNUSED_VAR
  #define CYTHON_MAYBE_UNUSED_VAR(x) CYTHON_UNUSED_VAR(x)
#endif
#ifndef CYTHON_NCP_UNUSED
# if CYTHON_COMPILING_IN_CPYTHON && !CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
#  define CYTHON_NCP_UNUSED
# else
#  define CYTHON_NCP_UNUSED CYTHON_UNUSED
# endif
#endif
#ifndef CYTHON_USE_CPP_STD_MOVE
  #if defined(__cplusplus) && (\
    __cplusplus >= 201103L || (defined(_MSC_VER) && _MSC_VER >= 1600))
    #define CYTHON_USE_CPP_STD_MOVE 1
  #else
    #define CYTHON_USE_CPP_STD_MOVE 0
  #endif
#endif
#define __Pyx_void_to_None(void_result) ((void)(void_result), Py_INCREF(Py_None), Py_None)
#ifdef _MSC_VER
    #ifndef _MSC_STDINT_H_
        #if _MSC_VER < 1300
            typedef unsigned char     uint8_t;
            typedef unsigned short    uint16_t;
            typedef unsigned int      uint32_t;
        #else
            typedef unsigned __int8   uint8_t;
            typedef unsigned __int16  uint16_t;
            typedef unsigned __int32  uint32_t;
        #endif
    #endif
    #if _MSC_VER < 1300
        #ifdef _WIN64
            typedef unsigned long long  __pyx_uintptr_t;
        #else
            typedef unsigned int        __pyx_uintptr_t;
        #endif
    #else
        #ifdef _WIN64
            typedef unsigned __int64    __pyx_uintptr_t;
        #else
            typedef unsigned __int32    __pyx_uintptr_t;
        #endif
    #endif
#else
    #include <stdint.h>
    typedef uintptr_t  __pyx_uintptr_t;
#endif
#ifndef CYTHON_FALLTHROUGH
  #if defined(__cplusplus)
    /* for clang __has_cpp_attribute(fallthrough) is true even before C++17
     * but leads to warnings with -pedantic, since it is a C++17 feature */
    #if ((defined(_MSVC_LANG) && _MSVC_LANG >= 201703L) || __cplusplus >= 201703L)
      #if __has_cpp_attribute(fallthrough)
        #define CYTHON_FALLTHROUGH [[fallthrough]]
      #endif
    #endif
    #ifndef CYTHON_FALLTHROUGH
      #if __has_cpp_attribute(clang::fallthrough)
        #define CYTHON_FALLTHROUGH [[clang::fallthrough]]
      #elif __has_cpp_attribute(gnu::fallthrough)
        #define CYTHON_FALLTHROUGH [[gnu::fallthrough]]
      #endif
    #endif
  #endif
  #ifndef CYTHON_FALLTHROUGH
    #if __has_attribute(fallthrough)
      #define CYTHON_FALLTHROUGH __attribute__((fallthrough))
    #else
      #define CYTHON_FALLTHROUGH
    #endif
  #endif
  #if defined(__clang__) && defined(__apple_build_version__)
    #if __apple_build_version__ < 7000000
      #undef  CYTHON_FALLTHROUGH
      #define CYTHON_FALLTHROUGH
    #endif
  #endif
#endif
#ifndef Py_UNREACHABLE
  #define Py_UNREACHABLE()  assert(0); abort()
#endif
#ifdef __cplusplus
  template <typename T>
  struct __PYX_IS_UNSIGNED_IMPL {static const bool value = T(0) < T(-1);};
  #define __PYX_IS_UNSIGNED(type) (__PYX_IS_UNSIGNED_IMPL<type>::value)
#else
  #define __PYX_IS_UNSIGNED(type) (((type)-1) > 0)
#endif
#if CYTHON_COMPILING_IN_PYPY == 1
  #define __PYX_NEED_TP_PRINT_SLOT  (PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x030A0000)
#else
  #define __PYX_NEED_TP_PRINT_SLOT  (PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000)
#endif
#define __PYX_REINTERPRET_FUNCION(func_pointer, other_pointer) ((func_pointer)(void(*)(void))(other_pointer))

/* CInitCode */
#ifndef CYTHON_INLINE
  #if defined(__clang__)
    #define CYTHON_INLINE __inline__ __attribute__ ((__unused__))
  #elif defined(__GNUC__)
    #define CYTHON_INLINE __inline__
  #elif defined(_MSC_VER)
    #define CYTHON_INLINE __inline
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_INLINE inline
  #else
    #define CYTHON_INLINE
  #endif
#endif

/* PythonCompatibility */
#define __PYX_BUILD_PY_SSIZE_T "n"
#define CYTHON_FORMAT_SSIZE_T "z"
#define __Pyx_BUILTIN_MODULE_NAME "builtins"
#define __Pyx_DefaultClassType PyType_Type
#if CYTHON_COMPILING_IN_LIMITED_API
    #ifndef CO_OPTIMIZED
    static int CO_OPTIMIZED;
    #endif
    #ifndef CO_NEWLOCALS
    static int CO_NEWLOCALS;
    #endif
    #ifndef CO_VARARGS
    static int CO_VARARGS;
    #endif
    #ifndef CO_VARKEYWORDS
    static int CO_VARKEYWORDS;
    #endif
    #ifndef CO_ASYNC_GENERATOR
    static int CO_ASYNC_GENERATOR;
    #endif
    #ifndef CO_GENERATOR
    static int CO_GENERATOR;
    #endif
    #ifndef CO_COROUTINE
    static int CO_COROUTINE;
    #endif
#else
    #ifndef CO_COROUTINE
      #define CO_COROUTINE 0x80
    #endif
    #ifndef CO_ASYNC_GENERATOR
      #define CO_ASYNC_GENERATOR 0x200
    #endif
#endif
static int __Pyx_init_co_variables(void);
#if PY_VERSION_HEX >= 0x030900A4 || defined(Py_IS_TYPE)
  #define __Pyx_IS_TYPE(ob, type) Py_IS_TYPE(ob, type)
#else
  #define __Pyx_IS_TYPE(ob, type) (((const PyObject*)ob)->ob_type == (type))
#endif
#if PY_VERSION_HEX >= 0x030A00B1 || defined(Py_Is)
  #define __Pyx_Py_Is(x, y)  Py_Is(x, y)
#else
  #define __Pyx_Py_Is(x, y) ((x) == (y))
#endif
#if PY_VERSION_HEX >= 0x030A00B1 || defined(Py_IsNone)
  #define __Pyx_Py_IsNone(ob) Py_IsNone(ob)
#else
  #define __Pyx_Py_IsNone(ob) __Pyx_Py_Is((ob), Py_None)
#endif
#if PY_VERSION_HEX >= 0x030A00B1 || defined(Py_IsTrue)
  #define __Pyx_Py_IsTrue(ob) Py_IsTrue(ob)
#else
  #define __Pyx_Py_IsTrue(ob) __Pyx_Py_Is((ob), Py_True)
#endif
#if PY_VERSION_HEX >= 0x030A00B1 || defined(Py_IsFalse)
  #define __Pyx_Py_IsFalse(ob) Py_IsFalse(ob)
#else
  #define __Pyx_Py_IsFalse(ob) __Pyx_Py_Is((ob), Py_False)
#endif
#define __Pyx_NoneAsNull(obj)  (__Pyx_Py_IsNone(obj) ? NULL : (obj))
#if PY_VERSION_HEX >= 0x030900F0 && !CYTHON_COMPILING_IN_PYPY
  #define __Pyx_PyObject_GC_IsFinalized(o) PyObject_GC_IsFinalized(o)
#else
  #define __Pyx_PyObject_GC_IsFinalized(o) _PyGC_FINALIZED(o)
#endif
#ifndef Py_TPFLAGS_CHECKTYPES
  #define Py_TPFLAGS_CHECKTYPES 0
#endif
#ifndef Py_TPFLAGS_HAVE_INDEX
  #define Py_TPFLAGS_HAVE_INDEX 0
#endif
#ifndef Py_TPFLAGS_HAVE_NEWBUFFER
  #define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif
#ifndef Py_TPFLAGS_HAVE_FINALIZE
  #define Py_TPFLAGS_HAVE_FINALIZE 0
#endif
#ifndef Py_TPFLAGS_SEQUENCE
  #define Py_TPFLAGS_SEQUENCE 0
#endif
#ifndef Py_TPFLAGS_MAPPING
  #define Py_TPFLAGS_MAPPING 0
#endif
#ifndef METH_STACKLESS
  #define METH_STACKLESS 0
#endif
#ifndef METH_FASTCALL
  #ifndef METH_FASTCALL
     #define METH_FASTCALL 0x80
  #endif
  typedef PyObject *(*__Pyx_PyCFunctionFast) (PyObject *self, PyObject *const *args, Py_ssize_t nargs);
  typedef PyObject *(*__Pyx_PyCFunctionFastWithKeywords) (PyObject *self, PyObject *const *args,
                                                          Py_ssize_t nargs, PyObject *kwnames);
#else
  #if PY_VERSION_HEX >= 0x030d00A4
  #  define __Pyx_PyCFunctionFast PyCFunctionFast
  #  define __Pyx_PyCFunctionFastWithKeywords PyCFunctionFastWithKeywords
  #else
  #  define __Pyx_PyCFunctionFast _PyCFunctionFast
  #  define __Pyx_PyCFunctionFastWithKeywords _PyCFunctionFastWithKeywords
  #endif
#endif
#if CYTHON_METH_FASTCALL
  #define __Pyx_METH_FASTCALL METH_FASTCALL
  #define __Pyx_PyCFunction_FastCall __Pyx_PyCFunctionFast
  #define __Pyx_PyCFunction_FastCallWithKeywords __Pyx_PyCFunctionFastWithKeywords
#else
  #define __Pyx_METH_FASTCALL METH_VARARGS
  #define __Pyx_PyCFunction_FastCall PyCFunction
  #define __Pyx_PyCFunction_FastCallWithKeywords PyCFunctionWithKeywords
#endif
#if CYTHON_VECTORCALL
  #define __pyx_vectorcallfunc vectorcallfunc
  #define __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET  PY_VECTORCALL_ARGUMENTS_OFFSET
  #define __Pyx_PyVectorcall_NARGS(n)  PyVectorcall_NARGS((size_t)(n))
#elif CYTHON_BACKPORT_VECTORCALL
  typedef PyObject *(*__pyx_vectorcallfunc)(PyObject *callable, PyObject *const *args,
                                            size_t nargsf, PyObject *kwnames);
  #define __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET  ((size_t)1 << (8 * sizeof(size_t) - 1))
  #define __Pyx_PyVectorcall_NARGS(n)  ((Py_ssize_t)(((size_t)(n)) & ~__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET))
#else
  #define __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET  0
  #define __Pyx_PyVectorcall_NARGS(n)  ((Py_ssize_t)(n))
#endif
#if PY_VERSION_HEX >= 0x030900B1
#define __Pyx_PyCFunction_CheckExact(func)  PyCFunction_CheckExact(func)
#else
#define __Pyx_PyCFunction_CheckExact(func)  PyCFunction_Check(func)
#endif
#define __Pyx_CyOrPyCFunction_Check(func)  PyCFunction_Check(func)
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_CyOrPyCFunction_GET_FUNCTION(func)  (((PyCFunctionObject*)(func))->m_ml->ml_meth)
#elif !CYTHON_COMPILING_IN_LIMITED_API
#define __Pyx_CyOrPyCFunction_GET_FUNCTION(func)  PyCFunction_GET_FUNCTION(func)
#endif
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_CyOrPyCFunction_GET_FLAGS(func)  (((PyCFunctionObject*)(func))->m_ml->ml_flags)
static CYTHON_INLINE PyObject* __Pyx_CyOrPyCFunction_GET_SELF(PyObject *func) {
    return (__Pyx_CyOrPyCFunction_GET_FLAGS(func) & METH_STATIC) ? NULL : ((PyCFunctionObject*)func)->m_self;
}
#endif
static CYTHON_INLINE int __Pyx__IsSameCFunction(PyObject *func, void (*cfunc)(void)) {
#if CYTHON_COMPILING_IN_LIMITED_API
    return PyCFunction_Check(func) && PyCFunction_GetFunction(func) == (PyCFunction) cfunc;
#else
    return PyCFunction_Check(func) && PyCFunction_GET_FUNCTION(func) == (PyCFunction) cfunc;
#endif
}
#define __Pyx_IsSameCFunction(func, cfunc)   __Pyx__IsSameCFunction(func, cfunc)
#if __PYX_LIMITED_VERSION_HEX < 0x03090000
  #define __Pyx_PyType_FromModuleAndSpec(m, s, b)  ((void)m, PyType_FromSpecWithBases(s, b))
  typedef PyObject *(*__Pyx_PyCMethod)(PyObject *, PyTypeObject *, PyObject *const *, size_t, PyObject *);
#else
  #define __Pyx_PyType_FromModuleAndSpec(m, s, b)  PyType_FromModuleAndSpec(m, s, b)
  #define __Pyx_PyCMethod  PyCMethod
#endif
#ifndef METH_METHOD
  #define METH_METHOD 0x200
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyObject_Malloc)
  #define PyObject_Malloc(s)   PyMem_Malloc(s)
  #define PyObject_Free(p)     PyMem_Free(p)
  #define PyObject_Realloc(p)  PyMem_Realloc(p)
#endif
#if CYTHON_COMPILING_IN_LIMITED_API
  #define __Pyx_PyFrame_SetLineNumber(frame, lineno)
#elif CYTHON_COMPILING_IN_GRAAL
  #define __Pyx_PyCode_HasFreeVars(co)  (PyCode_GetNumFree(co) > 0)
  #define __Pyx_PyFrame_SetLineNumber(frame, lineno) _PyFrame_SetLineNumber((frame), (lineno))
#else
  #define __Pyx_PyCode_HasFreeVars(co)  (PyCode_GetNumFree(co) > 0)
  #define __Pyx_PyFrame_SetLineNumber(frame, lineno)  (frame)->f_lineno = (lineno)
#endif
#if CYTHON_COMPILING_IN_LIMITED_API
  #define __Pyx_PyThreadState_Current PyThreadState_Get()
#elif !CYTHON_FAST_THREAD_STATE
  #define __Pyx_PyThreadState_Current PyThreadState_GET()
#elif PY_VERSION_HEX >= 0x030d00A1
  #define __Pyx_PyThreadState_Current PyThreadState_GetUnchecked()
#else
  #define __Pyx_PyThreadState_Current _PyThreadState_UncheckedGet()
#endif
#if CYTHON_USE_MODULE_STATE
static CYTHON_INLINE void *__Pyx__PyModule_GetState(PyObject *op)
{
    void *result;
    result = PyModule_GetState(op);
    if (!result)
        Py_FatalError("Couldn't find the module state");
    return result;
}
#define __Pyx_PyModule_GetState(o) (__pyx_mstatetype *)__Pyx__PyModule_GetState(o)
#else
#define __Pyx_PyModule_GetState(op) ((void)op,__pyx_mstate_global)
#endif
#define __Pyx_PyObject_GetSlot(obj, name, func_ctype)  __Pyx_PyType_GetSlot(Py_TYPE((PyObject *) obj), name, func_ctype)
#define __Pyx_PyObject_TryGetSlot(obj, name, func_ctype) __Pyx_PyType_TryGetSlot(Py_TYPE(obj), name, func_ctype)
#define __Pyx_PyObject_GetSubSlot(obj, sub, name, func_ctype) __Pyx_PyType_GetSubSlot(Py_TYPE(obj), sub, name, func_ctype)
#define __Pyx_PyObject_TryGetSubSlot(obj, sub, name, func_ctype) __Pyx_PyType_TryGetSubSlot(Py_TYPE(obj), sub, name, func_ctype)
#if CYTHON_USE_TYPE_SLOTS
  #define __Pyx_PyType_GetSlot(type, name, func_ctype)  ((type)->name)
  #define __Pyx_PyType_TryGetSlot(type, name, func_ctype) __Pyx_PyType_GetSlot(type, name, func_ctype)
  #define __Pyx_PyType_GetSubSlot(type, sub, name, func_ctype) (((type)->sub) ? ((type)->sub->name) : NULL)
  #define __Pyx_PyType_TryGetSubSlot(type, sub, name, func_ctype) __Pyx_PyType_GetSubSlot(type, sub, name, func_ctype)
#else
  #define __Pyx_PyType_GetSlot(type, name, func_ctype)  ((func_ctype) PyType_GetSlot((type), Py_##name))
  #define __Pyx_PyType_TryGetSlot(type, name, func_ctype)\
    ((__PYX_LIMITED_VERSION_HEX >= 0x030A0000 ||\
     (PyType_GetFlags(type) & Py_TPFLAGS_HEAPTYPE) || __Pyx_get_runtime_version() >= 0x030A0000) ?\
     __Pyx_PyType_GetSlot(type, name, func_ctype) : NULL)
  #define __Pyx_PyType_GetSubSlot(obj, sub, name, func_ctype) __Pyx_PyType_GetSlot(obj, name, func_ctype)
  #define __Pyx_PyType_TryGetSubSlot(obj, sub, name, func_ctype) __Pyx_PyType_TryGetSlot(obj, name, func_ctype)
#endif
#if CYTHON_COMPILING_IN_CPYTHON || defined(_PyDict_NewPresized)
#define __Pyx_PyDict_NewPresized(n)  ((n <= 8) ? PyDict_New() : _PyDict_NewPresized(n))
#else
#define __Pyx_PyDict_NewPresized(n)  PyDict_New()
#endif
#define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
#define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceTrueDivide(x,y)
#if CYTHON_COMPILING_IN_CPYTHON && CYTHON_USE_UNICODE_INTERNALS
#define __Pyx_PyDict_GetItemStrWithError(dict, name)  _PyDict_GetItem_KnownHash(dict, name, ((PyASCIIObject *) name)->hash)
static CYTHON_INLINE PyObject * __Pyx_PyDict_GetItemStr(PyObject *dict, PyObject *name) {
    PyObject *res = __Pyx_PyDict_GetItemStrWithError(dict, name);
    if (res == NULL) PyErr_Clear();
    return res;
}
#elif !CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07020000
#define __Pyx_PyDict_GetItemStrWithError  PyDict_GetItemWithError
#define __Pyx_PyDict_GetItemStr           PyDict_GetItem
#else
static CYTHON_INLINE PyObject * __Pyx_PyDict_GetItemStrWithError(PyObject *dict, PyObject *name) {
#if CYTHON_COMPILING_IN_PYPY
    return PyDict_GetItem(dict, name);
#else
    PyDictEntry *ep;
    PyDictObject *mp = (PyDictObject*) dict;
    long hash = ((PyStringObject *) name)->ob_shash;
    assert(hash != -1);
    ep = (mp->ma_lookup)(mp, name, hash);
    if (ep == NULL) {
        return NULL;
    }
    return ep->me_value;
#endif
}
#define __Pyx_PyDict_GetItemStr           PyDict_GetItem
#endif
#if CYTHON_USE_TYPE_SLOTS
  #define __Pyx_PyType_GetFlags(tp)   (((PyTypeObject *)tp)->tp_flags)
  #define __Pyx_PyType_HasFeature(type, feature)  ((__Pyx_PyType_GetFlags(type) & (feature)) != 0)
#else
  #define __Pyx_PyType_GetFlags(tp)   (PyType_GetFlags((PyTypeObject *)tp))
  #define __Pyx_PyType_HasFeature(type, feature)  PyType_HasFeature(type, feature)
#endif
#define __Pyx_PyObject_GetIterNextFunc(iterator)  __Pyx_PyObject_GetSlot(iterator, tp_iternext, iternextfunc)
#if CYTHON_USE_TYPE_SPECS && PY_VERSION_HEX >= 0x03080000
#define __Pyx_PyHeapTypeObject_GC_Del(obj)  {\
    PyTypeObject *type = Py_TYPE((PyObject*)obj);\
    assert(__Pyx_PyType_HasFeature(type, Py_TPFLAGS_HEAPTYPE));\
    PyObject_GC_Del(obj);\
    Py_DECREF(type);\
}
#else
#define __Pyx_PyHeapTypeObject_GC_Del(obj)  PyObject_GC_Del(obj)
#endif
#if CYTHON_COMPILING_IN_LIMITED_API
  #define __Pyx_PyUnicode_READY(op)       (0)
  #define __Pyx_PyUnicode_READ_CHAR(u, i) PyUnicode_ReadChar(u, i)
  #define __Pyx_PyUnicode_MAX_CHAR_VALUE(u)   ((void)u, 1114111U)
  #define __Pyx_PyUnicode_KIND(u)         ((void)u, (0))
  #define __Pyx_PyUnicode_DATA(u)         ((void*)u)
  #define __Pyx_PyUnicode_READ(k, d, i)   ((void)k, PyUnicode_ReadChar((PyObject*)(d), i))
  #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != PyUnicode_GetLength(u))
#else
  #if PY_VERSION_HEX >= 0x030C0000
    #define __Pyx_PyUnicode_READY(op)       (0)
  #else
    #define __Pyx_PyUnicode_READY(op)       (likely(PyUnicode_IS_READY(op)) ?\
                                                0 : _PyUnicode_Ready((PyObject *)(op)))
  #endif
  #define __Pyx_PyUnicode_READ_CHAR(u, i) PyUnicode_READ_CHAR(u, i)
  #define __Pyx_PyUnicode_MAX_CHAR_VALUE(u)   PyUnicode_MAX_CHAR_VALUE(u)
  #define __Pyx_PyUnicode_KIND(u)         ((int)PyUnicode_KIND(u))
  #define __Pyx_PyUnicode_DATA(u)         PyUnicode_DATA(u)
  #define __Pyx_PyUnicode_READ(k, d, i)   PyUnicode_READ(k, d, i)
  #define __Pyx_PyUnicode_WRITE(k, d, i, ch)  PyUnicode_WRITE(k, d, i, (Py_UCS4) ch)
  #if PY_VERSION_HEX >= 0x030C0000
    #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != PyUnicode_GET_LENGTH(u))
  #else
    #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x03090000
    #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != (likely(PyUnicode_IS_READY(u)) ? PyUnicode_GET_LENGTH(u) : ((PyCompactUnicodeObject *)(u))->wstr_length))
    #else
    #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != (likely(PyUnicode_IS_READY(u)) ? PyUnicode_GET_LENGTH(u) : PyUnicode_GET_SIZE(u)))
    #endif
  #endif
#endif
#if CYTHON_COMPILING_IN_PYPY
  #define __Pyx_PyUnicode_Concat(a, b)      PyNumber_Add(a, b)
  #define __Pyx_PyUnicode_ConcatSafe(a, b)  PyNumber_Add(a, b)
#else
  #define __Pyx_PyUnicode_Concat(a, b)      PyUnicode_Concat(a, b)
  #define __Pyx_PyUnicode_ConcatSafe(a, b)  ((unlikely((a) == Py_None) || unlikely((b) == Py_None)) ?\
      PyNumber_Add(a, b) : __Pyx_PyUnicode_Concat(a, b))
#endif
#if CYTHON_COMPILING_IN_PYPY
  #if !defined(PyUnicode_DecodeUnicodeEscape)
    #define PyUnicode_DecodeUnicodeEscape(s, size, errors)  PyUnicode_Decode(s, size, "unicode_escape", errors)
  #endif
  #if !defined(PyUnicode_Contains)
    #define PyUnicode_Contains(u, s)  PySequence_Contains(u, s)
  #endif
  #if !defined(PyByteArray_Check)
    #define PyByteArray_Check(obj)  PyObject_TypeCheck(obj, &PyByteArray_Type)
  #endif
  #if !defined(PyObject_Format)
    #define PyObject_Format(obj, fmt)  PyObject_CallMethod(obj, "__format__", "O", fmt)
  #endif
#endif
#define __Pyx_PyUnicode_FormatSafe(a, b)  ((unlikely((a) == Py_None || (PyUnicode_Check(b) && !PyUnicode_CheckExact(b)))) ? PyNumber_Remainder(a, b) : PyUnicode_Format(a, b))
#if CYTHON_COMPILING_IN_CPYTHON
  #define __Pyx_PySequence_ListKeepNew(obj)\
    (likely(PyList_CheckExact(obj) && Py_REFCNT(obj) == 1) ? __Pyx_NewRef(obj) : PySequence_List(obj))
#else
  #define __Pyx_PySequence_ListKeepNew(obj)  PySequence_List(obj)
#endif
#ifndef PySet_CheckExact
  #define PySet_CheckExact(obj)        __Pyx_IS_TYPE(obj, &PySet_Type)
#endif
#if PY_VERSION_HEX >= 0x030900A4
  #define __Pyx_SET_REFCNT(obj, refcnt) Py_SET_REFCNT(obj, refcnt)
  #define __Pyx_SET_SIZE(obj, size) Py_SET_SIZE(obj, size)
#else
  #define __Pyx_SET_REFCNT(obj, refcnt) Py_REFCNT(obj) = (refcnt)
  #define __Pyx_SET_SIZE(obj, size) Py_SIZE(obj) = (size)
#endif
#if CYTHON_AVOID_BORROWED_REFS || CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS
  #if __PYX_LIMITED_VERSION_HEX >= 0x030d0000
    #define __Pyx_PyList_GetItemRef(o, i) PyList_GetItemRef(o, i)
  #elif CYTHON_COMPILING_IN_LIMITED_API || !CYTHON_ASSUME_SAFE_MACROS
    #define __Pyx_PyList_GetItemRef(o, i) (likely((i) >= 0) ? PySequence_GetItem(o, i) : (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL))
  #else
    #define __Pyx_PyList_GetItemRef(o, i) PySequence_ITEM(o, i)
  #endif
#elif CYTHON_COMPILING_IN_LIMITED_API || !CYTHON_ASSUME_SAFE_MACROS
  #if __PYX_LIMITED_VERSION_HEX >= 0x030d0000
    #define __Pyx_PyList_GetItemRef(o, i) PyList_GetItemRef(o, i)
  #else
    #define __Pyx_PyList_GetItemRef(o, i) __Pyx_XNewRef(PyList_GetItem(o, i))
  #endif
#else
  #define __Pyx_PyList_GetItemRef(o, i) __Pyx_NewRef(PyList_GET_ITEM(o, i))
#endif
#if __PYX_LIMITED_VERSION_HEX >= 0x030d0000
#define __Pyx_PyDict_GetItemRef(dict, key, result) PyDict_GetItemRef(dict, key, result)
#elif CYTHON_AVOID_BORROWED_REFS || CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS
static CYTHON_INLINE int __Pyx_PyDict_GetItemRef(PyObject *dict, PyObject *key, PyObject **result) {
  *result = PyObject_GetItem(dict, key);
  if (*result == NULL) {
    if (PyErr_ExceptionMatches(PyExc_KeyError)) {
      PyErr_Clear();
      return 0;
    }
    return -1;
  }
  return 1;
}
#else
static CYTHON_INLINE int __Pyx_PyDict_GetItemRef(PyObject *dict, PyObject *key, PyObject **result) {
  *result = PyDict_GetItemWithError(dict, key);
  if (*result == NULL) {
    return PyErr_Occurred() ? -1 : 0;
  }
  Py_INCREF(*result);
  return 1;
}
#endif
#if defined(CYTHON_DEBUG_VISIT_CONST) && CYTHON_DEBUG_VISIT_CONST
  #define __Pyx_VISIT_CONST(obj)  Py_VISIT(obj)
#else
  #define __Pyx_VISIT_CONST(obj)
#endif
#if CYTHON_ASSUME_SAFE_MACROS
  #define __Pyx_PySequence_ITEM(o, i) PySequence_ITEM(o, i)
  #define __Pyx_PySequence_SIZE(seq)  Py_SIZE(seq)
  #define __Pyx_PyTuple_SET_ITEM(o, i, v) (PyTuple_SET_ITEM(o, i, v), (0))
  #define __Pyx_PyTuple_GET_ITEM(o, i) PyTuple_GET_ITEM(o, i)
  #define __Pyx_PyList_SET_ITEM(o, i, v) (PyList_SET_ITEM(o, i, v), (0))
  #define __Pyx_PyList_GET_ITEM(o, i) PyList_GET_ITEM(o, i)
#else
  #define __Pyx_PySequence_ITEM(o, i) PySequence_GetItem(o, i)
  #define __Pyx_PySequence_SIZE(seq)  PySequence_Size(seq)
  #define __Pyx_PyTuple_SET_ITEM(o, i, v) PyTuple_SetItem(o, i, v)
  #define __Pyx_PyTuple_GET_ITEM(o, i) PyTuple_GetItem(o, i)
  #define __Pyx_PyList_SET_ITEM(o, i, v) PyList_SetItem(o, i, v)
  #define __Pyx_PyList_GET_ITEM(o, i) PyList_GetItem(o, i)
#endif
#if CYTHON_ASSUME_SAFE_SIZE
  #define __Pyx_PyTuple_GET_SIZE(o) PyTuple_GET_SIZE(o)
  #define __Pyx_PyList_GET_SIZE(o) PyList_GET_SIZE(o)
  #define __Pyx_PySet_GET_SIZE(o) PySet_GET_SIZE(o)
  #define __Pyx_PyBytes_GET_SIZE(o) PyBytes_GET_SIZE(o)
  #define __Pyx_PyByteArray_GET_SIZE(o) PyByteArray_GET_SIZE(o)
  #define __Pyx_PyUnicode_GET_LENGTH(o) PyUnicode_GET_LENGTH(o)
#else
  #define __Pyx_PyTuple_GET_SIZE(o) PyTuple_Size(o)
  #define __Pyx_PyList_GET_SIZE(o) PyList_Size(o)
  #define __Pyx_PySet_GET_SIZE(o) PySet_Size(o)
  #define __Pyx_PyBytes_GET_SIZE(o) PyBytes_Size(o)
  #define __Pyx_PyByteArray_GET_SIZE(o) PyByteArray_Size(o)
  #define __Pyx_PyUnicode_GET_LENGTH(o) PyUnicode_GetLength(o)
#endif
#if __PYX_LIMITED_VERSION_HEX >= 0x030d0000
  #define __Pyx_PyImport_AddModuleRef(name) PyImport_AddModuleRef(name)
#else
  static CYTHON_INLINE PyObject *__Pyx_PyImport_AddModuleRef(const char *name) {
      PyObject *module = PyImport_AddModule(name);
      Py_XINCREF(module);
      return module;
  }
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyUnicode_InternFromString)
  #define PyUnicode_InternFromString(s) PyUnicode_FromString(s)
#endif
#define __Pyx_PyLong_FromHash_t PyLong_FromSsize_t
#define __Pyx_PyLong_AsHash_t   __Pyx_PyIndex_AsSsize_t
#if __PYX_LIMITED_VERSION_HEX >= 0x030A0000
    #define __Pyx_PySendResult PySendResult
#else
    typedef enum {
        PYGEN_RETURN = 0,
        PYGEN_ERROR = -1,
        PYGEN_NEXT = 1,
    } __Pyx_PySendResult;
#endif
#if CYTHON_COMPILING_IN_LIMITED_API || PY_VERSION_HEX < 0x030A00A3
  typedef __Pyx_PySendResult (*__Pyx_pyiter_sendfunc)(PyObject *iter, PyObject *value, PyObject **result);
#else
  #define __Pyx_pyiter_sendfunc sendfunc
#endif
#if !CYTHON_USE_AM_SEND
#define __PYX_HAS_PY_AM_SEND 0
#elif __PYX_LIMITED_VERSION_HEX >= 0x030A0000
#define __PYX_HAS_PY_AM_SEND 1
#else
#define __PYX_HAS_PY_AM_SEND 2  // our own backported implementation
#endif
#if __PYX_HAS_PY_AM_SEND < 2
    #define __Pyx_PyAsyncMethodsStruct PyAsyncMethods
#else
    typedef struct {
        unaryfunc am_await;
        unaryfunc am_aiter;
        unaryfunc am_anext;
        __Pyx_pyiter_sendfunc am_send;
    } __Pyx_PyAsyncMethodsStruct;
    #define __Pyx_SlotTpAsAsync(s) ((PyAsyncMethods*)(s))
#endif
#if CYTHON_USE_AM_SEND && PY_VERSION_HEX < 0x030A00F0
    #define __Pyx_TPFLAGS_HAVE_AM_SEND (1UL << 21)
#else
    #define __Pyx_TPFLAGS_HAVE_AM_SEND (0)
#endif
#if PY_VERSION_HEX >= 0x03090000
#define __Pyx_PyInterpreterState_Get() PyInterpreterState_Get()
#else
#define __Pyx_PyInterpreterState_Get() PyThreadState_Get()->interp
#endif
#if CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030A0000
#ifdef __cplusplus
extern "C"
#endif
PyAPI_FUNC(void *) PyMem_Calloc(size_t nelem, size_t elsize);
#endif
#if CYTHON_COMPILING_IN_LIMITED_API
static int __Pyx_init_co_variable(PyObject *inspect, const char* name, int *write_to) {
    int value;
    PyObject *py_value = PyObject_GetAttrString(inspect, name);
    if (!py_value) return 0;
    value = (int) PyLong_AsLong(py_value);
    Py_DECREF(py_value);
    *write_to = value;
    return value != -1 || !PyErr_Occurred();
}
static int __Pyx_init_co_variables(void) {
    PyObject *inspect;
    int result;
    inspect = PyImport_ImportModule("inspect");
    result =
#if !defined(CO_OPTIMIZED)
        __Pyx_init_co_variable(inspect, "CO_OPTIMIZED", &CO_OPTIMIZED) &&
#endif
#if !defined(CO_NEWLOCALS)
        __Pyx_init_co_variable(inspect, "CO_NEWLOCALS", &CO_NEWLOCALS) &&
#endif
#if !defined(CO_VARARGS)
        __Pyx_init_co_variable(inspect, "CO_VARARGS", &CO_VARARGS) &&
#endif
#if !defined(CO_VARKEYWORDS)
        __Pyx_init_co_variable(inspect, "CO_VARKEYWORDS", &CO_VARKEYWORDS) &&
#endif
#if !defined(CO_ASYNC_GENERATOR)
        __Pyx_init_co_variable(inspect, "CO_ASYNC_GENERATOR", &CO_ASYNC_GENERATOR) &&
#endif
#if !defined(CO_GENERATOR)
        __Pyx_init_co_variable(inspect, "CO_GENERATOR", &CO_GENERATOR) &&
#endif
#if !defined(CO_COROUTINE)
        __Pyx_init_co_variable(inspect, "CO_COROUTINE", &CO_COROUTINE) &&
#endif
        1;
    Py_DECREF(inspect);
    return result ? 0 : -1;
}
#else
static int __Pyx_init_co_variables(void) {
    return 0;  // It's a limited API-only feature
}
#endif

/* MathInitCode */
#if defined(_WIN32) || defined(WIN32) || defined(MS_WINDOWS)
  #ifndef _USE_MATH_DEFINES
    #define _USE_MATH_DEFINES
  #endif
#endif
#include <math.h>
#ifdef NAN
#define __PYX_NAN() ((float) NAN)
#else
static CYTHON_INLINE float __PYX_NAN() {
  float value;
  memset(&value, 0xFF, sizeof(value));
  return value;
}
#endif
#if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
#define __Pyx_truncl trunc
#else
#define __Pyx_truncl truncl
#endif

#ifndef CYTHON_CLINE_IN_TRACEBACK_RUNTIME
#define CYTHON_CLINE_IN_TRACEBACK_RUNTIME 0
#endif
#ifndef CYTHON_CLINE_IN_TRACEBACK
#define CYTHON_CLINE_IN_TRACEBACK CYTHON_CLINE_IN_TRACEBACK_RUNTIME
#endif
#if CYTHON_CLINE_IN_TRACEBACK
#define __PYX_MARK_ERR_POS(f_index, lineno)  { __pyx_filename = __pyx_f[f_index]; (void) __pyx_filename; __pyx_lineno = lineno; (void) __pyx_lineno; __pyx_clineno = __LINE__; (void) __pyx_clineno; }
#else
#define __PYX_MARK_ERR_POS(f_index, lineno)  { __pyx_filename = __pyx_f[f_index]; (void) __pyx_filename; __pyx_lineno = lineno; (void) __pyx_lineno; (void) __pyx_clineno; }
#endif
#define __PYX_ERR(f_index, lineno, Ln_error) \
    { __PYX_MARK_ERR_POS(f_index, lineno) goto Ln_error; }

#ifdef CYTHON_EXTERN_C
    #undef __PYX_EXTERN_C
    #define __PYX_EXTERN_C CYTHON_EXTERN_C
#elif defined(__PYX_EXTERN_C)
    #ifdef _MSC_VER
    #pragma message ("Please do not define the '__PYX_EXTERN_C' macro externally. Use 'CYTHON_EXTERN_C' instead.")
    #else
    #warning Please do not define the '__PYX_EXTERN_C' macro externally. Use 'CYTHON_EXTERN_C' instead.
    #endif
#else
  #ifdef __cplusplus
    #define __PYX_EXTERN_C extern "C"
  #else
    #define __PYX_EXTERN_C extern
  #endif
#endif

#define __PYX_HAVE__tmm4py__tmm4py_core
#define __PYX_HAVE_API__tmm4py__tmm4py_core
/* Early includes */
#include <petsc.h>
#include "tmm_timer.h"
#include "tmm_forcing_utils.h"
#include "tmm.h"
#include <string.h>
#include <stdio.h>

    /* Using NumPy API declarations from "numpy/__init__.cython-30.pxd" */
    
#include "numpy/arrayobject.h"
#include "numpy/ndarrayobject.h"
#include "numpy/ndarraytypes.h"
#include "numpy/arrayscalars.h"
#include "numpy/ufuncobject.h"
#include <stdlib.h>

    #if PY_MAJOR_VERSION >= 3
      #define __Pyx_PyFloat_FromString(obj)  PyFloat_FromString(obj)
    #else
      #define __Pyx_PyFloat_FromString(obj)  PyFloat_FromString(obj, NULL)
    #endif
    
#include <stddef.h>

    #if PY_MAJOR_VERSION <= 2
    #define PyDict_GetItemWithError _PyDict_GetItemWithError
    #endif
    

    #if PY_VERSION_HEX < 0x030d0000
    static CYTHON_INLINE int __Pyx_PyWeakref_GetRef(PyObject *ref, PyObject **pobj)
    {
        PyObject *obj = PyWeakref_GetObject(ref);
        if (obj == NULL) {
            // SystemError if ref is NULL
            *pobj = NULL;
            return -1;
        }
        if (obj == Py_None) {
            *pobj = NULL;
            return 0;
        }
        Py_INCREF(obj);
        *pobj = obj;
        return 1;
    }
    #else
    #define __Pyx_PyWeakref_GetRef PyWeakref_GetRef
    #endif
    
#include "pythread.h"

    #if (CYTHON_COMPILING_IN_PYPY && PYPY_VERSION_NUM < 0x07030600) && !defined(PyContextVar_Get)
    #define PyContextVar_Get(var, d, v)         ((d) ?             ((void)(var), Py_INCREF(d), (v)[0] = (d), 0) :             ((v)[0] = NULL, 0)         )
    #endif
    
#include "tmm_share.h"
#include "tmm_petsc_matvec_utils.h"
#include "tmm_profile_utils.h"
#ifdef _OPENMP
#include <omp.h>
#endif /* _OPENMP */

#if defined(PYREX_WITHOUT_ASSERTIONS) && !defined(CYTHON_WITHOUT_ASSERTIONS)
#define CYTHON_WITHOUT_ASSERTIONS
#endif

#define __PYX_DEFAULT_STRING_ENCODING_IS_ASCII 0
#define __PYX_DEFAULT_STRING_ENCODING_IS_UTF8 0
#define __PYX_DEFAULT_STRING_ENCODING ""
#define __Pyx_PyObject_FromString __Pyx_PyBytes_FromString
#define __Pyx_PyObject_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
#define __Pyx_uchar_cast(c) ((unsigned char)c)
#define __Pyx_long_cast(x) ((long)x)
#define __Pyx_fits_Py_ssize_t(v, type, is_signed)  (\
    (sizeof(type) < sizeof(Py_ssize_t))  ||\
    (sizeof(type) > sizeof(Py_ssize_t) &&\
          likely(v < (type)PY_SSIZE_T_MAX ||\
                 v == (type)PY_SSIZE_T_MAX)  &&\
          (!is_signed || likely(v > (type)PY_SSIZE_T_MIN ||\
                                v == (type)PY_SSIZE_T_MIN)))  ||\
    (sizeof(type) == sizeof(Py_ssize_t) &&\
          (is_signed || likely(v < (type)PY_SSIZE_T_MAX ||\
                               v == (type)PY_SSIZE_T_MAX)))  )
static CYTHON_INLINE int __Pyx_is_valid_index(Py_ssize_t i, Py_ssize_t limit) {
    return (size_t) i < (size_t) limit;
}
#if defined (__cplusplus) && __cplusplus >= 201103L
    #include <cstdlib>
    #define __Pyx_sst_abs(value) std::abs(value)
#elif SIZEOF_INT >= SIZEOF_SIZE_T
    #define __Pyx_sst_abs(value) abs(value)
#elif SIZEOF_LONG >= SIZEOF_SIZE_T
    #define __Pyx_sst_abs(value) labs(value)
#elif defined (_MSC_VER)
    #define __Pyx_sst_abs(value) ((Py_ssize_t)_abs64(value))
#elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define __Pyx_sst_abs(value) llabs(value)
#elif defined (__GNUC__)
    #define __Pyx_sst_abs(value) __builtin_llabs(value)
#else
    #define __Pyx_sst_abs(value) ((value<0) ? -value : value)
#endif
static CYTHON_INLINE Py_ssize_t __Pyx_ssize_strlen(const char *s);
static CYTHON_INLINE const char* __Pyx_PyObject_AsString(PyObject*);
static CYTHON_INLINE const char* __Pyx_PyObject_AsStringAndSize(PyObject*, Py_ssize_t* length);
static CYTHON_INLINE PyObject* __Pyx_PyByteArray_FromString(const char*);
#define __Pyx_PyByteArray_FromStringAndSize(s, l) PyByteArray_FromStringAndSize((const char*)s, l)
#define __Pyx_PyBytes_FromString        PyBytes_FromString
#define __Pyx_PyBytes_FromStringAndSize PyBytes_FromStringAndSize
static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromString(const char*);
#if CYTHON_ASSUME_SAFE_MACROS
    #define __Pyx_PyBytes_AsWritableString(s)     ((char*) PyBytes_AS_STRING(s))
    #define __Pyx_PyBytes_AsWritableSString(s)    ((signed char*) PyBytes_AS_STRING(s))
    #define __Pyx_PyBytes_AsWritableUString(s)    ((unsigned char*) PyBytes_AS_STRING(s))
    #define __Pyx_PyBytes_AsString(s)     ((const char*) PyBytes_AS_STRING(s))
    #define __Pyx_PyBytes_AsSString(s)    ((const signed char*) PyBytes_AS_STRING(s))
    #define __Pyx_PyBytes_AsUString(s)    ((const unsigned char*) PyBytes_AS_STRING(s))
    #define __Pyx_PyByteArray_AsString(s) PyByteArray_AS_STRING(s)
#else
    #define __Pyx_PyBytes_AsWritableString(s)     ((char*) PyBytes_AsString(s))
    #define __Pyx_PyBytes_AsWritableSString(s)    ((signed char*) PyBytes_AsString(s))
    #define __Pyx_PyBytes_AsWritableUString(s)    ((unsigned char*) PyBytes_AsString(s))
    #define __Pyx_PyBytes_AsString(s)     ((const char*) PyBytes_AsString(s))
    #define __Pyx_PyBytes_AsSString(s)    ((const signed char*) PyBytes_AsString(s))
    #define __Pyx_PyBytes_AsUString(s)    ((const unsigned char*) PyBytes_AsString(s))
    #define __Pyx_PyByteArray_AsString(s) PyByteArray_AsString(s)
#endif
#define __Pyx_PyObject_AsWritableString(s)    ((char*)(__pyx_uintptr_t) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_AsWritableSString(s)    ((signed char*)(__pyx_uintptr_t) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_AsWritableUString(s)    ((unsigned char*)(__pyx_uintptr_t) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_AsSString(s)    ((const signed char*) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_AsUString(s)    ((const unsigned char*) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
#define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
#define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
#define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
#define __Pyx_PyUnicode_FromOrdinal(o)       PyUnicode_FromOrdinal((int)o)
#define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
static CYTHON_INLINE PyObject *__Pyx_NewRef(PyObject *obj) {
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030a0000 || defined(Py_NewRef)
    return Py_NewRef(obj);
#else
    Py_INCREF(obj);
    return obj;
#endif
}
static CYTHON_INLINE PyObject *__Pyx_XNewRef(PyObject *obj) {
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030a0000 || defined(Py_XNewRef)
    return Py_XNewRef(obj);
#else
    Py_XINCREF(obj);
    return obj;
#endif
}
static CYTHON_INLINE PyObject *__Pyx_Owned_Py_None(int b);
static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b);
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
static CYTHON_INLINE PyObject* __Pyx_PyNumber_Long(PyObject* x);
#define __Pyx_PySequence_Tuple(obj)\
    (likely(PyTuple_CheckExact(obj)) ? __Pyx_NewRef(obj) : PySequence_Tuple(obj))
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
static CYTHON_INLINE PyObject * __Pyx_PyLong_FromSize_t(size_t);
static CYTHON_INLINE Py_hash_t __Pyx_PyIndex_AsHash_t(PyObject*);
#if CYTHON_ASSUME_SAFE_MACROS
#define __Pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))
#define __Pyx_PyFloat_AS_DOUBLE(x) PyFloat_AS_DOUBLE(x)
#else
#define __Pyx_PyFloat_AsDouble(x) PyFloat_AsDouble(x)
#define __Pyx_PyFloat_AS_DOUBLE(x) PyFloat_AsDouble(x)
#endif
#define __Pyx_PyFloat_AsFloat(x) ((float) __Pyx_PyFloat_AsDouble(x))
#define __Pyx_PyNumber_Int(x) (PyLong_CheckExact(x) ? __Pyx_NewRef(x) : PyNumber_Long(x))
#if CYTHON_USE_PYLONG_INTERNALS
  #if PY_VERSION_HEX >= 0x030C00A7
  #ifndef _PyLong_SIGN_MASK
    #define _PyLong_SIGN_MASK 3
  #endif
  #ifndef _PyLong_NON_SIZE_BITS
    #define _PyLong_NON_SIZE_BITS 3
  #endif
  #define __Pyx_PyLong_Sign(x)  (((PyLongObject*)x)->long_value.lv_tag & _PyLong_SIGN_MASK)
  #define __Pyx_PyLong_IsNeg(x)  ((__Pyx_PyLong_Sign(x) & 2) != 0)
  #define __Pyx_PyLong_IsNonNeg(x)  (!__Pyx_PyLong_IsNeg(x))
  #define __Pyx_PyLong_IsZero(x)  (__Pyx_PyLong_Sign(x) & 1)
  #define __Pyx_PyLong_IsPos(x)  (__Pyx_PyLong_Sign(x) == 0)
  #define __Pyx_PyLong_CompactValueUnsigned(x)  (__Pyx_PyLong_Digits(x)[0])
  #define __Pyx_PyLong_DigitCount(x)  ((Py_ssize_t) (((PyLongObject*)x)->long_value.lv_tag >> _PyLong_NON_SIZE_BITS))
  #define __Pyx_PyLong_SignedDigitCount(x)\
        ((1 - (Py_ssize_t) __Pyx_PyLong_Sign(x)) * __Pyx_PyLong_DigitCount(x))
  #if defined(PyUnstable_Long_IsCompact) && defined(PyUnstable_Long_CompactValue)
    #define __Pyx_PyLong_IsCompact(x)     PyUnstable_Long_IsCompact((PyLongObject*) x)
    #define __Pyx_PyLong_CompactValue(x)  PyUnstable_Long_CompactValue((PyLongObject*) x)
  #else
    #define __Pyx_PyLong_IsCompact(x)     (((PyLongObject*)x)->long_value.lv_tag < (2 << _PyLong_NON_SIZE_BITS))
    #define __Pyx_PyLong_CompactValue(x)  ((1 - (Py_ssize_t) __Pyx_PyLong_Sign(x)) * (Py_ssize_t) __Pyx_PyLong_Digits(x)[0])
  #endif
  typedef Py_ssize_t  __Pyx_compact_pylong;
  typedef size_t  __Pyx_compact_upylong;
  #else
  #define __Pyx_PyLong_IsNeg(x)  (Py_SIZE(x) < 0)
  #define __Pyx_PyLong_IsNonNeg(x)  (Py_SIZE(x) >= 0)
  #define __Pyx_PyLong_IsZero(x)  (Py_SIZE(x) == 0)
  #define __Pyx_PyLong_IsPos(x)  (Py_SIZE(x) > 0)
  #define __Pyx_PyLong_CompactValueUnsigned(x)  ((Py_SIZE(x) == 0) ? 0 : __Pyx_PyLong_Digits(x)[0])
  #define __Pyx_PyLong_DigitCount(x)  __Pyx_sst_abs(Py_SIZE(x))
  #define __Pyx_PyLong_SignedDigitCount(x)  Py_SIZE(x)
  #define __Pyx_PyLong_IsCompact(x)  (Py_SIZE(x) == 0 || Py_SIZE(x) == 1 || Py_SIZE(x) == -1)
  #define __Pyx_PyLong_CompactValue(x)\
        ((Py_SIZE(x) == 0) ? (sdigit) 0 : ((Py_SIZE(x) < 0) ? -(sdigit)__Pyx_PyLong_Digits(x)[0] : (sdigit)__Pyx_PyLong_Digits(x)[0]))
  typedef sdigit  __Pyx_compact_pylong;
  typedef digit  __Pyx_compact_upylong;
  #endif
  #if PY_VERSION_HEX >= 0x030C00A5
  #define __Pyx_PyLong_Digits(x)  (((PyLongObject*)x)->long_value.ob_digit)
  #else
  #define __Pyx_PyLong_Digits(x)  (((PyLongObject*)x)->ob_digit)
  #endif
#endif
#if __PYX_DEFAULT_STRING_ENCODING_IS_UTF8
  #define __Pyx_PyUnicode_FromStringAndSize(c_str, size) PyUnicode_DecodeUTF8(c_str, size, NULL)
#elif __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
  #define __Pyx_PyUnicode_FromStringAndSize(c_str, size) PyUnicode_DecodeASCII(c_str, size, NULL)
#else
  #define __Pyx_PyUnicode_FromStringAndSize(c_str, size) PyUnicode_Decode(c_str, size, __PYX_DEFAULT_STRING_ENCODING, NULL)
#endif


/* Test for GCC > 2.95 */
#if defined(__GNUC__)     && (__GNUC__ > 2 || (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)))
  #define likely(x)   __builtin_expect(!!(x), 1)
  #define unlikely(x) __builtin_expect(!!(x), 0)
#else /* !__GNUC__ or GCC < 2.95 */
  #define likely(x)   (x)
  #define unlikely(x) (x)
#endif /* __GNUC__ */
/* PretendToInitialize */
#ifdef __cplusplus
#if __cplusplus > 201103L
#include <type_traits>
#endif
template <typename T>
static void __Pyx_pretend_to_initialize(T* ptr) {
#if __cplusplus > 201103L
    if ((std::is_trivially_default_constructible<T>::value))
#endif
        *ptr = T();
    (void)ptr;
}
#else
static CYTHON_INLINE void __Pyx_pretend_to_initialize(void* ptr) { (void)ptr; }
#endif


#if !CYTHON_USE_MODULE_STATE
static PyObject *__pyx_m = NULL;
#endif
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char * const __pyx_cfilenm = __FILE__;
static const char *__pyx_filename;

/* Header.proto */
#if !defined(CYTHON_CCOMPLEX)
  #if defined(__cplusplus)
    #define CYTHON_CCOMPLEX 1
  #elif (defined(_Complex_I) && !defined(_MSC_VER)) || ((defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) && !defined(__STDC_NO_COMPLEX__) && !defined(_MSC_VER))
    #define CYTHON_CCOMPLEX 1
  #else
    #define CYTHON_CCOMPLEX 0
  #endif
#endif
#if CYTHON_CCOMPLEX
  #ifdef __cplusplus
    #include <complex>
  #else
    #include <complex.h>
  #endif
#endif
#if CYTHON_CCOMPLEX && !defined(__cplusplus) && defined(__sun__) && defined(__GNUC__)
  #undef _Complex_I
  #define _Complex_I 1.0fj
#endif

/* #### Code section: filename_table ### */

static const char* const __pyx_f[] = {
  "tmm4py/tmm4py_core.pyx",
  "<stringsource>",
  "tmm4py/tmm4py_core.pxd",
  "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd",
  "cpython/contextvars.pxd",
  "petsc4py/PETSc.pxd",
  "cpython/type.pxd",
  "cpython/bool.pxd",
  "cpython/complex.pxd",
};
/* #### Code section: utility_code_proto_before_types ### */
/* ForceInitThreads.proto */
#ifndef __PYX_FORCE_INIT_THREADS
  #define __PYX_FORCE_INIT_THREADS 0
#endif

/* NoFastGil.proto */
#define __Pyx_PyGILState_Ensure PyGILState_Ensure
#define __Pyx_PyGILState_Release PyGILState_Release
#define __Pyx_FastGIL_Remember()
#define __Pyx_FastGIL_Forget()
#define __Pyx_FastGilFuncInit()

/* Atomics.proto */
#include <pythread.h>
#ifndef CYTHON_ATOMICS
    #define CYTHON_ATOMICS 1
#endif
#define __PYX_CYTHON_ATOMICS_ENABLED() CYTHON_ATOMICS
#define __PYX_GET_CYTHON_COMPILING_IN_CPYTHON_FREETHREADING() CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
#define __pyx_atomic_int_type int
#define __pyx_nonatomic_int_type int
#if CYTHON_ATOMICS && (defined(__STDC_VERSION__) &&\
                        (__STDC_VERSION__ >= 201112L) &&\
                        !defined(__STDC_NO_ATOMICS__))
    #include <stdatomic.h>
#elif CYTHON_ATOMICS && (defined(__cplusplus) && (\
                    (__cplusplus >= 201103L) ||\
                    (defined(_MSC_VER) && _MSC_VER >= 1700)))
    #include <atomic>
#endif
#if CYTHON_ATOMICS && (defined(__STDC_VERSION__) &&\
                        (__STDC_VERSION__ >= 201112L) &&\
                        !defined(__STDC_NO_ATOMICS__) &&\
                       ATOMIC_INT_LOCK_FREE == 2)
    #undef __pyx_atomic_int_type
    #define __pyx_atomic_int_type atomic_int
    #define __pyx_atomic_ptr_type atomic_uintptr_t
    #define __pyx_nonatomic_ptr_type uintptr_t
    #define __pyx_atomic_incr_relaxed(value) atomic_fetch_add_explicit(value, 1, memory_order_relaxed)
    #define __pyx_atomic_incr_acq_rel(value) atomic_fetch_add_explicit(value, 1, memory_order_acq_rel)
    #define __pyx_atomic_decr_acq_rel(value) atomic_fetch_sub_explicit(value, 1, memory_order_acq_rel)
    #define __pyx_atomic_sub(value, arg) atomic_fetch_sub(value, arg)
    #define __pyx_atomic_int_cmp_exchange(value, expected, desired) atomic_compare_exchange_strong(value, expected, desired)
    #define __pyx_atomic_load(value) atomic_load(value)
    #define __pyx_atomic_store(value, new_value) atomic_store(value, new_value)
    #define __pyx_atomic_pointer_load_relaxed(value) atomic_load_explicit(value, memory_order_relaxed)
    #define __pyx_atomic_pointer_load_acquire(value) atomic_load_explicit(value, memory_order_acquire)
    #define __pyx_atomic_pointer_exchange(value, new_value) atomic_exchange(value, (__pyx_nonatomic_ptr_type)new_value)
    #if defined(__PYX_DEBUG_ATOMICS) && defined(_MSC_VER)
        #pragma message ("Using standard C atomics")
    #elif defined(__PYX_DEBUG_ATOMICS)
        #warning "Using standard C atomics"
    #endif
#elif CYTHON_ATOMICS && (defined(__cplusplus) && (\
                    (__cplusplus >= 201103L) ||\
\
                    (defined(_MSC_VER) && _MSC_VER >= 1700)) &&\
                    ATOMIC_INT_LOCK_FREE == 2)
    #undef __pyx_atomic_int_type
    #define __pyx_atomic_int_type std::atomic_int
    #define __pyx_atomic_ptr_type std::atomic_uintptr_t
    #define __pyx_nonatomic_ptr_type uintptr_t
    #define __pyx_atomic_incr_relaxed(value) std::atomic_fetch_add_explicit(value, 1, std::memory_order_relaxed)
    #define __pyx_atomic_incr_acq_rel(value) std::atomic_fetch_add_explicit(value, 1, std::memory_order_acq_rel)
    #define __pyx_atomic_decr_acq_rel(value) std::atomic_fetch_sub_explicit(value, 1, std::memory_order_acq_rel)
    #define __pyx_atomic_sub(value, arg) std::atomic_fetch_sub(value, arg)
    #define __pyx_atomic_int_cmp_exchange(value, expected, desired) std::atomic_compare_exchange_strong(value, expected, desired)
    #define __pyx_atomic_load(value) std::atomic_load(value)
    #define __pyx_atomic_store(value, new_value) std::atomic_store(value, new_value)
    #define __pyx_atomic_pointer_load_relaxed(value) std::atomic_load_explicit(value, std::memory_order_relaxed)
    #define __pyx_atomic_pointer_load_acquire(value) std::atomic_load_explicit(value, std::memory_order_acquire)
    #define __pyx_atomic_pointer_exchange(value, new_value) std::atomic_exchange(value, (__pyx_nonatomic_ptr_type)new_value)
    #if defined(__PYX_DEBUG_ATOMICS) && defined(_MSC_VER)
        #pragma message ("Using standard C++ atomics")
    #elif defined(__PYX_DEBUG_ATOMICS)
        #warning "Using standard C++ atomics"
    #endif
#elif CYTHON_ATOMICS && (__GNUC__ >= 5 || (__GNUC__ == 4 &&\
                    (__GNUC_MINOR__ > 1 ||\
                    (__GNUC_MINOR__ == 1 && __GNUC_PATCHLEVEL__ >= 2))))
    #define __pyx_atomic_ptr_type void*
    #define __pyx_atomic_incr_relaxed(value) __sync_fetch_and_add(value, 1)
    #define __pyx_atomic_incr_acq_rel(value) __sync_fetch_and_add(value, 1)
    #define __pyx_atomic_decr_acq_rel(value) __sync_fetch_and_sub(value, 1)
    #define __pyx_atomic_sub(value, arg) __sync_fetch_and_sub(value, arg)
    static CYTHON_INLINE int __pyx_atomic_int_cmp_exchange(__pyx_atomic_int_type* value, __pyx_nonatomic_int_type* expected, __pyx_nonatomic_int_type desired) {
        __pyx_nonatomic_int_type old = __sync_val_compare_and_swap(value, *expected, desired);
        int result = old == *expected;
        *expected = old;
        return result;
    }
    #define __pyx_atomic_load(value) __sync_fetch_and_add(value, 0)
    #define __pyx_atomic_store(value, new_value) __sync_lock_test_and_set(value, new_value)
    #define __pyx_atomic_pointer_load_relaxed(value) __sync_fetch_and_add(value, 0)
    #define __pyx_atomic_pointer_load_acquire(value) __sync_fetch_and_add(value, 0)
    #define __pyx_atomic_pointer_exchange(value, new_value) __sync_lock_test_and_set(value, (__pyx_atomic_ptr_type)new_value)
    #ifdef __PYX_DEBUG_ATOMICS
        #warning "Using GNU atomics"
    #endif
#elif CYTHON_ATOMICS && defined(_MSC_VER)
    #include <intrin.h>
    #undef __pyx_atomic_int_type
    #define __pyx_atomic_int_type long
    #define __pyx_atomic_ptr_type void*
    #undef __pyx_nonatomic_int_type
    #define __pyx_nonatomic_int_type long
    #pragma intrinsic (_InterlockedExchangeAdd, _InterlockedExchange, _InterlockedCompareExchange, _InterlockedCompareExchangePointer, _InterlockedExchangePointer)
    #define __pyx_atomic_incr_relaxed(value) _InterlockedExchangeAdd(value, 1)
    #define __pyx_atomic_incr_acq_rel(value) _InterlockedExchangeAdd(value, 1)
    #define __pyx_atomic_decr_acq_rel(value) _InterlockedExchangeAdd(value, -1)
    #define __pyx_atomic_sub(value, arg) _InterlockedExchangeAdd(value, -arg)
    static CYTHON_INLINE int __pyx_atomic_int_cmp_exchange(__pyx_atomic_int_type* value, __pyx_nonatomic_int_type* expected, __pyx_nonatomic_int_type desired) {
        __pyx_nonatomic_int_type old = _InterlockedCompareExchange(value, desired, *expected);
        int result = old == *expected;
        *expected = old;
        return result;
    }
    #define __pyx_atomic_load(value) _InterlockedExchangeAdd(value, 0)
    #define __pyx_atomic_store(value, new_value) _InterlockedExchange(value, new_value)
    #define __pyx_atomic_pointer_load_relaxed(value) *(void * volatile *)value
    #define __pyx_atomic_pointer_load_acquire(value) _InterlockedCompareExchangePointer(value, 0, 0)
    #define __pyx_atomic_pointer_exchange(value, new_value) _InterlockedExchangePointer(value, (__pyx_atomic_ptr_type)new_value)
    #ifdef __PYX_DEBUG_ATOMICS
        #pragma message ("Using MSVC atomics")
    #endif
#else
    #undef CYTHON_ATOMICS
    #define CYTHON_ATOMICS 0
    #ifdef __PYX_DEBUG_ATOMICS
        #warning "Not using atomics"
    #endif
#endif
#if CYTHON_ATOMICS
    #define __pyx_add_acquisition_count(memview)\
             __pyx_atomic_incr_relaxed(__pyx_get_slice_count_pointer(memview))
    #define __pyx_sub_acquisition_count(memview)\
            __pyx_atomic_decr_acq_rel(__pyx_get_slice_count_pointer(memview))
#else
    #define __pyx_add_acquisition_count(memview)\
            __pyx_add_acquisition_count_locked(__pyx_get_slice_count_pointer(memview), memview->lock)
    #define __pyx_sub_acquisition_count(memview)\
            __pyx_sub_acquisition_count_locked(__pyx_get_slice_count_pointer(memview), memview->lock)
#endif

/* BufferFormatStructs.proto */
struct __Pyx_StructField_;
#define __PYX_BUF_FLAGS_PACKED_STRUCT (1 << 0)
typedef struct {
  const char* name;
  const struct __Pyx_StructField_* fields;
  size_t size;
  size_t arraysize[8];
  int ndim;
  char typegroup;
  char is_unsigned;
  int flags;
} __Pyx_TypeInfo;
typedef struct __Pyx_StructField_ {
  const __Pyx_TypeInfo* type;
  const char* name;
  size_t offset;
} __Pyx_StructField;
typedef struct {
  const __Pyx_StructField* field;
  size_t parent_offset;
} __Pyx_BufFmt_StackElem;
typedef struct {
  __Pyx_StructField root;
  __Pyx_BufFmt_StackElem* head;
  size_t fmt_offset;
  size_t new_count, enc_count;
  size_t struct_alignment;
  int is_complex;
  char enc_type;
  char new_packmode;
  char enc_packmode;
  char is_valid_array;
} __Pyx_BufFmt_Context;

/* IncludeStructmemberH.proto */
#include <structmember.h>

/* CriticalSections.proto */
#if !CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
#define __Pyx_PyCriticalSection void*
#define __Pyx_PyCriticalSection2 void*
#define __Pyx_PyCriticalSection_Begin1(cs, arg) (void)cs
#define __Pyx_PyCriticalSection_Begin2(cs, arg1, arg2) (void)cs
#define __Pyx_PyCriticalSection_End1(cs)
#define __Pyx_PyCriticalSection_End2(cs)
#else
#define __Pyx_PyCriticalSection PyCriticalSection
#define __Pyx_PyCriticalSection2 PyCriticalSection2
#define __Pyx_PyCriticalSection_Begin1 PyCriticalSection_Begin
#define __Pyx_PyCriticalSection_Begin2 PyCriticalSection2_Begin
#define __Pyx_PyCriticalSection_End1 PyCriticalSection_End
#define __Pyx_PyCriticalSection_End2 PyCriticalSection2_End
#endif
#if PY_VERSION_HEX < 0x030d0000 || CYTHON_COMPILING_IN_LIMITED_API
#define __Pyx_BEGIN_CRITICAL_SECTION(o) {
#define __Pyx_END_CRITICAL_SECTION() }
#else
#define __Pyx_BEGIN_CRITICAL_SECTION Py_BEGIN_CRITICAL_SECTION
#define __Pyx_END_CRITICAL_SECTION Py_END_CRITICAL_SECTION
#endif

/* #### Code section: numeric_typedefs ### */

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":770
 * # in Cython to enable them only on the right systems.
 * 
 * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
 * ctypedef npy_int16      int16_t
 * ctypedef npy_int32      int32_t
*/
typedef npy_int8 __pyx_t_5numpy_int8_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":771
 * 
 * ctypedef npy_int8       int8_t
 * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
 * ctypedef npy_int32      int32_t
 * ctypedef npy_int64      int64_t
*/
typedef npy_int16 __pyx_t_5numpy_int16_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":772
 * ctypedef npy_int8       int8_t
 * ctypedef npy_int16      int16_t
 * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
 * ctypedef npy_int64      int64_t
 * #ctypedef npy_int96      int96_t
*/
typedef npy_int32 __pyx_t_5numpy_int32_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":773
 * ctypedef npy_int16      int16_t
 * ctypedef npy_int32      int32_t
 * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
 * #ctypedef npy_int96      int96_t
 * #ctypedef npy_int128     int128_t
*/
typedef npy_int64 __pyx_t_5numpy_int64_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":777
 * #ctypedef npy_int128     int128_t
 * 
 * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
 * ctypedef npy_uint16     uint16_t
 * ctypedef npy_uint32     uint32_t
*/
typedef npy_uint8 __pyx_t_5numpy_uint8_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":778
 * 
 * ctypedef npy_uint8      uint8_t
 * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
 * ctypedef npy_uint32     uint32_t
 * ctypedef npy_uint64     uint64_t
*/
typedef npy_uint16 __pyx_t_5numpy_uint16_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":779
 * ctypedef npy_uint8      uint8_t
 * ctypedef npy_uint16     uint16_t
 * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
 * ctypedef npy_uint64     uint64_t
 * #ctypedef npy_uint96     uint96_t
*/
typedef npy_uint32 __pyx_t_5numpy_uint32_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":780
 * ctypedef npy_uint16     uint16_t
 * ctypedef npy_uint32     uint32_t
 * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
 * #ctypedef npy_uint96     uint96_t
 * #ctypedef npy_uint128    uint128_t
*/
typedef npy_uint64 __pyx_t_5numpy_uint64_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":784
 * #ctypedef npy_uint128    uint128_t
 * 
 * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
 * ctypedef npy_float64    float64_t
 * #ctypedef npy_float80    float80_t
*/
typedef npy_float32 __pyx_t_5numpy_float32_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":785
 * 
 * ctypedef npy_float32    float32_t
 * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
 * #ctypedef npy_float80    float80_t
 * #ctypedef npy_float128   float128_t
*/
typedef npy_float64 __pyx_t_5numpy_float64_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":792
 * ctypedef double complex complex128_t
 * 
 * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
 * ctypedef npy_ulonglong  ulonglong_t
 * 
*/
typedef npy_longlong __pyx_t_5numpy_longlong_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":793
 * 
 * ctypedef npy_longlong   longlong_t
 * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
 * 
 * ctypedef npy_intp       intp_t
*/
typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":795
 * ctypedef npy_ulonglong  ulonglong_t
 * 
 * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
 * ctypedef npy_uintp      uintp_t
 * 
*/
typedef npy_intp __pyx_t_5numpy_intp_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":796
 * 
 * ctypedef npy_intp       intp_t
 * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
 * 
 * ctypedef npy_double     float_t
*/
typedef npy_uintp __pyx_t_5numpy_uintp_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":798
 * ctypedef npy_uintp      uintp_t
 * 
 * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
 * ctypedef npy_double     double_t
 * ctypedef npy_longdouble longdouble_t
*/
typedef npy_double __pyx_t_5numpy_float_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":799
 * 
 * ctypedef npy_double     float_t
 * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
 * ctypedef npy_longdouble longdouble_t
 * 
*/
typedef npy_double __pyx_t_5numpy_double_t;

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":800
 * ctypedef npy_double     float_t
 * ctypedef npy_double     double_t
 * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
 * 
 * ctypedef float complex       cfloat_t
*/
typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
/* #### Code section: complex_type_declarations ### */
/* Declarations.proto */
#if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
  #ifdef __cplusplus
    typedef ::std::complex< float > __pyx_t_float_complex;
  #else
    typedef float _Complex __pyx_t_float_complex;
  #endif
#else
    typedef struct { float real, imag; } __pyx_t_float_complex;
#endif
static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float, float);

/* Declarations.proto */
#if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
  #ifdef __cplusplus
    typedef ::std::complex< double > __pyx_t_double_complex;
  #else
    typedef double _Complex __pyx_t_double_complex;
  #endif
#else
    typedef struct { double real, imag; } __pyx_t_double_complex;
#endif
static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double, double);

/* Declarations.proto */
#if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
  #ifdef __cplusplus
    typedef ::std::complex< long double > __pyx_t_long_double_complex;
  #else
    typedef long double _Complex __pyx_t_long_double_complex;
  #endif
#else
    typedef struct { long double real, imag; } __pyx_t_long_double_complex;
#endif
static CYTHON_INLINE __pyx_t_long_double_complex __pyx_t_long_double_complex_from_parts(long double, long double);

/* #### Code section: type_declarations ### */

/*--- Type declarations ---*/
struct PyPetscCommObject;
struct PyPetscObjectObject;
struct PyPetscViewerObject;
struct PyPetscRandomObject;
struct PyPetscDeviceObject;
struct PyPetscDeviceContextObject;
struct PyPetscISObject;
struct PyPetscLGMapObject;
struct PyPetscSFObject;
struct PyPetscVecObject;
struct PyPetscSpaceObject;
struct PyPetscDualSpaceObject;
struct PyPetscFEObject;
struct PyPetscQuadObject;
struct PyPetscScatterObject;
struct PyPetscSectionObject;
struct PyPetscMatObject;
struct PyPetscMatPartitioningObject;
struct PyPetscNullSpaceObject;
struct PyPetscPCObject;
struct PyPetscKSPObject;
struct PyPetscSNESObject;
struct PyPetscSNESLineSearchObject;
struct PyPetscTSObject;
struct PyPetscTAOObject;
struct PyPetscTAOLineSearchObject;
struct PyPetscAOObject;
struct PyPetscDMObject;
struct PyPetscDMPlexTransformObject;
struct PyPetscDMSwarmCellDMObject;
struct PyPetscDSObject;
struct PyPetscPartitionerObject;
struct PyPetscDMLabelObject;
struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState;
struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer;
struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer;
struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer;
struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec;
struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec;
struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray;
struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray;
struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper;
struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel;
struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper;
struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel;
struct __pyx_opt_args_7cpython_11contextvars_get_value;
struct __pyx_opt_args_7cpython_11contextvars_get_value_no_default;

/* "cpython/contextvars.pxd":116
 * 
 * @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")
 * cdef inline object get_value(var, default_value=None):             # <<<<<<<<<<<<<<
 *     """Return a new reference to the value of the context variable,
 *     or the default value of the context variable,
*/
struct __pyx_opt_args_7cpython_11contextvars_get_value {
  int __pyx_n;
  PyObject *default_value;
};

/* "cpython/contextvars.pxd":134
 * 
 * @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")
 * cdef inline object get_value_no_default(var, default_value=None):             # <<<<<<<<<<<<<<
 *     """Return a new reference to the value of the context variable,
 *     or the provided default value if no such value was found.
*/
struct __pyx_opt_args_7cpython_11contextvars_get_value_no_default {
  int __pyx_n;
  PyObject *default_value;
};

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1096
 * 
 * # Iterator API added in v1.6
 * ctypedef int (*NpyIter_IterNextFunc)(NpyIter* it) noexcept nogil             # <<<<<<<<<<<<<<
 * ctypedef void (*NpyIter_GetMultiIndexFunc)(NpyIter* it, npy_intp* outcoords) noexcept nogil
 * 
*/
typedef int (*__pyx_t_5numpy_NpyIter_IterNextFunc)(NpyIter *);

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1097
 * # Iterator API added in v1.6
 * ctypedef int (*NpyIter_IterNextFunc)(NpyIter* it) noexcept nogil
 * ctypedef void (*NpyIter_GetMultiIndexFunc)(NpyIter* it, npy_intp* outcoords) noexcept nogil             # <<<<<<<<<<<<<<
 * 
 * cdef extern from "numpy/arrayobject.h":
*/
typedef void (*__pyx_t_5numpy_NpyIter_GetMultiIndexFunc)(NpyIter *, npy_intp *);

/* "petsc4py/PETSc.pxd":115
 * # --------------------------------------------------------------------
 * 
 * ctypedef public api class Comm [             # <<<<<<<<<<<<<<
 *     type   PyPetscComm_Type,
 *     object PyPetscCommObject,
*/
struct PyPetscCommObject {
  PyObject_HEAD
  MPI_Comm comm;
  int isdup;
  PyObject *base;
};
typedef struct PyPetscCommObject PyPetscCommObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscComm_Type;

/* "petsc4py/PETSc.pxd":123
 *     cdef object base
 * 
 * ctypedef public api class Object [             # <<<<<<<<<<<<<<
 *     type   PyPetscObject_Type,
 *     object PyPetscObjectObject,
*/
struct PyPetscObjectObject {
  PyObject_HEAD
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object *__pyx_vtab;
  PyObject *__weakref__;
  PyObject *__dummy__;
  PetscObject oval;
  PetscObject *obj;
};
typedef struct PyPetscObjectObject PyPetscObjectObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscObject_Type;

/* "petsc4py/PETSc.pxd":135
 *     cdef object get_dict(self)
 * 
 * ctypedef public api class Viewer(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscViewer_Type,
 *     object PyPetscViewerObject,
*/
struct PyPetscViewerObject {
  struct PyPetscObjectObject __pyx_base;
  PetscViewer vwr;
};
typedef struct PyPetscViewerObject PyPetscViewerObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscViewer_Type;

/* "petsc4py/PETSc.pxd":141
 *     cdef PetscViewer vwr
 * 
 * ctypedef public api class Random(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscRandom_Type,
 *     object PyPetscRandomObject,
*/
struct PyPetscRandomObject {
  struct PyPetscObjectObject __pyx_base;
  PetscRandom rnd;
};
typedef struct PyPetscRandomObject PyPetscRandomObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscRandom_Type;

/* "petsc4py/PETSc.pxd":147
 *     cdef PetscRandom rnd
 * 
 * ctypedef public api class Device [             # <<<<<<<<<<<<<<
 *     type   PyPetscDevice_Type,
 *     object PyPetscDeviceObject,
*/
struct PyPetscDeviceObject {
  PyObject_HEAD
  PetscDevice device;
  PyObject *__weakref__;
};
typedef struct PyPetscDeviceObject PyPetscDeviceObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDevice_Type;

/* "petsc4py/PETSc.pxd":154
 *     cdef object __weakref__
 * 
 * ctypedef public api class DeviceContext(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDeviceContext_Type,
 *     object PyPetscDeviceContextObject,
*/
struct PyPetscDeviceContextObject {
  struct PyPetscObjectObject __pyx_base;
  PetscDeviceContext dctx;
};
typedef struct PyPetscDeviceContextObject PyPetscDeviceContextObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDeviceContext_Type;

/* "petsc4py/PETSc.pxd":160
 *     cdef PetscDeviceContext dctx
 * 
 * ctypedef public api class IS(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscIS_Type,
 *     object PyPetscISObject,
*/
struct PyPetscISObject {
  struct PyPetscObjectObject __pyx_base;
  IS iset;
};
typedef struct PyPetscISObject PyPetscISObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscIS_Type;

/* "petsc4py/PETSc.pxd":166
 *     cdef PetscIS iset
 * 
 * ctypedef public api class LGMap(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscLGMap_Type,
 *     object PyPetscLGMapObject,
*/
struct PyPetscLGMapObject {
  struct PyPetscObjectObject __pyx_base;
  ISLocalToGlobalMapping lgm;
};
typedef struct PyPetscLGMapObject PyPetscLGMapObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscLGMap_Type;

/* "petsc4py/PETSc.pxd":172
 *     cdef PetscLGMap lgm
 * 
 * ctypedef public api class SF(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscSF_Type,
 *     object PyPetscSFObject,
*/
struct PyPetscSFObject {
  struct PyPetscObjectObject __pyx_base;
  PetscSF sf;
};
typedef struct PyPetscSFObject PyPetscSFObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscSF_Type;

/* "petsc4py/PETSc.pxd":178
 *     cdef PetscSF sf
 * 
 * ctypedef public api class Vec(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscVec_Type,
 *     object PyPetscVecObject,
*/
struct PyPetscVecObject {
  struct PyPetscObjectObject __pyx_base;
  Vec vec;
};
typedef struct PyPetscVecObject PyPetscVecObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscVec_Type;

/* "petsc4py/PETSc.pxd":184
 *     cdef PetscVec vec
 * 
 * ctypedef public api class Space(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscSpace_Type,
 *     object PyPetscSpaceObject,
*/
struct PyPetscSpaceObject {
  struct PyPetscObjectObject __pyx_base;
  PetscSpace space;
};
typedef struct PyPetscSpaceObject PyPetscSpaceObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscSpace_Type;

/* "petsc4py/PETSc.pxd":190
 *     cdef PetscSpace space
 * 
 * ctypedef public api class DualSpace(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDualSpace_Type,
 *     object PyPetscDualSpaceObject,
*/
struct PyPetscDualSpaceObject {
  struct PyPetscObjectObject __pyx_base;
  PetscDualSpace dualspace;
};
typedef struct PyPetscDualSpaceObject PyPetscDualSpaceObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDualSpace_Type;

/* "petsc4py/PETSc.pxd":196
 *     cdef PetscDualSpace dualspace
 * 
 * ctypedef public api class FE(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscFE_Type,
 *     object PyPetscFEObject,
*/
struct PyPetscFEObject {
  struct PyPetscObjectObject __pyx_base;
  PetscFE fe;
};
typedef struct PyPetscFEObject PyPetscFEObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscFE_Type;

/* "petsc4py/PETSc.pxd":202
 *     cdef PetscFE fe
 * 
 * ctypedef public api class Quad(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscQuad_Type,
 *     object PyPetscQuadObject,
*/
struct PyPetscQuadObject {
  struct PyPetscObjectObject __pyx_base;
  PetscQuadrature quad;
};
typedef struct PyPetscQuadObject PyPetscQuadObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscQuad_Type;

/* "petsc4py/PETSc.pxd":208
 *     cdef PetscQuadrature quad
 * 
 * ctypedef public api class Scatter(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscScatter_Type,
 *     object PyPetscScatterObject,
*/
struct PyPetscScatterObject {
  struct PyPetscObjectObject __pyx_base;
  VecScatter sct;
};
typedef struct PyPetscScatterObject PyPetscScatterObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscScatter_Type;

/* "petsc4py/PETSc.pxd":214
 *     cdef PetscScatter sct
 * 
 * ctypedef public api class Section(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscSection_Type,
 *     object PyPetscSectionObject,
*/
struct PyPetscSectionObject {
  struct PyPetscObjectObject __pyx_base;
  PetscSection sec;
};
typedef struct PyPetscSectionObject PyPetscSectionObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscSection_Type;

/* "petsc4py/PETSc.pxd":220
 *     cdef PetscSection sec
 * 
 * ctypedef public api class Mat(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscMat_Type,
 *     object PyPetscMatObject,
*/
struct PyPetscMatObject {
  struct PyPetscObjectObject __pyx_base;
  Mat mat;
};
typedef struct PyPetscMatObject PyPetscMatObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscMat_Type;

/* "petsc4py/PETSc.pxd":226
 *     cdef PetscMat mat
 * 
 * ctypedef public api class MatPartitioning(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscMatPartitioning_Type,
 *     object PyPetscMatPartitioningObject,
*/
struct PyPetscMatPartitioningObject {
  struct PyPetscObjectObject __pyx_base;
  MatPartitioning part;
};
typedef struct PyPetscMatPartitioningObject PyPetscMatPartitioningObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscMatPartitioning_Type;

/* "petsc4py/PETSc.pxd":232
 *     cdef PetscMatPartitioning part
 * 
 * ctypedef public api class NullSpace(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscNullSpace_Type,
 *     object PyPetscNullSpaceObject,
*/
struct PyPetscNullSpaceObject {
  struct PyPetscObjectObject __pyx_base;
  MatNullSpace nsp;
};
typedef struct PyPetscNullSpaceObject PyPetscNullSpaceObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscNullSpace_Type;

/* "petsc4py/PETSc.pxd":238
 *     cdef PetscNullSpace nsp
 * 
 * ctypedef public api class PC(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscPC_Type,
 *     object PyPetscPCObject,
*/
struct PyPetscPCObject {
  struct PyPetscObjectObject __pyx_base;
  PC pc;
};
typedef struct PyPetscPCObject PyPetscPCObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscPC_Type;

/* "petsc4py/PETSc.pxd":244
 *     cdef PetscPC pc
 * 
 * ctypedef public api class KSP(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscKSP_Type,
 *     object PyPetscKSPObject,
*/
struct PyPetscKSPObject {
  struct PyPetscObjectObject __pyx_base;
  KSP ksp;
};
typedef struct PyPetscKSPObject PyPetscKSPObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscKSP_Type;

/* "petsc4py/PETSc.pxd":250
 *     cdef PetscKSP ksp
 * 
 * ctypedef public api class SNES(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscSNES_Type,
 *     object PyPetscSNESObject,
*/
struct PyPetscSNESObject {
  struct PyPetscObjectObject __pyx_base;
  SNES snes;
};
typedef struct PyPetscSNESObject PyPetscSNESObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscSNES_Type;

/* "petsc4py/PETSc.pxd":256
 *     cdef PetscSNES snes
 * 
 * ctypedef public api class SNESLineSearch(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscSNESLineSearch_Type,
 *     object PyPetscSNESLineSearchObject,
*/
struct PyPetscSNESLineSearchObject {
  struct PyPetscObjectObject __pyx_base;
  SNESLineSearch snesls;
};
typedef struct PyPetscSNESLineSearchObject PyPetscSNESLineSearchObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscSNESLineSearch_Type;

/* "petsc4py/PETSc.pxd":262
 *     cdef PetscSNESLineSearch snesls
 * 
 * ctypedef public api class TS(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscTS_Type,
 *     object PyPetscTSObject,
*/
struct PyPetscTSObject {
  struct PyPetscObjectObject __pyx_base;
  TS ts;
};
typedef struct PyPetscTSObject PyPetscTSObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscTS_Type;

/* "petsc4py/PETSc.pxd":268
 *     cdef PetscTS ts
 * 
 * ctypedef public api class TAO(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscTAO_Type,
 *     object PyPetscTAOObject,
*/
struct PyPetscTAOObject {
  struct PyPetscObjectObject __pyx_base;
  Tao tao;
};
typedef struct PyPetscTAOObject PyPetscTAOObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscTAO_Type;

/* "petsc4py/PETSc.pxd":274
 *     cdef PetscTAO tao
 * 
 * ctypedef public api class TAOLineSearch(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscTAOLineSearch_Type,
 *     object PyPetscTAOLineSearchObject,
*/
struct PyPetscTAOLineSearchObject {
  struct PyPetscObjectObject __pyx_base;
  TaoLineSearch taols;
};
typedef struct PyPetscTAOLineSearchObject PyPetscTAOLineSearchObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscTAOLineSearch_Type;

/* "petsc4py/PETSc.pxd":281
 * 
 * 
 * ctypedef public api class AO(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscAO_Type,
 *     object PyPetscAOObject,
*/
struct PyPetscAOObject {
  struct PyPetscObjectObject __pyx_base;
  AO ao;
};
typedef struct PyPetscAOObject PyPetscAOObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscAO_Type;

/* "petsc4py/PETSc.pxd":287
 *     cdef PetscAO ao
 * 
 * ctypedef public api class DM(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDM_Type,
 *     object PyPetscDMObject,
*/
struct PyPetscDMObject {
  struct PyPetscObjectObject __pyx_base;
  DM dm;
};
typedef struct PyPetscDMObject PyPetscDMObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDM_Type;

/* "petsc4py/PETSc.pxd":293
 *     cdef PetscDM dm
 * 
 * ctypedef public api class DMPlexTransform(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDMPlexTransform_Type,
 *     object PyPetscDMPlexTransformObject,
*/
struct PyPetscDMPlexTransformObject {
  struct PyPetscObjectObject __pyx_base;
  DMPlexTransform tr;
};
typedef struct PyPetscDMPlexTransformObject PyPetscDMPlexTransformObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDMPlexTransform_Type;

/* "petsc4py/PETSc.pxd":299
 *     cdef PetscDMPlexTransform tr
 * 
 * ctypedef public api class CellDM(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDMSwarmCellDM_Type,
 *     object PyPetscDMSwarmCellDMObject,
*/
struct PyPetscDMSwarmCellDMObject {
  struct PyPetscObjectObject __pyx_base;
  DMSwarmCellDM cdm;
};
typedef struct PyPetscDMSwarmCellDMObject PyPetscDMSwarmCellDMObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDMSwarmCellDM_Type;

/* "petsc4py/PETSc.pxd":305
 *     cdef PetscDMSwarmCellDM cdm
 * 
 * ctypedef public api class DS(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDS_Type,
 *     object PyPetscDSObject,
*/
struct PyPetscDSObject {
  struct PyPetscObjectObject __pyx_base;
  PetscDS ds;
};
typedef struct PyPetscDSObject PyPetscDSObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDS_Type;

/* "petsc4py/PETSc.pxd":311
 *     cdef PetscDS ds
 * 
 * ctypedef public api class Partitioner(Object) [             # <<<<<<<<<<<<<<
 *     type PyPetscPartitioner_Type,
 *     object PyPetscPartitionerObject,
*/
struct PyPetscPartitionerObject {
  struct PyPetscObjectObject __pyx_base;
  PetscPartitioner part;
};
typedef struct PyPetscPartitionerObject PyPetscPartitionerObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscPartitioner_Type;

/* "petsc4py/PETSc.pxd":317
 *     cdef PetscPartitioner part
 * 
 * ctypedef public api class DMLabel(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDMLabel_Type,
 *     object PyPetscDMLabelObject,
*/
struct PyPetscDMLabelObject {
  struct PyPetscObjectObject __pyx_base;
  DMLabel dmlabel;
};
typedef struct PyPetscDMLabelObject PyPetscDMLabelObject;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDMLabel_Type;

/* "tmm4py/tmm4py_core.pxd":124
 *     ctypedef _p_TMMState* PetscTMMState "TMMState"
 * 
 * cdef class TMMState:             # <<<<<<<<<<<<<<
 *     cdef PetscTMMState state
 *     cdef public:
*/
struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState {
  PyObject_HEAD
  TMMState state;
  PyObject *finiex;
  PyObject *fcalcex;
  PyObject *fwriex;
  PyObject *ffinex;
  PyObject *freiex;
  PyObject *finicbc;
  PyObject *fcalccbc;
  PyObject *fwricbc;
  PyObject *ffincbc;
  PyObject *freicbc;
  PyObject *finimon;
  PyObject *fcalcmon;
  PyObject *fwrimon;
  PyObject *ffinmon;
  PyObject *finimis;
  PyObject *fcalcmis;
  PyObject *fwrimis;
  PyObject *ffinmis;
  PyObject *stateId;
  PyObject *numTracers;
  PyObject *config;
  PyObject *tracerNames;
  PyObject *c;
  PyObject *qf;
  PyObject *qef;
  PyObject *qrel;
  PyObject *cbc;
  PyObject *cbf;
};


/* "tmm4py/tmm4py_core.pxd":156
 *       object cbf
 * 
 * cdef class StepTimer:             # <<<<<<<<<<<<<<
 *     cdef PetscStepTimer timer
 *     cdef public:
*/
struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer {
  PyObject_HEAD
  StepTimer timer;
  PyObject *count;
  PyObject *startTimeStep;
  PyObject *numTimeSteps;
};


/* "tmm4py/tmm4py_core.pxd":163
 *       object numTimeSteps
 * 
 * cdef class PeriodicTimer:             # <<<<<<<<<<<<<<
 *     cdef PetscPeriodicTimer timer
 * 
*/
struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer {
  PyObject_HEAD
  PeriodicTimer timer;
};


/* "tmm4py/tmm4py_core.pxd":166
 *     cdef PetscPeriodicTimer timer
 * 
 * cdef class TimeDependentTimer:             # <<<<<<<<<<<<<<
 *     cdef PetscTimeDependentTimer timer
 * 
*/
struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer {
  PyObject_HEAD
  TimeDependentTimer timer;
};


/* "tmm4py/tmm4py_core.pxd":169
 *     cdef PetscTimeDependentTimer timer
 * 
 * cdef class PeriodicVec:             # <<<<<<<<<<<<<<
 *     cdef PetscPeriodicVec pvec
 *     cdef PetscVec c
*/
struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec {
  PyObject_HEAD
  PeriodicVec pvec;
  Vec c;
  PetscInt lDim;
  PetscInt frombuf;
  PyObject *arr;
};


/* "tmm4py/tmm4py_core.pxd":177
 *       object arr
 * 
 * cdef class TimeDependentVec:             # <<<<<<<<<<<<<<
 *     cdef PetscTimeDependentVec pvec
 *     cdef PetscVec c
*/
struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec {
  PyObject_HEAD
  TimeDependentVec pvec;
  Vec c;
  PetscInt lDim;
  PetscInt frombuf;
  PyObject *arr;
};


/* "tmm4py/tmm4py_core.pxd":185
 *       object arr
 * 
 * cdef class PeriodicArray:             # <<<<<<<<<<<<<<
 *     cdef PetscPeriodicArray parr
 *     cdef PetscScalar *data_pointer
*/
struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray {
  PyObject_HEAD
  PeriodicArray parr;
  PetscScalar *data_pointer;
  PetscInt lDim;
  PetscInt frombuf;
  PyObject *arr;
};


/* "tmm4py/tmm4py_core.pxd":193
 *       object arr
 * 
 * cdef class TimeDependentArray:             # <<<<<<<<<<<<<<
 *     cdef PetscTimeDependentArray parr
 *     cdef PetscScalar *data_pointer
*/
struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray {
  PyObject_HEAD
  TimeDependentArray parr;
  PetscScalar *data_pointer;
  PetscInt lDim;
  PetscInt frombuf;
  PyObject *arr;
};


/* "tmm4py/tmm4py_core.pyx":1554
 *   return arr
 * 
 * cdef class _RealArrayWrapper:             # <<<<<<<<<<<<<<
 *     cdef PetscScalar* data_ptr
 *     cdef int size
*/
struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper {
  PyObject_HEAD
  struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__RealArrayWrapper *__pyx_vtab;
  PetscScalar *data_ptr;
  int size;
  Vec pv;
  PyObject *myId;
};


/* "tmm4py/tmm4py_core.pyx":1593
 * #         free(<void*>self.data_ptr)
 * 
 * cdef class _RealArrayWrapperWithDel:             # <<<<<<<<<<<<<<
 *     cdef PetscScalar* data_ptr
 *     cdef int size
*/
struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel {
  PyObject_HEAD
  struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *__pyx_vtab;
  PetscScalar *data_ptr;
  int size;
  Vec pv;
  PyObject *myId;
};


/* "tmm4py/tmm4py_core.pyx":1617
 *         PyMem_Free(self.data_ptr)
 * 
 * cdef class _IntArrayWrapper:             # <<<<<<<<<<<<<<
 *     cdef PetscInt* data_ptr
 *     cdef int size
*/
struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper {
  PyObject_HEAD
  struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__IntArrayWrapper *__pyx_vtab;
  PetscInt *data_ptr;
  int size;
};


/* "tmm4py/tmm4py_core.pyx":1631
 *         return ndarray
 * 
 * cdef class _IntArrayWrapperWithDel:             # <<<<<<<<<<<<<<
 *     cdef PetscInt* data_ptr
 *     cdef int size
*/
struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel {
  PyObject_HEAD
  struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *__pyx_vtab;
  PetscInt *data_ptr;
  int size;
};


__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscObject_Type;

/* "petsc4py/PETSc.pxd":123
 *     cdef object base
 * 
 * ctypedef public api class Object [             # <<<<<<<<<<<<<<
 *     type   PyPetscObject_Type,
 *     object PyPetscObjectObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_Object {
  PyObject *(*get_attr)(struct PyPetscObjectObject *, char *);
  PyObject *(*set_attr)(struct PyPetscObjectObject *, char *, PyObject *);
  PyObject *(*get_dict)(struct PyPetscObjectObject *);
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_Object *__pyx_vtabptr_8petsc4py_5PETSc_Object;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscViewer_Type;

/* "petsc4py/PETSc.pxd":135
 *     cdef object get_dict(self)
 * 
 * ctypedef public api class Viewer(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscViewer_Type,
 *     object PyPetscViewerObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_Viewer {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_Viewer *__pyx_vtabptr_8petsc4py_5PETSc_Viewer;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscRandom_Type;

/* "petsc4py/PETSc.pxd":141
 *     cdef PetscViewer vwr
 * 
 * ctypedef public api class Random(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscRandom_Type,
 *     object PyPetscRandomObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_Random {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_Random *__pyx_vtabptr_8petsc4py_5PETSc_Random;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDeviceContext_Type;

/* "petsc4py/PETSc.pxd":154
 *     cdef object __weakref__
 * 
 * ctypedef public api class DeviceContext(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDeviceContext_Type,
 *     object PyPetscDeviceContextObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_DeviceContext {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_DeviceContext *__pyx_vtabptr_8petsc4py_5PETSc_DeviceContext;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscIS_Type;

/* "petsc4py/PETSc.pxd":160
 *     cdef PetscDeviceContext dctx
 * 
 * ctypedef public api class IS(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscIS_Type,
 *     object PyPetscISObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_IS {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_IS *__pyx_vtabptr_8petsc4py_5PETSc_IS;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscLGMap_Type;

/* "petsc4py/PETSc.pxd":166
 *     cdef PetscIS iset
 * 
 * ctypedef public api class LGMap(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscLGMap_Type,
 *     object PyPetscLGMapObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_LGMap {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_LGMap *__pyx_vtabptr_8petsc4py_5PETSc_LGMap;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscSF_Type;

/* "petsc4py/PETSc.pxd":172
 *     cdef PetscLGMap lgm
 * 
 * ctypedef public api class SF(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscSF_Type,
 *     object PyPetscSFObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_SF {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_SF *__pyx_vtabptr_8petsc4py_5PETSc_SF;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscVec_Type;

/* "petsc4py/PETSc.pxd":178
 *     cdef PetscSF sf
 * 
 * ctypedef public api class Vec(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscVec_Type,
 *     object PyPetscVecObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_Vec {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_Vec *__pyx_vtabptr_8petsc4py_5PETSc_Vec;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscSpace_Type;

/* "petsc4py/PETSc.pxd":184
 *     cdef PetscVec vec
 * 
 * ctypedef public api class Space(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscSpace_Type,
 *     object PyPetscSpaceObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_Space {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_Space *__pyx_vtabptr_8petsc4py_5PETSc_Space;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDualSpace_Type;

/* "petsc4py/PETSc.pxd":190
 *     cdef PetscSpace space
 * 
 * ctypedef public api class DualSpace(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDualSpace_Type,
 *     object PyPetscDualSpaceObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_DualSpace {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_DualSpace *__pyx_vtabptr_8petsc4py_5PETSc_DualSpace;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscFE_Type;

/* "petsc4py/PETSc.pxd":196
 *     cdef PetscDualSpace dualspace
 * 
 * ctypedef public api class FE(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscFE_Type,
 *     object PyPetscFEObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_FE {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_FE *__pyx_vtabptr_8petsc4py_5PETSc_FE;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscQuad_Type;

/* "petsc4py/PETSc.pxd":202
 *     cdef PetscFE fe
 * 
 * ctypedef public api class Quad(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscQuad_Type,
 *     object PyPetscQuadObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_Quad {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_Quad *__pyx_vtabptr_8petsc4py_5PETSc_Quad;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscScatter_Type;

/* "petsc4py/PETSc.pxd":208
 *     cdef PetscQuadrature quad
 * 
 * ctypedef public api class Scatter(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscScatter_Type,
 *     object PyPetscScatterObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_Scatter {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_Scatter *__pyx_vtabptr_8petsc4py_5PETSc_Scatter;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscSection_Type;

/* "petsc4py/PETSc.pxd":214
 *     cdef PetscScatter sct
 * 
 * ctypedef public api class Section(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscSection_Type,
 *     object PyPetscSectionObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_Section {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_Section *__pyx_vtabptr_8petsc4py_5PETSc_Section;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscMat_Type;

/* "petsc4py/PETSc.pxd":220
 *     cdef PetscSection sec
 * 
 * ctypedef public api class Mat(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscMat_Type,
 *     object PyPetscMatObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_Mat {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_Mat *__pyx_vtabptr_8petsc4py_5PETSc_Mat;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscMatPartitioning_Type;

/* "petsc4py/PETSc.pxd":226
 *     cdef PetscMat mat
 * 
 * ctypedef public api class MatPartitioning(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscMatPartitioning_Type,
 *     object PyPetscMatPartitioningObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_MatPartitioning {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_MatPartitioning *__pyx_vtabptr_8petsc4py_5PETSc_MatPartitioning;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscNullSpace_Type;

/* "petsc4py/PETSc.pxd":232
 *     cdef PetscMatPartitioning part
 * 
 * ctypedef public api class NullSpace(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscNullSpace_Type,
 *     object PyPetscNullSpaceObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_NullSpace {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_NullSpace *__pyx_vtabptr_8petsc4py_5PETSc_NullSpace;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscPC_Type;

/* "petsc4py/PETSc.pxd":238
 *     cdef PetscNullSpace nsp
 * 
 * ctypedef public api class PC(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscPC_Type,
 *     object PyPetscPCObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_PC {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_PC *__pyx_vtabptr_8petsc4py_5PETSc_PC;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscKSP_Type;

/* "petsc4py/PETSc.pxd":244
 *     cdef PetscPC pc
 * 
 * ctypedef public api class KSP(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscKSP_Type,
 *     object PyPetscKSPObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_KSP {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_KSP *__pyx_vtabptr_8petsc4py_5PETSc_KSP;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscSNES_Type;

/* "petsc4py/PETSc.pxd":250
 *     cdef PetscKSP ksp
 * 
 * ctypedef public api class SNES(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscSNES_Type,
 *     object PyPetscSNESObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_SNES {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_SNES *__pyx_vtabptr_8petsc4py_5PETSc_SNES;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscSNESLineSearch_Type;

/* "petsc4py/PETSc.pxd":256
 *     cdef PetscSNES snes
 * 
 * ctypedef public api class SNESLineSearch(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscSNESLineSearch_Type,
 *     object PyPetscSNESLineSearchObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_SNESLineSearch {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_SNESLineSearch *__pyx_vtabptr_8petsc4py_5PETSc_SNESLineSearch;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscTS_Type;

/* "petsc4py/PETSc.pxd":262
 *     cdef PetscSNESLineSearch snesls
 * 
 * ctypedef public api class TS(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscTS_Type,
 *     object PyPetscTSObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_TS {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_TS *__pyx_vtabptr_8petsc4py_5PETSc_TS;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscTAO_Type;

/* "petsc4py/PETSc.pxd":268
 *     cdef PetscTS ts
 * 
 * ctypedef public api class TAO(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscTAO_Type,
 *     object PyPetscTAOObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_TAO {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_TAO *__pyx_vtabptr_8petsc4py_5PETSc_TAO;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscTAOLineSearch_Type;

/* "petsc4py/PETSc.pxd":274
 *     cdef PetscTAO tao
 * 
 * ctypedef public api class TAOLineSearch(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscTAOLineSearch_Type,
 *     object PyPetscTAOLineSearchObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_TAOLineSearch {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_TAOLineSearch *__pyx_vtabptr_8petsc4py_5PETSc_TAOLineSearch;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscAO_Type;

/* "petsc4py/PETSc.pxd":281
 * 
 * 
 * ctypedef public api class AO(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscAO_Type,
 *     object PyPetscAOObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_AO {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_AO *__pyx_vtabptr_8petsc4py_5PETSc_AO;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDM_Type;

/* "petsc4py/PETSc.pxd":287
 *     cdef PetscAO ao
 * 
 * ctypedef public api class DM(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDM_Type,
 *     object PyPetscDMObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_DM {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_DM *__pyx_vtabptr_8petsc4py_5PETSc_DM;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDMPlexTransform_Type;

/* "petsc4py/PETSc.pxd":293
 *     cdef PetscDM dm
 * 
 * ctypedef public api class DMPlexTransform(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDMPlexTransform_Type,
 *     object PyPetscDMPlexTransformObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_DMPlexTransform {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_DMPlexTransform *__pyx_vtabptr_8petsc4py_5PETSc_DMPlexTransform;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDMSwarmCellDM_Type;

/* "petsc4py/PETSc.pxd":299
 *     cdef PetscDMPlexTransform tr
 * 
 * ctypedef public api class CellDM(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDMSwarmCellDM_Type,
 *     object PyPetscDMSwarmCellDMObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_CellDM {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_CellDM *__pyx_vtabptr_8petsc4py_5PETSc_CellDM;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDS_Type;

/* "petsc4py/PETSc.pxd":305
 *     cdef PetscDMSwarmCellDM cdm
 * 
 * ctypedef public api class DS(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDS_Type,
 *     object PyPetscDSObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_DS {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_DS *__pyx_vtabptr_8petsc4py_5PETSc_DS;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscPartitioner_Type;

/* "petsc4py/PETSc.pxd":311
 *     cdef PetscDS ds
 * 
 * ctypedef public api class Partitioner(Object) [             # <<<<<<<<<<<<<<
 *     type PyPetscPartitioner_Type,
 *     object PyPetscPartitionerObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_Partitioner {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_Partitioner *__pyx_vtabptr_8petsc4py_5PETSc_Partitioner;

__PYX_EXTERN_C DL_EXPORT(PyTypeObject) PyPetscDMLabel_Type;

/* "petsc4py/PETSc.pxd":317
 *     cdef PetscPartitioner part
 * 
 * ctypedef public api class DMLabel(Object) [             # <<<<<<<<<<<<<<
 *     type   PyPetscDMLabel_Type,
 *     object PyPetscDMLabelObject,
*/

struct __pyx_vtabstruct_8petsc4py_5PETSc_DMLabel {
  struct __pyx_vtabstruct_8petsc4py_5PETSc_Object __pyx_base;
};
static struct __pyx_vtabstruct_8petsc4py_5PETSc_DMLabel *__pyx_vtabptr_8petsc4py_5PETSc_DMLabel;


/* "tmm4py/tmm4py_core.pyx":1554
 *   return arr
 * 
 * cdef class _RealArrayWrapper:             # <<<<<<<<<<<<<<
 *     cdef PetscScalar* data_ptr
 *     cdef int size
*/

struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__RealArrayWrapper {
  PyObject *(*set_data)(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *, PetscInt, PetscScalar *, Vec, PyObject *);
};
static struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__RealArrayWrapper *__pyx_vtabptr_6tmm4py_11tmm4py_core__RealArrayWrapper;


/* "tmm4py/tmm4py_core.pyx":1593
 * #         free(<void*>self.data_ptr)
 * 
 * cdef class _RealArrayWrapperWithDel:             # <<<<<<<<<<<<<<
 *     cdef PetscScalar* data_ptr
 *     cdef int size
*/

struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel {
  PyObject *(*set_data)(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *, PetscInt, PetscScalar *, Vec, PyObject *);
};
static struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *__pyx_vtabptr_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel;


/* "tmm4py/tmm4py_core.pyx":1617
 *         PyMem_Free(self.data_ptr)
 * 
 * cdef class _IntArrayWrapper:             # <<<<<<<<<<<<<<
 *     cdef PetscInt* data_ptr
 *     cdef int size
*/

struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__IntArrayWrapper {
  PyObject *(*set_data)(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *, int, PetscInt *);
};
static struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__IntArrayWrapper *__pyx_vtabptr_6tmm4py_11tmm4py_core__IntArrayWrapper;


/* "tmm4py/tmm4py_core.pyx":1631
 *         return ndarray
 * 
 * cdef class _IntArrayWrapperWithDel:             # <<<<<<<<<<<<<<
 *     cdef PetscInt* data_ptr
 *     cdef int size
*/

struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel {
  PyObject *(*set_data)(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *, int, PetscInt *);
};
static struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *__pyx_vtabptr_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel;
/* #### Code section: utility_code_proto ### */

/* --- Runtime support code (head) --- */
/* Refnanny.proto */
#ifndef CYTHON_REFNANNY
  #define CYTHON_REFNANNY 0
#endif
#if CYTHON_REFNANNY
  typedef struct {
    void (*INCREF)(void*, PyObject*, Py_ssize_t);
    void (*DECREF)(void*, PyObject*, Py_ssize_t);
    void (*GOTREF)(void*, PyObject*, Py_ssize_t);
    void (*GIVEREF)(void*, PyObject*, Py_ssize_t);
    void* (*SetupContext)(const char*, Py_ssize_t, const char*);
    void (*FinishContext)(void**);
  } __Pyx_RefNannyAPIStruct;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNanny = NULL;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname);
  #define __Pyx_RefNannyDeclarations void *__pyx_refnanny = NULL;
  #define __Pyx_RefNannySetupContext(name, acquire_gil)\
          if (acquire_gil) {\
              PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();\
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), (__LINE__), (__FILE__));\
              PyGILState_Release(__pyx_gilstate_save);\
          } else {\
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), (__LINE__), (__FILE__));\
          }
  #define __Pyx_RefNannyFinishContextNogil() {\
              PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();\
              __Pyx_RefNannyFinishContext();\
              PyGILState_Release(__pyx_gilstate_save);\
          }
  #define __Pyx_RefNannyFinishContextNogil() {\
              PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();\
              __Pyx_RefNannyFinishContext();\
              PyGILState_Release(__pyx_gilstate_save);\
          }
  #define __Pyx_RefNannyFinishContext()\
          __Pyx_RefNanny->FinishContext(&__pyx_refnanny)
  #define __Pyx_INCREF(r)  __Pyx_RefNanny->INCREF(__pyx_refnanny, (PyObject *)(r), (__LINE__))
  #define __Pyx_DECREF(r)  __Pyx_RefNanny->DECREF(__pyx_refnanny, (PyObject *)(r), (__LINE__))
  #define __Pyx_GOTREF(r)  __Pyx_RefNanny->GOTREF(__pyx_refnanny, (PyObject *)(r), (__LINE__))
  #define __Pyx_GIVEREF(r) __Pyx_RefNanny->GIVEREF(__pyx_refnanny, (PyObject *)(r), (__LINE__))
  #define __Pyx_XINCREF(r)  do { if((r) == NULL); else {__Pyx_INCREF(r); }} while(0)
  #define __Pyx_XDECREF(r)  do { if((r) == NULL); else {__Pyx_DECREF(r); }} while(0)
  #define __Pyx_XGOTREF(r)  do { if((r) == NULL); else {__Pyx_GOTREF(r); }} while(0)
  #define __Pyx_XGIVEREF(r) do { if((r) == NULL); else {__Pyx_GIVEREF(r);}} while(0)
#else
  #define __Pyx_RefNannyDeclarations
  #define __Pyx_RefNannySetupContext(name, acquire_gil)
  #define __Pyx_RefNannyFinishContextNogil()
  #define __Pyx_RefNannyFinishContext()
  #define __Pyx_INCREF(r) Py_INCREF(r)
  #define __Pyx_DECREF(r) Py_DECREF(r)
  #define __Pyx_GOTREF(r)
  #define __Pyx_GIVEREF(r)
  #define __Pyx_XINCREF(r) Py_XINCREF(r)
  #define __Pyx_XDECREF(r) Py_XDECREF(r)
  #define __Pyx_XGOTREF(r)
  #define __Pyx_XGIVEREF(r)
#endif
#define __Pyx_Py_XDECREF_SET(r, v) do {\
        PyObject *tmp = (PyObject *) r;\
        r = v; Py_XDECREF(tmp);\
    } while (0)
#define __Pyx_XDECREF_SET(r, v) do {\
        PyObject *tmp = (PyObject *) r;\
        r = v; __Pyx_XDECREF(tmp);\
    } while (0)
#define __Pyx_DECREF_SET(r, v) do {\
        PyObject *tmp = (PyObject *) r;\
        r = v; __Pyx_DECREF(tmp);\
    } while (0)
#define __Pyx_CLEAR(r)    do { PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);} while(0)
#define __Pyx_XCLEAR(r)   do { if((r) != NULL) {PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);}} while(0)

/* PyErrExceptionMatches.proto */
#if CYTHON_FAST_THREAD_STATE
#define __Pyx_PyErr_ExceptionMatches(err) __Pyx_PyErr_ExceptionMatchesInState(__pyx_tstate, err)
static CYTHON_INLINE int __Pyx_PyErr_ExceptionMatchesInState(PyThreadState* tstate, PyObject* err);
#else
#define __Pyx_PyErr_ExceptionMatches(err)  PyErr_ExceptionMatches(err)
#endif

/* PyThreadStateGet.proto */
#if CYTHON_FAST_THREAD_STATE
#define __Pyx_PyThreadState_declare  PyThreadState *__pyx_tstate;
#define __Pyx_PyThreadState_assign  __pyx_tstate = __Pyx_PyThreadState_Current;
#if PY_VERSION_HEX >= 0x030C00A6
#define __Pyx_PyErr_Occurred()  (__pyx_tstate->current_exception != NULL)
#define __Pyx_PyErr_CurrentExceptionType()  (__pyx_tstate->current_exception ? (PyObject*) Py_TYPE(__pyx_tstate->current_exception) : (PyObject*) NULL)
#else
#define __Pyx_PyErr_Occurred()  (__pyx_tstate->curexc_type != NULL)
#define __Pyx_PyErr_CurrentExceptionType()  (__pyx_tstate->curexc_type)
#endif
#else
#define __Pyx_PyThreadState_declare
#define __Pyx_PyThreadState_assign
#define __Pyx_PyErr_Occurred()  (PyErr_Occurred() != NULL)
#define __Pyx_PyErr_CurrentExceptionType()  PyErr_Occurred()
#endif

/* PyErrFetchRestore.proto */
#if CYTHON_FAST_THREAD_STATE
#define __Pyx_PyErr_Clear() __Pyx_ErrRestore(NULL, NULL, NULL)
#define __Pyx_ErrRestoreWithState(type, value, tb)  __Pyx_ErrRestoreInState(PyThreadState_GET(), type, value, tb)
#define __Pyx_ErrFetchWithState(type, value, tb)    __Pyx_ErrFetchInState(PyThreadState_GET(), type, value, tb)
#define __Pyx_ErrRestore(type, value, tb)  __Pyx_ErrRestoreInState(__pyx_tstate, type, value, tb)
#define __Pyx_ErrFetch(type, value, tb)    __Pyx_ErrFetchInState(__pyx_tstate, type, value, tb)
static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030C00A6
#define __Pyx_PyErr_SetNone(exc) (Py_INCREF(exc), __Pyx_ErrRestore((exc), NULL, NULL))
#else
#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
#endif
#else
#define __Pyx_PyErr_Clear() PyErr_Clear()
#define __Pyx_PyErr_SetNone(exc) PyErr_SetNone(exc)
#define __Pyx_ErrRestoreWithState(type, value, tb)  PyErr_Restore(type, value, tb)
#define __Pyx_ErrFetchWithState(type, value, tb)  PyErr_Fetch(type, value, tb)
#define __Pyx_ErrRestoreInState(tstate, type, value, tb)  PyErr_Restore(type, value, tb)
#define __Pyx_ErrFetchInState(tstate, type, value, tb)  PyErr_Fetch(type, value, tb)
#define __Pyx_ErrRestore(type, value, tb)  PyErr_Restore(type, value, tb)
#define __Pyx_ErrFetch(type, value, tb)  PyErr_Fetch(type, value, tb)
#endif

/* PyObjectGetAttrStr.proto */
#if CYTHON_USE_TYPE_SLOTS
static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStr(PyObject* obj, PyObject* attr_name);
#else
#define __Pyx_PyObject_GetAttrStr(o,n) PyObject_GetAttr(o,n)
#endif

/* PyObjectGetAttrStrNoError.proto */
static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStrNoError(PyObject* obj, PyObject* attr_name);

/* GetBuiltinName.proto */
static PyObject *__Pyx_GetBuiltinName(PyObject *name);

/* GetTopmostException.proto */
#if CYTHON_USE_EXC_INFO_STACK && CYTHON_FAST_THREAD_STATE
static _PyErr_StackItem * __Pyx_PyErr_GetTopmostException(PyThreadState *tstate);
#endif

/* SaveResetException.proto */
#if CYTHON_FAST_THREAD_STATE
#define __Pyx_ExceptionSave(type, value, tb)  __Pyx__ExceptionSave(__pyx_tstate, type, value, tb)
static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
#define __Pyx_ExceptionReset(type, value, tb)  __Pyx__ExceptionReset(__pyx_tstate, type, value, tb)
static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
#else
#define __Pyx_ExceptionSave(type, value, tb)   PyErr_GetExcInfo(type, value, tb)
#define __Pyx_ExceptionReset(type, value, tb)  PyErr_SetExcInfo(type, value, tb)
#endif

/* GetException.proto */
#if CYTHON_FAST_THREAD_STATE
#define __Pyx_GetException(type, value, tb)  __Pyx__GetException(__pyx_tstate, type, value, tb)
static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
#else
static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb);
#endif

/* PyFunctionFastCall.proto */
#if CYTHON_FAST_PYCALL
#if !CYTHON_VECTORCALL
#define __Pyx_PyFunction_FastCall(func, args, nargs)\
    __Pyx_PyFunction_FastCallDict((func), (args), (nargs), NULL)
static PyObject *__Pyx_PyFunction_FastCallDict(PyObject *func, PyObject *const *args, Py_ssize_t nargs, PyObject *kwargs);
#endif
#define __Pyx_BUILD_ASSERT_EXPR(cond)\
    (sizeof(char [1 - 2*!(cond)]) - 1)
#ifndef Py_MEMBER_SIZE
#define Py_MEMBER_SIZE(type, member) sizeof(((type *)0)->member)
#endif
#if !CYTHON_VECTORCALL
#if PY_VERSION_HEX >= 0x03080000
  #include "frameobject.h"
  #define __Pxy_PyFrame_Initialize_Offsets()
  #define __Pyx_PyFrame_GetLocalsplus(frame)  ((frame)->f_localsplus)
#else
  static size_t __pyx_pyframe_localsplus_offset = 0;
  #include "frameobject.h"
  #define __Pxy_PyFrame_Initialize_Offsets()\
    ((void)__Pyx_BUILD_ASSERT_EXPR(sizeof(PyFrameObject) == offsetof(PyFrameObject, f_localsplus) + Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),\
     (void)(__pyx_pyframe_localsplus_offset = ((size_t)PyFrame_Type.tp_basicsize) - Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
  #define __Pyx_PyFrame_GetLocalsplus(frame)\
    (assert(__pyx_pyframe_localsplus_offset), (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
#endif
#endif
#endif

/* PyObjectCall.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
#else
#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
#endif

/* PyObjectCallMethO.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
#endif

/* PyObjectFastCall.proto */
#define __Pyx_PyObject_FastCall(func, args, nargs)  __Pyx_PyObject_FastCallDict(func, args, (size_t)(nargs), NULL)
static CYTHON_INLINE PyObject* __Pyx_PyObject_FastCallDict(PyObject *func, PyObject * const*args, size_t nargs, PyObject *kwargs);

/* RaiseException.proto */
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);

/* RaiseTooManyValuesToUnpack.proto */
static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);

/* RaiseNeedMoreValuesToUnpack.proto */
static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);

/* IterFinish.proto */
static CYTHON_INLINE int __Pyx_IterFinish(void);

/* UnpackItemEndCheck.proto */
static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected);

/* PyObjectCallOneArg.proto */
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);

/* WriteUnraisableException.proto */
static void __Pyx_WriteUnraisable(const char *name, int clineno,
                                  int lineno, const char *filename,
                                  int full_traceback, int nogil);

/* TupleAndListFromArray.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyList_FromArray(PyObject *const *src, Py_ssize_t n);
#endif
#if CYTHON_COMPILING_IN_CPYTHON || CYTHON_METH_FASTCALL
static CYTHON_INLINE PyObject* __Pyx_PyTuple_FromArray(PyObject *const *src, Py_ssize_t n);
#endif

/* IncludeStringH.proto */
#include <string.h>

/* BytesEquals.proto */
static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals);

/* UnicodeEquals.proto */
static CYTHON_INLINE int __Pyx_PyUnicode_Equals(PyObject* s1, PyObject* s2, int equals);

/* fastcall.proto */
#if CYTHON_AVOID_BORROWED_REFS
    #define __Pyx_ArgRef_VARARGS(args, i) __Pyx_PySequence_ITEM(args, i)
#elif CYTHON_ASSUME_SAFE_MACROS
    #define __Pyx_ArgRef_VARARGS(args, i) __Pyx_NewRef(__Pyx_PyTuple_GET_ITEM(args, i))
#else
    #define __Pyx_ArgRef_VARARGS(args, i) __Pyx_XNewRef(PyTuple_GetItem(args, i))
#endif
#define __Pyx_NumKwargs_VARARGS(kwds) PyDict_Size(kwds)
#define __Pyx_KwValues_VARARGS(args, nargs) NULL
#define __Pyx_GetKwValue_VARARGS(kw, kwvalues, s) __Pyx_PyDict_GetItemStrWithError(kw, s)
#define __Pyx_KwargsAsDict_VARARGS(kw, kwvalues) PyDict_Copy(kw)
#if CYTHON_METH_FASTCALL
    #define __Pyx_ArgRef_FASTCALL(args, i) __Pyx_NewRef(args[i])
    #define __Pyx_NumKwargs_FASTCALL(kwds) __Pyx_PyTuple_GET_SIZE(kwds)
    #define __Pyx_KwValues_FASTCALL(args, nargs) ((args) + (nargs))
    static CYTHON_INLINE PyObject * __Pyx_GetKwValue_FASTCALL(PyObject *kwnames, PyObject *const *kwvalues, PyObject *s);
  #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030d0000 || CYTHON_COMPILING_IN_LIMITED_API
    CYTHON_UNUSED static PyObject *__Pyx_KwargsAsDict_FASTCALL(PyObject *kwnames, PyObject *const *kwvalues);
  #else
    #define __Pyx_KwargsAsDict_FASTCALL(kw, kwvalues) _PyStack_AsDict(kwvalues, kw)
  #endif
#else
    #define __Pyx_ArgRef_FASTCALL __Pyx_ArgRef_VARARGS
    #define __Pyx_NumKwargs_FASTCALL __Pyx_NumKwargs_VARARGS
    #define __Pyx_KwValues_FASTCALL __Pyx_KwValues_VARARGS
    #define __Pyx_GetKwValue_FASTCALL __Pyx_GetKwValue_VARARGS
    #define __Pyx_KwargsAsDict_FASTCALL __Pyx_KwargsAsDict_VARARGS
#endif
#define __Pyx_ArgsSlice_VARARGS(args, start, stop) PyTuple_GetSlice(args, start, stop)
#if CYTHON_METH_FASTCALL || (CYTHON_COMPILING_IN_CPYTHON && CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS)
#define __Pyx_ArgsSlice_FASTCALL(args, start, stop) __Pyx_PyTuple_FromArray(args + start, stop - start)
#else
#define __Pyx_ArgsSlice_FASTCALL(args, start, stop) PyTuple_GetSlice(args, start, stop)
#endif

/* RaiseDoubleKeywords.proto */
static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);

/* ParseKeywords.proto */
static CYTHON_INLINE int __Pyx_ParseKeywords(
    PyObject *kwds, PyObject *const *kwvalues, PyObject ** const argnames[],
    PyObject *kwds2, PyObject *values[],
    Py_ssize_t num_pos_args, Py_ssize_t num_kwargs,
    const char* function_name,
    int ignore_unknown_kwargs
);

/* CallCFunction.proto */
#define __Pyx_CallCFunction(cfunc, self, args)\
    ((PyCFunction)(void(*)(void))(cfunc)->func)(self, args)
#define __Pyx_CallCFunctionWithKeywords(cfunc, self, args, kwargs)\
    ((PyCFunctionWithKeywords)(void(*)(void))(cfunc)->func)(self, args, kwargs)
#define __Pyx_CallCFunctionFast(cfunc, self, args, nargs)\
    ((__Pyx_PyCFunctionFast)(void(*)(void))(PyCFunction)(cfunc)->func)(self, args, nargs)
#define __Pyx_CallCFunctionFastWithKeywords(cfunc, self, args, nargs, kwnames)\
    ((__Pyx_PyCFunctionFastWithKeywords)(void(*)(void))(PyCFunction)(cfunc)->func)(self, args, nargs, kwnames)

/* UnpackUnboundCMethod.proto */
typedef struct {
    PyObject *type;
    PyObject **method_name;
#if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING && CYTHON_ATOMICS
    __pyx_atomic_int_type initialized;
#endif
    PyCFunction func;
    PyObject *method;
    int flag;
} __Pyx_CachedCFunction;
#if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
static CYTHON_INLINE int __Pyx_CachedCFunction_GetAndSetInitializing(__Pyx_CachedCFunction *cfunc) {
#if !CYTHON_ATOMICS
    return 1;
#else
    __pyx_nonatomic_int_type expected = 0;
    if (__pyx_atomic_int_cmp_exchange(&cfunc->initialized, &expected, 1)) {
        return 0;
    }
    return expected;
#endif
}
static CYTHON_INLINE void __Pyx_CachedCFunction_SetFinishedInitializing(__Pyx_CachedCFunction *cfunc) {
#if CYTHON_ATOMICS
    __pyx_atomic_store(&cfunc->initialized, 2);
#endif
}
#else
#define __Pyx_CachedCFunction_GetAndSetInitializing(cfunc) 2
#define __Pyx_CachedCFunction_SetFinishedInitializing(cfunc)
#endif

/* CallUnboundCMethod2.proto */
CYTHON_UNUSED
static PyObject* __Pyx__CallUnboundCMethod2(__Pyx_CachedCFunction* cfunc, PyObject* self, PyObject* arg1, PyObject* arg2);
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject *__Pyx_CallUnboundCMethod2(__Pyx_CachedCFunction *cfunc, PyObject *self, PyObject *arg1, PyObject *arg2);
#else
#define __Pyx_CallUnboundCMethod2(cfunc, self, arg1, arg2)  __Pyx__CallUnboundCMethod2(cfunc, self, arg1, arg2)
#endif

/* RaiseArgTupleInvalid.proto */
static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);

/* PyObjectDelAttr.proto */
#if CYTHON_COMPILING_IN_LIMITED_API && __PYX_LIMITED_VERSION_HEX < 0x030d0000
#define __Pyx_PyObject_DelAttr(o, n) PyObject_SetAttr(o, n, NULL)
#else
#define __Pyx_PyObject_DelAttr(o, n) PyObject_DelAttr(o, n)
#endif

/* PyObjectSetAttrStr.proto */
#if CYTHON_USE_TYPE_SLOTS
#define __Pyx_PyObject_DelAttrStr(o,n) __Pyx_PyObject_SetAttrStr(o, n, NULL)
static CYTHON_INLINE int __Pyx_PyObject_SetAttrStr(PyObject* obj, PyObject* attr_name, PyObject* value);
#else
#define __Pyx_PyObject_DelAttrStr(o,n)   __Pyx_PyObject_DelAttr(o,n)
#define __Pyx_PyObject_SetAttrStr(o,n,v) PyObject_SetAttr(o,n,v)
#endif

/* RejectKeywords.proto */
static void __Pyx_RejectKeywords(const char* function_name, PyObject *kwds);

/* ListAppend.proto */
#if CYTHON_USE_PYLIST_INTERNALS && CYTHON_ASSUME_SAFE_MACROS
static CYTHON_INLINE int __Pyx_PyList_Append(PyObject* list, PyObject* x) {
    PyListObject* L = (PyListObject*) list;
    Py_ssize_t len = Py_SIZE(list);
    if (likely(L->allocated > len) & likely(len > (L->allocated >> 1))) {
        Py_INCREF(x);
        #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030d0000
        L->ob_item[len] = x;
        #else
        PyList_SET_ITEM(list, len, x);
        #endif
        __Pyx_SET_SIZE(list, len + 1);
        return 0;
    }
    return PyList_Append(list, x);
}
#else
#define __Pyx_PyList_Append(L,x) PyList_Append(L,x)
#endif

/* PyObjectCall2Args.proto */
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2);

/* PyObjectGetMethod.proto */
static int __Pyx_PyObject_GetMethod(PyObject *obj, PyObject *name, PyObject **method);

/* PyObjectCallMethod1.proto */
static PyObject* __Pyx_PyObject_CallMethod1(PyObject* obj, PyObject* method_name, PyObject* arg);

/* append.proto */
static CYTHON_INLINE int __Pyx_PyObject_Append(PyObject* L, PyObject* x);

/* PyDictVersioning.proto */
#if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
#define __PYX_DICT_VERSION_INIT  ((PY_UINT64_T) -1)
#define __PYX_GET_DICT_VERSION(dict)  (((PyDictObject*)(dict))->ma_version_tag)
#define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)\
    (version_var) = __PYX_GET_DICT_VERSION(dict);\
    (cache_var) = (value);
#define __PYX_PY_DICT_LOOKUP_IF_MODIFIED(VAR, DICT, LOOKUP) {\
    static PY_UINT64_T __pyx_dict_version = 0;\
    static PyObject *__pyx_dict_cached_value = NULL;\
    if (likely(__PYX_GET_DICT_VERSION(DICT) == __pyx_dict_version)) {\
        (VAR) = __pyx_dict_cached_value;\
    } else {\
        (VAR) = __pyx_dict_cached_value = (LOOKUP);\
        __pyx_dict_version = __PYX_GET_DICT_VERSION(DICT);\
    }\
}
static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj);
static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj);
static CYTHON_INLINE int __Pyx_object_dict_version_matches(PyObject* obj, PY_UINT64_T tp_dict_version, PY_UINT64_T obj_dict_version);
#else
#define __PYX_GET_DICT_VERSION(dict)  (0)
#define __PYX_UPDATE_DICT_CACHE(dict, value, cache_var, version_var)
#define __PYX_PY_DICT_LOOKUP_IF_MODIFIED(VAR, DICT, LOOKUP)  (VAR) = (LOOKUP);
#endif

/* GetModuleGlobalName.proto */
#if CYTHON_USE_DICT_VERSIONS
#define __Pyx_GetModuleGlobalName(var, name)  do {\
    static PY_UINT64_T __pyx_dict_version = 0;\
    static PyObject *__pyx_dict_cached_value = NULL;\
    (var) = (likely(__pyx_dict_version == __PYX_GET_DICT_VERSION(__pyx_mstate_global->__pyx_d))) ?\
        (likely(__pyx_dict_cached_value) ? __Pyx_NewRef(__pyx_dict_cached_value) : __Pyx_GetBuiltinName(name)) :\
        __Pyx__GetModuleGlobalName(name, &__pyx_dict_version, &__pyx_dict_cached_value);\
} while(0)
#define __Pyx_GetModuleGlobalNameUncached(var, name)  do {\
    PY_UINT64_T __pyx_dict_version;\
    PyObject *__pyx_dict_cached_value;\
    (var) = __Pyx__GetModuleGlobalName(name, &__pyx_dict_version, &__pyx_dict_cached_value);\
} while(0)
static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value);
#else
#define __Pyx_GetModuleGlobalName(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
#define __Pyx_GetModuleGlobalNameUncached(var, name)  (var) = __Pyx__GetModuleGlobalName(name)
static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name);
#endif

/* DictGetItem.proto */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key);
#define __Pyx_PyObject_Dict_GetItem(obj, name)\
    (likely(PyDict_CheckExact(obj)) ?\
     __Pyx_PyDict_GetItem(obj, name) : PyObject_GetItem(obj, name))
#else
#define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
#define __Pyx_PyObject_Dict_GetItem(obj, name)  PyObject_GetItem(obj, name)
#endif

/* PyObjectFormatSimple.proto */
#if CYTHON_COMPILING_IN_PYPY
    #define __Pyx_PyObject_FormatSimple(s, f) (\
        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
        PyObject_Format(s, f))
#elif CYTHON_USE_TYPE_SLOTS
    #define __Pyx_PyObject_FormatSimple(s, f) (\
        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
        likely(PyLong_CheckExact(s)) ? PyLong_Type.tp_repr(s) :\
        likely(PyFloat_CheckExact(s)) ? PyFloat_Type.tp_repr(s) :\
        PyObject_Format(s, f))
#else
    #define __Pyx_PyObject_FormatSimple(s, f) (\
        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
        PyObject_Format(s, f))
#endif

/* PyObjectFastCallMethod.proto */
#if CYTHON_VECTORCALL && PY_VERSION_HEX >= 0x03090000
#define __Pyx_PyObject_FastCallMethod(name, args, nargsf) PyObject_VectorcallMethod(name, args, nargsf, NULL)
#else
static PyObject *__Pyx_PyObject_FastCallMethod(PyObject *name, PyObject *const *args, size_t nargsf);
#endif

/* ListCompAppend.proto */
#if CYTHON_USE_PYLIST_INTERNALS && CYTHON_ASSUME_SAFE_MACROS
static CYTHON_INLINE int __Pyx_ListComp_Append(PyObject* list, PyObject* x) {
    PyListObject* L = (PyListObject*) list;
    Py_ssize_t len = Py_SIZE(list);
    if (likely(L->allocated > len)) {
        Py_INCREF(x);
        #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030d0000
        L->ob_item[len] = x;
        #else
        PyList_SET_ITEM(list, len, x);
        #endif
        __Pyx_SET_SIZE(list, len + 1);
        return 0;
    }
    return PyList_Append(list, x);
}
#else
#define __Pyx_ListComp_Append(L,x) PyList_Append(L,x)
#endif

/* JoinPyUnicode.proto */
static PyObject* __Pyx_PyUnicode_Join(PyObject** values, Py_ssize_t value_count, Py_ssize_t result_ulength,
                                      Py_UCS4 max_char);

/* KeywordStringCheck.proto */
static CYTHON_INLINE int __Pyx_CheckKeywordStrings(const char* function_name, PyObject *kw);

/* PyObjectCallNoArg.proto */
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);

/* PyObjectCallMethod0.proto */
static PyObject* __Pyx_PyObject_CallMethod0(PyObject* obj, PyObject* method_name);

/* RaiseNoneIterError.proto */
static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void);

/* UnpackTupleError.proto */
static void __Pyx_UnpackTupleError(PyObject *, Py_ssize_t index);

/* UnpackTuple2.proto */
static CYTHON_INLINE int __Pyx_unpack_tuple2(
    PyObject* tuple, PyObject** value1, PyObject** value2, int is_tuple, int has_known_size, int decref_tuple);
static CYTHON_INLINE int __Pyx_unpack_tuple2_exact(
    PyObject* tuple, PyObject** value1, PyObject** value2, int decref_tuple);
static int __Pyx_unpack_tuple2_generic(
    PyObject* tuple, PyObject** value1, PyObject** value2, int has_known_size, int decref_tuple);

/* dict_iter.proto */
static CYTHON_INLINE PyObject* __Pyx_dict_iterator(PyObject* dict, int is_dict, PyObject* method_name,
                                                   Py_ssize_t* p_orig_length, int* p_is_dict);
static CYTHON_INLINE int __Pyx_dict_iter_next(PyObject* dict_or_iter, Py_ssize_t orig_length, Py_ssize_t* ppos,
                                              PyObject** pkey, PyObject** pvalue, PyObject** pitem, int is_dict);

/* pop_index.proto */
static PyObject* __Pyx__PyObject_PopNewIndex(PyObject* L, PyObject* py_ix);
static PyObject* __Pyx__PyObject_PopIndex(PyObject* L, PyObject* py_ix);
#if CYTHON_USE_PYLIST_INTERNALS && CYTHON_ASSUME_SAFE_MACROS && CYTHON_ASSUME_SAFE_SIZE
static PyObject* __Pyx__PyList_PopIndex(PyObject* L, PyObject* py_ix, Py_ssize_t ix);
#define __Pyx_PyObject_PopIndex(L, py_ix, ix, is_signed, type, to_py_func) (\
    (likely(PyList_CheckExact(L) && __Pyx_fits_Py_ssize_t(ix, type, is_signed))) ?\
        __Pyx__PyList_PopIndex(L, py_ix, ix) : (\
        (unlikely((py_ix) == Py_None)) ? __Pyx__PyObject_PopNewIndex(L, to_py_func(ix)) :\
            __Pyx__PyObject_PopIndex(L, py_ix)))
#define __Pyx_PyList_PopIndex(L, py_ix, ix, is_signed, type, to_py_func) (\
    __Pyx_fits_Py_ssize_t(ix, type, is_signed) ?\
        __Pyx__PyList_PopIndex(L, py_ix, ix) : (\
        (unlikely((py_ix) == Py_None)) ? __Pyx__PyObject_PopNewIndex(L, to_py_func(ix)) :\
            __Pyx__PyObject_PopIndex(L, py_ix)))
#else
#define __Pyx_PyList_PopIndex(L, py_ix, ix, is_signed, type, to_py_func)\
    __Pyx_PyObject_PopIndex(L, py_ix, ix, is_signed, type, to_py_func)
#define __Pyx_PyObject_PopIndex(L, py_ix, ix, is_signed, type, to_py_func) (\
    (unlikely((py_ix) == Py_None)) ? __Pyx__PyObject_PopNewIndex(L, to_py_func(ix)) :\
        __Pyx__PyObject_PopIndex(L, py_ix))
#endif

/* ArgTypeTest.proto */
#define __Pyx_ArgTypeTest(obj, type, none_allowed, name, exact)\
    ((likely(__Pyx_IS_TYPE(obj, type) | (none_allowed && (obj == Py_None)))) ? 1 :\
        __Pyx__ArgTypeTest(obj, type, name, exact))
static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact);

/* IsLittleEndian.proto */
static CYTHON_INLINE int __Pyx_Is_Little_Endian(void);

/* BufferFormatCheck.proto */
static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts);
static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
                              __Pyx_BufFmt_StackElem* stack,
                              const __Pyx_TypeInfo* type);

/* BufferGetAndValidate.proto */
#define __Pyx_GetBufferAndValidate(buf, obj, dtype, flags, nd, cast, stack)\
    ((obj == Py_None || obj == NULL) ?\
    (__Pyx_ZeroBuffer(buf), 0) :\
    __Pyx__GetBufferAndValidate(buf, obj, dtype, flags, nd, cast, stack))
static int  __Pyx__GetBufferAndValidate(Py_buffer* buf, PyObject* obj,
  const __Pyx_TypeInfo* dtype, int flags, int nd, int cast, __Pyx_BufFmt_StackElem* stack);
static void __Pyx_ZeroBuffer(Py_buffer* buf);
static CYTHON_INLINE void __Pyx_SafeReleaseBuffer(Py_buffer* info);
static Py_ssize_t __Pyx_minusones[] = { -1, -1, -1, -1, -1, -1, -1, -1 };
static Py_ssize_t __Pyx_zeros[] = { 0, 0, 0, 0, 0, 0, 0, 0 };

/* BuildPyUnicode.proto */
static PyObject* __Pyx_PyUnicode_BuildFromAscii(Py_ssize_t ulength, const char* chars, int clength,
                                                int prepend_sign, char padding_char);

/* COrdinalToPyUnicode.proto */
static CYTHON_INLINE int __Pyx_CheckUnicodeValue(int value);
static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromOrdinal_Padded(int value, Py_ssize_t width, char padding_char);

/* GCCDiagnostics.proto */
#if !defined(__INTEL_COMPILER) && defined(__GNUC__) && (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ >= 6))
#define __Pyx_HAS_GCC_DIAGNOSTIC
#endif

/* IncludeStdlibH.proto */
#include <stdlib.h>

/* CIntToPyUnicode.proto */
static CYTHON_INLINE PyObject* __Pyx_PyUnicode_From_Py_ssize_t(Py_ssize_t value, Py_ssize_t width, char padding_char, char format_char);

/* BufferIndexError.proto */
static void __Pyx_RaiseBufferIndexError(int axis);

#define __Pyx_BufPtrCContig1d(type, buf, i0, s0) ((type)buf + i0)
/* PyObjectVectorCallKwBuilder.proto */
CYTHON_UNUSED static int __Pyx_VectorcallBuilder_AddArg_Check(PyObject *key, PyObject *value, PyObject *builder, PyObject **args, int n);
#if CYTHON_VECTORCALL
#if PY_VERSION_HEX >= 0x03090000
#define __Pyx_Object_Vectorcall_CallFromBuilder PyObject_Vectorcall
#else
#define __Pyx_Object_Vectorcall_CallFromBuilder _PyObject_Vectorcall
#endif
#define __Pyx_MakeVectorcallBuilderKwds(n) PyTuple_New(n)
static int __Pyx_VectorcallBuilder_AddArg(PyObject *key, PyObject *value, PyObject *builder, PyObject **args, int n);
static int __Pyx_VectorcallBuilder_AddArgStr(const char *key, PyObject *value, PyObject *builder, PyObject **args, int n);
#else
#define __Pyx_Object_Vectorcall_CallFromBuilder __Pyx_PyObject_FastCallDict
#define __Pyx_MakeVectorcallBuilderKwds(n) __Pyx_PyDict_NewPresized(n)
#define __Pyx_VectorcallBuilder_AddArg(key, value, builder, args, n) PyDict_SetItem(builder, key, value)
#define __Pyx_VectorcallBuilder_AddArgStr(key, value, builder, args, n) PyDict_SetItemString(builder, key, value)
#endif

/* PyObjectVectorCallMethodKwBuilder.proto */
#if CYTHON_VECTORCALL && PY_VERSION_HEX >= 0x03090000
#define __Pyx_Object_VectorcallMethod_CallFromBuilder PyObject_VectorcallMethod
#else
static PyObject *__Pyx_Object_VectorcallMethod_CallFromBuilder(PyObject *name, PyObject *const *args, size_t nargsf, PyObject *kwnames);
#endif

/* PyUnicode_Unicode.proto */
static CYTHON_INLINE PyObject* __Pyx_PyUnicode_Unicode(PyObject *obj);

/* RaiseUnexpectedTypeError.proto */
static int __Pyx_RaiseUnexpectedTypeError(const char *expected, PyObject *obj);

/* ExtTypeTest.proto */
static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);

/* CallTypeTraverse.proto */
#if !CYTHON_USE_TYPE_SPECS || (!CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x03090000)
#define __Pyx_call_type_traverse(o, always_call, visit, arg) 0
#else
static int __Pyx_call_type_traverse(PyObject *o, int always_call, visitproc visit, void *arg);
#endif

/* LimitedApiGetTypeDict.proto */
#if CYTHON_COMPILING_IN_LIMITED_API
static PyObject *__Pyx_GetTypeDict(PyTypeObject *tp);
#endif

/* SetItemOnTypeDict.proto */
static int __Pyx__SetItemOnTypeDict(PyTypeObject *tp, PyObject *k, PyObject *v);
#define __Pyx_SetItemOnTypeDict(tp, k, v) __Pyx__SetItemOnTypeDict((PyTypeObject*)tp, k, v)

/* FixUpExtensionType.proto */
static CYTHON_INLINE int __Pyx_fix_up_extension_type_from_spec(PyType_Spec *spec, PyTypeObject *type);

/* ValidateBasesTuple.proto */
#if CYTHON_COMPILING_IN_CPYTHON || CYTHON_COMPILING_IN_LIMITED_API || CYTHON_USE_TYPE_SPECS
static int __Pyx_validate_bases_tuple(const char *type_name, Py_ssize_t dictoffset, PyObject *bases);
#endif

/* PyType_Ready.proto */
CYTHON_UNUSED static int __Pyx_PyType_Ready(PyTypeObject *t);

/* DelItemOnTypeDict.proto */
static int __Pyx__DelItemOnTypeDict(PyTypeObject *tp, PyObject *k);
#define __Pyx_DelItemOnTypeDict(tp, k) __Pyx__DelItemOnTypeDict((PyTypeObject*)tp, k)

/* SetupReduce.proto */
static int __Pyx_setup_reduce(PyObject* type_obj);

/* SetVTable.proto */
static int __Pyx_SetVtable(PyTypeObject* typeptr , void* vtable);

/* GetVTable.proto */
static void* __Pyx_GetVtable(PyTypeObject *type);

/* MergeVTables.proto */
static int __Pyx_MergeVtables(PyTypeObject *type);

/* TypeImport.proto */
#ifndef __PYX_HAVE_RT_ImportType_proto_3_1_3
#define __PYX_HAVE_RT_ImportType_proto_3_1_3
#if defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L
#include <stdalign.h>
#endif
#if (defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) || __cplusplus >= 201103L
#define __PYX_GET_STRUCT_ALIGNMENT_3_1_3(s) alignof(s)
#else
#define __PYX_GET_STRUCT_ALIGNMENT_3_1_3(s) sizeof(void*)
#endif
enum __Pyx_ImportType_CheckSize_3_1_3 {
   __Pyx_ImportType_CheckSize_Error_3_1_3 = 0,
   __Pyx_ImportType_CheckSize_Warn_3_1_3 = 1,
   __Pyx_ImportType_CheckSize_Ignore_3_1_3 = 2
};
static PyTypeObject *__Pyx_ImportType_3_1_3(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_1_3 check_size);
#endif

/* Import.proto */
static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level);

/* ImportDottedModule.proto */
static PyObject *__Pyx_ImportDottedModule(PyObject *name, PyObject *parts_tuple);
static PyObject *__Pyx_ImportDottedModule_WalkParts(PyObject *module, PyObject *name, PyObject *parts_tuple);

/* ListPack.proto */
static PyObject *__Pyx_PyList_Pack(Py_ssize_t n, ...);

/* ImportFrom.proto */
static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name);

/* Py3UpdateBases.proto */
static PyObject* __Pyx_PEP560_update_bases(PyObject *bases);

/* CalculateMetaclass.proto */
static PyObject *__Pyx_CalculateMetaclass(PyTypeObject *metaclass, PyObject *bases);

/* FetchSharedCythonModule.proto */
static PyObject *__Pyx_FetchSharedCythonABIModule(void);

/* dict_setdefault.proto */
static CYTHON_INLINE PyObject *__Pyx_PyDict_SetDefault(PyObject *d, PyObject *key, PyObject *default_value, int is_safe_type);

/* FetchCommonType.proto */
static PyTypeObject* __Pyx_FetchCommonTypeFromSpec(PyTypeObject *metaclass, PyObject *module, PyType_Spec *spec, PyObject *bases);

/* CommonTypesMetaclass.proto */
static int __pyx_CommonTypesMetaclass_init(PyObject *module);
#define __Pyx_CommonTypesMetaclass_USED

/* PyMethodNew.proto */
static PyObject *__Pyx_PyMethod_New(PyObject *func, PyObject *self, PyObject *typ);

/* PyVectorcallFastCallDict.proto */
#if CYTHON_METH_FASTCALL && (CYTHON_VECTORCALL || CYTHON_BACKPORT_VECTORCALL)
static CYTHON_INLINE PyObject *__Pyx_PyVectorcall_FastCallDict(PyObject *func, __pyx_vectorcallfunc vc, PyObject *const *args, size_t nargs, PyObject *kw);
#endif

/* CythonFunctionShared.proto */
#define __Pyx_CyFunction_USED
#define __Pyx_CYFUNCTION_STATICMETHOD  0x01
#define __Pyx_CYFUNCTION_CLASSMETHOD   0x02
#define __Pyx_CYFUNCTION_CCLASS        0x04
#define __Pyx_CYFUNCTION_COROUTINE     0x08
#define __Pyx_CyFunction_GetClosure(f)\
    (((__pyx_CyFunctionObject *) (f))->func_closure)
#if PY_VERSION_HEX < 0x030900B1 || CYTHON_COMPILING_IN_LIMITED_API
  #define __Pyx_CyFunction_GetClassObj(f)\
      (((__pyx_CyFunctionObject *) (f))->func_classobj)
#else
  #define __Pyx_CyFunction_GetClassObj(f)\
      ((PyObject*) ((PyCMethodObject *) (f))->mm_class)
#endif
#define __Pyx_CyFunction_SetClassObj(f, classobj)\
    __Pyx__CyFunction_SetClassObj((__pyx_CyFunctionObject *) (f), (classobj))
#define __Pyx_CyFunction_Defaults(type, f)\
    ((type *)(((__pyx_CyFunctionObject *) (f))->defaults))
#define __Pyx_CyFunction_SetDefaultsGetter(f, g)\
    ((__pyx_CyFunctionObject *) (f))->defaults_getter = (g)
typedef struct {
#if CYTHON_COMPILING_IN_LIMITED_API
    PyObject_HEAD
    PyObject *func;
#elif PY_VERSION_HEX < 0x030900B1
    PyCFunctionObject func;
#else
    PyCMethodObject func;
#endif
#if CYTHON_BACKPORT_VECTORCALL ||\
        (CYTHON_COMPILING_IN_LIMITED_API && CYTHON_METH_FASTCALL)
    __pyx_vectorcallfunc func_vectorcall;
#endif
#if CYTHON_COMPILING_IN_LIMITED_API
    PyObject *func_weakreflist;
#endif
    PyObject *func_dict;
    PyObject *func_name;
    PyObject *func_qualname;
    PyObject *func_doc;
    PyObject *func_globals;
    PyObject *func_code;
    PyObject *func_closure;
#if PY_VERSION_HEX < 0x030900B1 || CYTHON_COMPILING_IN_LIMITED_API
    PyObject *func_classobj;
#endif
    PyObject *defaults;
    int flags;
    PyObject *defaults_tuple;
    PyObject *defaults_kwdict;
    PyObject *(*defaults_getter)(PyObject *);
    PyObject *func_annotations;
    PyObject *func_is_coroutine;
} __pyx_CyFunctionObject;
#undef __Pyx_CyOrPyCFunction_Check
#define __Pyx_CyFunction_Check(obj)  __Pyx_TypeCheck(obj, __pyx_mstate_global->__pyx_CyFunctionType)
#define __Pyx_CyOrPyCFunction_Check(obj)  __Pyx_TypeCheck2(obj, __pyx_mstate_global->__pyx_CyFunctionType, &PyCFunction_Type)
#define __Pyx_CyFunction_CheckExact(obj)  __Pyx_IS_TYPE(obj, __pyx_mstate_global->__pyx_CyFunctionType)
static CYTHON_INLINE int __Pyx__IsSameCyOrCFunction(PyObject *func, void (*cfunc)(void));
#undef __Pyx_IsSameCFunction
#define __Pyx_IsSameCFunction(func, cfunc)   __Pyx__IsSameCyOrCFunction(func, cfunc)
static PyObject *__Pyx_CyFunction_Init(__pyx_CyFunctionObject* op, PyMethodDef *ml,
                                      int flags, PyObject* qualname,
                                      PyObject *closure,
                                      PyObject *module, PyObject *globals,
                                      PyObject* code);
static CYTHON_INLINE void __Pyx__CyFunction_SetClassObj(__pyx_CyFunctionObject* f, PyObject* classobj);
static CYTHON_INLINE PyObject *__Pyx_CyFunction_InitDefaults(PyObject *func,
                                                         PyTypeObject *defaults_type);
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *m,
                                                            PyObject *tuple);
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *m,
                                                             PyObject *dict);
static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *m,
                                                              PyObject *dict);
static int __pyx_CyFunction_init(PyObject *module);
#if CYTHON_METH_FASTCALL
static PyObject * __Pyx_CyFunction_Vectorcall_NOARGS(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames);
static PyObject * __Pyx_CyFunction_Vectorcall_O(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames);
static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames);
static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames);
#if CYTHON_BACKPORT_VECTORCALL || CYTHON_COMPILING_IN_LIMITED_API
#define __Pyx_CyFunction_func_vectorcall(f) (((__pyx_CyFunctionObject*)f)->func_vectorcall)
#else
#define __Pyx_CyFunction_func_vectorcall(f) (((PyCFunctionObject*)f)->vectorcall)
#endif
#endif

/* CythonFunction.proto */
static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml,
                                      int flags, PyObject* qualname,
                                      PyObject *closure,
                                      PyObject *module, PyObject *globals,
                                      PyObject* code);

/* SetNameInClass.proto */
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030d0000
#define __Pyx_SetNameInClass(ns, name, value)\
    (likely(PyDict_CheckExact(ns)) ? _PyDict_SetItem_KnownHash(ns, name, value, ((PyASCIIObject *) name)->hash) : PyObject_SetItem(ns, name, value))
#elif CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_SetNameInClass(ns, name, value)\
    (likely(PyDict_CheckExact(ns)) ? PyDict_SetItem(ns, name, value) : PyObject_SetItem(ns, name, value))
#else
#define __Pyx_SetNameInClass(ns, name, value)  PyObject_SetItem(ns, name, value)
#endif

/* PyObjectLookupSpecial.proto */
#if CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
#define __Pyx_PyObject_LookupSpecialNoError(obj, attr_name)  __Pyx__PyObject_LookupSpecial(obj, attr_name, 0)
#define __Pyx_PyObject_LookupSpecial(obj, attr_name)  __Pyx__PyObject_LookupSpecial(obj, attr_name, 1)
static CYTHON_INLINE PyObject* __Pyx__PyObject_LookupSpecial(PyObject* obj, PyObject* attr_name, int with_error);
#else
#define __Pyx_PyObject_LookupSpecialNoError(o,n) __Pyx_PyObject_GetAttrStrNoError(o,n)
#define __Pyx_PyObject_LookupSpecial(o,n) __Pyx_PyObject_GetAttrStr(o,n)
#endif

/* Py3ClassCreate.proto */
static PyObject *__Pyx_Py3MetaclassPrepare(PyObject *metaclass, PyObject *bases, PyObject *name, PyObject *qualname,
                                           PyObject *mkw, PyObject *modname, PyObject *doc);
static PyObject *__Pyx_Py3ClassCreate(PyObject *metaclass, PyObject *name, PyObject *bases, PyObject *dict,
                                      PyObject *mkw, int calculate_metaclass, int allow_py2_metaclass);

/* CLineInTraceback.proto */
#if CYTHON_CLINE_IN_TRACEBACK && CYTHON_CLINE_IN_TRACEBACK_RUNTIME
static int __Pyx_CLineForTraceback(PyThreadState *tstate, int c_line);
#else
#define __Pyx_CLineForTraceback(tstate, c_line)  (((CYTHON_CLINE_IN_TRACEBACK)) ? c_line : 0)
#endif

/* CodeObjectCache.proto */
#if CYTHON_COMPILING_IN_LIMITED_API
typedef PyObject __Pyx_CachedCodeObjectType;
#else
typedef PyCodeObject __Pyx_CachedCodeObjectType;
#endif
typedef struct {
    __Pyx_CachedCodeObjectType* code_object;
    int code_line;
} __Pyx_CodeObjectCacheEntry;
struct __Pyx_CodeObjectCache {
    int count;
    int max_count;
    __Pyx_CodeObjectCacheEntry* entries;
  #if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
    __pyx_atomic_int_type accessor_count;
  #endif
};
static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line);
static __Pyx_CachedCodeObjectType *__pyx_find_code_object(int code_line);
static void __pyx_insert_code_object(int code_line, __Pyx_CachedCodeObjectType* code_object);

/* AddTraceback.proto */
static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename);

/* BufferStructDeclare.proto */
typedef struct {
  Py_ssize_t shape, strides, suboffsets;
} __Pyx_Buf_DimInfo;
typedef struct {
  size_t refcount;
  Py_buffer pybuffer;
} __Pyx_Buffer;
typedef struct {
  __Pyx_Buffer *rcbuffer;
  char *data;
  __Pyx_Buf_DimInfo diminfo[8];
} __Pyx_LocalBuf_ND;

/* RealImag.proto */
#if CYTHON_CCOMPLEX
  #ifdef __cplusplus
    #define __Pyx_CREAL(z) ((z).real())
    #define __Pyx_CIMAG(z) ((z).imag())
  #else
    #define __Pyx_CREAL(z) (__real__(z))
    #define __Pyx_CIMAG(z) (__imag__(z))
  #endif
#else
    #define __Pyx_CREAL(z) ((z).real)
    #define __Pyx_CIMAG(z) ((z).imag)
#endif
#if defined(__cplusplus) && CYTHON_CCOMPLEX\
        && (defined(_WIN32) || defined(__clang__) || (defined(__GNUC__) && (__GNUC__ >= 5 || __GNUC__ == 4 && __GNUC_MINOR__ >= 4 )) || __cplusplus >= 201103)
    #define __Pyx_SET_CREAL(z,x) ((z).real(x))
    #define __Pyx_SET_CIMAG(z,y) ((z).imag(y))
#else
    #define __Pyx_SET_CREAL(z,x) __Pyx_CREAL(z) = (x)
    #define __Pyx_SET_CIMAG(z,y) __Pyx_CIMAG(z) = (y)
#endif

/* Arithmetic.proto */
#if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
    #define __Pyx_c_eq_float(a, b)   ((a)==(b))
    #define __Pyx_c_sum_float(a, b)  ((a)+(b))
    #define __Pyx_c_diff_float(a, b) ((a)-(b))
    #define __Pyx_c_prod_float(a, b) ((a)*(b))
    #define __Pyx_c_quot_float(a, b) ((a)/(b))
    #define __Pyx_c_neg_float(a)     (-(a))
  #ifdef __cplusplus
    #define __Pyx_c_is_zero_float(z) ((z)==(float)0)
    #define __Pyx_c_conj_float(z)    (::std::conj(z))
    #if 1
        #define __Pyx_c_abs_float(z)     (::std::abs(z))
        #define __Pyx_c_pow_float(a, b)  (::std::pow(a, b))
    #endif
  #else
    #define __Pyx_c_is_zero_float(z) ((z)==0)
    #define __Pyx_c_conj_float(z)    (conjf(z))
    #if 1
        #define __Pyx_c_abs_float(z)     (cabsf(z))
        #define __Pyx_c_pow_float(a, b)  (cpowf(a, b))
    #endif
 #endif
#else
    static CYTHON_INLINE int __Pyx_c_eq_float(__pyx_t_float_complex, __pyx_t_float_complex);
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_sum_float(__pyx_t_float_complex, __pyx_t_float_complex);
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_diff_float(__pyx_t_float_complex, __pyx_t_float_complex);
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_prod_float(__pyx_t_float_complex, __pyx_t_float_complex);
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quot_float(__pyx_t_float_complex, __pyx_t_float_complex);
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_neg_float(__pyx_t_float_complex);
    static CYTHON_INLINE int __Pyx_c_is_zero_float(__pyx_t_float_complex);
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_conj_float(__pyx_t_float_complex);
    #if 1
        static CYTHON_INLINE float __Pyx_c_abs_float(__pyx_t_float_complex);
        static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_pow_float(__pyx_t_float_complex, __pyx_t_float_complex);
    #endif
#endif

/* Arithmetic.proto */
#if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
    #define __Pyx_c_eq_double(a, b)   ((a)==(b))
    #define __Pyx_c_sum_double(a, b)  ((a)+(b))
    #define __Pyx_c_diff_double(a, b) ((a)-(b))
    #define __Pyx_c_prod_double(a, b) ((a)*(b))
    #define __Pyx_c_quot_double(a, b) ((a)/(b))
    #define __Pyx_c_neg_double(a)     (-(a))
  #ifdef __cplusplus
    #define __Pyx_c_is_zero_double(z) ((z)==(double)0)
    #define __Pyx_c_conj_double(z)    (::std::conj(z))
    #if 1
        #define __Pyx_c_abs_double(z)     (::std::abs(z))
        #define __Pyx_c_pow_double(a, b)  (::std::pow(a, b))
    #endif
  #else
    #define __Pyx_c_is_zero_double(z) ((z)==0)
    #define __Pyx_c_conj_double(z)    (conj(z))
    #if 1
        #define __Pyx_c_abs_double(z)     (cabs(z))
        #define __Pyx_c_pow_double(a, b)  (cpow(a, b))
    #endif
 #endif
#else
    static CYTHON_INLINE int __Pyx_c_eq_double(__pyx_t_double_complex, __pyx_t_double_complex);
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum_double(__pyx_t_double_complex, __pyx_t_double_complex);
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff_double(__pyx_t_double_complex, __pyx_t_double_complex);
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod_double(__pyx_t_double_complex, __pyx_t_double_complex);
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex, __pyx_t_double_complex);
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg_double(__pyx_t_double_complex);
    static CYTHON_INLINE int __Pyx_c_is_zero_double(__pyx_t_double_complex);
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj_double(__pyx_t_double_complex);
    #if 1
        static CYTHON_INLINE double __Pyx_c_abs_double(__pyx_t_double_complex);
        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow_double(__pyx_t_double_complex, __pyx_t_double_complex);
    #endif
#endif

/* Arithmetic.proto */
#if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
    #define __Pyx_c_eq_long__double(a, b)   ((a)==(b))
    #define __Pyx_c_sum_long__double(a, b)  ((a)+(b))
    #define __Pyx_c_diff_long__double(a, b) ((a)-(b))
    #define __Pyx_c_prod_long__double(a, b) ((a)*(b))
    #define __Pyx_c_quot_long__double(a, b) ((a)/(b))
    #define __Pyx_c_neg_long__double(a)     (-(a))
  #ifdef __cplusplus
    #define __Pyx_c_is_zero_long__double(z) ((z)==(long double)0)
    #define __Pyx_c_conj_long__double(z)    (::std::conj(z))
    #if 1
        #define __Pyx_c_abs_long__double(z)     (::std::abs(z))
        #define __Pyx_c_pow_long__double(a, b)  (::std::pow(a, b))
    #endif
  #else
    #define __Pyx_c_is_zero_long__double(z) ((z)==0)
    #define __Pyx_c_conj_long__double(z)    (conjl(z))
    #if 1
        #define __Pyx_c_abs_long__double(z)     (cabsl(z))
        #define __Pyx_c_pow_long__double(a, b)  (cpowl(a, b))
    #endif
 #endif
#else
    static CYTHON_INLINE int __Pyx_c_eq_long__double(__pyx_t_long_double_complex, __pyx_t_long_double_complex);
    static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_sum_long__double(__pyx_t_long_double_complex, __pyx_t_long_double_complex);
    static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_diff_long__double(__pyx_t_long_double_complex, __pyx_t_long_double_complex);
    static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_prod_long__double(__pyx_t_long_double_complex, __pyx_t_long_double_complex);
    static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_quot_long__double(__pyx_t_long_double_complex, __pyx_t_long_double_complex);
    static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_neg_long__double(__pyx_t_long_double_complex);
    static CYTHON_INLINE int __Pyx_c_is_zero_long__double(__pyx_t_long_double_complex);
    static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_conj_long__double(__pyx_t_long_double_complex);
    #if 1
        static CYTHON_INLINE long double __Pyx_c_abs_long__double(__pyx_t_long_double_complex);
        static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_pow_long__double(__pyx_t_long_double_complex, __pyx_t_long_double_complex);
    #endif
#endif

/* CIntToPy.proto */
static CYTHON_INLINE PyObject* __Pyx_PyLong_From_PetscInt(PetscInt value);

/* CIntFromPy.proto */
static CYTHON_INLINE PetscInt __Pyx_PyLong_As_PetscInt(PyObject *);

/* CIntToPy.proto */
static CYTHON_INLINE PyObject* __Pyx_PyLong_From_PetscErrorCode(PetscErrorCode value);

/* CIntFromPy.proto */
static CYTHON_INLINE size_t __Pyx_PyLong_As_size_t(PyObject *);

/* CIntFromPy.proto */
static CYTHON_INLINE int __Pyx_PyLong_As_int(PyObject *);

/* FormatTypeName.proto */
#if CYTHON_COMPILING_IN_LIMITED_API
typedef PyObject *__Pyx_TypeName;
#define __Pyx_FMT_TYPENAME "%U"
#define __Pyx_DECREF_TypeName(obj) Py_XDECREF(obj)
#if __PYX_LIMITED_VERSION_HEX >= 0x030d0000
#define __Pyx_PyType_GetFullyQualifiedName PyType_GetFullyQualifiedName
#else
static __Pyx_TypeName __Pyx_PyType_GetFullyQualifiedName(PyTypeObject* tp);
#endif
#else  // !LIMITED_API
typedef const char *__Pyx_TypeName;
#define __Pyx_FMT_TYPENAME "%.200s"
#define __Pyx_PyType_GetFullyQualifiedName(tp) ((tp)->tp_name)
#define __Pyx_DECREF_TypeName(obj)
#endif

/* CIntToPy.proto */
static CYTHON_INLINE PyObject* __Pyx_PyLong_From_long(long value);

/* CIntFromPy.proto */
static CYTHON_INLINE long __Pyx_PyLong_As_long(PyObject *);

/* FastTypeChecks.proto */
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_TypeCheck(obj, type) __Pyx_IsSubtype(Py_TYPE(obj), (PyTypeObject *)type)
#define __Pyx_TypeCheck2(obj, type1, type2) __Pyx_IsAnySubtype2(Py_TYPE(obj), (PyTypeObject *)type1, (PyTypeObject *)type2)
static CYTHON_INLINE int __Pyx_IsSubtype(PyTypeObject *a, PyTypeObject *b);
static CYTHON_INLINE int __Pyx_IsAnySubtype2(PyTypeObject *cls, PyTypeObject *a, PyTypeObject *b);
static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches(PyObject *err, PyObject *type);
static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches2(PyObject *err, PyObject *type1, PyObject *type2);
#else
#define __Pyx_TypeCheck(obj, type) PyObject_TypeCheck(obj, (PyTypeObject *)type)
#define __Pyx_TypeCheck2(obj, type1, type2) (PyObject_TypeCheck(obj, (PyTypeObject *)type1) || PyObject_TypeCheck(obj, (PyTypeObject *)type2))
#define __Pyx_PyErr_GivenExceptionMatches(err, type) PyErr_GivenExceptionMatches(err, type)
static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches2(PyObject *err, PyObject *type1, PyObject *type2) {
    return PyErr_GivenExceptionMatches(err, type1) || PyErr_GivenExceptionMatches(err, type2);
}
#endif
#define __Pyx_PyErr_ExceptionMatches2(err1, err2)  __Pyx_PyErr_GivenExceptionMatches2(__Pyx_PyErr_CurrentExceptionType(), err1, err2)
#define __Pyx_PyException_Check(obj) __Pyx_TypeCheck(obj, PyExc_Exception)
#ifdef PyExceptionInstance_Check
  #define __Pyx_PyBaseException_Check(obj) PyExceptionInstance_Check(obj)
#else
  #define __Pyx_PyBaseException_Check(obj) __Pyx_TypeCheck(obj, PyExc_BaseException)
#endif

/* GetRuntimeVersion.proto */
static unsigned long __Pyx_get_runtime_version(void);

/* CheckBinaryVersion.proto */
static int __Pyx_check_binary_version(unsigned long ct_version, unsigned long rt_version, int allow_newer);

/* FunctionExport.proto */
static int __Pyx_ExportFunction(const char *name, void (*f)(void), const char *sig);

/* MultiPhaseInitModuleState.proto */
#if CYTHON_PEP489_MULTI_PHASE_INIT && CYTHON_USE_MODULE_STATE
static PyObject *__Pyx_State_FindModule(void*);
static int __Pyx_State_AddModule(PyObject* module, void*);
static int __Pyx_State_RemoveModule(void*);
#elif CYTHON_USE_MODULE_STATE
#define __Pyx_State_FindModule PyState_FindModule
#define __Pyx_State_AddModule PyState_AddModule
#define __Pyx_State_RemoveModule PyState_RemoveModule
#endif

/* #### Code section: module_declarations ### */
/* CythonABIVersion.proto */
#if CYTHON_COMPILING_IN_LIMITED_API
    #if CYTHON_METH_FASTCALL
        #define __PYX_FASTCALL_ABI_SUFFIX  "_fastcall"
    #else
        #define __PYX_FASTCALL_ABI_SUFFIX
    #endif
    #define __PYX_LIMITED_ABI_SUFFIX "limited" __PYX_FASTCALL_ABI_SUFFIX __PYX_AM_SEND_ABI_SUFFIX
#else
    #define __PYX_LIMITED_ABI_SUFFIX
#endif
#if __PYX_HAS_PY_AM_SEND == 1
    #define __PYX_AM_SEND_ABI_SUFFIX
#elif __PYX_HAS_PY_AM_SEND == 2
    #define __PYX_AM_SEND_ABI_SUFFIX "amsendbackport"
#else
    #define __PYX_AM_SEND_ABI_SUFFIX "noamsend"
#endif
#ifndef __PYX_MONITORING_ABI_SUFFIX
    #define __PYX_MONITORING_ABI_SUFFIX
#endif
#if CYTHON_USE_TP_FINALIZE
    #define __PYX_TP_FINALIZE_ABI_SUFFIX
#else
    #define __PYX_TP_FINALIZE_ABI_SUFFIX "nofinalize"
#endif
#if CYTHON_USE_FREELISTS || !defined(__Pyx_AsyncGen_USED)
    #define __PYX_FREELISTS_ABI_SUFFIX
#else
    #define __PYX_FREELISTS_ABI_SUFFIX "nofreelists"
#endif
#define CYTHON_ABI  __PYX_ABI_VERSION __PYX_LIMITED_ABI_SUFFIX __PYX_MONITORING_ABI_SUFFIX __PYX_TP_FINALIZE_ABI_SUFFIX __PYX_FREELISTS_ABI_SUFFIX __PYX_AM_SEND_ABI_SUFFIX
#define __PYX_ABI_MODULE_NAME "_cython_" CYTHON_ABI
#define __PYX_TYPE_MODULE_PREFIX __PYX_ABI_MODULE_NAME "."

static CYTHON_INLINE npy_intp __pyx_f_5numpy_5dtype_8itemsize_itemsize(PyArray_Descr *__pyx_v_self); /* proto*/
static CYTHON_INLINE npy_intp __pyx_f_5numpy_5dtype_9alignment_alignment(PyArray_Descr *__pyx_v_self); /* proto*/
static CYTHON_INLINE PyObject *__pyx_f_5numpy_5dtype_6fields_fields(PyArray_Descr *__pyx_v_self); /* proto*/
static CYTHON_INLINE PyObject *__pyx_f_5numpy_5dtype_5names_names(PyArray_Descr *__pyx_v_self); /* proto*/
static CYTHON_INLINE PyArray_ArrayDescr *__pyx_f_5numpy_5dtype_8subarray_subarray(PyArray_Descr *__pyx_v_self); /* proto*/
static CYTHON_INLINE npy_uint64 __pyx_f_5numpy_5dtype_5flags_flags(PyArray_Descr *__pyx_v_self); /* proto*/
static CYTHON_INLINE int __pyx_f_5numpy_9broadcast_7numiter_numiter(PyArrayMultiIterObject *__pyx_v_self); /* proto*/
static CYTHON_INLINE npy_intp __pyx_f_5numpy_9broadcast_4size_size(PyArrayMultiIterObject *__pyx_v_self); /* proto*/
static CYTHON_INLINE npy_intp __pyx_f_5numpy_9broadcast_5index_index(PyArrayMultiIterObject *__pyx_v_self); /* proto*/
static CYTHON_INLINE int __pyx_f_5numpy_9broadcast_2nd_nd(PyArrayMultiIterObject *__pyx_v_self); /* proto*/
static CYTHON_INLINE npy_intp *__pyx_f_5numpy_9broadcast_10dimensions_dimensions(PyArrayMultiIterObject *__pyx_v_self); /* proto*/
static CYTHON_INLINE void **__pyx_f_5numpy_9broadcast_5iters_iters(PyArrayMultiIterObject *__pyx_v_self); /* proto*/
static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self); /* proto*/
static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self); /* proto*/
static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self); /* proto*/
static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self); /* proto*/
static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self); /* proto*/
static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self); /* proto*/
static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self); /* proto*/
#if !CYTHON_COMPILING_IN_LIMITED_API
static CYTHON_INLINE double __pyx_f_7cpython_7complex_7complex_4real_real(PyComplexObject *__pyx_v_self); /* proto*/
#endif
#if !CYTHON_COMPILING_IN_LIMITED_API
static CYTHON_INLINE double __pyx_f_7cpython_7complex_7complex_4imag_imag(PyComplexObject *__pyx_v_self); /* proto*/
#endif
static PyObject *__pyx_f_6tmm4py_11tmm4py_core_17_RealArrayWrapper_set_data(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *__pyx_v_self, PetscInt __pyx_v_size, PetscScalar *__pyx_v_data_ptr, Vec __pyx_v_pv, PyObject *__pyx_v_myId); /* proto*/
static PyObject *__pyx_f_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_set_data(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *__pyx_v_self, PetscInt __pyx_v_size, PetscScalar *__pyx_v_data_ptr, Vec __pyx_v_pv, PyObject *__pyx_v_myId); /* proto*/
static PyObject *__pyx_f_6tmm4py_11tmm4py_core_16_IntArrayWrapper_set_data(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *__pyx_v_self, int __pyx_v_size, PetscInt *__pyx_v_data_ptr); /* proto*/
static PyObject *__pyx_f_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_set_data(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *__pyx_v_self, int __pyx_v_size, PetscInt *__pyx_v_data_ptr); /* proto*/

/* Module declarations from "petsc4py.PETSc" */

/* Module declarations from "cython" */

/* Module declarations from "libc.string" */

/* Module declarations from "libc.stdio" */

/* Module declarations from "__builtin__" */

/* Module declarations from "cpython.type" */

/* Module declarations from "cpython.version" */

/* Module declarations from "cpython.exc" */

/* Module declarations from "cpython.module" */

/* Module declarations from "cpython.mem" */

/* Module declarations from "cpython.tuple" */

/* Module declarations from "cpython.list" */

/* Module declarations from "cpython.sequence" */

/* Module declarations from "cpython.mapping" */

/* Module declarations from "cpython.iterator" */

/* Module declarations from "cpython.number" */

/* Module declarations from "__builtin__" */

/* Module declarations from "cpython.bool" */

/* Module declarations from "cpython.long" */

/* Module declarations from "cpython.float" */

/* Module declarations from "__builtin__" */

/* Module declarations from "cpython.complex" */

/* Module declarations from "libc.stddef" */

/* Module declarations from "cpython.unicode" */

/* Module declarations from "cpython.pyport" */

/* Module declarations from "cpython.dict" */

/* Module declarations from "cpython.instance" */

/* Module declarations from "cpython.function" */

/* Module declarations from "cpython.method" */

/* Module declarations from "cpython.weakref" */

/* Module declarations from "cpython.getargs" */

/* Module declarations from "cpython.pythread" */

/* Module declarations from "cpython.pystate" */

/* Module declarations from "cpython.set" */

/* Module declarations from "cpython.buffer" */

/* Module declarations from "cpython.bytes" */

/* Module declarations from "cpython.pycapsule" */

/* Module declarations from "cpython.contextvars" */

/* Module declarations from "cpython" */

/* Module declarations from "cpython.object" */

/* Module declarations from "cpython.ref" */

/* Module declarations from "numpy" */

/* Module declarations from "numpy" */
static CYTHON_INLINE int __pyx_f_5numpy_import_array(void); /*proto*/

/* Module declarations from "libc.stdlib" */

/* Module declarations from "tmm4py.tmm4py_core" */
static CYTHON_INLINE PyObject *__pyx_f_6tmm4py_11tmm4py_core_toBool(PetscBool); /*proto*/
static CYTHON_INLINE PetscBool __pyx_f_6tmm4py_11tmm4py_core_asBool(PyObject *); /*proto*/
static CYTHON_INLINE PyObject *__pyx_f_6tmm4py_11tmm4py_core_toInt(PetscInt); /*proto*/
static CYTHON_INLINE PetscInt __pyx_f_6tmm4py_11tmm4py_core_asInt(PyObject *); /*proto*/
static CYTHON_INLINE PyObject *__pyx_f_6tmm4py_11tmm4py_core_toReal(PetscReal); /*proto*/
static CYTHON_INLINE PetscReal __pyx_f_6tmm4py_11tmm4py_core_asReal(PyObject *); /*proto*/
static PyObject *__pyx_f_6tmm4py_11tmm4py_core_copyNumpyIntArrayFromPointer(PetscInt *, PetscInt); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_iniExternalForcingCB(PetscScalar, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_calcExternalForcingCB(PetscScalar, PetscInt, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_wriExternalForcingCB(PetscScalar, PetscInt, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_finExternalForcingCB(PetscScalar, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_reiExternalForcingCB(PetscScalar, PetscInt, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_iniCalcBCCB(PetscScalar, PetscInt, PetscScalar, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_calcCalcBCCB(PetscScalar, PetscInt, PetscScalar, PetscInt, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_wriCalcBCCB(PetscScalar, PetscInt, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_finCalcBCCB(PetscScalar, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_reiCalcBCCB(PetscScalar, PetscInt, PetscScalar, PetscInt, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_iniMonitorCB(PetscScalar, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_calcMonitorCB(PetscScalar, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_wriMonitorCB(PetscScalar, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_finMonitorCB(PetscScalar, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_iniMisfitCB(PetscScalar, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_calcMisfitCB(PetscScalar, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_wriMisfitCB(PetscScalar, PetscInt, TMMState, void *); /*proto*/
static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_finMisfitCB(PetscScalar, PetscInt, TMMState, void *); /*proto*/
static PyObject *__pyx_f_6tmm4py_11tmm4py_core__getStateConfig(TMMState); /*proto*/
static PyObject *__pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArray(PetscInt, PetscScalar *, Vec, PyObject *); /*proto*/
static PyObject *__pyx_f_6tmm4py_11tmm4py_core__ToNumpyIntArray(PetscInt, PetscInt *); /*proto*/
static PyObject *__pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArrayWithDel(PetscInt, PetscScalar *, Vec, PyObject *); /*proto*/
static PyObject *__pyx_f_6tmm4py_11tmm4py_core__ToNumpyIntArrayWithDel(PetscInt, PetscInt *); /*proto*/
/* #### Code section: typeinfo ### */
static const __Pyx_TypeInfo __Pyx_TypeInfo_double = { "double", NULL, sizeof(double), { 0 }, 0, 'R', 0, 0 };
/* #### Code section: before_global_var ### */
#define __Pyx_MODULE_NAME "tmm4py.tmm4py_core"
extern int __pyx_module_is_main_tmm4py__tmm4py_core;
int __pyx_module_is_main_tmm4py__tmm4py_core = 0;

/* Implementation of "tmm4py.tmm4py_core" */
/* #### Code section: global_var ### */
static PyObject *__pyx_builtin_RuntimeError;
static PyObject *__pyx_builtin_print;
static PyObject *__pyx_builtin_range;
static PyObject *__pyx_builtin_TypeError;
static PyObject *__pyx_builtin_KeyError;
static PyObject *__pyx_builtin_ImportError;
/* #### Code section: string_decls ### */
static const char __pyx_k_[] = "";
static const char __pyx_k_A[] = "\200A\330\006\n\210&\220\001";
static const char __pyx_k_N[] = "N";
static const char __pyx_k_Q[] = "\200\001\330\004\n\210+\220Q";
static const char __pyx_k_c[] = "-c[";
static const char __pyx_k_k[] = "k";
static const char __pyx_k_n[] = "n";
static const char __pyx_k_r[] = "], r=";
static const char __pyx_k_s[] = "s";
static const char __pyx_k_x[] = "x";
static const char __pyx_k_y[] = "y";
static const char __pyx_k_Id[] = "Id";
static const char __pyx_k_Qa[] = "\200!\330\003\t\210\034\220Q\220a";
static const char __pyx_k__2[] = ",";
static const char __pyx_k__3[] = ", ";
static const char __pyx_k__4[] = ".";
static const char __pyx_k__5[] = "?";
static const char __pyx_k_aq[] = "\200!\330\004\n\210,\220a\220q";
static const char __pyx_k_gc[] = "gc";
static const char __pyx_k_nl[] = "nl";
static const char __pyx_k_np[] = "np";
static const char __pyx_k_nx[] = "nx";
static const char __pyx_k_ny[] = "ny";
static const char __pyx_k_qf[] = "-qf[";
static const char __pyx_k_tc[] = "tc";
static const char __pyx_k_tf[] = "tf";
static const char __pyx_k_xc[] = "xc";
static const char __pyx_k_A_2[] = "\200A";
static const char __pyx_k_MPI[] = "MPI";
static const char __pyx_k_Vec[] = "Vec";
static const char __pyx_k_arr[] = "arr";
static const char __pyx_k_buf[] = "buf";
static const char __pyx_k_c_2[] = "c";
static const char __pyx_k_cbc[] = "-cbc[";
static const char __pyx_k_cbf[] = "-cbf[";
static const char __pyx_k_doc[] = "__doc__";
static const char __pyx_k_dot[] = "dot";
static const char __pyx_k_for[] = ") for ";
static const char __pyx_k_itr[] = "itr";
static const char __pyx_k_key[] = "key";
static const char __pyx_k_pop[] = "pop";
static const char __pyx_k_pre[] = "pre";
static const char __pyx_k_qef[] = "-qef[";
static const char __pyx_k_res[] = "res";
static const char __pyx_k_sys[] = "sys";
static const char __pyx_k_tcc[] = "tcc";
static const char __pyx_k_tdp[] = "tdp";
static const char __pyx_k_tdt[] = "tdt";
static const char __pyx_k_tot[] = "tot";
static const char __pyx_k_typ[] = "typ";
static const char __pyx_k_val[] = "val";
static const char __pyx_k_A_4q[] = "\200A\340\n\023\220?\240!\2404\240q\330\n\021\220\021";
static const char __pyx_k_Id_2[] = "Id=";
static const char __pyx_k_Iter[] = "Iter";
static const char __pyx_k_None[] = "None";
static const char __pyx_k_Stub[] = "Stub";
static const char __pyx_k_args[] = "args";
static const char __pyx_k_comm[] = "comm";
static const char __pyx_k_copy[] = "copy";
static const char __pyx_k_func[] = "func";
static const char __pyx_k_iRec[] = "iRec";
static const char __pyx_k_ierr[] = "ierr";
static const char __pyx_k_incr[] = "incr";
static const char __pyx_k_init[] = "__init__";
static const char __pyx_k_item[] = "item";
static const char __pyx_k_keys[] = "keys";
static const char __pyx_k_lDim[] = "lDim";
static const char __pyx_k_main[] = "__main__";
static const char __pyx_k_mode[] = "mode";
static const char __pyx_k_myId[] = "myId";
static const char __pyx_k_name[] = "__name__";
static const char __pyx_k_qf_2[] = "qf";
static const char __pyx_k_qrel[] = "-qrel[";
static const char __pyx_k_rank[] = "rank";
static const char __pyx_k_self[] = "self";
static const char __pyx_k_spec[] = "__spec__";
static const char __pyx_k_sval[] = "sval";
static const char __pyx_k_test[] = "__test__";
static const char __pyx_k_view[] = "view";
static const char __pyx_k_xarr[] = "xarr";
static const char __pyx_k_yarr[] = "yarr";
static const char __pyx_k_5_e1A[] = "\200\001\330\004\013\2105\220\001\220\025\220e\2301\230A";
static const char __pyx_k_Error[] = "Error";
static const char __pyx_k_Iter0[] = "Iter0";
static const char __pyx_k_Iterc[] = "Iterc";
static const char __pyx_k_Iterf[] = "Iterf";
static const char __pyx_k_OptDB[] = "OptDB";
static const char __pyx_k_PETSc[] = "PETSc";
static const char __pyx_k_alpha[] = "alpha";
static const char __pyx_k_array[] = "array";
static const char __pyx_k_c_pre[] = "c_pre";
static const char __pyx_k_c_tdp[] = "c_tdp";
static const char __pyx_k_c_tdt[] = "c_tdt";
static const char __pyx_k_cbc_2[] = "cbc";
static const char __pyx_k_cbf_2[] = "cbf";
static const char __pyx_k_debug[] = "debug";
static const char __pyx_k_dtype[] = "dtype";
static const char __pyx_k_iLoop[] = "iLoop";
static const char __pyx_k_iRecc[] = "iRecc";
static const char __pyx_k_index[] = "index";
static const char __pyx_k_lSize[] = "lSize";
static const char __pyx_k_nparr[] = "nparr";
static const char __pyx_k_numpy[] = "numpy";
static const char __pyx_k_print[] = "print";
static const char __pyx_k_qef_2[] = "qef";
static const char __pyx_k_range[] = "range";
static const char __pyx_k_shape[] = "shape";
static const char __pyx_k_split[] = "split";
static const char __pyx_k_state[] = "state";
static const char __pyx_k_time0[] = "time0";
static const char __pyx_k_timer[] = "timer";
static const char __pyx_k_Itercc[] = "Itercc";
static const char __pyx_k_Viewer[] = "Viewer";
static const char __pyx_k_append[] = "append";
static const char __pyx_k_atexit[] = "atexit";
static const char __pyx_k_config[] = "config";
static const char __pyx_k_create[] = "create";
static const char __pyx_k_enable[] = "enable";
static const char __pyx_k_encode[] = "encode";
static const char __pyx_k_func_2[] = "__func__";
static const char __pyx_k_getInt[] = "getInt";
static const char __pyx_k_iLoopc[] = "iLoopc";
static const char __pyx_k_insert[] = "insert";
static const char __pyx_k_interp[] = "interp";
static const char __pyx_k_kwargs[] = "kwargs";
static const char __pyx_k_module[] = "__module__";
static const char __pyx_k_mpi4py[] = "mpi4py";
static const char __pyx_k_newarr[] = "newarr";
static const char __pyx_k_newvec[] = "newvec";
static const char __pyx_k_output[] = "output";
static const char __pyx_k_prefix[] = "prefix";
static const char __pyx_k_qrel_2[] = "qrel";
static const char __pyx_k_reduce[] = "__reduce__";
static const char __pyx_k_tracer[] = "tracer";
static const char __pyx_k_update[] = "update";
static const char __pyx_k_viewer[] = "viewer";
static const char __pyx_k_A_uAT_q[] = "\200A\330\010\017\210u\220A\220T\230\026\230q";
static const char __pyx_k_Options[] = "Options";
static const char __pyx_k_applyBC[] = "applyBC";
static const char __pyx_k_array_2[] = "__array__";
static const char __pyx_k_barrier[] = "barrier";
static const char __pyx_k_cleanUp[] = "_cleanUp";
static const char __pyx_k_context[] = "context";
static const char __pyx_k_destroy[] = "destroy";
static const char __pyx_k_disable[] = "disable";
static const char __pyx_k_dotProd[] = "dotProd";
static const char __pyx_k_getRank[] = "getRank";
static const char __pyx_k_hasName[] = "hasName";
static const char __pyx_k_ndarray[] = "ndarray";
static const char __pyx_k_prepare[] = "__prepare__";
static const char __pyx_k_setitem[] = "__setitem__";
static const char __pyx_k_tconfig[] = "tconfig";
static const char __pyx_k_Doing_GC[] = "Doing GC ";
static const char __pyx_k_Iter0ret[] = "Iter0ret";
static const char __pyx_k_KeyError[] = "KeyError";
static const char __pyx_k_TMMState[] = "TMMState";
static const char __pyx_k_add_note[] = "add_note";
static const char __pyx_k_doCalcBC[] = "doCalcBC";
static const char __pyx_k_doMisfit[] = "doMisfit";
static const char __pyx_k_doOutput[] = "doOutput";
static const char __pyx_k_filename[] = "filename";
static const char __pyx_k_finalize[] = "finalize";
static const char __pyx_k_getSizes[] = "getSizes";
static const char __pyx_k_getstate[] = "__getstate__";
static const char __pyx_k_maxSteps[] = "maxSteps";
static const char __pyx_k_newstate[] = "newstate";
static const char __pyx_k_newtimer[] = "newtimer";
static const char __pyx_k_petsc4py[] = "petsc4py";
static const char __pyx_k_qualname[] = "__qualname__";
static const char __pyx_k_register[] = "register";
static const char __pyx_k_setValue[] = "setValue";
static const char __pyx_k_set_name[] = "__set_name__";
static const char __pyx_k_setstate[] = "__setstate__";
static const char __pyx_k_time0ret[] = "time0ret";
static const char __pyx_k_timeStep[] = "timeStep";
static const char __pyx_k_warnings[] = "warnings";
static const char __pyx_k_7_uCs_V1A[] = "\200\001\360\006\000\005\014\2107\220!\330\004\007\200u\210C\210s\220&\230\005\230V\2401\240A";
static const char __pyx_k_Before_GC[] = "Before GC ";
static const char __pyx_k_StepTimer[] = "StepTimer";
static const char __pyx_k_TypeError[] = "TypeError";
static const char __pyx_k_c_pre2pre[] = "c_pre2pre";
static const char __pyx_k_doWriteBC[] = "doWriteBC";
static const char __pyx_k_doWriteQF[] = "doWriteQF";
static const char __pyx_k_getConfig[] = "getConfig";
static const char __pyx_k_getString[] = "getString";
static const char __pyx_k_globalSum[] = "globalSum";
static const char __pyx_k_isenabled[] = "isenabled";
static const char __pyx_k_metaclass[] = "__metaclass__";
static const char __pyx_k_num_times[] = "num_times";
static const char __pyx_k_pyx_state[] = "__pyx_state";
static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
static const char __pyx_k_setTracer[] = "setTracer";
static const char __pyx_k_updateTMs[] = "updateTMs";
static const char __pyx_k_COMM_WORLD[] = "COMM_WORLD";
static const char __pyx_k_OptDBState[] = "OptDBState";
static const char __pyx_k_c_filename[] = "c_filename";
static const char __pyx_k_configVars[] = "configVars";
static const char __pyx_k_constantBC[] = "constantBC";
static const char __pyx_k_doWriteQEF[] = "doWriteQEF";
static const char __pyx_k_getBCSizes[] = "getBCSizes";
static const char __pyx_k_initialize[] = "initialize";
static const char __pyx_k_numTracers[] = "numTracers";
static const char __pyx_k_periodicBC[] = "periodicBC";
static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
static const char __pyx_k_useMonitor[] = "useMonitor";
static const char __pyx_k_6_q_uCs_V1A[] = "\200\001\340\004\033\2306\240\021\240!\330\004\013\210<\220q\230\001\330\004\007\200u\210C\210s\220&\230\005\230V\2401\240A";
static const char __pyx_k_ImportError[] = "ImportError";
static const char __pyx_k_PeriodicVec[] = "PeriodicVec";
static const char __pyx_k_Stub___init[] = "Stub.__init__";
static const char __pyx_k_arrayLength[] = "arrayLength";
static const char __pyx_k_cyclePeriod[] = "cyclePeriod";
static const char __pyx_k_deltaTClock[] = "deltaTClock";
static const char __pyx_k_dotProdVecs[] = "dotProdVecs";
static const char __pyx_k_iniCalcBCFn[] = "iniCalcBCFn";
static const char __pyx_k_iniMisfitFn[] = "iniMisfitFn";
static const char __pyx_k_lEndIndices[] = "lEndIndices";
static const char __pyx_k_maxStepsret[] = "maxStepsret";
static const char __pyx_k_mro_entries[] = "__mro_entries__";
static const char __pyx_k_profileVars[] = "profileVars";
static const char __pyx_k_relaxTracer[] = "relaxTracer";
static const char __pyx_k_useProfiles[] = "useProfiles";
static const char __pyx_k_vQa_U_U_1_L[] = "\200\001\330\004\007\200v\210Q\210a\330\006\r\210U\220!\220:\230U\240!\2401\340\006\014\210L\230\001\230\021";
static const char __pyx_k_writePickup[] = "writePickup";
static const char __pyx_k_xarr_length[] = "xarr length ";
static const char __pyx_k_6_aq_uCs_V1A[] = "\200\001\340\004\033\2306\240\021\240!\330\004\013\210;\220a\220q\330\004\007\200u\210C\210s\220&\230\005\230V\2401\240A";
static const char __pyx_k_RuntimeError[] = "RuntimeError";
static const char __pyx_k_appendOutput[] = "appendOutput";
static const char __pyx_k_appendToFile[] = "appendToFile";
static const char __pyx_k_calcCalcBCFn[] = "calcCalcBCFn";
static const char __pyx_k_calcMisfitFn[] = "calcMisfitFn";
static const char __pyx_k_createBinary[] = "createBinary";
static const char __pyx_k_cycle_period[] = "cycle_period";
static const char __pyx_k_data_pointer[] = "data_pointer";
static const char __pyx_k_doExtraWrite[] = "doExtraWrite";
static const char __pyx_k_freeing_data[] = "freeing data";
static const char __pyx_k_iniMonitorFn[] = "iniMonitorFn";
static const char __pyx_k_initializing[] = "_initializing";
static const char __pyx_k_is_coroutine[] = "_is_coroutine";
static const char __pyx_k_lNumProfiles[] = "lNumProfiles";
static const char __pyx_k_stringsource[] = "<stringsource>";
static const char __pyx_k_timeStepPost[] = "timeStepPost";
static const char __pyx_k_tracer_names[] = "tracer_names";
static const char __pyx_k_when_loading[] = " when loading";
static const char __pyx_k_9AT_uCs_V1A_6[] = "\200\001\360\006\000\005\033\230&\240\001\240\021\360\006\000\005\014\2109\220A\220T\230\021\230!\330\004\007\200u\210C\210s\220&\230\005\230V\2401\240A\340\004\013\2106\220\021\220!";
static const char __pyx_k_A_D_a_5_3fE_q[] = "\200A\360\006\000\t\r\210D\220\001\330\010\017\320\017(\250\001\250\021\250$\250a\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_ImmutableList[] = "_ImmutableList";
static const char __pyx_k_PeriodicArray[] = "PeriodicArray";
static const char __pyx_k_PeriodicTimer[] = "PeriodicTimer";
static const char __pyx_k_calcMonitorFn[] = "calcMonitorFn";
static const char __pyx_k_doTimeAverage[] = "doTimeAverage";
static const char __pyx_k_forcingUpdate[] = "forcingUpdate";
static const char __pyx_k_getNumTracers[] = "getNumTracers";
static const char __pyx_k_getTimeConfig[] = "getTimeConfig";
static const char __pyx_k_k_Qe_Q_as_A_q[] = "\320\004\036\230k\250\021\340\010\r\210Q\210e\220>\240\024\240Q\340\010\024\320\024.\250a\250s\260)\270=\310\004\310A\330\010\017\210q";
static const char __pyx_k_k_Qe_Q_as_T_q[] = "\320\004\036\230k\250\021\340\010\r\210Q\210e\220>\240\024\240Q\340\010\024\320\024.\250a\250s\260)\270:\300T\310\021\330\010\017\210q";
static const char __pyx_k_lStartIndices[] = "lStartIndices";
static const char __pyx_k_prefix2prefix[] = "prefix2prefix";
static const char __pyx_k_pushConfigVar[] = "pushConfigVar";
static const char __pyx_k_reduce_cython[] = "__reduce_cython__";
static const char __pyx_k_startTimeStep[] = "startTimeStep";
static const char __pyx_k_statescreated[] = "_statescreated";
static const char __pyx_k_writeCalcBCFn[] = "writeCalcBCFn";
static const char __pyx_k_writeMisfitFn[] = "writeMisfitFn";
static const char __pyx_k_xdata_pointer[] = "xdata_pointer";
static const char __pyx_k_ydata_pointer[] = "ydata_pointer";
static const char __pyx_k_A_F_4vWBa_IT_q[] = "\200A\330\010\014\210F\220)\2304\230v\240W\250B\250a\330\010\014\210I\220T\230\026\230q";
static const char __pyx_k_Must_be_a_bool[] = ". Must be a bool!";
static const char __pyx_k_StepTimer_incr[] = "StepTimer.incr";
static const char __pyx_k_deltaTClockret[] = "deltaTClockret";
static const char __pyx_k_lProfileLength[] = "lProfileLength";
static const char __pyx_k_num_per_period[] = "num_per_period";
static const char __pyx_k_pickupFromFile[] = "pickupFromFile";
static const char __pyx_k_setFromOptions[] = "setFromOptions";
static const char __pyx_k_writeMonitorFn[] = "writeMonitorFn";
static const char __pyx_k_A_D_1AT_5_3fE_q[] = "\200A\360\006\000\t\r\210D\220\001\330\010\017\320\017#\2401\240A\240T\250\021\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_IntArrayWrapper[] = "_IntArrayWrapper";
static const char __pyx_k_TMMState_create[] = "TMMState.create";
static const char __pyx_k_TMMState_output[] = "TMMState.output";
static const char __pyx_k_avgAppendOutput[] = "avgAppendOutput";
static const char __pyx_k_constantForcing[] = "constantForcing";
static const char __pyx_k_createWithArray[] = "createWithArray";
static const char __pyx_k_globalScalarSum[] = "globalScalarSum";
static const char __pyx_k_periodicForcing[] = "periodicForcing";
static const char __pyx_k_setstate_cython[] = "__setstate_cython__";
static const char __pyx_k_timeDependentBC[] = "timeDependentBC";
static const char __pyx_k_usePrescribedBC[] = "usePrescribedBC";
static const char __pyx_k_writeArrayToVec[] = "writeArrayToVec";
static const char __pyx_k_A_y_5_3fE_q_G1_q[] = "\200A\360\n\000\t\020\210y\230\001\230\021\230!\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\010\014\210G\2201\340\010\017\210q";
static const char __pyx_k_RealArrayWrapper[] = "_RealArrayWrapper";
static const char __pyx_k_StepTimer_create[] = "StepTimer.create";
static const char __pyx_k_StepTimer_update[] = "StepTimer.update";
static const char __pyx_k_Stub_iniCalcBCFn[] = "Stub.iniCalcBCFn";
static const char __pyx_k_Stub_iniMisfitFn[] = "Stub.iniMisfitFn";
static const char __pyx_k_TMMState_destroy[] = "TMMState.destroy";
static const char __pyx_k_TimeDependentVec[] = "TimeDependentVec";
static const char __pyx_k_finalizeCalcBCFn[] = "finalizeCalcBCFn";
static const char __pyx_k_finalizeMisfitFn[] = "finalizeMisfitFn";
static const char __pyx_k_getProfileConfig[] = "getProfileConfig";
static const char __pyx_k_loadVecIntoArray[] = "loadVecIntoArray";
static const char __pyx_k_totalNumProfiles[] = "totalNumProfiles";
static const char __pyx_k_writeBinaryArray[] = "writeBinaryArray";
static const char __pyx_k_Stub_calcCalcBCFn[] = "Stub.calcCalcBCFn";
static const char __pyx_k_Stub_calcMisfitFn[] = "Stub.calcMisfitFn";
static const char __pyx_k_Stub_iniMonitorFn[] = "Stub.iniMonitorFn";
static const char __pyx_k_TMMState_timeStep[] = "TMMState.timeStep";
static const char __pyx_k_finalizeMonitorFn[] = "finalizeMonitorFn";
static const char __pyx_k_numValsPerProfile[] = "numValsPerProfile";
static const char __pyx_k_1_aq_vQd_6_5_3fE_q[] = "\320\004#\2401\330\010 \240\006\240a\240q\340\010\017\210v\220Q\220d\230&\240\002\240!\2406\250\021\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_Qa_uCs_V1A_5_E_a[] = "\200\001\360\022\000\005\014\210=\230\001\230\021\230*\240A\240]\260!\260:\270Q\270a\330\004\007\200u\210C\210s\220&\230\005\230V\2401\240A\360\n\000\005\014\2105\220\001\220\033\230E\240\021\240.\260\006\260a\260{\300&\310\001\310\021";
static const char __pyx_k_Incorrect_type_for[] = "Incorrect type for ";
static const char __pyx_k_PeriodicVec_create[] = "PeriodicVec.create";
static const char __pyx_k_PeriodicVec_interp[] = "PeriodicVec.interp";
static const char __pyx_k_Stub_calcMonitorFn[] = "Stub.calcMonitorFn";
static const char __pyx_k_Stub_writeCalcBCFn[] = "Stub.writeCalcBCFn";
static const char __pyx_k_Stub_writeMisfitFn[] = "Stub.writeMisfitFn";
static const char __pyx_k_TMMState_getConfig[] = "TMMState.getConfig";
static const char __pyx_k_TMMState_setTracer[] = "TMMState.setTracer";
static const char __pyx_k_TimeDependentArray[] = "TimeDependentArray";
static const char __pyx_k_TimeDependentTimer[] = "TimeDependentTimer";
static const char __pyx_k_asyncio_coroutines[] = "asyncio.coroutines";
static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
static const char __pyx_k_loadTracerFromFile[] = "loadTracerFromFile";
static const char __pyx_k_tmm4py_tmm4py_core[] = "tmm4py.tmm4py_core";
static const char __pyx_k_useExternalForcing[] = "useExternalForcing";
static const char __pyx_k_useForcingFromFile[] = "useForcingFromFile";
static const char __pyx_k_Ini_monitor_func_is[] = "Ini monitor func is ";
static const char __pyx_k_Length_of_tdp_array[] = "Length of tdp array (";
static const char __pyx_k_Length_of_tdt_array[] = "Length of tdt array (";
static const char __pyx_k_List_is_not_mutable[] = "List is not mutable";
static const char __pyx_k_PeriodicVec_destroy[] = "PeriodicVec.destroy";
static const char __pyx_k_Stub_writeMonitorFn[] = "Stub.writeMonitorFn";
static const char __pyx_k_d_Qd_xvQ_U_5_U_1_XQ[] = "\200\001\360\026\000\005\t\210\010\220\006\220d\230!\330\004\005\320\005\025\220Q\220d\230%\230x\240v\250Q\360\006\000\005\016\210U\220'\230\022\230=\250\001\250\032\2605\270\001\330\004\005\200U\210!\2101\330\004\n\210(\220!\330\004\005\200X\210Q";
static const char __pyx_k_isInitializedCalcBC[] = "isInitializedCalcBC";
static const char __pyx_k_ImmutableList_append[] = "_ImmutableList.append";
static const char __pyx_k_ImmutableList_insert[] = "_ImmutableList.insert";
static const char __pyx_k_PeriodicArray_create[] = "PeriodicArray.create";
static const char __pyx_k_PeriodicArray_interp[] = "PeriodicArray.interp";
static const char __pyx_k_PeriodicTimer_create[] = "PeriodicTimer.create";
static const char __pyx_k_applyExternalForcing[] = "applyExternalForcing";
static const char __pyx_k_applyForcingFromFile[] = "applyForcingFromFile";
static const char __pyx_k_iniExternalForcingFn[] = "iniExternalForcingFn";
static const char __pyx_k_reInitializeCalcBCFn[] = "reInitializeCalcBCFn";
static const char __pyx_k_setFinCalcBCFunction[] = "setFinCalcBCFunction";
static const char __pyx_k_setFinMisfitFunction[] = "setFinMisfitFunction";
static const char __pyx_k_setIniCalcBCFunction[] = "setIniCalcBCFunction";
static const char __pyx_k_setIniMisfitFunction[] = "setIniMisfitFunction";
static const char __pyx_k_setReiCalcBCFunction[] = "setReiCalcBCFunction";
static const char __pyx_k_setWriCalcBCFunction[] = "setWriCalcBCFunction";
static const char __pyx_k_setWriMisfitFunction[] = "setWriMisfitFunction";
static const char __pyx_k_timeDependentForcing[] = "timeDependentForcing";
static const char __pyx_k_PeriodicArray_destroy[] = "PeriodicArray.destroy";
static const char __pyx_k_Stub_finalizeCalcBCFn[] = "Stub.finalizeCalcBCFn";
static const char __pyx_k_Stub_finalizeMisfitFn[] = "Stub.finalizeMisfitFn";
static const char __pyx_k_TMMState_timeStepPost[] = "TMMState.timeStepPost";
static const char __pyx_k_calcExternalForcingFn[] = "calcExternalForcingFn";
static const char __pyx_k_iuAXYfAX_a_Ziiooppq_1[] = "\200\001\330\004\016\210i\220u\230A\230X\240Y\250f\260A\260X\270\\\310\025\310a\310{\320Zi\320io\320op\320pq\330\004\013\2101";
static const char __pyx_k_readProfileScalarData[] = "readProfileScalarData";
static const char __pyx_k_setCalcCalcBCFunction[] = "setCalcCalcBCFunction";
static const char __pyx_k_setCalcMisfitFunction[] = "setCalcMisfitFunction";
static const char __pyx_k_setFinMonitorFunction[] = "setFinMonitorFunction";
static const char __pyx_k_setIniMonitorFunction[] = "setIniMonitorFunction";
static const char __pyx_k_setWriMonitorFunction[] = "setWriMonitorFunction";
static const char __pyx_k_IntArrayWrapperWithDel[] = "_IntArrayWrapperWithDel";
static const char __pyx_k_List_is_not_appendable[] = "List is not appendable";
static const char __pyx_k_List_is_not_insertable[] = "List is not insertable";
static const char __pyx_k_RRS_c_1Cq_3fAQ_uCs_V1A[] = "\320\000R\320RS\360\014\000\005\022\320\021!\240\021\240(\250'\260\021\330\004\006\200c\210\021\210!\330\004\023\2201\220C\220q\230\001\330\004\013\320\013 \240\001\240\034\250^\2703\270f\300A\300Q\330\004\007\200u\210C\210s\220&\230\005\230V\2401\240A";
static const char __pyx_k_Stub_finalizeMonitorFn[] = "Stub.finalizeMonitorFn";
static const char __pyx_k_TMMState_forcingUpdate[] = "TMMState.forcingUpdate";
static const char __pyx_k_TMMState_getNumTracers[] = "TMMState.getNumTracers";
static const char __pyx_k_TMMState_pushConfigVar[] = "TMMState.pushConfigVar";
static const char __pyx_k_Unknown_type_of_vector[] = "Unknown type of vector ";
static const char __pyx_k_Within_destroy_at_time[] = "Within destroy at time ";
static const char __pyx_k_setCalcMonitorFunction[] = "setCalcMonitorFunction";
static const char __pyx_k_tmm4py_tmm4py_core_pyx[] = "tmm4py/tmm4py_core.pyx";
static const char __pyx_k_writeExternalForcingFn[] = "writeExternalForcingFn";
static const char __pyx_k_writeProfileScalarData[] = "writeProfileScalarData";
static const char __pyx_k_AQ_AT_81O5_aq_uCs_V1A_6[] = "\200\001\360\014\000\005\n\210\023\210A\210Q\330\004\024\220A\220T\230\021\230!\340\004\013\2108\2201\220O\2405\250\001\250\025\250a\250q\330\004\007\200u\210C\210s\220&\230\005\230V\2401\240A\340\004\013\2106\220\021\220!";
static const char __pyx_k_Calling_destroy_at_time[] = "Calling destroy at time ";
static const char __pyx_k_ImmutableList___setitem[] = "_ImmutableList.__setitem__";
static const char __pyx_k_Ini_exf_forcing_func_is[] = "Ini exf forcing func is ";
static const char __pyx_k_IntArrayWrapper___array[] = "_IntArrayWrapper.__array__";
static const char __pyx_k_RealArrayWrapperWithDel[] = "_RealArrayWrapperWithDel";
static const char __pyx_k_TMMState_setFromOptions[] = "TMMState.setFromOptions";
static const char __pyx_k_TimeDependentVec_create[] = "TimeDependentVec.create";
static const char __pyx_k_TimeDependentVec_interp[] = "TimeDependentVec.interp";
static const char __pyx_k_Calling_finalize_at_time[] = "Calling finalize at time ";
static const char __pyx_k_RealArrayWrapper___array[] = "_RealArrayWrapper.__array__";
static const char __pyx_k_Setting_options_database[] = ". Setting options database.";
static const char __pyx_k_TMMState___reduce_cython[] = "TMMState.__reduce_cython__";
static const char __pyx_k_TimeDependentVec_destroy[] = "TimeDependentVec.destroy";
static const char __pyx_k_dotProdProfileScalarData[] = "dotProdProfileScalarData";
static const char __pyx_k_A_vQa_uAQ_uAQ_5_A_5_3fE_q[] = "\200A\330\010\037\230v\240Q\240a\330\010\037\230u\240A\240Q\330\010\037\230u\240A\240Q\340\010\017\210{\230!\2305\240\010\250\010\260\004\260A\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_StepTimer___reduce_cython[] = "StepTimer.__reduce_cython__";
static const char __pyx_k_Stub_iniExternalForcingFn[] = "Stub.iniExternalForcingFn";
static const char __pyx_k_Stub_reInitializeCalcBCFn[] = "Stub.reInitializeCalcBCFn";
static const char __pyx_k_TimeDependentArray_create[] = "TimeDependentArray.create";
static const char __pyx_k_TimeDependentArray_interp[] = "TimeDependentArray.interp";
static const char __pyx_k_TimeDependentTimer_create[] = "TimeDependentTimer.create";
static const char __pyx_k_finalizeExternalForcingFn[] = "finalizeExternalForcingFn";
static const char __pyx_k_A_avT_5_3fE_q_IT_q_T_q_D_a[] = "\200A\340\010\017\210\177\230a\230v\240T\250\021\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\010\014\210I\220T\230\026\230q\330\010\014\320\014\035\230T\240\026\240q\330\010\014\320\014\034\230D\240\006\240a";
static const char __pyx_k_Stub_calcExternalForcingFn[] = "Stub.calcExternalForcingFn";
static const char __pyx_k_TMMState___setstate_cython[] = "TMMState.__setstate_cython__";
static const char __pyx_k_TimeDependentArray_destroy[] = "TimeDependentArray.destroy";
static const char __pyx_k_d_Qe5_a_d_Qe5_a_Qa_XQ_XQ_1[] = "\200\001\340\004\010\210\010\220\006\220d\230!\330\004\005\320\005\025\220Q\220e\2305\240\010\250\006\250a\330\004\010\210\010\220\006\220d\230!\330\004\005\320\005\025\220Q\220e\2305\240\010\250\006\250a\340\004\010\210\001\210\024\210Q\210a\340\004\005\200X\210Q\330\004\005\200X\210Q\340\004\013\2101";
static const char __pyx_k_does_not_equal_yarr_length[] = " does not equal yarr length ";
static const char __pyx_k_A_D_z_4q_5_3fE_q_4q_5_3fE_q[] = "\200A\360\006\000\t\r\210D\220\001\330\010\017\210z\230\021\230!\2304\230q\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\010\017\320\017!\240\021\240!\2404\240q\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_vQa_uAQ_uAQ_q_XXT_5_3fE_q[] = "\200A\330\010\037\230v\240Q\240a\330\010\037\230u\240A\240Q\330\010\037\230u\240A\240Q\340\010\017\320\017\037\230q\240\005\240X\250X\260T\270\021\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_vQa_uAQ_uAQ_y_hhd_5_3fE_q[] = "\200A\330\010\037\230v\240Q\240a\330\010\037\230u\240A\240Q\330\010\037\230u\240A\240Q\360\006\000\t\020\210y\230\001\230\025\230h\240h\250d\260!\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_PeriodicVec___reduce_cython[] = "PeriodicVec.__reduce_cython__";
static const char __pyx_k_StepTimer___setstate_cython[] = "StepTimer.__setstate_cython__";
static const char __pyx_k_Stub_writeExternalForcingFn[] = "Stub.writeExternalForcingFn";
static const char __pyx_k_TMMState_loadTracerFromFile[] = "TMMState.loadTracerFromFile";
static const char __pyx_k_A_vQa_uAQ_uAQ_auG7_a_5_3fE_q[] = "\200A\330\010\037\230v\240Q\240a\330\010\037\230u\240A\240Q\330\010\037\230u\240A\240Q\360\006\000\t\020\210\177\230a\230u\240G\2507\260$\260a\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_Setting_options_database_for[] = "Setting options database for ";
static const char __pyx_k_isInitializedExternalForcing[] = "isInitializedExternalForcing";
static const char __pyx_k_A_D_z_4q_5_3fE_q_aq_A_5_3fE_q[] = "\200A\360\006\000\t\r\210D\220\001\330\010\017\210z\230\021\230!\2304\230q\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\010\017\320\017&\240a\240q\250\004\250A\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_PeriodicArray___reduce_cython[] = "PeriodicArray.__reduce_cython__";
static const char __pyx_k_PeriodicTimer___reduce_cython[] = "PeriodicTimer.__reduce_cython__";
static const char __pyx_k_PeriodicVec___setstate_cython[] = "PeriodicVec.__setstate_cython__";
static const char __pyx_k_TMMState_setFinCalcBCFunction[] = "TMMState.setFinCalcBCFunction";
static const char __pyx_k_TMMState_setFinMisfitFunction[] = "TMMState.setFinMisfitFunction";
static const char __pyx_k_TMMState_setIniCalcBCFunction[] = "TMMState.setIniCalcBCFunction";
static const char __pyx_k_TMMState_setIniMisfitFunction[] = "TMMState.setIniMisfitFunction";
static const char __pyx_k_TMMState_setReiCalcBCFunction[] = "TMMState.setReiCalcBCFunction";
static const char __pyx_k_TMMState_setWriCalcBCFunction[] = "TMMState.setWriCalcBCFunction";
static const char __pyx_k_TMMState_setWriMisfitFunction[] = "TMMState.setWriMisfitFunction";
static const char __pyx_k_reInitializeExternalForcingFn[] = "reInitializeExternalForcingFn";
static const char __pyx_k_setFinExternalForcingFunction[] = "setFinExternalForcingFunction";
static const char __pyx_k_setIniExternalForcingFunction[] = "setIniExternalForcingFunction";
static const char __pyx_k_setReiExternalForcingFunction[] = "setReiExternalForcingFunction";
static const char __pyx_k_setWriExternalForcingFunction[] = "setWriExternalForcingFunction";
static const char __pyx_k_AQ_AQ_s_Q_L_K1_AT_AT_uAU_1_uCs[] = "\200\001\360\014\000\005\n\210\023\210A\210Q\330\004\t\210\023\210A\210Q\330\004\007\200s\210#\210Q\330\006\014\210L\230\001\230\022\320\033+\320+K\3101\340\004\024\220A\220T\230\021\230!\330\004\024\220A\220T\230\021\230!\340\004\013\210=\230\001\230\037\250\017\260u\270A\270U\300!\3001\330\004\007\200u\210C\210s\220&\230\005\230V\2401\240A\340\004\013\2106\220\021\220!";
static const char __pyx_k_IntArrayWrapperWithDel___array[] = "_IntArrayWrapperWithDel.__array__";
static const char __pyx_k_LA_5_3fE_q_F_4s_s_c_ha_ha_4s_k[] = "\320\004\031\320\031L\310A\360\n\000\t\020\320\017 \240\001\240\021\240!\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\010\014\210F\220!\340\010\013\2104\210s\220%\220s\230$\230c\240\021\330\n\016\210h\220a\340\n\016\210h\220a\340\010\013\2104\210s\220!\330\n\016\210k\230\021\330\n\021\320\021'\240q\250\004\250G\2601\260D\270\001\330\n\r\210U\220#\220S\230\006\230e\2406\250\021\250!\330\n\021\220\033\230A\230T\240\024\240Q\240a\330\n\r\210U\220#\220S\230\006\230e\2406\250\021\250!\360\006\000\013\016\210S\220\001\220\025\220c\230\024\230Q\330\014\022\220,\230a\230r\320!Z\320Z^\320^_\330\n\016\210k\230\021\330\n\031\230\021\230#\230Q\230a\330\n\021\320\0210\260\001\260\024\260W\270N\310!\3104\310q\330\n\r\210U\220#\220S\230\006\230e\2406\250\021\250!\360\006\000\t\r\210G\320\023$\240A\240T\250\027\260\016\270d\300$\300a\340\010\017\210q";
static const char __pyx_k_Stub_finalizeExternalForcingFn[] = "Stub.finalizeExternalForcingFn";
static const char __pyx_k_TMMState_setCalcCalcBCFunction[] = "TMMState.setCalcCalcBCFunction";
static const char __pyx_k_TMMState_setCalcMisfitFunction[] = "TMMState.setCalcMisfitFunction";
static const char __pyx_k_TMMState_setFinMonitorFunction[] = "TMMState.setFinMonitorFunction";
static const char __pyx_k_TMMState_setIniMonitorFunction[] = "TMMState.setIniMonitorFunction";
static const char __pyx_k_TMMState_setWriMonitorFunction[] = "TMMState.setWriMonitorFunction";
static const char __pyx_k_XQ_A_a_m1A_4s_WAS_3c_l_2_c_B_G[] = "\320\004\034\320\034.\320.]\320]^\360\016\000\t\021\220\005\220X\230Q\340\010\013\210>\230\023\230A\330\n\016\210a\340\n\016\210m\2301\230A\360\006\000\t\014\2104\210s\220!\330\n\022\220!\340\n\013\340\016\020\220\005\220W\230A\230S\240\001\240\021\330\016\021\220\022\2203\220c\230\021\230!\330\020\026\220l\240!\2402\320%>\270c\300\021\320B}\360\000\000~\001G\002\360\000\000G\002J\002\360\000\000J\002K\002\360\000\000K\002L\002\330\021\022\330\016\023\2201\220B\320\026G\300s\310!\3101\330\016\023\2209\230A\230S\240\001\240\034\250S\260\001\260\021\330\n\022\220!\2203\220a\220q\340\010\020\320\020 \240\001\240\026\240w\250a\330\010\013\210>\230\023\230A\330\n\026\220a\340\n\026\320\026&\240a\240}\260G\2701\340\010\017\320\017'\240q\250\001\250\021\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\010\014\210G\2201\330\010\017\320\017$\240A\240W\250K\260w\270d\300!\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\340\010\017\210q";
static const char __pyx_k_oop_XQ_A_a_m1A_4s_WAS_3c_l_2_c[] = "\320\004\034\320\034.\320.]\320]o\320op\360\016\000\t\021\220\005\220X\230Q\340\010\013\210>\230\023\230A\330\n\016\210a\340\n\016\210m\2301\230A\360\006\000\t\014\2104\210s\220!\330\n\022\220!\340\n\013\340\016\020\220\005\220W\230A\230S\240\001\240\021\330\016\021\220\022\2203\220c\230\021\230!\330\020\026\220l\240!\2402\320%>\270c\300\021\320B}\360\000\000~\001G\002\360\000\000G\002J\002\360\000\000J\002K\002\360\000\000K\002L\002\330\021\022\330\016\023\2201\220B\320\026G\300s\310!\3101\330\016\023\2209\230A\230S\240\001\320!2\260#\260Q\260a\330\n\022\220!\2203\220a\220q\340\010\013\210<\220w\230a\330\014\021\220\021\220\"\320\0245\260S\270\001\270\021\330\014\021\220\031\230!\2303\230a\230\177\250a\340\010\020\320\020 \240\001\240\026\240w\250a\330\010\013\210>\230\023\230A\330\n\026\220a\340\n\026\320\026&\240a\240}\260G\2701\340\010\017\320\017\"\240!\2401\240A\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\010\014\210G\2201\330\010\017\320\017\037\230q\240\007\240{\260'\270\024\270Q\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\340\010\017\210q";
static const char __pyx_k_q_t3a_1E_q_1_5_3fE_q_fA_q_q_1A[] = "\320\000\037\230q\360\016\000\005\022\320\021!\240\021\240(\250'\260\021\340\004\007\200t\2103\210a\330\010\027\320\027'\240|\2601\260E\270\021\270!\330\010\017\320\017\037\230q\240\007\240|\2601\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\010\020\320\020(\250\001\250\027\260\016\270f\300A\340\010\017\210q\340\010\027\220q\230\003\2301\230A\330\010\017\320\017\037\230q\240\007\240|\2601\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_setCalcExternalForcingFunction[] = "setCalcExternalForcingFunction";
static const char __pyx_k_1F_Q_L_J_1F_Q_L_J_AT_AT_uCs_V1A[] = "\200\001\360\014\000\005\t\210\003\2101\210F\220#\220Q\330\006\014\210L\230\001\230\022\320\033J\310!\340\004\010\210\003\2101\210F\220#\220Q\330\006\014\210L\230\001\230\022\320\033J\310!\340\004\024\220A\220T\230\021\230!\330\004\024\220A\220T\230\021\230!\340\004\013\320\013*\250!\250?\270/\310\021\310!\330\004\007\200u\210C\210s\220&\230\005\230V\2401\240A\340\004\013\2106\220\021\220!";
static const char __pyx_k_9_q_t3a_1D_1K_A_5_3fE_q_V1_q_3a[] = "\320\000$\320$9\270\021\360\n\000\005\022\320\021!\240\021\240(\250'\260\021\340\004\013\210<\220q\230\001\330\004\007\200t\2103\210a\330\010\027\320\027'\240|\2601\260D\270\001\270\021\330\010\017\320\017+\2501\250K\260}\300A\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\010\020\320\020(\250\001\250\026\250~\270V\3001\340\010\017\210q\340\010\013\2103\210a\210u\220C\220q\330\n\020\220\014\230A\230R\320\037X\320XY\330\010\027\220q\230\003\2301\230A\330\010\017\320\017+\2501\250K\260}\300A\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_4t7_1_aq_5_q_vV81_1D_8NgUV_1D[] = "\200A\330\010\013\2104\210t\2207\230!\2301\330\014\022\220,\230a\230q\330\010\013\2105\220\007\220q\330\014\027\220v\230V\2408\2501\330\014\020\220\n\230!\330\014\023\320\023+\2501\250D\260\010\3208N\310g\320UV\340\014\023\320\023+\2501\250D\260\010\270\006\270a\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_4t7_1_aq_5_q_vV81_1_AT_9PPWWX[] = "\200A\330\010\013\2104\210t\2207\230!\2301\330\014\022\220,\230a\230q\330\010\013\2105\220\007\220q\330\014\027\220v\230V\2408\2501\330\014\020\220\013\2301\330\014\023\320\023,\250A\250T\260\030\3209P\320PW\320WX\340\014\023\320\023,\250A\250T\260\030\270\026\270q\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_4t7_1_aq_5_q_vV81_A_AT_q_AT_q[] = "\200A\330\010\013\2104\210t\2207\230!\2301\330\014\022\220,\230a\230q\330\010\013\2105\220\007\220q\330\014\027\220v\230V\2408\2501\330\014\020\220\014\230A\330\014\023\320\023,\250A\250T\260\030\270\037\310\007\310q\340\014\023\320\023,\250A\250T\260\030\270\026\270q\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_7_q_5Q_4q_A_4q_A_4q_A_4q_A_4q[] = "\200A\360\006\000\t\014\2107\220%\220q\230\002\320\0325\260Q\340\010\013\2104\210q\330\014\020\220\004\220A\340\010\013\2104\210q\330\014\020\220\004\220A\340\010\013\2104\210q\330\014\020\220\004\220A\340\010\013\2104\210q\330\014\020\220\004\220A\340\010\013\2104\210q\330\014\020\220\004\220A\340\010\013\2104\210q\330\014\020\220\004\220A\340\010\017\210z\230\021\230&\240\001\240\025\240a\240t\2501\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_G1_S_aq_t1E_L_4F_1_A_aq_t1E_L[] = "\200A\330\010\014\210G\2201\330\n\r\210S\220\002\220!\330\014\020\220\006\220a\220q\330\014\017\210t\2201\220E\230\027\240\001\330\016\024\220L\240\001\240\022\320#:\270!\330\014\020\220\006\320\0264\260F\270!\2701\330\017\022\220\"\220A\330\014\020\220\006\220a\220q\330\014\017\210t\2201\220E\230\027\240\001\330\016\024\220L\240\001\240\022\320#:\270!\330\014\020\220\006\320\026+\2506\260\021\260!\340\010\014\210H\220O\2401\240D\250\001";
static const char __pyx_k_A_vQa_QhgQ_5Qe4_eSYYggllr_s_B_B[] = "\200A\330\010\037\230v\240Q\240a\360\010\000\t\026\320\025%\240Q\240h\250g\260Q\330\010\017\320\0175\260Q\260e\2704\270\177\310e\320SY\320Yg\320gl\320lr\360\000\000s\001B\002\360\000\000B\002G\002\360\000\000G\002M\002\360\000\000M\002S\002\360\000\000S\002W\002\360\000\000W\002^\002\360\000\000^\002_\002\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_vQa_QhgQ_at4uF_VSbbggmmssww_5[] = "\200A\330\010\037\230v\240Q\240a\360\010\000\t\026\320\025%\240Q\240h\250g\260Q\330\010\017\320\017 \240\001\240\025\240a\240t\2504\250u\260F\270.\310\005\310V\320Sb\320bg\320gm\320ms\320sw\320w~\320~\177\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_E_q_1HG1_S_Q_4A_F_AVSXXYY___5_3[] = "\320\004:\270!\360\010\000\007\035\230E\240\021\240%\240q\250\001\330\006\023\320\023#\2401\240H\250G\2601\340\006\t\210\024\210S\220\001\330\010\r\210Q\330\010\017\320\0174\260A\260[\300\004\300F\310\"\310A\310V\320SX\320XY\320Y^\320^_\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\013\017\210s\220!\330\010\r\210Q\330\010\017\320\0174\260A\260[\300\004\300F\310$\310a\310v\320UZ\320Z[\320[`\320`a\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\013\017\210s\220!\330\010\r\210Q\330\010\017\320\0174\260A\260[\300\004\300F\310$\310a\310v\320UZ\320Z[\320[`\320`a\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\340\010\016\210l\230!\2302\320\0358\270\001";
static const char __pyx_k_IntArrayWrapperWithDel___reduce[] = "_IntArrayWrapperWithDel.__reduce_cython__";
static const char __pyx_k_IntArrayWrapperWithDel___setsta[] = "_IntArrayWrapperWithDel.__setstate_cython__";
static const char __pyx_k_IntArrayWrapper___reduce_cython[] = "_IntArrayWrapper.__reduce_cython__";
static const char __pyx_k_IntArrayWrapper___setstate_cyth[] = "_IntArrayWrapper.__setstate_cython__";
static const char __pyx_k_K1_1HA_5_3fE_q_F_HA_4s_k_l_4uAQ[] = "\320\004K\3101\360\n\000\t\020\320\017\"\240!\2401\240H\250A\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\010\014\210F\220!\330\010\014\210H\220A\340\010\013\2104\210s\220!\330\n\016\210k\230\021\330\n\016\320\016\036\320\036.\250l\270!\2704\270u\300A\300Q\330\n\016\210g\320\025-\250Q\250d\260'\270\024\270_\310F\320RS\360\006\000\013\016\210S\220\001\220\025\220c\230\024\230Q\330\014\022\220,\230a\230r\320!Z\320Z^\320^_\330\n\016\210k\230\021\330\n\016\320\016\036\230a\230s\240!\2401\330\n\016\210g\320\025&\240a\240t\2507\260$\260o\300V\3101\360\006\000\t\020\210q";
static const char __pyx_k_K1_q_5_3fE_q_F_HA_4s_k_l_4uAQ_g[] = "\320\004K\3101\360\n\000\t\020\320\017'\240q\250\001\250\030\260\021\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\010\014\210F\220!\330\010\014\210H\220A\340\010\013\2104\210s\220!\330\n\016\210k\230\021\330\n\016\320\016\036\320\036.\250l\270!\2704\270u\300A\300Q\330\n\016\210g\320\025-\250Q\250d\260'\270\024\270_\310F\320RS\360\006\000\013\016\210S\220\001\220\025\220c\230\024\230Q\330\014\022\220,\230a\230r\320!Z\320Z^\320^_\330\n\016\210k\230\021\330\n\016\320\016\036\230a\230s\240!\2401\330\n\016\210g\320\025&\240a\240t\2507\260$\260o\300V\3101\360\006\000\t\020\210q";
static const char __pyx_k_K1_wa_A_a_a_G1_aq_5_3fE_q_G1_1G[] = "\320\004\034\320\034.\320.K\3101\360\n\000\t\021\320\020 \240\001\240\026\240w\250a\330\010\013\210>\230\023\230A\330\n\026\220a\340\n\026\320\026&\240a\240}\260G\2701\330\010\017\210\177\230a\230q\240\001\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\010\014\210G\2201\330\010\017\210|\2301\230G\240;\250o\270T\300\021\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\340\010\014\210I\220T\230\026\230q\330\010\014\320\014\035\230T\240\026\240q\330\010\014\320\014\034\230D\240\006\240a\340\010\017\210q";
static const char __pyx_k_LA_Qaq_5_3fE_q_F_4s_s_c_ha_ha_4[] = "\320\004\031\320\031L\310A\360\n\000\t\020\320\017%\240Q\240a\240q\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\330\010\014\210F\220!\340\010\013\2104\210s\220%\220s\230$\230c\240\021\330\n\016\210h\220a\340\n\016\210h\220a\340\010\013\2104\210s\220!\330\n\016\210k\230\021\330\n\021\320\021'\240q\250\004\250G\2601\260D\270\001\330\n\r\210U\220#\220S\230\006\230e\2406\250\021\250!\330\n\021\220\033\230A\230T\240\024\240Q\240a\330\n\r\210U\220#\220S\230\006\230e\2406\250\021\250!\360\006\000\013\016\210S\220\001\220\025\220c\230\024\230Q\330\014\022\220,\230a\230r\320!Z\320Z^\320^_\330\n\016\210k\230\021\330\n\031\230\021\230#\230Q\230a\330\n\021\320\0210\260\001\260\024\260W\270N\310!\3104\310q\330\n\r\210U\220#\220S\230\006\230e\2406\250\021\250!\360\006\000\t\r\210G\320\023$\240A\240T\250\027\260\016\270d\300$\300a\340\010\017\210q";
static const char __pyx_k_M_G1N_7_1_QoQa_d_1_Qb_4A_xq_we1[] = "\200\001\330\004\014\210M\230\021\330\004\t\210\027\220\001\220\031\230\"\230G\2401\240N\260!\2607\270!\2701\330\004\n\210#\210Q\210o\230Q\230a\330\006\010\210\016\220d\230!\2301\330\006\t\210\027\220\005\220Q\220b\320\0304\260A\330\006\007\200x\210q\220\001\330\004\007\200w\210e\2201\220B\320\0263\2609\270L\310\001\330\004\014\210A\210Q";
static const char __pyx_k_M_avWA_XU_5_3fE_q_IU_4vQ_L_Qd_H[] = "\320\004$\240M\260\021\360\010\000\t\017\320\016\036\230a\230v\240W\250A\360\006\000\t\020\320\017 \240\001\240\024\240X\250U\260&\270\001\270\021\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001\360\010\000\t\r\210I\220U\230!\2304\230v\240Q\330\010\014\210L\230\005\230Q\230d\240&\250\001\330\010\014\210H\220O\2401\240D\250\001\340\010\023\2205\230\010\240\001\240\021\330\010\013\210:\220X\230Q\230a\330\n\016\210m\230:\240Z\250q\260\017\270v\300Q\300a\340\n\016\210m\2301\340\010\017\210x\220v\230[\250\010\260\001\330\010\014\210A\210S\220\004\220G\2305\240\001\240\024\240Q\330\010\014\210G\2205\230\001\230\024\230Q\340\014\023\220;\230a\230t\2406\250\022\2501\250F\260!\2601\330\014\017\210u\220C\220s\230&\240\005\240V\2501\250A\330\014\023\2202\220W\230D\240\r\250Z\260q\330\014\r\210Q\210g\320\025&\240a\240w\250n\270D\300\006\300b\310\001\310\026\310q\330\010\014\210C\210~\230Q\230a\330\010\014\210A\340\010\013\2104\210w\220a\220q\330\014\021\220\021\220#\220T\230\027\240\005\240Q\240d\250!\330\014\020\220\007\220u\230A\230T\240\021\340\020\027\220{\240!\2404\240v\250S\260\001\260\026\260q\270\001\330\020\023\2205\230\003\2303\230f\240E\250\026\250q\260\001\330\020\027\220r\230\027\240\004\240N\260*\270A\330\020\022\220!\2207\320\032+\2501\250G\260>\300\024\300V\3103\310a\310v\320UV\330\014\020\220\004\220N\240!\2401\330\014\020\220\001\340\010\013\2104\210w\220a\220q\330\014\022\220!\2203\220d\230'\240\025\240a\240t\2501\330\014\020\220\007\220u\230A\230T\240\021\340\020\027\220{\240!\2404\240v\250T\260\021\260&\270\001\270\021\330\020\023\2205\230\003\2303\230f\240E\250\026\250q\260\001\330\020\027\220r\230\027\240\004\240O\260:\270Q\330\020\023\2201\220G\320\033,\250A\250W\260N\300$\300f\310D\320PQ\320QW\320WX\330\014\020\220\005\220^\2401\240A\330\014\020\220\001\340\010\013\2104\210w\220a\220q\330\014\023\2201\220C\220t\2307\240%\240q\250\004\250A\330\014\020\220\007\220u\230A\230T\240\021\340\020\027\220{\240!\2404\240v\250U\260!\2606\270\021\270!""\330\020\023\2205\230\003\2303\230f\240E\250\026\250q\260\001\330\020\027\220r\230\027\240\004\320$4\260J\270a\330\020\024\220E\230\021\230'\320!2\260!\2607\270.\310\004\310F\320RW\320WX\320X^\320^_\330\014\020\220\006\220n\240A\240Q\330\014\020\220\001\340\010\013\2104\210w\220a\220q\330\014\022\220!\2203\220d\230'\240\025\240a\240t\2501\330\014\020\220\007\220u\230A\230T\240\021\340\020\027\220{\240!\2404\240v\250T\260\021\260%\260q\270\001\330\020\023\2205\230\003\2303\230f\240E\250\026\250q\260\001\330\020\027\220r\230\027\240\004\240O\260:\270Q\330\020\023\2201\220G\320\033,\250A\250Y\260n\300D\310\006\310d\320RS\320SY\320YZ\330\014\020\220\005\220^\2401\240A\330\014\020\220\001\340\014\022\220!\2203\220d\230'\240\025\240a\240t\2501\330\014\020\220\007\220u\230A\230T\240\021\340\020\027\220{\240!\2404\240v\250T\260\021\260%\260q\270\001\330\020\023\2205\230\003\2303\230f\240E\250\026\250q\260\001\330\020\027\220r\230\027\240\004\240O\260:\270Q\330\020\023\2201\220G\320\033,\250A\250Y\260n\300D\310\006\310d\320RS\320SY\320YZ\330\014\020\220\005\220^\2401\240A\330\014\020\220\001";
static const char __pyx_k_PeriodicArray___setstate_cython[] = "PeriodicArray.__setstate_cython__";
static const char __pyx_k_PeriodicTimer___setstate_cython[] = "PeriodicTimer.__setstate_cython__";
static const char __pyx_k_Qe6_WA_vQa_a_aq_E_uA_Rs_AU_q_Rs[] = "\200\001\330\004\r\210Q\210e\2206\230\024\230W\240A\330\004\007\200v\210Q\210a\330\010\016\210a\320\017 \240\006\240a\240q\330\010\014\210E\220\026\220u\230A\330\n\r\210R\210s\220!\330\016\024\220A\220U\230%\230q\240\001\330\n\r\210R\210s\220!\330\016\024\220A\220U\230%\230q\240\001\330\n\r\210R\210s\220!\330\016\024\220A\220U\230%\230q\240\001\340\n\r\210R\210s\220!\330\016\024\220A\220U\320\0326\260a\3207G\300q\330\n\r\210R\210s\220!\330\016\024\220A\220U\320\0326\260a\260\177\300a\330\n\r\210R\210s\220!\330\016\024\220A\220U\320\0326\260a\260}\300A\340\010\021\220\021\330\004\013\2101";
static const char __pyx_k_RealArrayWrapperWithDel___array[] = "_RealArrayWrapperWithDel.__array__";
static const char __pyx_k_RealArrayWrapperWithDel___reduc[] = "_RealArrayWrapperWithDel.__reduce_cython__";
static const char __pyx_k_RealArrayWrapperWithDel___setst[] = "_RealArrayWrapperWithDel.__setstate_cython__";
static const char __pyx_k_RealArrayWrapper___reduce_cytho[] = "_RealArrayWrapper.__reduce_cython__";
static const char __pyx_k_RealArrayWrapper___setstate_cyt[] = "_RealArrayWrapper.__setstate_cython__";
static const char __pyx_k_TMMState_setCalcMonitorFunction[] = "TMMState.setCalcMonitorFunction";
static const char __pyx_k_This_will_override_any_previous[] = ". This will override any previously set value.";
static const char __pyx_k_XXmmn_q_s_5_1_L_I_1Cq_5_I_ccdde[] = "\320\000X\320Xm\320mn\360\n\000\005\022\320\021!\240\021\240(\250'\260\021\340\004\013\210<\220q\230\001\330\004\007\200s\210!\2105\220\003\2201\330\006\014\210L\230\001\230\022\320\033I\310\021\330\004\023\2201\220C\220q\230\001\330\004\013\320\013(\250\001\250\034\260^\3005\310\001\320I]\320]c\320cd\320de\330\004\007\200u\210C\210s\220&\230\005\230V\2401\240A";
static const char __pyx_k_does_not_match_size_specified_i[] = ") does not match size specified in options database (";
static const char __pyx_k_self_data_ptr_self_pv_cannot_be[] = "self.data_ptr,self.pv cannot be converted to a Python object for pickling";
static const char __pyx_k_A_4t7_1_aq_5_q_vV81_1_1D_gQ_1D_a[] = "\200A\330\010\013\2104\210t\2207\230!\2301\330\014\022\220,\230a\230q\330\010\013\2105\220\007\220q\330\014\027\220v\230V\2408\2501\330\014\020\220\013\2301\330\014\023\320\023+\2501\250D\260\010\270\016\300g\310Q\340\014\023\320\023+\2501\250D\260\010\270\006\270a\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_4t7_1_aq_5_q_vV81_1_4x_G1_4xvQ[] = "\200A\330\010\013\2104\210t\2207\230!\2301\330\014\022\220,\230a\230q\330\010\013\2105\220\007\220q\330\014\027\220v\230V\2408\2501\330\014\020\220\013\2301\330\014\023\320\023*\250!\2504\250x\260}\300G\3101\340\014\023\320\023*\250!\2504\250x\260v\270Q\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_4t7_1_aq_5_q_vV81_1_we1B_6a_1D[] = "\200A\330\010\013\2104\210t\2207\230!\2301\330\014\022\220,\230a\230q\330\010\013\2105\220\007\220q\330\014\027\220v\230V\2408\2501\330\014\020\220\013\2301\330\014\017\210w\220e\2301\230B\320\0366\260a\330\014\023\320\023+\2501\250D\260\010\270\016\300g\310Q\340\014\023\320\023+\2501\250D\260\010\270\006\270a\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_4t7_1_aq_5_q_vV81_A_1D_gQ_1D_a[] = "\200A\330\010\013\2104\210t\2207\230!\2301\330\014\022\220,\230a\230q\330\010\013\2105\220\007\220q\330\014\027\220v\230V\2408\2501\330\014\020\220\014\230A\330\014\023\320\023+\2501\250D\260\010\270\016\300g\310Q\340\014\023\320\023+\2501\250D\260\010\270\006\270a\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_4t7_1_aq_5_q_vV81_we1B_1D_8NgU[] = "\200A\330\010\013\2104\210t\2207\230!\2301\330\014\022\220,\230a\230q\330\010\013\2105\220\007\220q\330\014\027\220v\230V\2408\2501\330\014\020\220\n\230!\330\014\017\210w\220e\2301\230B\320\036:\270!\330\014\023\320\023+\2501\250D\260\010\3208N\310g\320UV\360\006\000\r\024\320\023+\2501\250D\260\010\270\006\270a\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_vQa_QhgQ_5_OSXX_iinnttzz_F_F_G[] = "\200A\330\010\037\230v\240Q\240a\360\010\000\t\026\320\025%\240Q\240h\250g\260Q\330\010\017\320\017:\270!\2705\300\004\300O\320SX\320X^\320^i\320in\320nt\320tz\320z~\360\000\000\177\001F\002\360\000\000F\002G\002\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_A_vQa_QhgQ_Qe1D_E_vU___ffg_5_3fE[] = "\200A\330\010\037\230v\240Q\240a\360\010\000\t\026\320\025%\240Q\240h\250g\260Q\330\010\017\320\017%\240Q\240e\2501\250D\260\004\260E\270\026\270{\310%\310v\320U[\320[_\320_f\320fg\330\010\013\2105\220\003\2203\220f\230E\240\026\240q\250\001";
static const char __pyx_k_Note_that_Cython_is_deliberately[] = "Note that Cython is deliberately stricter than PEP-484 and rejects subclasses of builtin types. If you need to pass subclasses then set the 'annotation_typing' directive to False.";
static const char __pyx_k_Provided_array_length_does_not_m[] = "Provided array length does not match expected length ";
static const char __pyx_k_Stub_reInitializeExternalForcing[] = "Stub.reInitializeExternalForcingFn";
static const char __pyx_k_TMMState_setCalcExternalForcingF[] = "TMMState.setCalcExternalForcingFunction";
static const char __pyx_k_TMMState_setFinExternalForcingFu[] = "TMMState.setFinExternalForcingFunction";
static const char __pyx_k_TMMState_setIniExternalForcingFu[] = "TMMState.setIniExternalForcingFunction";
static const char __pyx_k_TMMState_setReiExternalForcingFu[] = "TMMState.setReiExternalForcingFunction";
static const char __pyx_k_TMMState_setWriExternalForcingFu[] = "TMMState.setWriExternalForcingFunction";
static const char __pyx_k_TimeDependentArray___reduce_cyth[] = "TimeDependentArray.__reduce_cython__";
static const char __pyx_k_TimeDependentArray___setstate_cy[] = "TimeDependentArray.__setstate_cython__";
static const char __pyx_k_TimeDependentTimer___reduce_cyth[] = "TimeDependentTimer.__reduce_cython__";
static const char __pyx_k_TimeDependentTimer___setstate_cy[] = "TimeDependentTimer.__setstate_cython__";
static const char __pyx_k_TimeDependentVec___reduce_cython[] = "TimeDependentVec.__reduce_cython__";
static const char __pyx_k_TimeDependentVec___setstate_cyth[] = "TimeDependentVec.__setstate_cython__";
static const char __pyx_k_Warning_no_options_database_valu[] = "Warning: no options database value found for ";
static const char __pyx_k_arr_length_does_not_match_expect[] = "arr length does not match expected length ";
static const char __pyx_k_getBCSizes_failed_because_no_pre[] = "getBCSizes failed because no prescribed BCs are in use!";
static const char __pyx_k_no_default___reduce___due_to_non[] = "no default __reduce__ due to non-trivial __cinit__";
static const char __pyx_k_numpy__core_multiarray_failed_to[] = "numpy._core.multiarray failed to import";
static const char __pyx_k_numpy__core_umath_failed_to_impo[] = "numpy._core.umath failed to import";
static const char __pyx_k_self_data_ptr_cannot_be_converte[] = "self.data_ptr cannot be converted to a Python object for pickling";
static const char __pyx_k_setCalcCalcBCFunction_failed_cal[] = "setCalcCalcBCFunction failed: -calc_bc not specified";
static const char __pyx_k_setCalcExternalForcingFunction_f[] = "setCalcExternalForcingFunction failed: -external_forcing not specified";
static const char __pyx_k_setCalcMisfitFunction_failed_cal[] = "setCalcMisfitFunction failed: -calc_misfit not specified";
static const char __pyx_k_setCalcMonitorFunction_failed_us[] = "setCalcMonitorFunction failed: -use_monitor not specified";
static const char __pyx_k_setFinCalcBCFunction_failed_calc[] = "setFinCalcBCFunction failed: -calc_bc not specified";
static const char __pyx_k_setFinExternalForcingFunction_fa[] = "setFinExternalForcingFunction failed: -external_forcing not specified";
static const char __pyx_k_setFinMisfitFunction_failed_calc[] = "setFinMisfitFunction failed: -calc_misfit not specified";
static const char __pyx_k_setFinMonitorFunction_failed_use[] = "setFinMonitorFunction failed: -use_monitor not specified";
static const char __pyx_k_setIniCalcBCFunction_failed_calc[] = "setIniCalcBCFunction failed: -calc_bc not specified";
static const char __pyx_k_setIniExternalForcingFunction_fa[] = "setIniExternalForcingFunction failed: -external_forcing not specified";
static const char __pyx_k_setIniMisfitFunction_failed_calc[] = "setIniMisfitFunction failed: -calc_misfit not specified";
static const char __pyx_k_setIniMonitorFunction_failed_use[] = "setIniMonitorFunction failed: -use_monitor not specified";
static const char __pyx_k_setReiCalcBCFunction_failed_calc[] = "setReiCalcBCFunction failed: -calc_bc not specified";
static const char __pyx_k_setReiExternalForcingFunction_fa[] = "setReiExternalForcingFunction failed: -external_forcing not specified";
static const char __pyx_k_setWriCalcBCFunction_failed_calc[] = "setWriCalcBCFunction failed: -calc_bc not specified";
static const char __pyx_k_setWriExternalForcingFunction_fa[] = "setWriExternalForcingFunction failed: -external_forcing not specified";
static const char __pyx_k_setWriMisfitFunction_failed_calc[] = "setWriMisfitFunction failed: -calc_misfit not specified";
static const char __pyx_k_setWriMonitorFunction_failed_use[] = "setWriMonitorFunction failed: -use_monitor not specified";
static const char __pyx_k_xarr_length_does_not_match_expec[] = "xarr length does not match expected length ";
static const char __pyx_k_yarr_length_does_not_match_expec[] = "yarr length does not match expected length ";
/* #### Code section: decls ### */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_14_ImmutableList___setitem__(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_index, CYTHON_UNUSED PyObject *__pyx_v_item); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_14_ImmutableList_2insert(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_index, CYTHON_UNUSED PyObject *__pyx_v_item); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_14_ImmutableList_4append(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_item); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_Id, CYTHON_UNUSED PyObject *__pyx_v_prefix); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_2iniExternalForcingFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_4calcExternalForcingFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_6writeExternalForcingFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_8finalizeExternalForcingFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_10reInitializeExternalForcingFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_12iniCalcBCFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iterc, CYTHON_UNUSED PyObject *__pyx_v_tf, CYTHON_UNUSED PyObject *__pyx_v_Iterf, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_14calcCalcBCFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iterc, CYTHON_UNUSED PyObject *__pyx_v_tf, CYTHON_UNUSED PyObject *__pyx_v_Iterf, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_16writeCalcBCFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_18finalizeCalcBCFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_20reInitializeCalcBCFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_22iniMonitorFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_24calcMonitorFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_26writeMonitorFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_28finalizeMonitorFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_30iniMisfitFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_32calcMisfitFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_34writeMisfitFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_36finalizeMisfitFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_2__init__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6setIniExternalForcingFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8setCalcExternalForcingFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_10setWriExternalForcingFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_12setFinExternalForcingFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_14setReiExternalForcingFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_16setIniCalcBCFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_18setCalcCalcBCFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_20setWriCalcBCFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_22setFinCalcBCFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_24setReiCalcBCFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_26setIniMonitorFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_28setCalcMonitorFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_30setWriMonitorFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_32setFinMonitorFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_34setIniMisfitFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_36setCalcMisfitFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_38setWriMisfitFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_40setFinMisfitFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_42getConfig(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_44getNumTracers(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_46setFromOptions(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_prefix, PyObject *__pyx_v_doOutput); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_48forcingUpdate(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_tc, PyObject *__pyx_v_Iterc, PyObject *__pyx_v_iLoop); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_50timeStep(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_tc, PyObject *__pyx_v_Iterc, PyObject *__pyx_v_iLoop); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_52timeStepPost(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_tc, PyObject *__pyx_v_Iterc, PyObject *__pyx_v_iLoop); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_54output(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_tc, PyObject *__pyx_v_Iterc, PyObject *__pyx_v_iLoop); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_56pushConfigVar(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_kwargs); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_58destroy(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_tc); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_60setTracer(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_alpha, PyObject *__pyx_v_itr); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_62loadTracerFromFile(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_typ, PyObject *__pyx_v_filename, PyObject *__pyx_v_itr, PyObject *__pyx_v_iRec); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6finiex___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6finiex_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6finiex_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fcalcex___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6fwriex___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6fwriex_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6fwriex_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6ffinex___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6ffinex_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6ffinex_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6freiex___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6freiex_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6freiex_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finicbc___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finicbc_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finicbc_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwricbc___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffincbc___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7freicbc___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7freicbc_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7freicbc_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimon___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimon_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimon_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimon___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmon___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimis___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimis_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimis_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimis___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmis___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7stateId___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7stateId_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7stateId_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_10numTracers___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_10numTracers_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_10numTracers_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6config___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6config_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6config_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_11tracerNames___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_1c___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_1c_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_1c_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_2qf___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_2qf_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_2qf_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3qef___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3qef_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3qef_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_4qrel___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_4qrel_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_4qrel_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbc___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbc_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbc_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbf___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbf_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbf_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_64__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_66__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core__cleanUp(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_2initialize(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4updateTMs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tc); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_6finalize(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tc); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8getProfileConfig(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_10getTimeConfig(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_12getSizes(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_14getBCSizes(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self, PyObject *__pyx_v_prefix, PyObject *__pyx_v_prefix2prefix, PetscInt __pyx_v_startTimeStep); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_6update(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self, PetscInt __pyx_v_Iter); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_8incr(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_5count___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_5count_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_5count_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_10__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_12__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_self, PyObject *__pyx_v_prefix, PyObject *__pyx_v_prefix2prefix, PyArrayObject *__pyx_v_tdp, PyObject *__pyx_v_cyclePeriod); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer_6__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer_8__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_self, PyObject *__pyx_v_prefix, PyObject *__pyx_v_prefix2prefix, PyArrayObject *__pyx_v_tdt); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer_6__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer_8__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self, PyObject *__pyx_v_typ, PyArrayObject *__pyx_v_buf); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_6interp(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self, PyObject *__pyx_v_tc, struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_timer, PyObject *__pyx_v_filename); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_8destroy(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_3arr___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_10__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_12__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self, PyObject *__pyx_v_typ, PyArrayObject *__pyx_v_buf); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_6interp(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self, PyObject *__pyx_v_tc, struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_timer, PyObject *__pyx_v_filename); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_8destroy(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_10__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_12__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self, PyObject *__pyx_v_arrayLength, PyArrayObject *__pyx_v_buf); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_6interp(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self, PyObject *__pyx_v_tc, struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_timer, PyObject *__pyx_v_filename); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_8destroy(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_3arr___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_10__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_12__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self, PyObject *__pyx_v_arrayLength, PyArrayObject *__pyx_v_buf); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_6interp(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self, PyObject *__pyx_v_tc, struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_timer, PyObject *__pyx_v_filename); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_8destroy(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self, PyObject *__pyx_v_value); /* proto */
static int __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_10__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_12__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16loadVecIntoArray(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_filename, PyArrayObject *__pyx_v_buf); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18readProfileScalarData(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_filename, PyObject *__pyx_v_numValsPerProfile, PyArrayObject *__pyx_v_buf); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_20writeProfileScalarData(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_filename, PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_numValsPerProfile, PyObject *__pyx_v_appendToFile); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_22writeArrayToVec(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_filename, PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_mode); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_24writeBinaryArray(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_filename, PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_appendToFile); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_26barrier(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_28globalScalarSum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_30globalSum(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_xarr); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_32dotProd(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_xarr, PyArrayObject *__pyx_v_yarr); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_34dotProdProfileScalarData(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_xarr, PyArrayObject *__pyx_v_yarr); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_36dotProdVecs(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_xarr, PyArrayObject *__pyx_v_yarr); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_17_RealArrayWrapper___array__(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_dtype, CYTHON_UNUSED PyObject *__pyx_v_copy); /* proto */
static void __pyx_pf_6tmm4py_11tmm4py_core_17_RealArrayWrapper_2__dealloc__(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_17_RealArrayWrapper_4__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_17_RealArrayWrapper_6__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel___array__(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_dtype, CYTHON_UNUSED PyObject *__pyx_v_copy); /* proto */
static void __pyx_pf_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_2__dealloc__(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_4__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_6__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16_IntArrayWrapper___array__(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_dtype, CYTHON_UNUSED PyObject *__pyx_v_copy); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16_IntArrayWrapper_2__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16_IntArrayWrapper_4__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel___array__(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_dtype, CYTHON_UNUSED PyObject *__pyx_v_copy); /* proto */
static void __pyx_pf_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_2__dealloc__(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_4__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_6__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_TMMState(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_StepTimer(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_PeriodicTimer(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_TimeDependentTimer(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_PeriodicVec(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_TimeDependentVec(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_PeriodicArray(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_TimeDependentArray(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core__RealArrayWrapper(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core__IntArrayWrapper(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
/* #### Code section: late_includes ### */
/* #### Code section: module_state ### */
/* SmallCodeConfig */
#ifndef CYTHON_SMALL_CODE
#if defined(__clang__)
    #define CYTHON_SMALL_CODE
#elif defined(__GNUC__) && (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ >= 3))
    #define CYTHON_SMALL_CODE __attribute__((cold))
#else
    #define CYTHON_SMALL_CODE
#endif
#endif

typedef struct {
  PyObject *__pyx_d;
  PyObject *__pyx_b;
  PyObject *__pyx_cython_runtime;
  PyObject *__pyx_empty_tuple;
  PyObject *__pyx_empty_bytes;
  PyObject *__pyx_empty_unicode;
  #ifdef __Pyx_CyFunction_USED
  PyTypeObject *__pyx_CyFunctionType;
  #endif
  #ifdef __Pyx_FusedFunction_USED
  PyTypeObject *__pyx_FusedFunctionType;
  #endif
  #ifdef __Pyx_Generator_USED
  PyTypeObject *__pyx_GeneratorType;
  #endif
  #ifdef __Pyx_IterableCoroutine_USED
  PyTypeObject *__pyx_IterableCoroutineType;
  #endif
  #ifdef __Pyx_Coroutine_USED
  PyTypeObject *__pyx_CoroutineAwaitType;
  #endif
  #ifdef __Pyx_Coroutine_USED
  PyTypeObject *__pyx_CoroutineType;
  #endif
  PyObject *PyPetscComm_Type;
  PyObject *PyPetscObject_Type;
  PyObject *PyPetscViewer_Type;
  PyObject *PyPetscRandom_Type;
  PyObject *PyPetscDevice_Type;
  PyObject *PyPetscDeviceContext_Type;
  PyObject *PyPetscIS_Type;
  PyObject *PyPetscLGMap_Type;
  PyObject *PyPetscSF_Type;
  PyObject *PyPetscVec_Type;
  PyObject *PyPetscSpace_Type;
  PyObject *PyPetscDualSpace_Type;
  PyObject *PyPetscFE_Type;
  PyObject *PyPetscQuad_Type;
  PyObject *PyPetscScatter_Type;
  PyObject *PyPetscSection_Type;
  PyObject *PyPetscMat_Type;
  PyObject *PyPetscMatPartitioning_Type;
  PyObject *PyPetscNullSpace_Type;
  PyObject *PyPetscPC_Type;
  PyObject *PyPetscKSP_Type;
  PyObject *PyPetscSNES_Type;
  PyObject *PyPetscSNESLineSearch_Type;
  PyObject *PyPetscTS_Type;
  PyObject *PyPetscTAO_Type;
  PyObject *PyPetscTAOLineSearch_Type;
  PyObject *PyPetscAO_Type;
  PyObject *PyPetscDM_Type;
  PyObject *PyPetscDMPlexTransform_Type;
  PyObject *PyPetscDMSwarmCellDM_Type;
  PyObject *PyPetscDS_Type;
  PyObject *PyPetscPartitioner_Type;
  PyObject *PyPetscDMLabel_Type;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_Comm;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_Object;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_Viewer;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_Random;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_Device;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_DeviceContext;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_IS;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_LGMap;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_SF;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_Vec;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_Space;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_DualSpace;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_FE;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_Quad;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_Scatter;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_Section;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_Mat;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_MatPartitioning;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_NullSpace;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_PC;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_KSP;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_SNES;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_SNESLineSearch;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_TS;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_TAO;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_TAOLineSearch;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_AO;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_DM;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_DMPlexTransform;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_CellDM;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_DS;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_Partitioner;
  PyTypeObject *__pyx_ptype_8petsc4py_5PETSc_DMLabel;
  PyTypeObject *__pyx_ptype_7cpython_4type_type;
  PyTypeObject *__pyx_ptype_7cpython_4bool_bool;
  PyTypeObject *__pyx_ptype_7cpython_7complex_complex;
  PyTypeObject *__pyx_ptype_5numpy_dtype;
  PyTypeObject *__pyx_ptype_5numpy_flatiter;
  PyTypeObject *__pyx_ptype_5numpy_broadcast;
  PyTypeObject *__pyx_ptype_5numpy_ndarray;
  PyTypeObject *__pyx_ptype_5numpy_generic;
  PyTypeObject *__pyx_ptype_5numpy_number;
  PyTypeObject *__pyx_ptype_5numpy_integer;
  PyTypeObject *__pyx_ptype_5numpy_signedinteger;
  PyTypeObject *__pyx_ptype_5numpy_unsignedinteger;
  PyTypeObject *__pyx_ptype_5numpy_inexact;
  PyTypeObject *__pyx_ptype_5numpy_floating;
  PyTypeObject *__pyx_ptype_5numpy_complexfloating;
  PyTypeObject *__pyx_ptype_5numpy_flexible;
  PyTypeObject *__pyx_ptype_5numpy_character;
  PyTypeObject *__pyx_ptype_5numpy_ufunc;
  PyObject *__pyx_type_6tmm4py_11tmm4py_core_TMMState;
  PyObject *__pyx_type_6tmm4py_11tmm4py_core_StepTimer;
  PyObject *__pyx_type_6tmm4py_11tmm4py_core_PeriodicTimer;
  PyObject *__pyx_type_6tmm4py_11tmm4py_core_TimeDependentTimer;
  PyObject *__pyx_type_6tmm4py_11tmm4py_core_PeriodicVec;
  PyObject *__pyx_type_6tmm4py_11tmm4py_core_TimeDependentVec;
  PyObject *__pyx_type_6tmm4py_11tmm4py_core_PeriodicArray;
  PyObject *__pyx_type_6tmm4py_11tmm4py_core_TimeDependentArray;
  PyObject *__pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapper;
  PyObject *__pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel;
  PyObject *__pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapper;
  PyObject *__pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel;
  PyTypeObject *__pyx_ptype_6tmm4py_11tmm4py_core_TMMState;
  PyTypeObject *__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer;
  PyTypeObject *__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer;
  PyTypeObject *__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer;
  PyTypeObject *__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec;
  PyTypeObject *__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec;
  PyTypeObject *__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray;
  PyTypeObject *__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray;
  PyTypeObject *__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper;
  PyTypeObject *__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel;
  PyTypeObject *__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper;
  PyTypeObject *__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel;
  __Pyx_CachedCFunction __pyx_umethod_PyDict_Type_pop;
  PyObject *__pyx_tuple[11];
  PyObject *__pyx_codeobj_tab[116];
  PyObject *__pyx_string_tab[462];
  PyObject *__pyx_int_0;
  PyObject *__pyx_int_1;
  PyObject *__pyx_int_neg_1;
/* #### Code section: module_state_contents ### */
/* CommonTypesMetaclass.module_state_decls */
PyTypeObject *__pyx_CommonTypesMetaclassType;

/* CachedMethodType.module_state_decls */
#if CYTHON_COMPILING_IN_LIMITED_API
PyObject *__Pyx_CachedMethodType;
#endif

/* CodeObjectCache.module_state_decls */
struct __Pyx_CodeObjectCache __pyx_code_cache;

/* #### Code section: module_state_end ### */
} __pyx_mstatetype;

#if CYTHON_USE_MODULE_STATE
#ifdef __cplusplus
namespace {
extern struct PyModuleDef __pyx_moduledef;
} /* anonymous namespace */
#else
static struct PyModuleDef __pyx_moduledef;
#endif

#define __pyx_mstate_global (__Pyx_PyModule_GetState(__Pyx_State_FindModule(&__pyx_moduledef)))

#define __pyx_m (__Pyx_State_FindModule(&__pyx_moduledef))
#else
static __pyx_mstatetype __pyx_mstate_global_static =
#ifdef __cplusplus
    {};
#else
    {0};
#endif
static __pyx_mstatetype * const __pyx_mstate_global = &__pyx_mstate_global_static;
#endif
/* #### Code section: constant_name_defines ### */
#define __pyx_kp_u_ __pyx_string_tab[0]
#define __pyx_kp_u_Before_GC __pyx_string_tab[1]
#define __pyx_n_u_COMM_WORLD __pyx_string_tab[2]
#define __pyx_kp_u_Calling_destroy_at_time __pyx_string_tab[3]
#define __pyx_kp_u_Calling_finalize_at_time __pyx_string_tab[4]
#define __pyx_kp_u_Doing_GC __pyx_string_tab[5]
#define __pyx_n_u_Error __pyx_string_tab[6]
#define __pyx_n_u_Id __pyx_string_tab[7]
#define __pyx_kp_u_Id_2 __pyx_string_tab[8]
#define __pyx_n_u_ImmutableList __pyx_string_tab[9]
#define __pyx_n_u_ImmutableList___setitem __pyx_string_tab[10]
#define __pyx_n_u_ImmutableList_append __pyx_string_tab[11]
#define __pyx_n_u_ImmutableList_insert __pyx_string_tab[12]
#define __pyx_n_u_ImportError __pyx_string_tab[13]
#define __pyx_kp_u_Incorrect_type_for __pyx_string_tab[14]
#define __pyx_kp_u_Ini_exf_forcing_func_is __pyx_string_tab[15]
#define __pyx_kp_u_Ini_monitor_func_is __pyx_string_tab[16]
#define __pyx_n_u_IntArrayWrapper __pyx_string_tab[17]
#define __pyx_n_u_IntArrayWrapperWithDel __pyx_string_tab[18]
#define __pyx_n_u_IntArrayWrapperWithDel___array __pyx_string_tab[19]
#define __pyx_n_u_IntArrayWrapperWithDel___reduce __pyx_string_tab[20]
#define __pyx_n_u_IntArrayWrapperWithDel___setsta __pyx_string_tab[21]
#define __pyx_n_u_IntArrayWrapper___array __pyx_string_tab[22]
#define __pyx_n_u_IntArrayWrapper___reduce_cython __pyx_string_tab[23]
#define __pyx_n_u_IntArrayWrapper___setstate_cyth __pyx_string_tab[24]
#define __pyx_n_u_Iter __pyx_string_tab[25]
#define __pyx_n_u_Iter0 __pyx_string_tab[26]
#define __pyx_n_u_Iter0ret __pyx_string_tab[27]
#define __pyx_n_u_Iterc __pyx_string_tab[28]
#define __pyx_n_u_Itercc __pyx_string_tab[29]
#define __pyx_n_u_Iterf __pyx_string_tab[30]
#define __pyx_n_u_KeyError __pyx_string_tab[31]
#define __pyx_kp_u_Length_of_tdp_array __pyx_string_tab[32]
#define __pyx_kp_u_Length_of_tdt_array __pyx_string_tab[33]
#define __pyx_kp_u_List_is_not_appendable __pyx_string_tab[34]
#define __pyx_kp_u_List_is_not_insertable __pyx_string_tab[35]
#define __pyx_kp_u_List_is_not_mutable __pyx_string_tab[36]
#define __pyx_n_u_MPI __pyx_string_tab[37]
#define __pyx_kp_u_Must_be_a_bool __pyx_string_tab[38]
#define __pyx_n_u_N __pyx_string_tab[39]
#define __pyx_kp_u_None __pyx_string_tab[40]
#define __pyx_kp_u_Note_that_Cython_is_deliberately __pyx_string_tab[41]
#define __pyx_n_u_OptDB __pyx_string_tab[42]
#define __pyx_n_u_OptDBState __pyx_string_tab[43]
#define __pyx_n_u_Options __pyx_string_tab[44]
#define __pyx_n_u_PETSc __pyx_string_tab[45]
#define __pyx_n_u_PeriodicArray __pyx_string_tab[46]
#define __pyx_n_u_PeriodicArray___reduce_cython __pyx_string_tab[47]
#define __pyx_n_u_PeriodicArray___setstate_cython __pyx_string_tab[48]
#define __pyx_n_u_PeriodicArray_create __pyx_string_tab[49]
#define __pyx_n_u_PeriodicArray_destroy __pyx_string_tab[50]
#define __pyx_n_u_PeriodicArray_interp __pyx_string_tab[51]
#define __pyx_n_u_PeriodicTimer __pyx_string_tab[52]
#define __pyx_n_u_PeriodicTimer___reduce_cython __pyx_string_tab[53]
#define __pyx_n_u_PeriodicTimer___setstate_cython __pyx_string_tab[54]
#define __pyx_n_u_PeriodicTimer_create __pyx_string_tab[55]
#define __pyx_n_u_PeriodicVec __pyx_string_tab[56]
#define __pyx_n_u_PeriodicVec___reduce_cython __pyx_string_tab[57]
#define __pyx_n_u_PeriodicVec___setstate_cython __pyx_string_tab[58]
#define __pyx_n_u_PeriodicVec_create __pyx_string_tab[59]
#define __pyx_n_u_PeriodicVec_destroy __pyx_string_tab[60]
#define __pyx_n_u_PeriodicVec_interp __pyx_string_tab[61]
#define __pyx_kp_u_Provided_array_length_does_not_m __pyx_string_tab[62]
#define __pyx_n_u_RealArrayWrapper __pyx_string_tab[63]
#define __pyx_n_u_RealArrayWrapperWithDel __pyx_string_tab[64]
#define __pyx_n_u_RealArrayWrapperWithDel___array __pyx_string_tab[65]
#define __pyx_n_u_RealArrayWrapperWithDel___reduc __pyx_string_tab[66]
#define __pyx_n_u_RealArrayWrapperWithDel___setst __pyx_string_tab[67]
#define __pyx_n_u_RealArrayWrapper___array __pyx_string_tab[68]
#define __pyx_n_u_RealArrayWrapper___reduce_cytho __pyx_string_tab[69]
#define __pyx_n_u_RealArrayWrapper___setstate_cyt __pyx_string_tab[70]
#define __pyx_n_u_RuntimeError __pyx_string_tab[71]
#define __pyx_kp_u_Setting_options_database __pyx_string_tab[72]
#define __pyx_kp_u_Setting_options_database_for __pyx_string_tab[73]
#define __pyx_n_u_StepTimer __pyx_string_tab[74]
#define __pyx_n_u_StepTimer___reduce_cython __pyx_string_tab[75]
#define __pyx_n_u_StepTimer___setstate_cython __pyx_string_tab[76]
#define __pyx_n_u_StepTimer_create __pyx_string_tab[77]
#define __pyx_n_u_StepTimer_incr __pyx_string_tab[78]
#define __pyx_n_u_StepTimer_update __pyx_string_tab[79]
#define __pyx_n_u_Stub __pyx_string_tab[80]
#define __pyx_n_u_Stub___init __pyx_string_tab[81]
#define __pyx_n_u_Stub_calcCalcBCFn __pyx_string_tab[82]
#define __pyx_n_u_Stub_calcExternalForcingFn __pyx_string_tab[83]
#define __pyx_n_u_Stub_calcMisfitFn __pyx_string_tab[84]
#define __pyx_n_u_Stub_calcMonitorFn __pyx_string_tab[85]
#define __pyx_n_u_Stub_finalizeCalcBCFn __pyx_string_tab[86]
#define __pyx_n_u_Stub_finalizeExternalForcingFn __pyx_string_tab[87]
#define __pyx_n_u_Stub_finalizeMisfitFn __pyx_string_tab[88]
#define __pyx_n_u_Stub_finalizeMonitorFn __pyx_string_tab[89]
#define __pyx_n_u_Stub_iniCalcBCFn __pyx_string_tab[90]
#define __pyx_n_u_Stub_iniExternalForcingFn __pyx_string_tab[91]
#define __pyx_n_u_Stub_iniMisfitFn __pyx_string_tab[92]
#define __pyx_n_u_Stub_iniMonitorFn __pyx_string_tab[93]
#define __pyx_n_u_Stub_reInitializeCalcBCFn __pyx_string_tab[94]
#define __pyx_n_u_Stub_reInitializeExternalForcing __pyx_string_tab[95]
#define __pyx_n_u_Stub_writeCalcBCFn __pyx_string_tab[96]
#define __pyx_n_u_Stub_writeExternalForcingFn __pyx_string_tab[97]
#define __pyx_n_u_Stub_writeMisfitFn __pyx_string_tab[98]
#define __pyx_n_u_Stub_writeMonitorFn __pyx_string_tab[99]
#define __pyx_n_u_TMMState __pyx_string_tab[100]
#define __pyx_n_u_TMMState___reduce_cython __pyx_string_tab[101]
#define __pyx_n_u_TMMState___setstate_cython __pyx_string_tab[102]
#define __pyx_n_u_TMMState_create __pyx_string_tab[103]
#define __pyx_n_u_TMMState_destroy __pyx_string_tab[104]
#define __pyx_n_u_TMMState_forcingUpdate __pyx_string_tab[105]
#define __pyx_n_u_TMMState_getConfig __pyx_string_tab[106]
#define __pyx_n_u_TMMState_getNumTracers __pyx_string_tab[107]
#define __pyx_n_u_TMMState_loadTracerFromFile __pyx_string_tab[108]
#define __pyx_n_u_TMMState_output __pyx_string_tab[109]
#define __pyx_n_u_TMMState_pushConfigVar __pyx_string_tab[110]
#define __pyx_n_u_TMMState_setCalcCalcBCFunction __pyx_string_tab[111]
#define __pyx_n_u_TMMState_setCalcExternalForcingF __pyx_string_tab[112]
#define __pyx_n_u_TMMState_setCalcMisfitFunction __pyx_string_tab[113]
#define __pyx_n_u_TMMState_setCalcMonitorFunction __pyx_string_tab[114]
#define __pyx_n_u_TMMState_setFinCalcBCFunction __pyx_string_tab[115]
#define __pyx_n_u_TMMState_setFinExternalForcingFu __pyx_string_tab[116]
#define __pyx_n_u_TMMState_setFinMisfitFunction __pyx_string_tab[117]
#define __pyx_n_u_TMMState_setFinMonitorFunction __pyx_string_tab[118]
#define __pyx_n_u_TMMState_setFromOptions __pyx_string_tab[119]
#define __pyx_n_u_TMMState_setIniCalcBCFunction __pyx_string_tab[120]
#define __pyx_n_u_TMMState_setIniExternalForcingFu __pyx_string_tab[121]
#define __pyx_n_u_TMMState_setIniMisfitFunction __pyx_string_tab[122]
#define __pyx_n_u_TMMState_setIniMonitorFunction __pyx_string_tab[123]
#define __pyx_n_u_TMMState_setReiCalcBCFunction __pyx_string_tab[124]
#define __pyx_n_u_TMMState_setReiExternalForcingFu __pyx_string_tab[125]
#define __pyx_n_u_TMMState_setTracer __pyx_string_tab[126]
#define __pyx_n_u_TMMState_setWriCalcBCFunction __pyx_string_tab[127]
#define __pyx_n_u_TMMState_setWriExternalForcingFu __pyx_string_tab[128]
#define __pyx_n_u_TMMState_setWriMisfitFunction __pyx_string_tab[129]
#define __pyx_n_u_TMMState_setWriMonitorFunction __pyx_string_tab[130]
#define __pyx_n_u_TMMState_timeStep __pyx_string_tab[131]
#define __pyx_n_u_TMMState_timeStepPost __pyx_string_tab[132]
#define __pyx_kp_u_This_will_override_any_previous __pyx_string_tab[133]
#define __pyx_n_u_TimeDependentArray __pyx_string_tab[134]
#define __pyx_n_u_TimeDependentArray___reduce_cyth __pyx_string_tab[135]
#define __pyx_n_u_TimeDependentArray___setstate_cy __pyx_string_tab[136]
#define __pyx_n_u_TimeDependentArray_create __pyx_string_tab[137]
#define __pyx_n_u_TimeDependentArray_destroy __pyx_string_tab[138]
#define __pyx_n_u_TimeDependentArray_interp __pyx_string_tab[139]
#define __pyx_n_u_TimeDependentTimer __pyx_string_tab[140]
#define __pyx_n_u_TimeDependentTimer___reduce_cyth __pyx_string_tab[141]
#define __pyx_n_u_TimeDependentTimer___setstate_cy __pyx_string_tab[142]
#define __pyx_n_u_TimeDependentTimer_create __pyx_string_tab[143]
#define __pyx_n_u_TimeDependentVec __pyx_string_tab[144]
#define __pyx_n_u_TimeDependentVec___reduce_cython __pyx_string_tab[145]
#define __pyx_n_u_TimeDependentVec___setstate_cyth __pyx_string_tab[146]
#define __pyx_n_u_TimeDependentVec_create __pyx_string_tab[147]
#define __pyx_n_u_TimeDependentVec_destroy __pyx_string_tab[148]
#define __pyx_n_u_TimeDependentVec_interp __pyx_string_tab[149]
#define __pyx_n_u_TypeError __pyx_string_tab[150]
#define __pyx_kp_u_Unknown_type_of_vector __pyx_string_tab[151]
#define __pyx_n_u_Vec __pyx_string_tab[152]
#define __pyx_n_u_Viewer __pyx_string_tab[153]
#define __pyx_kp_u_Warning_no_options_database_valu __pyx_string_tab[154]
#define __pyx_kp_u_Within_destroy_at_time __pyx_string_tab[155]
#define __pyx_kp_u__2 __pyx_string_tab[156]
#define __pyx_kp_u__3 __pyx_string_tab[157]
#define __pyx_kp_u__4 __pyx_string_tab[158]
#define __pyx_kp_u__5 __pyx_string_tab[159]
#define __pyx_kp_u_add_note __pyx_string_tab[160]
#define __pyx_n_u_alpha __pyx_string_tab[161]
#define __pyx_n_u_append __pyx_string_tab[162]
#define __pyx_n_u_appendOutput __pyx_string_tab[163]
#define __pyx_n_u_appendToFile __pyx_string_tab[164]
#define __pyx_n_u_applyBC __pyx_string_tab[165]
#define __pyx_n_u_applyExternalForcing __pyx_string_tab[166]
#define __pyx_n_u_applyForcingFromFile __pyx_string_tab[167]
#define __pyx_n_u_args __pyx_string_tab[168]
#define __pyx_n_u_arr __pyx_string_tab[169]
#define __pyx_kp_u_arr_length_does_not_match_expect __pyx_string_tab[170]
#define __pyx_n_u_array __pyx_string_tab[171]
#define __pyx_n_u_arrayLength __pyx_string_tab[172]
#define __pyx_n_u_array_2 __pyx_string_tab[173]
#define __pyx_n_u_asyncio_coroutines __pyx_string_tab[174]
#define __pyx_n_u_atexit __pyx_string_tab[175]
#define __pyx_n_u_avgAppendOutput __pyx_string_tab[176]
#define __pyx_n_u_barrier __pyx_string_tab[177]
#define __pyx_n_u_buf __pyx_string_tab[178]
#define __pyx_kp_u_c __pyx_string_tab[179]
#define __pyx_n_u_c_2 __pyx_string_tab[180]
#define __pyx_n_u_c_filename __pyx_string_tab[181]
#define __pyx_n_u_c_pre __pyx_string_tab[182]
#define __pyx_n_u_c_pre2pre __pyx_string_tab[183]
#define __pyx_n_u_c_tdp __pyx_string_tab[184]
#define __pyx_n_u_c_tdt __pyx_string_tab[185]
#define __pyx_n_u_calcCalcBCFn __pyx_string_tab[186]
#define __pyx_n_u_calcExternalForcingFn __pyx_string_tab[187]
#define __pyx_n_u_calcMisfitFn __pyx_string_tab[188]
#define __pyx_n_u_calcMonitorFn __pyx_string_tab[189]
#define __pyx_kp_u_cbc __pyx_string_tab[190]
#define __pyx_n_u_cbc_2 __pyx_string_tab[191]
#define __pyx_kp_u_cbf __pyx_string_tab[192]
#define __pyx_n_u_cbf_2 __pyx_string_tab[193]
#define __pyx_n_u_cleanUp __pyx_string_tab[194]
#define __pyx_n_u_cline_in_traceback __pyx_string_tab[195]
#define __pyx_n_u_comm __pyx_string_tab[196]
#define __pyx_n_u_config __pyx_string_tab[197]
#define __pyx_n_u_configVars __pyx_string_tab[198]
#define __pyx_n_u_constantBC __pyx_string_tab[199]
#define __pyx_n_u_constantForcing __pyx_string_tab[200]
#define __pyx_n_u_context __pyx_string_tab[201]
#define __pyx_n_u_copy __pyx_string_tab[202]
#define __pyx_n_u_create __pyx_string_tab[203]
#define __pyx_n_u_createBinary __pyx_string_tab[204]
#define __pyx_n_u_createWithArray __pyx_string_tab[205]
#define __pyx_n_u_cyclePeriod __pyx_string_tab[206]
#define __pyx_n_u_cycle_period __pyx_string_tab[207]
#define __pyx_n_u_data_pointer __pyx_string_tab[208]
#define __pyx_n_u_debug __pyx_string_tab[209]
#define __pyx_n_u_deltaTClock __pyx_string_tab[210]
#define __pyx_n_u_deltaTClockret __pyx_string_tab[211]
#define __pyx_n_u_destroy __pyx_string_tab[212]
#define __pyx_kp_u_disable __pyx_string_tab[213]
#define __pyx_n_u_doCalcBC __pyx_string_tab[214]
#define __pyx_n_u_doExtraWrite __pyx_string_tab[215]
#define __pyx_n_u_doMisfit __pyx_string_tab[216]
#define __pyx_n_u_doOutput __pyx_string_tab[217]
#define __pyx_n_u_doTimeAverage __pyx_string_tab[218]
#define __pyx_n_u_doWriteBC __pyx_string_tab[219]
#define __pyx_n_u_doWriteQEF __pyx_string_tab[220]
#define __pyx_n_u_doWriteQF __pyx_string_tab[221]
#define __pyx_n_u_doc __pyx_string_tab[222]
#define __pyx_kp_u_does_not_equal_yarr_length __pyx_string_tab[223]
#define __pyx_kp_u_does_not_match_size_specified_i __pyx_string_tab[224]
#define __pyx_n_u_dot __pyx_string_tab[225]
#define __pyx_n_u_dotProd __pyx_string_tab[226]
#define __pyx_n_u_dotProdProfileScalarData __pyx_string_tab[227]
#define __pyx_n_u_dotProdVecs __pyx_string_tab[228]
#define __pyx_n_u_dtype __pyx_string_tab[229]
#define __pyx_kp_u_enable __pyx_string_tab[230]
#define __pyx_n_u_encode __pyx_string_tab[231]
#define __pyx_n_u_filename __pyx_string_tab[232]
#define __pyx_n_u_finalize __pyx_string_tab[233]
#define __pyx_n_u_finalizeCalcBCFn __pyx_string_tab[234]
#define __pyx_n_u_finalizeExternalForcingFn __pyx_string_tab[235]
#define __pyx_n_u_finalizeMisfitFn __pyx_string_tab[236]
#define __pyx_n_u_finalizeMonitorFn __pyx_string_tab[237]
#define __pyx_kp_u_for __pyx_string_tab[238]
#define __pyx_n_u_forcingUpdate __pyx_string_tab[239]
#define __pyx_kp_u_freeing_data __pyx_string_tab[240]
#define __pyx_n_u_func __pyx_string_tab[241]
#define __pyx_n_u_func_2 __pyx_string_tab[242]
#define __pyx_kp_u_gc __pyx_string_tab[243]
#define __pyx_n_u_getBCSizes __pyx_string_tab[244]
#define __pyx_kp_u_getBCSizes_failed_because_no_pre __pyx_string_tab[245]
#define __pyx_n_u_getConfig __pyx_string_tab[246]
#define __pyx_n_u_getInt __pyx_string_tab[247]
#define __pyx_n_u_getNumTracers __pyx_string_tab[248]
#define __pyx_n_u_getProfileConfig __pyx_string_tab[249]
#define __pyx_n_u_getRank __pyx_string_tab[250]
#define __pyx_n_u_getSizes __pyx_string_tab[251]
#define __pyx_n_u_getString __pyx_string_tab[252]
#define __pyx_n_u_getTimeConfig __pyx_string_tab[253]
#define __pyx_n_u_getstate __pyx_string_tab[254]
#define __pyx_n_u_globalScalarSum __pyx_string_tab[255]
#define __pyx_n_u_globalSum __pyx_string_tab[256]
#define __pyx_n_u_hasName __pyx_string_tab[257]
#define __pyx_n_u_iLoop __pyx_string_tab[258]
#define __pyx_n_u_iLoopc __pyx_string_tab[259]
#define __pyx_n_u_iRec __pyx_string_tab[260]
#define __pyx_n_u_iRecc __pyx_string_tab[261]
#define __pyx_n_u_ierr __pyx_string_tab[262]
#define __pyx_n_u_incr __pyx_string_tab[263]
#define __pyx_n_u_index __pyx_string_tab[264]
#define __pyx_n_u_iniCalcBCFn __pyx_string_tab[265]
#define __pyx_n_u_iniExternalForcingFn __pyx_string_tab[266]
#define __pyx_n_u_iniMisfitFn __pyx_string_tab[267]
#define __pyx_n_u_iniMonitorFn __pyx_string_tab[268]
#define __pyx_n_u_init __pyx_string_tab[269]
#define __pyx_n_u_initialize __pyx_string_tab[270]
#define __pyx_n_u_initializing __pyx_string_tab[271]
#define __pyx_n_u_insert __pyx_string_tab[272]
#define __pyx_n_u_interp __pyx_string_tab[273]
#define __pyx_n_u_isInitializedCalcBC __pyx_string_tab[274]
#define __pyx_n_u_isInitializedExternalForcing __pyx_string_tab[275]
#define __pyx_n_u_is_coroutine __pyx_string_tab[276]
#define __pyx_kp_u_isenabled __pyx_string_tab[277]
#define __pyx_n_u_item __pyx_string_tab[278]
#define __pyx_n_u_itr __pyx_string_tab[279]
#define __pyx_n_u_k __pyx_string_tab[280]
#define __pyx_n_u_key __pyx_string_tab[281]
#define __pyx_n_u_keys __pyx_string_tab[282]
#define __pyx_n_u_kwargs __pyx_string_tab[283]
#define __pyx_n_u_lDim __pyx_string_tab[284]
#define __pyx_n_u_lEndIndices __pyx_string_tab[285]
#define __pyx_n_u_lNumProfiles __pyx_string_tab[286]
#define __pyx_n_u_lProfileLength __pyx_string_tab[287]
#define __pyx_n_u_lSize __pyx_string_tab[288]
#define __pyx_n_u_lStartIndices __pyx_string_tab[289]
#define __pyx_n_u_loadTracerFromFile __pyx_string_tab[290]
#define __pyx_n_u_loadVecIntoArray __pyx_string_tab[291]
#define __pyx_n_u_main __pyx_string_tab[292]
#define __pyx_n_u_maxSteps __pyx_string_tab[293]
#define __pyx_n_u_maxStepsret __pyx_string_tab[294]
#define __pyx_n_u_metaclass __pyx_string_tab[295]
#define __pyx_n_u_mode __pyx_string_tab[296]
#define __pyx_n_u_module __pyx_string_tab[297]
#define __pyx_n_u_mpi4py __pyx_string_tab[298]
#define __pyx_n_u_mro_entries __pyx_string_tab[299]
#define __pyx_n_u_myId __pyx_string_tab[300]
#define __pyx_n_u_n __pyx_string_tab[301]
#define __pyx_n_u_name __pyx_string_tab[302]
#define __pyx_n_u_ndarray __pyx_string_tab[303]
#define __pyx_n_u_newarr __pyx_string_tab[304]
#define __pyx_n_u_newstate __pyx_string_tab[305]
#define __pyx_n_u_newtimer __pyx_string_tab[306]
#define __pyx_n_u_newvec __pyx_string_tab[307]
#define __pyx_n_u_nl __pyx_string_tab[308]
#define __pyx_kp_u_no_default___reduce___due_to_non __pyx_string_tab[309]
#define __pyx_n_u_np __pyx_string_tab[310]
#define __pyx_n_u_nparr __pyx_string_tab[311]
#define __pyx_n_u_numTracers __pyx_string_tab[312]
#define __pyx_n_u_numValsPerProfile __pyx_string_tab[313]
#define __pyx_n_u_num_per_period __pyx_string_tab[314]
#define __pyx_n_u_num_times __pyx_string_tab[315]
#define __pyx_n_u_numpy __pyx_string_tab[316]
#define __pyx_kp_u_numpy__core_multiarray_failed_to __pyx_string_tab[317]
#define __pyx_kp_u_numpy__core_umath_failed_to_impo __pyx_string_tab[318]
#define __pyx_n_u_nx __pyx_string_tab[319]
#define __pyx_n_u_ny __pyx_string_tab[320]
#define __pyx_n_u_output __pyx_string_tab[321]
#define __pyx_n_u_periodicBC __pyx_string_tab[322]
#define __pyx_n_u_periodicForcing __pyx_string_tab[323]
#define __pyx_n_u_petsc4py __pyx_string_tab[324]
#define __pyx_n_u_pickupFromFile __pyx_string_tab[325]
#define __pyx_n_u_pop __pyx_string_tab[326]
#define __pyx_n_u_pre __pyx_string_tab[327]
#define __pyx_n_u_prefix __pyx_string_tab[328]
#define __pyx_n_u_prefix2prefix __pyx_string_tab[329]
#define __pyx_n_u_prepare __pyx_string_tab[330]
#define __pyx_n_u_print __pyx_string_tab[331]
#define __pyx_n_u_profileVars __pyx_string_tab[332]
#define __pyx_n_u_pushConfigVar __pyx_string_tab[333]
#define __pyx_n_u_pyx_state __pyx_string_tab[334]
#define __pyx_n_u_pyx_vtable __pyx_string_tab[335]
#define __pyx_kp_u_qef __pyx_string_tab[336]
#define __pyx_n_u_qef_2 __pyx_string_tab[337]
#define __pyx_kp_u_qf __pyx_string_tab[338]
#define __pyx_n_u_qf_2 __pyx_string_tab[339]
#define __pyx_kp_u_qrel __pyx_string_tab[340]
#define __pyx_n_u_qrel_2 __pyx_string_tab[341]
#define __pyx_n_u_qualname __pyx_string_tab[342]
#define __pyx_kp_u_r __pyx_string_tab[343]
#define __pyx_n_u_range __pyx_string_tab[344]
#define __pyx_n_u_rank __pyx_string_tab[345]
#define __pyx_n_u_reInitializeCalcBCFn __pyx_string_tab[346]
#define __pyx_n_u_reInitializeExternalForcingFn __pyx_string_tab[347]
#define __pyx_n_u_readProfileScalarData __pyx_string_tab[348]
#define __pyx_n_u_reduce __pyx_string_tab[349]
#define __pyx_n_u_reduce_cython __pyx_string_tab[350]
#define __pyx_n_u_reduce_ex __pyx_string_tab[351]
#define __pyx_n_u_register __pyx_string_tab[352]
#define __pyx_n_u_relaxTracer __pyx_string_tab[353]
#define __pyx_n_u_res __pyx_string_tab[354]
#define __pyx_n_u_s __pyx_string_tab[355]
#define __pyx_n_u_self __pyx_string_tab[356]
#define __pyx_kp_u_self_data_ptr_cannot_be_converte __pyx_string_tab[357]
#define __pyx_kp_u_self_data_ptr_self_pv_cannot_be __pyx_string_tab[358]
#define __pyx_n_u_setCalcCalcBCFunction __pyx_string_tab[359]
#define __pyx_kp_u_setCalcCalcBCFunction_failed_cal __pyx_string_tab[360]
#define __pyx_n_u_setCalcExternalForcingFunction __pyx_string_tab[361]
#define __pyx_kp_u_setCalcExternalForcingFunction_f __pyx_string_tab[362]
#define __pyx_n_u_setCalcMisfitFunction __pyx_string_tab[363]
#define __pyx_kp_u_setCalcMisfitFunction_failed_cal __pyx_string_tab[364]
#define __pyx_n_u_setCalcMonitorFunction __pyx_string_tab[365]
#define __pyx_kp_u_setCalcMonitorFunction_failed_us __pyx_string_tab[366]
#define __pyx_n_u_setFinCalcBCFunction __pyx_string_tab[367]
#define __pyx_kp_u_setFinCalcBCFunction_failed_calc __pyx_string_tab[368]
#define __pyx_n_u_setFinExternalForcingFunction __pyx_string_tab[369]
#define __pyx_kp_u_setFinExternalForcingFunction_fa __pyx_string_tab[370]
#define __pyx_n_u_setFinMisfitFunction __pyx_string_tab[371]
#define __pyx_kp_u_setFinMisfitFunction_failed_calc __pyx_string_tab[372]
#define __pyx_n_u_setFinMonitorFunction __pyx_string_tab[373]
#define __pyx_kp_u_setFinMonitorFunction_failed_use __pyx_string_tab[374]
#define __pyx_n_u_setFromOptions __pyx_string_tab[375]
#define __pyx_n_u_setIniCalcBCFunction __pyx_string_tab[376]
#define __pyx_kp_u_setIniCalcBCFunction_failed_calc __pyx_string_tab[377]
#define __pyx_n_u_setIniExternalForcingFunction __pyx_string_tab[378]
#define __pyx_kp_u_setIniExternalForcingFunction_fa __pyx_string_tab[379]
#define __pyx_n_u_setIniMisfitFunction __pyx_string_tab[380]
#define __pyx_kp_u_setIniMisfitFunction_failed_calc __pyx_string_tab[381]
#define __pyx_n_u_setIniMonitorFunction __pyx_string_tab[382]
#define __pyx_kp_u_setIniMonitorFunction_failed_use __pyx_string_tab[383]
#define __pyx_n_u_setReiCalcBCFunction __pyx_string_tab[384]
#define __pyx_kp_u_setReiCalcBCFunction_failed_calc __pyx_string_tab[385]
#define __pyx_n_u_setReiExternalForcingFunction __pyx_string_tab[386]
#define __pyx_kp_u_setReiExternalForcingFunction_fa __pyx_string_tab[387]
#define __pyx_n_u_setTracer __pyx_string_tab[388]
#define __pyx_n_u_setValue __pyx_string_tab[389]
#define __pyx_n_u_setWriCalcBCFunction __pyx_string_tab[390]
#define __pyx_kp_u_setWriCalcBCFunction_failed_calc __pyx_string_tab[391]
#define __pyx_n_u_setWriExternalForcingFunction __pyx_string_tab[392]
#define __pyx_kp_u_setWriExternalForcingFunction_fa __pyx_string_tab[393]
#define __pyx_n_u_setWriMisfitFunction __pyx_string_tab[394]
#define __pyx_kp_u_setWriMisfitFunction_failed_calc __pyx_string_tab[395]
#define __pyx_n_u_setWriMonitorFunction __pyx_string_tab[396]
#define __pyx_kp_u_setWriMonitorFunction_failed_use __pyx_string_tab[397]
#define __pyx_n_u_set_name __pyx_string_tab[398]
#define __pyx_n_u_setitem __pyx_string_tab[399]
#define __pyx_n_u_setstate __pyx_string_tab[400]
#define __pyx_n_u_setstate_cython __pyx_string_tab[401]
#define __pyx_n_u_shape __pyx_string_tab[402]
#define __pyx_n_u_spec __pyx_string_tab[403]
#define __pyx_n_u_split __pyx_string_tab[404]
#define __pyx_n_u_startTimeStep __pyx_string_tab[405]
#define __pyx_n_u_state __pyx_string_tab[406]
#define __pyx_n_u_statescreated __pyx_string_tab[407]
#define __pyx_kp_u_stringsource __pyx_string_tab[408]
#define __pyx_n_u_sval __pyx_string_tab[409]
#define __pyx_n_u_sys __pyx_string_tab[410]
#define __pyx_n_u_tc __pyx_string_tab[411]
#define __pyx_n_u_tcc __pyx_string_tab[412]
#define __pyx_n_u_tconfig __pyx_string_tab[413]
#define __pyx_n_u_tdp __pyx_string_tab[414]
#define __pyx_n_u_tdt __pyx_string_tab[415]
#define __pyx_n_u_test __pyx_string_tab[416]
#define __pyx_n_u_tf __pyx_string_tab[417]
#define __pyx_n_u_time0 __pyx_string_tab[418]
#define __pyx_n_u_time0ret __pyx_string_tab[419]
#define __pyx_n_u_timeDependentBC __pyx_string_tab[420]
#define __pyx_n_u_timeDependentForcing __pyx_string_tab[421]
#define __pyx_n_u_timeStep __pyx_string_tab[422]
#define __pyx_n_u_timeStepPost __pyx_string_tab[423]
#define __pyx_n_u_timer __pyx_string_tab[424]
#define __pyx_n_u_tmm4py_tmm4py_core __pyx_string_tab[425]
#define __pyx_kp_u_tmm4py_tmm4py_core_pyx __pyx_string_tab[426]
#define __pyx_n_u_tot __pyx_string_tab[427]
#define __pyx_n_u_totalNumProfiles __pyx_string_tab[428]
#define __pyx_n_u_tracer __pyx_string_tab[429]
#define __pyx_n_u_tracer_names __pyx_string_tab[430]
#define __pyx_n_u_typ __pyx_string_tab[431]
#define __pyx_n_u_update __pyx_string_tab[432]
#define __pyx_n_u_updateTMs __pyx_string_tab[433]
#define __pyx_n_u_useExternalForcing __pyx_string_tab[434]
#define __pyx_n_u_useForcingFromFile __pyx_string_tab[435]
#define __pyx_n_u_useMonitor __pyx_string_tab[436]
#define __pyx_n_u_usePrescribedBC __pyx_string_tab[437]
#define __pyx_n_u_useProfiles __pyx_string_tab[438]
#define __pyx_n_u_val __pyx_string_tab[439]
#define __pyx_n_u_view __pyx_string_tab[440]
#define __pyx_n_u_viewer __pyx_string_tab[441]
#define __pyx_n_u_warnings __pyx_string_tab[442]
#define __pyx_kp_u_when_loading __pyx_string_tab[443]
#define __pyx_n_u_writeArrayToVec __pyx_string_tab[444]
#define __pyx_n_u_writeBinaryArray __pyx_string_tab[445]
#define __pyx_n_u_writeCalcBCFn __pyx_string_tab[446]
#define __pyx_n_u_writeExternalForcingFn __pyx_string_tab[447]
#define __pyx_n_u_writeMisfitFn __pyx_string_tab[448]
#define __pyx_n_u_writeMonitorFn __pyx_string_tab[449]
#define __pyx_n_u_writePickup __pyx_string_tab[450]
#define __pyx_n_u_writeProfileScalarData __pyx_string_tab[451]
#define __pyx_n_u_x __pyx_string_tab[452]
#define __pyx_n_u_xarr __pyx_string_tab[453]
#define __pyx_kp_u_xarr_length __pyx_string_tab[454]
#define __pyx_kp_u_xarr_length_does_not_match_expec __pyx_string_tab[455]
#define __pyx_n_u_xc __pyx_string_tab[456]
#define __pyx_n_u_xdata_pointer __pyx_string_tab[457]
#define __pyx_n_u_y __pyx_string_tab[458]
#define __pyx_n_u_yarr __pyx_string_tab[459]
#define __pyx_kp_u_yarr_length_does_not_match_expec __pyx_string_tab[460]
#define __pyx_n_u_ydata_pointer __pyx_string_tab[461]
/* #### Code section: module_state_clear ### */
#if CYTHON_USE_MODULE_STATE
static CYTHON_SMALL_CODE int __pyx_m_clear(PyObject *m) {
  __pyx_mstatetype *clear_module_state = __Pyx_PyModule_GetState(m);
  if (!clear_module_state) return 0;
  Py_CLEAR(clear_module_state->__pyx_d);
  Py_CLEAR(clear_module_state->__pyx_b);
  Py_CLEAR(clear_module_state->__pyx_cython_runtime);
  Py_CLEAR(clear_module_state->__pyx_empty_tuple);
  Py_CLEAR(clear_module_state->__pyx_empty_bytes);
  Py_CLEAR(clear_module_state->__pyx_empty_unicode);
  #ifdef __Pyx_CyFunction_USED
  Py_CLEAR(clear_module_state->__pyx_CyFunctionType);
  #endif
  #ifdef __Pyx_FusedFunction_USED
  Py_CLEAR(clear_module_state->__pyx_FusedFunctionType);
  #endif
  #if CYTHON_PEP489_MULTI_PHASE_INIT
  __Pyx_State_RemoveModule(NULL);
  #endif
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_Comm);
  Py_CLEAR(clear_module_state->PyPetscComm_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_Object);
  Py_CLEAR(clear_module_state->PyPetscObject_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_Viewer);
  Py_CLEAR(clear_module_state->PyPetscViewer_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_Random);
  Py_CLEAR(clear_module_state->PyPetscRandom_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_Device);
  Py_CLEAR(clear_module_state->PyPetscDevice_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_DeviceContext);
  Py_CLEAR(clear_module_state->PyPetscDeviceContext_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_IS);
  Py_CLEAR(clear_module_state->PyPetscIS_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_LGMap);
  Py_CLEAR(clear_module_state->PyPetscLGMap_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_SF);
  Py_CLEAR(clear_module_state->PyPetscSF_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_Vec);
  Py_CLEAR(clear_module_state->PyPetscVec_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_Space);
  Py_CLEAR(clear_module_state->PyPetscSpace_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_DualSpace);
  Py_CLEAR(clear_module_state->PyPetscDualSpace_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_FE);
  Py_CLEAR(clear_module_state->PyPetscFE_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_Quad);
  Py_CLEAR(clear_module_state->PyPetscQuad_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_Scatter);
  Py_CLEAR(clear_module_state->PyPetscScatter_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_Section);
  Py_CLEAR(clear_module_state->PyPetscSection_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_Mat);
  Py_CLEAR(clear_module_state->PyPetscMat_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_MatPartitioning);
  Py_CLEAR(clear_module_state->PyPetscMatPartitioning_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_NullSpace);
  Py_CLEAR(clear_module_state->PyPetscNullSpace_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_PC);
  Py_CLEAR(clear_module_state->PyPetscPC_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_KSP);
  Py_CLEAR(clear_module_state->PyPetscKSP_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_SNES);
  Py_CLEAR(clear_module_state->PyPetscSNES_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_SNESLineSearch);
  Py_CLEAR(clear_module_state->PyPetscSNESLineSearch_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_TS);
  Py_CLEAR(clear_module_state->PyPetscTS_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_TAO);
  Py_CLEAR(clear_module_state->PyPetscTAO_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_TAOLineSearch);
  Py_CLEAR(clear_module_state->PyPetscTAOLineSearch_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_AO);
  Py_CLEAR(clear_module_state->PyPetscAO_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_DM);
  Py_CLEAR(clear_module_state->PyPetscDM_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_DMPlexTransform);
  Py_CLEAR(clear_module_state->PyPetscDMPlexTransform_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_CellDM);
  Py_CLEAR(clear_module_state->PyPetscDMSwarmCellDM_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_DS);
  Py_CLEAR(clear_module_state->PyPetscDS_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_Partitioner);
  Py_CLEAR(clear_module_state->PyPetscPartitioner_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_8petsc4py_5PETSc_DMLabel);
  Py_CLEAR(clear_module_state->PyPetscDMLabel_Type);
  Py_CLEAR(clear_module_state->__pyx_ptype_7cpython_4type_type);
  Py_CLEAR(clear_module_state->__pyx_ptype_7cpython_4bool_bool);
  Py_CLEAR(clear_module_state->__pyx_ptype_7cpython_7complex_complex);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_dtype);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_flatiter);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_broadcast);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_ndarray);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_generic);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_number);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_integer);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_signedinteger);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_unsignedinteger);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_inexact);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_floating);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_complexfloating);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_flexible);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_character);
  Py_CLEAR(clear_module_state->__pyx_ptype_5numpy_ufunc);
  Py_CLEAR(clear_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState);
  Py_CLEAR(clear_module_state->__pyx_type_6tmm4py_11tmm4py_core_TMMState);
  Py_CLEAR(clear_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer);
  Py_CLEAR(clear_module_state->__pyx_type_6tmm4py_11tmm4py_core_StepTimer);
  Py_CLEAR(clear_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer);
  Py_CLEAR(clear_module_state->__pyx_type_6tmm4py_11tmm4py_core_PeriodicTimer);
  Py_CLEAR(clear_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer);
  Py_CLEAR(clear_module_state->__pyx_type_6tmm4py_11tmm4py_core_TimeDependentTimer);
  Py_CLEAR(clear_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec);
  Py_CLEAR(clear_module_state->__pyx_type_6tmm4py_11tmm4py_core_PeriodicVec);
  Py_CLEAR(clear_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec);
  Py_CLEAR(clear_module_state->__pyx_type_6tmm4py_11tmm4py_core_TimeDependentVec);
  Py_CLEAR(clear_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray);
  Py_CLEAR(clear_module_state->__pyx_type_6tmm4py_11tmm4py_core_PeriodicArray);
  Py_CLEAR(clear_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray);
  Py_CLEAR(clear_module_state->__pyx_type_6tmm4py_11tmm4py_core_TimeDependentArray);
  Py_CLEAR(clear_module_state->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper);
  Py_CLEAR(clear_module_state->__pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapper);
  Py_CLEAR(clear_module_state->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel);
  Py_CLEAR(clear_module_state->__pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel);
  Py_CLEAR(clear_module_state->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper);
  Py_CLEAR(clear_module_state->__pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapper);
  Py_CLEAR(clear_module_state->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel);
  Py_CLEAR(clear_module_state->__pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel);
  for (int i=0; i<11; ++i) { Py_CLEAR(clear_module_state->__pyx_tuple[i]); }
  for (int i=0; i<116; ++i) { Py_CLEAR(clear_module_state->__pyx_codeobj_tab[i]); }
  for (int i=0; i<462; ++i) { Py_CLEAR(clear_module_state->__pyx_string_tab[i]); }
  Py_CLEAR(clear_module_state->__pyx_int_0);
  Py_CLEAR(clear_module_state->__pyx_int_1);
  Py_CLEAR(clear_module_state->__pyx_int_neg_1);
  return 0;
}
#endif
/* #### Code section: module_state_traverse ### */
#if CYTHON_USE_MODULE_STATE
static CYTHON_SMALL_CODE int __pyx_m_traverse(PyObject *m, visitproc visit, void *arg) {
  __pyx_mstatetype *traverse_module_state = __Pyx_PyModule_GetState(m);
  if (!traverse_module_state) return 0;
  Py_VISIT(traverse_module_state->__pyx_d);
  Py_VISIT(traverse_module_state->__pyx_b);
  Py_VISIT(traverse_module_state->__pyx_cython_runtime);
  __Pyx_VISIT_CONST(traverse_module_state->__pyx_empty_tuple);
  __Pyx_VISIT_CONST(traverse_module_state->__pyx_empty_bytes);
  __Pyx_VISIT_CONST(traverse_module_state->__pyx_empty_unicode);
  #ifdef __Pyx_CyFunction_USED
  Py_VISIT(traverse_module_state->__pyx_CyFunctionType);
  #endif
  #ifdef __Pyx_FusedFunction_USED
  Py_VISIT(traverse_module_state->__pyx_FusedFunctionType);
  #endif
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_Comm);
  Py_VISIT(traverse_module_state->PyPetscComm_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_Object);
  Py_VISIT(traverse_module_state->PyPetscObject_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_Viewer);
  Py_VISIT(traverse_module_state->PyPetscViewer_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_Random);
  Py_VISIT(traverse_module_state->PyPetscRandom_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_Device);
  Py_VISIT(traverse_module_state->PyPetscDevice_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_DeviceContext);
  Py_VISIT(traverse_module_state->PyPetscDeviceContext_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_IS);
  Py_VISIT(traverse_module_state->PyPetscIS_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_LGMap);
  Py_VISIT(traverse_module_state->PyPetscLGMap_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_SF);
  Py_VISIT(traverse_module_state->PyPetscSF_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_Vec);
  Py_VISIT(traverse_module_state->PyPetscVec_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_Space);
  Py_VISIT(traverse_module_state->PyPetscSpace_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_DualSpace);
  Py_VISIT(traverse_module_state->PyPetscDualSpace_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_FE);
  Py_VISIT(traverse_module_state->PyPetscFE_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_Quad);
  Py_VISIT(traverse_module_state->PyPetscQuad_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_Scatter);
  Py_VISIT(traverse_module_state->PyPetscScatter_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_Section);
  Py_VISIT(traverse_module_state->PyPetscSection_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_Mat);
  Py_VISIT(traverse_module_state->PyPetscMat_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_MatPartitioning);
  Py_VISIT(traverse_module_state->PyPetscMatPartitioning_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_NullSpace);
  Py_VISIT(traverse_module_state->PyPetscNullSpace_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_PC);
  Py_VISIT(traverse_module_state->PyPetscPC_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_KSP);
  Py_VISIT(traverse_module_state->PyPetscKSP_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_SNES);
  Py_VISIT(traverse_module_state->PyPetscSNES_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_SNESLineSearch);
  Py_VISIT(traverse_module_state->PyPetscSNESLineSearch_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_TS);
  Py_VISIT(traverse_module_state->PyPetscTS_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_TAO);
  Py_VISIT(traverse_module_state->PyPetscTAO_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_TAOLineSearch);
  Py_VISIT(traverse_module_state->PyPetscTAOLineSearch_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_AO);
  Py_VISIT(traverse_module_state->PyPetscAO_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_DM);
  Py_VISIT(traverse_module_state->PyPetscDM_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_DMPlexTransform);
  Py_VISIT(traverse_module_state->PyPetscDMPlexTransform_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_CellDM);
  Py_VISIT(traverse_module_state->PyPetscDMSwarmCellDM_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_DS);
  Py_VISIT(traverse_module_state->PyPetscDS_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_Partitioner);
  Py_VISIT(traverse_module_state->PyPetscPartitioner_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_8petsc4py_5PETSc_DMLabel);
  Py_VISIT(traverse_module_state->PyPetscDMLabel_Type);
  Py_VISIT(traverse_module_state->__pyx_ptype_7cpython_4type_type);
  Py_VISIT(traverse_module_state->__pyx_ptype_7cpython_4bool_bool);
  Py_VISIT(traverse_module_state->__pyx_ptype_7cpython_7complex_complex);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_dtype);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_flatiter);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_broadcast);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_ndarray);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_generic);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_number);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_integer);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_signedinteger);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_unsignedinteger);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_inexact);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_floating);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_complexfloating);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_flexible);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_character);
  Py_VISIT(traverse_module_state->__pyx_ptype_5numpy_ufunc);
  Py_VISIT(traverse_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState);
  Py_VISIT(traverse_module_state->__pyx_type_6tmm4py_11tmm4py_core_TMMState);
  Py_VISIT(traverse_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer);
  Py_VISIT(traverse_module_state->__pyx_type_6tmm4py_11tmm4py_core_StepTimer);
  Py_VISIT(traverse_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer);
  Py_VISIT(traverse_module_state->__pyx_type_6tmm4py_11tmm4py_core_PeriodicTimer);
  Py_VISIT(traverse_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer);
  Py_VISIT(traverse_module_state->__pyx_type_6tmm4py_11tmm4py_core_TimeDependentTimer);
  Py_VISIT(traverse_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec);
  Py_VISIT(traverse_module_state->__pyx_type_6tmm4py_11tmm4py_core_PeriodicVec);
  Py_VISIT(traverse_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec);
  Py_VISIT(traverse_module_state->__pyx_type_6tmm4py_11tmm4py_core_TimeDependentVec);
  Py_VISIT(traverse_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray);
  Py_VISIT(traverse_module_state->__pyx_type_6tmm4py_11tmm4py_core_PeriodicArray);
  Py_VISIT(traverse_module_state->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray);
  Py_VISIT(traverse_module_state->__pyx_type_6tmm4py_11tmm4py_core_TimeDependentArray);
  Py_VISIT(traverse_module_state->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper);
  Py_VISIT(traverse_module_state->__pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapper);
  Py_VISIT(traverse_module_state->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel);
  Py_VISIT(traverse_module_state->__pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel);
  Py_VISIT(traverse_module_state->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper);
  Py_VISIT(traverse_module_state->__pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapper);
  Py_VISIT(traverse_module_state->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel);
  Py_VISIT(traverse_module_state->__pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel);
  for (int i=0; i<11; ++i) { __Pyx_VISIT_CONST(traverse_module_state->__pyx_tuple[i]); }
  for (int i=0; i<116; ++i) { __Pyx_VISIT_CONST(traverse_module_state->__pyx_codeobj_tab[i]); }
  for (int i=0; i<462; ++i) { __Pyx_VISIT_CONST(traverse_module_state->__pyx_string_tab[i]); }
  __Pyx_VISIT_CONST(traverse_module_state->__pyx_int_0);
  __Pyx_VISIT_CONST(traverse_module_state->__pyx_int_1);
  __Pyx_VISIT_CONST(traverse_module_state->__pyx_int_neg_1);
  return 0;
}
#endif
/* #### Code section: module_code ### */

/* "tmm4py/tmm4py_core.pxd":207
 * # couldn't get those to work.
 * # Public definitions (for cimport into other extension modules)
 * cdef inline object toBool(PetscBool value):             # <<<<<<<<<<<<<<
 *     return True if value else False
 * 
*/

static CYTHON_INLINE PyObject *__pyx_f_6tmm4py_11tmm4py_core_toBool(PetscBool __pyx_v_value) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("toBool", 0);

  /* "tmm4py/tmm4py_core.pxd":208
 * # Public definitions (for cimport into other extension modules)
 * cdef inline object toBool(PetscBool value):
 *     return True if value else False             # <<<<<<<<<<<<<<
 * 
 * cdef inline PetscBool asBool(object value) except? <PetscBool>0:
*/
  __Pyx_XDECREF(__pyx_r);
  if (__pyx_v_value) {
    __Pyx_INCREF(Py_True);
    __pyx_t_1 = Py_True;
  } else {
    __Pyx_INCREF(Py_False);
    __pyx_t_1 = Py_False;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pxd":207
 * # couldn't get those to work.
 * # Public definitions (for cimport into other extension modules)
 * cdef inline object toBool(PetscBool value):             # <<<<<<<<<<<<<<
 *     return True if value else False
 * 
*/

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":210
 *     return True if value else False
 * 
 * cdef inline PetscBool asBool(object value) except? <PetscBool>0:             # <<<<<<<<<<<<<<
 *     return PETSC_TRUE if value else PETSC_FALSE
 * 
*/

static CYTHON_INLINE PetscBool __pyx_f_6tmm4py_11tmm4py_core_asBool(PyObject *__pyx_v_value) {
  PetscBool __pyx_r;
  PetscBool __pyx_t_1;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* "tmm4py/tmm4py_core.pxd":211
 * 
 * cdef inline PetscBool asBool(object value) except? <PetscBool>0:
 *     return PETSC_TRUE if value else PETSC_FALSE             # <<<<<<<<<<<<<<
 * 
 * cdef inline object toInt(PetscInt value):
*/
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_value); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(2, 211, __pyx_L1_error)
  if (__pyx_t_2) {
    __pyx_t_1 = PETSC_TRUE;
  } else {
    __pyx_t_1 = PETSC_FALSE;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pxd":210
 *     return True if value else False
 * 
 * cdef inline PetscBool asBool(object value) except? <PetscBool>0:             # <<<<<<<<<<<<<<
 *     return PETSC_TRUE if value else PETSC_FALSE
 * 
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.asBool", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = ((PetscBool)0);
  __pyx_L0:;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":213
 *     return PETSC_TRUE if value else PETSC_FALSE
 * 
 * cdef inline object toInt(PetscInt value):             # <<<<<<<<<<<<<<
 *     return value
 * 
*/

static CYTHON_INLINE PyObject *__pyx_f_6tmm4py_11tmm4py_core_toInt(PetscInt __pyx_v_value) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("toInt", 0);

  /* "tmm4py/tmm4py_core.pxd":214
 * 
 * cdef inline object toInt(PetscInt value):
 *     return value             # <<<<<<<<<<<<<<
 * 
 * cdef inline PetscInt asInt(object value) except? -1:
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyLong_From_PetscInt(__pyx_v_value); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 214, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pxd":213
 *     return PETSC_TRUE if value else PETSC_FALSE
 * 
 * cdef inline object toInt(PetscInt value):             # <<<<<<<<<<<<<<
 *     return value
 * 
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.toInt", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":216
 *     return value
 * 
 * cdef inline PetscInt asInt(object value) except? -1:             # <<<<<<<<<<<<<<
 *     return value
 * 
*/

static CYTHON_INLINE PetscInt __pyx_f_6tmm4py_11tmm4py_core_asInt(PyObject *__pyx_v_value) {
  PetscInt __pyx_r;
  PetscInt __pyx_t_1;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* "tmm4py/tmm4py_core.pxd":217
 * 
 * cdef inline PetscInt asInt(object value) except? -1:
 *     return value             # <<<<<<<<<<<<<<
 * 
 * cdef inline object toReal(PetscReal value):
*/
  __pyx_t_1 = __Pyx_PyLong_As_PetscInt(__pyx_v_value); if (unlikely((__pyx_t_1 == ((PetscInt)-1)) && PyErr_Occurred())) __PYX_ERR(2, 217, __pyx_L1_error)
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pxd":216
 *     return value
 * 
 * cdef inline PetscInt asInt(object value) except? -1:             # <<<<<<<<<<<<<<
 *     return value
 * 
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.asInt", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":219
 *     return value
 * 
 * cdef inline object toReal(PetscReal value):             # <<<<<<<<<<<<<<
 *     return value
 * 
*/

static CYTHON_INLINE PyObject *__pyx_f_6tmm4py_11tmm4py_core_toReal(PetscReal __pyx_v_value) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("toReal", 0);

  /* "tmm4py/tmm4py_core.pxd":220
 * 
 * cdef inline object toReal(PetscReal value):
 *     return value             # <<<<<<<<<<<<<<
 * 
 * cdef inline PetscReal asReal(object value) except? -1:
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_value); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 220, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pxd":219
 *     return value
 * 
 * cdef inline object toReal(PetscReal value):             # <<<<<<<<<<<<<<
 *     return value
 * 
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.toReal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":222
 *     return value
 * 
 * cdef inline PetscReal asReal(object value) except? -1:             # <<<<<<<<<<<<<<
 *     return value
 * 
*/

static CYTHON_INLINE PetscReal __pyx_f_6tmm4py_11tmm4py_core_asReal(PyObject *__pyx_v_value) {
  PetscReal __pyx_r;
  PetscReal __pyx_t_1;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* "tmm4py/tmm4py_core.pxd":223
 * 
 * cdef inline PetscReal asReal(object value) except? -1:
 *     return value             # <<<<<<<<<<<<<<
 * 
 * # Public functions (for cimport into other extension modules)
*/
  __pyx_t_1 = __Pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely((__pyx_t_1 == ((PetscReal)-1)) && PyErr_Occurred())) __PYX_ERR(2, 223, __pyx_L1_error)
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pxd":222
 *     return value
 * 
 * cdef inline PetscReal asReal(object value) except? -1:             # <<<<<<<<<<<<<<
 *     return value
 * 
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.asReal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1.0;
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":285
 *         cdef int type_num
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp itemsize(self) noexcept nogil:
 *             return PyDataType_ELSIZE(self)
*/

static CYTHON_INLINE npy_intp __pyx_f_5numpy_5dtype_8itemsize_itemsize(PyArray_Descr *__pyx_v_self) {
  npy_intp __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":287
 *         @property
 *         cdef inline npy_intp itemsize(self) noexcept nogil:
 *             return PyDataType_ELSIZE(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __pyx_r = PyDataType_ELSIZE(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":285
 *         cdef int type_num
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp itemsize(self) noexcept nogil:
 *             return PyDataType_ELSIZE(self)
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":289
 *             return PyDataType_ELSIZE(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp alignment(self) noexcept nogil:
 *             return PyDataType_ALIGNMENT(self)
*/

static CYTHON_INLINE npy_intp __pyx_f_5numpy_5dtype_9alignment_alignment(PyArray_Descr *__pyx_v_self) {
  npy_intp __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":291
 *         @property
 *         cdef inline npy_intp alignment(self) noexcept nogil:
 *             return PyDataType_ALIGNMENT(self)             # <<<<<<<<<<<<<<
 * 
 *         # Use fields/names with care as they may be NULL.  You must check
*/
  __pyx_r = PyDataType_ALIGNMENT(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":289
 *             return PyDataType_ELSIZE(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp alignment(self) noexcept nogil:
 *             return PyDataType_ALIGNMENT(self)
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":295
 *         # Use fields/names with care as they may be NULL.  You must check
 *         # for this using PyDataType_HASFIELDS.
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline object fields(self):
 *             return <object>PyDataType_FIELDS(self)
*/

static CYTHON_INLINE PyObject *__pyx_f_5numpy_5dtype_6fields_fields(PyArray_Descr *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1;
  __Pyx_RefNannySetupContext("fields", 0);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":297
 *         @property
 *         cdef inline object fields(self):
 *             return <object>PyDataType_FIELDS(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyDataType_FIELDS(__pyx_v_self);
  __Pyx_INCREF(((PyObject *)__pyx_t_1));
  __pyx_r = ((PyObject *)__pyx_t_1);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":295
 *         # Use fields/names with care as they may be NULL.  You must check
 *         # for this using PyDataType_HASFIELDS.
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline object fields(self):
 *             return <object>PyDataType_FIELDS(self)
*/

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":299
 *             return <object>PyDataType_FIELDS(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline tuple names(self):
 *             return <tuple>PyDataType_NAMES(self)
*/

static CYTHON_INLINE PyObject *__pyx_f_5numpy_5dtype_5names_names(PyArray_Descr *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1;
  __Pyx_RefNannySetupContext("names", 0);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":301
 *         @property
 *         cdef inline tuple names(self):
 *             return <tuple>PyDataType_NAMES(self)             # <<<<<<<<<<<<<<
 * 
 *         # Use PyDataType_HASSUBARRAY to test whether this field is
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyDataType_NAMES(__pyx_v_self);
  __Pyx_INCREF(((PyObject*)__pyx_t_1));
  __pyx_r = ((PyObject*)__pyx_t_1);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":299
 *             return <object>PyDataType_FIELDS(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline tuple names(self):
 *             return <tuple>PyDataType_NAMES(self)
*/

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":306
 *         # valid (the pointer can be NULL). Most users should access
 *         # this field via the inline helper method PyDataType_SHAPE.
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline PyArray_ArrayDescr* subarray(self) noexcept nogil:
 *             return PyDataType_SUBARRAY(self)
*/

static CYTHON_INLINE PyArray_ArrayDescr *__pyx_f_5numpy_5dtype_8subarray_subarray(PyArray_Descr *__pyx_v_self) {
  PyArray_ArrayDescr *__pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":308
 *         @property
 *         cdef inline PyArray_ArrayDescr* subarray(self) noexcept nogil:
 *             return PyDataType_SUBARRAY(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __pyx_r = PyDataType_SUBARRAY(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":306
 *         # valid (the pointer can be NULL). Most users should access
 *         # this field via the inline helper method PyDataType_SHAPE.
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline PyArray_ArrayDescr* subarray(self) noexcept nogil:
 *             return PyDataType_SUBARRAY(self)
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":310
 *             return PyDataType_SUBARRAY(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_uint64 flags(self) noexcept nogil:
 *             """The data types flags."""
*/

static CYTHON_INLINE npy_uint64 __pyx_f_5numpy_5dtype_5flags_flags(PyArray_Descr *__pyx_v_self) {
  npy_uint64 __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":313
 *         cdef inline npy_uint64 flags(self) noexcept nogil:
 *             """The data types flags."""
 *             return PyDataType_FLAGS(self)             # <<<<<<<<<<<<<<
 * 
 * 
*/
  __pyx_r = PyDataType_FLAGS(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":310
 *             return PyDataType_SUBARRAY(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_uint64 flags(self) noexcept nogil:
 *             """The data types flags."""
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":322
 *     ctypedef class numpy.broadcast [object PyArrayMultiIterObject, check_size ignore]:
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline int numiter(self) noexcept nogil:
 *             """The number of arrays that need to be broadcast to the same shape."""
*/

static CYTHON_INLINE int __pyx_f_5numpy_9broadcast_7numiter_numiter(PyArrayMultiIterObject *__pyx_v_self) {
  int __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":325
 *         cdef inline int numiter(self) noexcept nogil:
 *             """The number of arrays that need to be broadcast to the same shape."""
 *             return PyArray_MultiIter_NUMITER(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __pyx_r = PyArray_MultiIter_NUMITER(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":322
 *     ctypedef class numpy.broadcast [object PyArrayMultiIterObject, check_size ignore]:
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline int numiter(self) noexcept nogil:
 *             """The number of arrays that need to be broadcast to the same shape."""
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":327
 *             return PyArray_MultiIter_NUMITER(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp size(self) noexcept nogil:
 *             """The total broadcasted size."""
*/

static CYTHON_INLINE npy_intp __pyx_f_5numpy_9broadcast_4size_size(PyArrayMultiIterObject *__pyx_v_self) {
  npy_intp __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":330
 *         cdef inline npy_intp size(self) noexcept nogil:
 *             """The total broadcasted size."""
 *             return PyArray_MultiIter_SIZE(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __pyx_r = PyArray_MultiIter_SIZE(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":327
 *             return PyArray_MultiIter_NUMITER(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp size(self) noexcept nogil:
 *             """The total broadcasted size."""
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":332
 *             return PyArray_MultiIter_SIZE(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp index(self) noexcept nogil:
 *             """The current (1-d) index into the broadcasted result."""
*/

static CYTHON_INLINE npy_intp __pyx_f_5numpy_9broadcast_5index_index(PyArrayMultiIterObject *__pyx_v_self) {
  npy_intp __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":335
 *         cdef inline npy_intp index(self) noexcept nogil:
 *             """The current (1-d) index into the broadcasted result."""
 *             return PyArray_MultiIter_INDEX(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __pyx_r = PyArray_MultiIter_INDEX(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":332
 *             return PyArray_MultiIter_SIZE(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp index(self) noexcept nogil:
 *             """The current (1-d) index into the broadcasted result."""
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":337
 *             return PyArray_MultiIter_INDEX(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline int nd(self) noexcept nogil:
 *             """The number of dimensions in the broadcasted result."""
*/

static CYTHON_INLINE int __pyx_f_5numpy_9broadcast_2nd_nd(PyArrayMultiIterObject *__pyx_v_self) {
  int __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":340
 *         cdef inline int nd(self) noexcept nogil:
 *             """The number of dimensions in the broadcasted result."""
 *             return PyArray_MultiIter_NDIM(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __pyx_r = PyArray_MultiIter_NDIM(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":337
 *             return PyArray_MultiIter_INDEX(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline int nd(self) noexcept nogil:
 *             """The number of dimensions in the broadcasted result."""
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":342
 *             return PyArray_MultiIter_NDIM(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp* dimensions(self) noexcept nogil:
 *             """The shape of the broadcasted result."""
*/

static CYTHON_INLINE npy_intp *__pyx_f_5numpy_9broadcast_10dimensions_dimensions(PyArrayMultiIterObject *__pyx_v_self) {
  npy_intp *__pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":345
 *         cdef inline npy_intp* dimensions(self) noexcept nogil:
 *             """The shape of the broadcasted result."""
 *             return PyArray_MultiIter_DIMS(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __pyx_r = PyArray_MultiIter_DIMS(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":342
 *             return PyArray_MultiIter_NDIM(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp* dimensions(self) noexcept nogil:
 *             """The shape of the broadcasted result."""
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":347
 *             return PyArray_MultiIter_DIMS(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline void** iters(self) noexcept nogil:
 *             """An array of iterator objects that holds the iterators for the arrays to be broadcast together.
*/

static CYTHON_INLINE void **__pyx_f_5numpy_9broadcast_5iters_iters(PyArrayMultiIterObject *__pyx_v_self) {
  void **__pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":351
 *             """An array of iterator objects that holds the iterators for the arrays to be broadcast together.
 *             On return, the iterators are adjusted for broadcasting."""
 *             return PyArray_MultiIter_ITERS(self)             # <<<<<<<<<<<<<<
 * 
 * 
*/
  __pyx_r = PyArray_MultiIter_ITERS(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":347
 *             return PyArray_MultiIter_DIMS(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline void** iters(self) noexcept nogil:
 *             """An array of iterator objects that holds the iterators for the arrays to be broadcast together.
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":365
 *         # Instead, we use properties that map to the corresponding C-API functions.
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline PyObject* base(self) noexcept nogil:
 *             """Returns a borrowed reference to the object owning the data/memory.
*/

static CYTHON_INLINE PyObject *__pyx_f_5numpy_7ndarray_4base_base(PyArrayObject *__pyx_v_self) {
  PyObject *__pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":369
 *             """Returns a borrowed reference to the object owning the data/memory.
 *             """
 *             return PyArray_BASE(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __pyx_r = PyArray_BASE(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":365
 *         # Instead, we use properties that map to the corresponding C-API functions.
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline PyObject* base(self) noexcept nogil:
 *             """Returns a borrowed reference to the object owning the data/memory.
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":371
 *             return PyArray_BASE(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline dtype descr(self):
 *             """Returns an owned reference to the dtype of the array.
*/

static CYTHON_INLINE PyArray_Descr *__pyx_f_5numpy_7ndarray_5descr_descr(PyArrayObject *__pyx_v_self) {
  PyArray_Descr *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyArray_Descr *__pyx_t_1;
  __Pyx_RefNannySetupContext("descr", 0);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":375
 *             """Returns an owned reference to the dtype of the array.
 *             """
 *             return <dtype>PyArray_DESCR(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __Pyx_XDECREF((PyObject *)__pyx_r);
  __pyx_t_1 = PyArray_DESCR(__pyx_v_self);
  __Pyx_INCREF((PyObject *)((PyArray_Descr *)__pyx_t_1));
  __pyx_r = ((PyArray_Descr *)__pyx_t_1);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":371
 *             return PyArray_BASE(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline dtype descr(self):
 *             """Returns an owned reference to the dtype of the array.
*/

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF((PyObject *)__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":377
 *             return <dtype>PyArray_DESCR(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline int ndim(self) noexcept nogil:
 *             """Returns the number of dimensions in the array.
*/

static CYTHON_INLINE int __pyx_f_5numpy_7ndarray_4ndim_ndim(PyArrayObject *__pyx_v_self) {
  int __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":381
 *             """Returns the number of dimensions in the array.
 *             """
 *             return PyArray_NDIM(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __pyx_r = PyArray_NDIM(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":377
 *             return <dtype>PyArray_DESCR(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline int ndim(self) noexcept nogil:
 *             """Returns the number of dimensions in the array.
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":383
 *             return PyArray_NDIM(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp *shape(self) noexcept nogil:
 *             """Returns a pointer to the dimensions/shape of the array.
*/

static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_5shape_shape(PyArrayObject *__pyx_v_self) {
  npy_intp *__pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":389
 *             Can return NULL for 0-dimensional arrays.
 *             """
 *             return PyArray_DIMS(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __pyx_r = PyArray_DIMS(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":383
 *             return PyArray_NDIM(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp *shape(self) noexcept nogil:
 *             """Returns a pointer to the dimensions/shape of the array.
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":391
 *             return PyArray_DIMS(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp *strides(self) noexcept nogil:
 *             """Returns a pointer to the strides of the array.
*/

static CYTHON_INLINE npy_intp *__pyx_f_5numpy_7ndarray_7strides_strides(PyArrayObject *__pyx_v_self) {
  npy_intp *__pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":396
 *             The number of elements matches the number of dimensions of the array (ndim).
 *             """
 *             return PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __pyx_r = PyArray_STRIDES(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":391
 *             return PyArray_DIMS(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp *strides(self) noexcept nogil:
 *             """Returns a pointer to the strides of the array.
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":398
 *             return PyArray_STRIDES(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp size(self) noexcept nogil:
 *             """Returns the total size (in number of elements) of the array.
*/

static CYTHON_INLINE npy_intp __pyx_f_5numpy_7ndarray_4size_size(PyArrayObject *__pyx_v_self) {
  npy_intp __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":402
 *             """Returns the total size (in number of elements) of the array.
 *             """
 *             return PyArray_SIZE(self)             # <<<<<<<<<<<<<<
 * 
 *         @property
*/
  __pyx_r = PyArray_SIZE(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":398
 *             return PyArray_STRIDES(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline npy_intp size(self) noexcept nogil:
 *             """Returns the total size (in number of elements) of the array.
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":404
 *             return PyArray_SIZE(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline char* data(self) noexcept nogil:
 *             """The pointer to the data buffer as a char*.
*/

static CYTHON_INLINE char *__pyx_f_5numpy_7ndarray_4data_data(PyArrayObject *__pyx_v_self) {
  char *__pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":411
 *             of `PyArray_DATA()` instead, which returns a 'void*'.
 *             """
 *             return PyArray_BYTES(self)             # <<<<<<<<<<<<<<
 * 
 * 
*/
  __pyx_r = PyArray_BYTES(__pyx_v_self);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":404
 *             return PyArray_SIZE(self)
 * 
 *         @property             # <<<<<<<<<<<<<<
 *         cdef inline char* data(self) noexcept nogil:
 *             """The pointer to the data buffer as a char*.
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":807
 * ctypedef long double complex clongdouble_t
 * 
 * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(1, <void*>a)
 * 
*/

static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew1(PyObject *__pyx_v_a) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":808
 * 
 * cdef inline object PyArray_MultiIterNew1(a):
 *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
 * 
 * cdef inline object PyArray_MultiIterNew2(a, b):
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 808, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":807
 * ctypedef long double complex clongdouble_t
 * 
 * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(1, <void*>a)
 * 
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":810
 *     return PyArray_MultiIterNew(1, <void*>a)
 * 
 * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
 * 
*/

static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew2(PyObject *__pyx_v_a, PyObject *__pyx_v_b) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":811
 * 
 * cdef inline object PyArray_MultiIterNew2(a, b):
 *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
 * 
 * cdef inline object PyArray_MultiIterNew3(a, b, c):
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 811, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":810
 *     return PyArray_MultiIterNew(1, <void*>a)
 * 
 * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
 * 
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":813
 *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
 * 
 * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
 * 
*/

static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew3(PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_c) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":814
 * 
 * cdef inline object PyArray_MultiIterNew3(a, b, c):
 *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
 * 
 * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 814, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":813
 *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
 * 
 * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
 * 
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew3", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":816
 *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
 * 
 * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
 * 
*/

static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew4(PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_c, PyObject *__pyx_v_d) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":817
 * 
 * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
 *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
 * 
 * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 817, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":816
 *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
 * 
 * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
 * 
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew4", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":819
 *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
 * 
 * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
 * 
*/

static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew5(PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_c, PyObject *__pyx_v_d, PyObject *__pyx_v_e) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":820
 * 
 * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
 *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
 * 
 * cdef inline tuple PyDataType_SHAPE(dtype d):
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 820, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":819
 *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
 * 
 * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
 * 
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew5", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":822
 *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
 * 
 * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
 *     if PyDataType_HASSUBARRAY(d):
 *         return <tuple>d.subarray.shape
*/

static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2;
  __Pyx_RefNannySetupContext("PyDataType_SHAPE", 0);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":823
 * 
 * cdef inline tuple PyDataType_SHAPE(dtype d):
 *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
 *         return <tuple>d.subarray.shape
 *     else:
*/
  __pyx_t_1 = PyDataType_HASSUBARRAY(__pyx_v_d);
  if (__pyx_t_1) {

    /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":824
 * cdef inline tuple PyDataType_SHAPE(dtype d):
 *     if PyDataType_HASSUBARRAY(d):
 *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
 *     else:
 *         return ()
*/
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __pyx_f_5numpy_5dtype_8subarray_subarray(__pyx_v_d)->shape;
    __Pyx_INCREF(((PyObject*)__pyx_t_2));
    __pyx_r = ((PyObject*)__pyx_t_2);
    goto __pyx_L0;

    /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":823
 * 
 * cdef inline tuple PyDataType_SHAPE(dtype d):
 *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
 *         return <tuple>d.subarray.shape
 *     else:
*/
  }

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":826
 *         return <tuple>d.subarray.shape
 *     else:
 *         return ()             # <<<<<<<<<<<<<<
 * 
 * 
*/
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_mstate_global->__pyx_empty_tuple);
    __pyx_r = __pyx_mstate_global->__pyx_empty_tuple;
    goto __pyx_L0;
  }

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":822
 *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
 * 
 * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
 *     if PyDataType_HASSUBARRAY(d):
 *         return <tuple>d.subarray.shape
*/

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1010
 *     int _import_umath() except -1
 * 
 * cdef inline void set_array_base(ndarray arr, object base) except *:             # <<<<<<<<<<<<<<
 *     Py_INCREF(base) # important to do this before stealing the reference below!
 *     PyArray_SetBaseObject(arr, base)
*/

static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
  int __pyx_t_1;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1011
 * 
 * cdef inline void set_array_base(ndarray arr, object base) except *:
 *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
 *     PyArray_SetBaseObject(arr, base)
 * 
*/
  Py_INCREF(__pyx_v_base);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1012
 * cdef inline void set_array_base(ndarray arr, object base) except *:
 *     Py_INCREF(base) # important to do this before stealing the reference below!
 *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
 * 
 * cdef inline object get_array_base(ndarray arr):
*/
  __pyx_t_1 = PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(3, 1012, __pyx_L1_error)

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1010
 *     int _import_umath() except -1
 * 
 * cdef inline void set_array_base(ndarray arr, object base) except *:             # <<<<<<<<<<<<<<
 *     Py_INCREF(base) # important to do this before stealing the reference below!
 *     PyArray_SetBaseObject(arr, base)
*/

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("numpy.set_array_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1014
 *     PyArray_SetBaseObject(arr, base)
 * 
 * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
 *     base = PyArray_BASE(arr)
 *     if base is NULL:
*/

static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
  PyObject *__pyx_v_base;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  __Pyx_RefNannySetupContext("get_array_base", 0);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1015
 * 
 * cdef inline object get_array_base(ndarray arr):
 *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
 *     if base is NULL:
 *         return None
*/
  __pyx_v_base = PyArray_BASE(__pyx_v_arr);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1016
 * cdef inline object get_array_base(ndarray arr):
 *     base = PyArray_BASE(arr)
 *     if base is NULL:             # <<<<<<<<<<<<<<
 *         return None
 *     return <object>base
*/
  __pyx_t_1 = (__pyx_v_base == NULL);
  if (__pyx_t_1) {

    /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1017
 *     base = PyArray_BASE(arr)
 *     if base is NULL:
 *         return None             # <<<<<<<<<<<<<<
 *     return <object>base
 * 
*/
    __Pyx_XDECREF(__pyx_r);
    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;

    /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1016
 * cdef inline object get_array_base(ndarray arr):
 *     base = PyArray_BASE(arr)
 *     if base is NULL:             # <<<<<<<<<<<<<<
 *         return None
 *     return <object>base
*/
  }

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1018
 *     if base is NULL:
 *         return None
 *     return <object>base             # <<<<<<<<<<<<<<
 * 
 * # Versions of the import_* functions which are more suitable for
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_base));
  __pyx_r = ((PyObject *)__pyx_v_base);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1014
 *     PyArray_SetBaseObject(arr, base)
 * 
 * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
 *     base = PyArray_BASE(arr)
 *     if base is NULL:
*/

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1022
 * # Versions of the import_* functions which are more suitable for
 * # Cython code.
 * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
 *     try:
 *         __pyx_import_array()
*/

static CYTHON_INLINE int __pyx_f_5numpy_import_array(void) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  size_t __pyx_t_11;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("import_array", 0);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1023
 * # Cython code.
 * cdef inline int import_array() except -1:
 *     try:             # <<<<<<<<<<<<<<
 *         __pyx_import_array()
 *     except Exception:
*/
  {
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
    __Pyx_XGOTREF(__pyx_t_1);
    __Pyx_XGOTREF(__pyx_t_2);
    __Pyx_XGOTREF(__pyx_t_3);
    /*try:*/ {

      /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1024
 * cdef inline int import_array() except -1:
 *     try:
 *         __pyx_import_array()             # <<<<<<<<<<<<<<
 *     except Exception:
 *         raise ImportError("numpy._core.multiarray failed to import")
*/
      __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(3, 1024, __pyx_L3_error)

      /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1023
 * # Cython code.
 * cdef inline int import_array() except -1:
 *     try:             # <<<<<<<<<<<<<<
 *         __pyx_import_array()
 *     except Exception:
*/
    }
    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L8_try_end;
    __pyx_L3_error:;

    /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1025
 *     try:
 *         __pyx_import_array()
 *     except Exception:             # <<<<<<<<<<<<<<
 *         raise ImportError("numpy._core.multiarray failed to import")
 * 
*/
    __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(((PyTypeObject*)PyExc_Exception))));
    if (__pyx_t_4) {
      __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(3, 1025, __pyx_L5_except_error)
      __Pyx_XGOTREF(__pyx_t_5);
      __Pyx_XGOTREF(__pyx_t_6);
      __Pyx_XGOTREF(__pyx_t_7);

      /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1026
 *         __pyx_import_array()
 *     except Exception:
 *         raise ImportError("numpy._core.multiarray failed to import")             # <<<<<<<<<<<<<<
 * 
 * cdef inline int import_umath() except -1:
*/
      __pyx_t_9 = NULL;
      __Pyx_INCREF(__pyx_builtin_ImportError);
      __pyx_t_10 = __pyx_builtin_ImportError; 
      __pyx_t_11 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_mstate_global->__pyx_kp_u_numpy__core_multiarray_failed_to};
        __pyx_t_8 = __Pyx_PyObject_FastCall(__pyx_t_10, __pyx_callargs+__pyx_t_11, (2-__pyx_t_11) | (__pyx_t_11*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_8)) __PYX_ERR(3, 1026, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_8);
      }
      __Pyx_Raise(__pyx_t_8, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __PYX_ERR(3, 1026, __pyx_L5_except_error)
    }
    goto __pyx_L5_except_error;

    /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1023
 * # Cython code.
 * cdef inline int import_array() except -1:
 *     try:             # <<<<<<<<<<<<<<
 *         __pyx_import_array()
 *     except Exception:
*/
    __pyx_L5_except_error:;
    __Pyx_XGIVEREF(__pyx_t_1);
    __Pyx_XGIVEREF(__pyx_t_2);
    __Pyx_XGIVEREF(__pyx_t_3);
    __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L1_error;
    __pyx_L8_try_end:;
  }

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1022
 * # Versions of the import_* functions which are more suitable for
 * # Cython code.
 * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
 *     try:
 *         __pyx_import_array()
*/

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1028
 *         raise ImportError("numpy._core.multiarray failed to import")
 * 
 * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
 *     try:
 *         _import_umath()
*/

static CYTHON_INLINE int __pyx_f_5numpy_import_umath(void) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  size_t __pyx_t_11;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("import_umath", 0);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1029
 * 
 * cdef inline int import_umath() except -1:
 *     try:             # <<<<<<<<<<<<<<
 *         _import_umath()
 *     except Exception:
*/
  {
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
    __Pyx_XGOTREF(__pyx_t_1);
    __Pyx_XGOTREF(__pyx_t_2);
    __Pyx_XGOTREF(__pyx_t_3);
    /*try:*/ {

      /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1030
 * cdef inline int import_umath() except -1:
 *     try:
 *         _import_umath()             # <<<<<<<<<<<<<<
 *     except Exception:
 *         raise ImportError("numpy._core.umath failed to import")
*/
      __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(3, 1030, __pyx_L3_error)

      /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1029
 * 
 * cdef inline int import_umath() except -1:
 *     try:             # <<<<<<<<<<<<<<
 *         _import_umath()
 *     except Exception:
*/
    }
    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L8_try_end;
    __pyx_L3_error:;

    /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1031
 *     try:
 *         _import_umath()
 *     except Exception:             # <<<<<<<<<<<<<<
 *         raise ImportError("numpy._core.umath failed to import")
 * 
*/
    __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(((PyTypeObject*)PyExc_Exception))));
    if (__pyx_t_4) {
      __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(3, 1031, __pyx_L5_except_error)
      __Pyx_XGOTREF(__pyx_t_5);
      __Pyx_XGOTREF(__pyx_t_6);
      __Pyx_XGOTREF(__pyx_t_7);

      /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1032
 *         _import_umath()
 *     except Exception:
 *         raise ImportError("numpy._core.umath failed to import")             # <<<<<<<<<<<<<<
 * 
 * cdef inline int import_ufunc() except -1:
*/
      __pyx_t_9 = NULL;
      __Pyx_INCREF(__pyx_builtin_ImportError);
      __pyx_t_10 = __pyx_builtin_ImportError; 
      __pyx_t_11 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_mstate_global->__pyx_kp_u_numpy__core_umath_failed_to_impo};
        __pyx_t_8 = __Pyx_PyObject_FastCall(__pyx_t_10, __pyx_callargs+__pyx_t_11, (2-__pyx_t_11) | (__pyx_t_11*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_8)) __PYX_ERR(3, 1032, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_8);
      }
      __Pyx_Raise(__pyx_t_8, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __PYX_ERR(3, 1032, __pyx_L5_except_error)
    }
    goto __pyx_L5_except_error;

    /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1029
 * 
 * cdef inline int import_umath() except -1:
 *     try:             # <<<<<<<<<<<<<<
 *         _import_umath()
 *     except Exception:
*/
    __pyx_L5_except_error:;
    __Pyx_XGIVEREF(__pyx_t_1);
    __Pyx_XGIVEREF(__pyx_t_2);
    __Pyx_XGIVEREF(__pyx_t_3);
    __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L1_error;
    __pyx_L8_try_end:;
  }

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1028
 *         raise ImportError("numpy._core.multiarray failed to import")
 * 
 * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
 *     try:
 *         _import_umath()
*/

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1034
 *         raise ImportError("numpy._core.umath failed to import")
 * 
 * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
 *     try:
 *         _import_umath()
*/

static CYTHON_INLINE int __pyx_f_5numpy_import_ufunc(void) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  size_t __pyx_t_11;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("import_ufunc", 0);

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1035
 * 
 * cdef inline int import_ufunc() except -1:
 *     try:             # <<<<<<<<<<<<<<
 *         _import_umath()
 *     except Exception:
*/
  {
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
    __Pyx_XGOTREF(__pyx_t_1);
    __Pyx_XGOTREF(__pyx_t_2);
    __Pyx_XGOTREF(__pyx_t_3);
    /*try:*/ {

      /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1036
 * cdef inline int import_ufunc() except -1:
 *     try:
 *         _import_umath()             # <<<<<<<<<<<<<<
 *     except Exception:
 *         raise ImportError("numpy._core.umath failed to import")
*/
      __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(3, 1036, __pyx_L3_error)

      /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1035
 * 
 * cdef inline int import_ufunc() except -1:
 *     try:             # <<<<<<<<<<<<<<
 *         _import_umath()
 *     except Exception:
*/
    }
    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L8_try_end;
    __pyx_L3_error:;

    /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1037
 *     try:
 *         _import_umath()
 *     except Exception:             # <<<<<<<<<<<<<<
 *         raise ImportError("numpy._core.umath failed to import")
 * 
*/
    __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(((PyTypeObject*)PyExc_Exception))));
    if (__pyx_t_4) {
      __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(3, 1037, __pyx_L5_except_error)
      __Pyx_XGOTREF(__pyx_t_5);
      __Pyx_XGOTREF(__pyx_t_6);
      __Pyx_XGOTREF(__pyx_t_7);

      /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1038
 *         _import_umath()
 *     except Exception:
 *         raise ImportError("numpy._core.umath failed to import")             # <<<<<<<<<<<<<<
 * 
 * 
*/
      __pyx_t_9 = NULL;
      __Pyx_INCREF(__pyx_builtin_ImportError);
      __pyx_t_10 = __pyx_builtin_ImportError; 
      __pyx_t_11 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_mstate_global->__pyx_kp_u_numpy__core_umath_failed_to_impo};
        __pyx_t_8 = __Pyx_PyObject_FastCall(__pyx_t_10, __pyx_callargs+__pyx_t_11, (2-__pyx_t_11) | (__pyx_t_11*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_8)) __PYX_ERR(3, 1038, __pyx_L5_except_error)
        __Pyx_GOTREF(__pyx_t_8);
      }
      __Pyx_Raise(__pyx_t_8, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __PYX_ERR(3, 1038, __pyx_L5_except_error)
    }
    goto __pyx_L5_except_error;

    /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1035
 * 
 * cdef inline int import_ufunc() except -1:
 *     try:             # <<<<<<<<<<<<<<
 *         _import_umath()
 *     except Exception:
*/
    __pyx_L5_except_error:;
    __Pyx_XGIVEREF(__pyx_t_1);
    __Pyx_XGIVEREF(__pyx_t_2);
    __Pyx_XGIVEREF(__pyx_t_3);
    __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L1_error;
    __pyx_L8_try_end:;
  }

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1034
 *         raise ImportError("numpy._core.umath failed to import")
 * 
 * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
 *     try:
 *         _import_umath()
*/

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1041
 * 
 * 
 * cdef inline bint is_timedelta64_object(object obj) noexcept:             # <<<<<<<<<<<<<<
 *     """
 *     Cython equivalent of `isinstance(obj, np.timedelta64)`
*/

static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
  int __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1053
 *     bool
 *     """
 *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
 * 
 * 
*/
  __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1041
 * 
 * 
 * cdef inline bint is_timedelta64_object(object obj) noexcept:             # <<<<<<<<<<<<<<
 *     """
 *     Cython equivalent of `isinstance(obj, np.timedelta64)`
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1056
 * 
 * 
 * cdef inline bint is_datetime64_object(object obj) noexcept:             # <<<<<<<<<<<<<<
 *     """
 *     Cython equivalent of `isinstance(obj, np.datetime64)`
*/

static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
  int __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1068
 *     bool
 *     """
 *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
 * 
 * 
*/
  __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1056
 * 
 * 
 * cdef inline bint is_datetime64_object(object obj) noexcept:             # <<<<<<<<<<<<<<
 *     """
 *     Cython equivalent of `isinstance(obj, np.datetime64)`
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1071
 * 
 * 
 * cdef inline npy_datetime get_datetime64_value(object obj) noexcept nogil:             # <<<<<<<<<<<<<<
 *     """
 *     returns the int64 value underlying scalar numpy datetime64 object
*/

static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
  npy_datetime __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1078
 *     also needed.  That can be found using `get_datetime64_unit`.
 *     """
 *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
 * 
 * 
*/
  __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1071
 * 
 * 
 * cdef inline npy_datetime get_datetime64_value(object obj) noexcept nogil:             # <<<<<<<<<<<<<<
 *     """
 *     returns the int64 value underlying scalar numpy datetime64 object
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1081
 * 
 * 
 * cdef inline npy_timedelta get_timedelta64_value(object obj) noexcept nogil:             # <<<<<<<<<<<<<<
 *     """
 *     returns the int64 value underlying scalar numpy timedelta64 object
*/

static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
  npy_timedelta __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1085
 *     returns the int64 value underlying scalar numpy timedelta64 object
 *     """
 *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
 * 
 * 
*/
  __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1081
 * 
 * 
 * cdef inline npy_timedelta get_timedelta64_value(object obj) noexcept nogil:             # <<<<<<<<<<<<<<
 *     """
 *     returns the int64 value underlying scalar numpy timedelta64 object
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1088
 * 
 * 
 * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) noexcept nogil:             # <<<<<<<<<<<<<<
 *     """
 *     returns the unit part of the dtype for a numpy datetime64 object.
*/

static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
  NPY_DATETIMEUNIT __pyx_r;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1092
 *     returns the unit part of the dtype for a numpy datetime64 object.
 *     """
 *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
 * 
 * 
*/
  __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
  goto __pyx_L0;

  /* "../../../../../../../private/var/folders/d3/w861tc0j755f19272xfkq56w0000gn/T/build-env-tx6juj22/lib/python3.9/site-packages/numpy/__init__.cython-30.pxd":1088
 * 
 * 
 * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) noexcept nogil:             # <<<<<<<<<<<<<<
 *     """
 *     returns the unit part of the dtype for a numpy datetime64 object.
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* "cpython/complex.pxd":20
 * 
 *         # unavailable in limited API
 *         @property             # <<<<<<<<<<<<<<
 *         @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")
 *         cdef inline double real(self) noexcept:
*/

#if !CYTHON_COMPILING_IN_LIMITED_API
static CYTHON_INLINE double __pyx_f_7cpython_7complex_7complex_4real_real(PyComplexObject *__pyx_v_self) {
  double __pyx_r;

  /* "cpython/complex.pxd":23
 *         @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")
 *         cdef inline double real(self) noexcept:
 *             return self.cval.real             # <<<<<<<<<<<<<<
 * 
 *         # unavailable in limited API
*/
  __pyx_r = __pyx_v_self->cval.real;
  goto __pyx_L0;

  /* "cpython/complex.pxd":20
 * 
 *         # unavailable in limited API
 *         @property             # <<<<<<<<<<<<<<
 *         @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")
 *         cdef inline double real(self) noexcept:
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
#endif /*!(#if !CYTHON_COMPILING_IN_LIMITED_API)*/

/* "cpython/complex.pxd":26
 * 
 *         # unavailable in limited API
 *         @property             # <<<<<<<<<<<<<<
 *         @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")
 *         cdef inline double imag(self) noexcept:
*/

#if !CYTHON_COMPILING_IN_LIMITED_API
static CYTHON_INLINE double __pyx_f_7cpython_7complex_7complex_4imag_imag(PyComplexObject *__pyx_v_self) {
  double __pyx_r;

  /* "cpython/complex.pxd":29
 *         @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")
 *         cdef inline double imag(self) noexcept:
 *             return self.cval.imag             # <<<<<<<<<<<<<<
 * 
 *     # PyTypeObject PyComplex_Type
*/
  __pyx_r = __pyx_v_self->cval.imag;
  goto __pyx_L0;

  /* "cpython/complex.pxd":26
 * 
 *         # unavailable in limited API
 *         @property             # <<<<<<<<<<<<<<
 *         @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")
 *         cdef inline double imag(self) noexcept:
*/

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
#endif /*!(#if !CYTHON_COMPILING_IN_LIMITED_API)*/

/* "cpython/contextvars.pxd":115
 * 
 * 
 * @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")             # <<<<<<<<<<<<<<
 * cdef inline object get_value(var, default_value=None):
 *     """Return a new reference to the value of the context variable,
*/

#if !CYTHON_COMPILING_IN_LIMITED_API
static CYTHON_INLINE PyObject *__pyx_f_7cpython_11contextvars_get_value(PyObject *__pyx_v_var, struct __pyx_opt_args_7cpython_11contextvars_get_value *__pyx_optional_args) {

  /* "cpython/contextvars.pxd":116
 * 
 * @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")
 * cdef inline object get_value(var, default_value=None):             # <<<<<<<<<<<<<<
 *     """Return a new reference to the value of the context variable,
 *     or the default value of the context variable,
*/
  PyObject *__pyx_v_default_value = ((PyObject *)Py_None);
  PyObject *__pyx_v_value;
  PyObject *__pyx_v_pyvalue = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("get_value", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args->__pyx_n > 0) {
      __pyx_v_default_value = __pyx_optional_args->default_value;
    }
  }

  /* "cpython/contextvars.pxd":121
 *     or None if no such value or default was found.
 *     """
 *     cdef PyObject *value = NULL             # <<<<<<<<<<<<<<
 *     PyContextVar_Get(var, NULL, &value)
 *     if value is NULL:
*/
  __pyx_v_value = NULL;

  /* "cpython/contextvars.pxd":122
 *     """
 *     cdef PyObject *value = NULL
 *     PyContextVar_Get(var, NULL, &value)             # <<<<<<<<<<<<<<
 *     if value is NULL:
 *         # context variable does not have a default
*/
  __pyx_t_1 = PyContextVar_Get(__pyx_v_var, NULL, (&__pyx_v_value)); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(4, 122, __pyx_L1_error)

  /* "cpython/contextvars.pxd":123
 *     cdef PyObject *value = NULL
 *     PyContextVar_Get(var, NULL, &value)
 *     if value is NULL:             # <<<<<<<<<<<<<<
 *         # context variable does not have a default
 *         pyvalue = default_value
*/
  __pyx_t_2 = (__pyx_v_value == NULL);
  if (__pyx_t_2) {

    /* "cpython/contextvars.pxd":125
 *     if value is NULL:
 *         # context variable does not have a default
 *         pyvalue = default_value             # <<<<<<<<<<<<<<
 *     else:
 *         # value or default value of context variable
*/
    __Pyx_INCREF(__pyx_v_default_value);
    __pyx_v_pyvalue = __pyx_v_default_value;

    /* "cpython/contextvars.pxd":123
 *     cdef PyObject *value = NULL
 *     PyContextVar_Get(var, NULL, &value)
 *     if value is NULL:             # <<<<<<<<<<<<<<
 *         # context variable does not have a default
 *         pyvalue = default_value
*/
    goto __pyx_L3;
  }

  /* "cpython/contextvars.pxd":128
 *     else:
 *         # value or default value of context variable
 *         pyvalue = <object>value             # <<<<<<<<<<<<<<
 *         Py_XDECREF(value)  # PyContextVar_Get() returned an owned reference as 'PyObject*'
 *     return pyvalue
*/
  /*else*/ {
    __pyx_t_3 = ((PyObject *)__pyx_v_value);
    __Pyx_INCREF(__pyx_t_3);
    __pyx_v_pyvalue = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "cpython/contextvars.pxd":129
 *         # value or default value of context variable
 *         pyvalue = <object>value
 *         Py_XDECREF(value)  # PyContextVar_Get() returned an owned reference as 'PyObject*'             # <<<<<<<<<<<<<<
 *     return pyvalue
 * 
*/
    Py_XDECREF(__pyx_v_value);
  }
  __pyx_L3:;

  /* "cpython/contextvars.pxd":130
 *         pyvalue = <object>value
 *         Py_XDECREF(value)  # PyContextVar_Get() returned an owned reference as 'PyObject*'
 *     return pyvalue             # <<<<<<<<<<<<<<
 * 
 * 
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_pyvalue);
  __pyx_r = __pyx_v_pyvalue;
  goto __pyx_L0;

  /* "cpython/contextvars.pxd":115
 * 
 * 
 * @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")             # <<<<<<<<<<<<<<
 * cdef inline object get_value(var, default_value=None):
 *     """Return a new reference to the value of the context variable,
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("cpython.contextvars.get_value", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_pyvalue);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if !CYTHON_COMPILING_IN_LIMITED_API)*/

/* "cpython/contextvars.pxd":133
 * 
 * 
 * @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")             # <<<<<<<<<<<<<<
 * cdef inline object get_value_no_default(var, default_value=None):
 *     """Return a new reference to the value of the context variable,
*/

#if !CYTHON_COMPILING_IN_LIMITED_API
static CYTHON_INLINE PyObject *__pyx_f_7cpython_11contextvars_get_value_no_default(PyObject *__pyx_v_var, struct __pyx_opt_args_7cpython_11contextvars_get_value_no_default *__pyx_optional_args) {

  /* "cpython/contextvars.pxd":134
 * 
 * @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")
 * cdef inline object get_value_no_default(var, default_value=None):             # <<<<<<<<<<<<<<
 *     """Return a new reference to the value of the context variable,
 *     or the provided default value if no such value was found.
*/
  PyObject *__pyx_v_default_value = ((PyObject *)Py_None);
  PyObject *__pyx_v_value;
  PyObject *__pyx_v_pyvalue = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("get_value_no_default", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args->__pyx_n > 0) {
      __pyx_v_default_value = __pyx_optional_args->default_value;
    }
  }

  /* "cpython/contextvars.pxd":140
 *     Ignores the default value of the context variable, if any.
 *     """
 *     cdef PyObject *value = NULL             # <<<<<<<<<<<<<<
 *     PyContextVar_Get(var, <PyObject*>default_value, &value)
 *     # value of context variable or 'default_value'
*/
  __pyx_v_value = NULL;

  /* "cpython/contextvars.pxd":141
 *     """
 *     cdef PyObject *value = NULL
 *     PyContextVar_Get(var, <PyObject*>default_value, &value)             # <<<<<<<<<<<<<<
 *     # value of context variable or 'default_value'
 *     pyvalue = <object>value
*/
  __pyx_t_1 = PyContextVar_Get(__pyx_v_var, ((PyObject *)__pyx_v_default_value), (&__pyx_v_value)); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(4, 141, __pyx_L1_error)

  /* "cpython/contextvars.pxd":143
 *     PyContextVar_Get(var, <PyObject*>default_value, &value)
 *     # value of context variable or 'default_value'
 *     pyvalue = <object>value             # <<<<<<<<<<<<<<
 *     Py_XDECREF(value)  # PyContextVar_Get() returned an owned reference as 'PyObject*'
 *     return pyvalue
*/
  __pyx_t_2 = ((PyObject *)__pyx_v_value);
  __Pyx_INCREF(__pyx_t_2);
  __pyx_v_pyvalue = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "cpython/contextvars.pxd":144
 *     # value of context variable or 'default_value'
 *     pyvalue = <object>value
 *     Py_XDECREF(value)  # PyContextVar_Get() returned an owned reference as 'PyObject*'             # <<<<<<<<<<<<<<
 *     return pyvalue
*/
  Py_XDECREF(__pyx_v_value);

  /* "cpython/contextvars.pxd":145
 *     pyvalue = <object>value
 *     Py_XDECREF(value)  # PyContextVar_Get() returned an owned reference as 'PyObject*'
 *     return pyvalue             # <<<<<<<<<<<<<<
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_pyvalue);
  __pyx_r = __pyx_v_pyvalue;
  goto __pyx_L0;

  /* "cpython/contextvars.pxd":133
 * 
 * 
 * @_cython.c_compile_guard("!CYTHON_COMPILING_IN_LIMITED_API")             # <<<<<<<<<<<<<<
 * cdef inline object get_value_no_default(var, default_value=None):
 *     """Return a new reference to the value of the context variable,
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("cpython.contextvars.get_value_no_default", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_pyvalue);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if !CYTHON_COMPILING_IN_LIMITED_API)*/

/* "tmm4py/tmm4py_core.pyx":210
 * # Note: the *args and **kwargs unpack a tuple and dict, respectively, into arguments that
 * # are passed to the python callback function.
 * cdef PetscErrorCode iniExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_iniExternalForcingCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iter, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("iniExternalForcingCB", 0);

  /* "tmm4py/tmm4py_core.pyx":211
 * # are passed to the python callback function.
 * cdef PetscErrorCode iniExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 211, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 211, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 211, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 211, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 211, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 211, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 211, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 211, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":212
 * cdef PetscErrorCode iniExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 212, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 212, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 212, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 212, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_State) != (0)) __PYX_ERR(0, 212, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 212, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 212, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_5 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 212, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 212, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  }
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 212, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "tmm4py/tmm4py_core.pyx":213
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode calcExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":210
 * # Note: the *args and **kwargs unpack a tuple and dict, respectively, into arguments that
 * # are passed to the python callback function.
 * cdef PetscErrorCode iniExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.iniExternalForcingCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":215
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode calcExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_calcExternalForcingCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iter, PetscInt __pyx_v_iLoop, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("calcExternalForcingCB", 0);

  /* "tmm4py/tmm4py_core.pyx":216
 * 
 * cdef PetscErrorCode calcExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 216, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 216, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 216, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 216, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 216, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 216, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 216, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 216, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 216, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":217
 * cdef PetscErrorCode calcExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 217, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 217, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_iLoop); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 217, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 217, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 217, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 217, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_4);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_4) != (0)) __PYX_ERR(0, 217, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_v_State) != (0)) __PYX_ERR(0, 217, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 217, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyNumber_Add(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 217, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 217, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_4 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 217, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
  } else {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 217, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
  }
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 217, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "tmm4py/tmm4py_core.pyx":218
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode wriExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":215
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode calcExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.calcExternalForcingCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":220
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode wriExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_wriExternalForcingCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iter, PetscInt __pyx_v_iLoop, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("wriExternalForcingCB", 0);

  /* "tmm4py/tmm4py_core.pyx":221
 * 
 * cdef PetscErrorCode wriExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 221, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 221, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 221, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 221, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 221, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 221, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 221, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 221, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 221, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":222
 * cdef PetscErrorCode wriExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_iLoop); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 222, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 222, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_4);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_4) != (0)) __PYX_ERR(0, 222, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_v_State) != (0)) __PYX_ERR(0, 222, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyNumber_Add(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 222, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_4 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 222, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
  } else {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 222, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
  }
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "tmm4py/tmm4py_core.pyx":223
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode finExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":220
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode wriExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.wriExternalForcingCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":225
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode finExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_finExternalForcingCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iter, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("finExternalForcingCB", 0);

  /* "tmm4py/tmm4py_core.pyx":226
 * 
 * cdef PetscErrorCode finExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 226, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 226, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 226, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 226, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 226, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 226, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 226, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 226, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":227
 * cdef PetscErrorCode finExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 227, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 227, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 227, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 227, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 227, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_State) != (0)) __PYX_ERR(0, 227, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 227, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 227, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 227, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_5 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 227, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 227, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  }
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 227, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "tmm4py/tmm4py_core.pyx":228
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode reiExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":225
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode finExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.finExternalForcingCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":230
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode reiExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_reiExternalForcingCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iter, PetscInt __pyx_v_iLoop, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("reiExternalForcingCB", 0);

  /* "tmm4py/tmm4py_core.pyx":231
 * 
 * cdef PetscErrorCode reiExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 231, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 231, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 231, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 231, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 231, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 231, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 231, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 231, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 231, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":232
 * cdef PetscErrorCode reiExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 232, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 232, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_iLoop); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 232, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 232, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 232, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 232, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_4);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_4) != (0)) __PYX_ERR(0, 232, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_v_State) != (0)) __PYX_ERR(0, 232, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 232, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyNumber_Add(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 232, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 232, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_4 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 232, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
  } else {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 232, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
  }
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 232, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "tmm4py/tmm4py_core.pyx":233
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode iniCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":230
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode reiExternalForcingCB(PetscScalar tc, PetscInt Iter, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), toInt(iLoop), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.reiExternalForcingCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":235
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode iniCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_iniCalcBCCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iterc, PetscScalar __pyx_v_tf, PetscInt __pyx_v_Iterf, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("iniCalcBCCB", 0);

  /* "tmm4py/tmm4py_core.pyx":236
 * 
 * cdef PetscErrorCode iniCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 236, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 236, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 236, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 236, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 236, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 236, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 236, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 236, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":237
 * cdef PetscErrorCode iniCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iterc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iterf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 237, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 237, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_4);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_4) != (0)) __PYX_ERR(0, 237, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_3);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_t_3) != (0)) __PYX_ERR(0, 237, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 4, __pyx_v_State) != (0)) __PYX_ERR(0, 237, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 237, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_3 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
  } else {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
  }
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":238
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode calcCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":235
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode iniCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.iniCalcBCCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":240
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode calcCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), toInt(iLoop), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_calcCalcBCCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iterc, PetscScalar __pyx_v_tf, PetscInt __pyx_v_Iterf, PetscInt __pyx_v_iLoop, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("calcCalcBCCB", 0);

  /* "tmm4py/tmm4py_core.pyx":241
 * 
 * cdef PetscErrorCode calcCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 241, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 241, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 241, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 241, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 241, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 241, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 241, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 241, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 241, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":242
 * cdef PetscErrorCode calcCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), toInt(iLoop), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iterc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 242, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 242, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iterf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 242, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_iLoop); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = PyTuple_New(6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 242, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 242, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 242, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_4);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_t_4) != (0)) __PYX_ERR(0, 242, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_3);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_6, 3, __pyx_t_3) != (0)) __PYX_ERR(0, 242, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_2);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_6, 4, __pyx_t_2) != (0)) __PYX_ERR(0, 242, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_6, 5, __pyx_v_State) != (0)) __PYX_ERR(0, 242, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyNumber_Add(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 242, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 242, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_2 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  } else {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  }
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 242, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":243
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode wriCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":240
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode calcCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), toInt(iLoop), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.calcCalcBCCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":245
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode wriCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toInt(iLoop), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_wriCalcBCCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iterc, PetscInt __pyx_v_iLoop, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("wriCalcBCCB", 0);

  /* "tmm4py/tmm4py_core.pyx":246
 * 
 * cdef PetscErrorCode wriCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iterc), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 246, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 246, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 246, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 246, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 246, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 246, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 246, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 246, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 246, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":247
 * cdef PetscErrorCode wriCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toInt(iLoop), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 247, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iterc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 247, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_iLoop); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 247, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 247, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 247, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 247, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_4);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_4) != (0)) __PYX_ERR(0, 247, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_v_State) != (0)) __PYX_ERR(0, 247, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 247, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyNumber_Add(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 247, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 247, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_4 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 247, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
  } else {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 247, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
  }
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 247, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "tmm4py/tmm4py_core.pyx":248
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode finCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":245
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode wriCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toInt(iLoop), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.wriCalcBCCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":250
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode finCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_finCalcBCCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iterc, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("finCalcBCCB", 0);

  /* "tmm4py/tmm4py_core.pyx":251
 * 
 * cdef PetscErrorCode finCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iterc), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 251, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 251, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 251, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 251, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 251, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 251, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 251, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 251, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 251, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":252
 * cdef PetscErrorCode finCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 252, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iterc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 252, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 252, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 252, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 252, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_State) != (0)) __PYX_ERR(0, 252, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 252, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 252, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 252, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_5 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 252, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 252, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  }
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 252, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "tmm4py/tmm4py_core.pyx":253
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode reiCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":250
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode finCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.finCalcBCCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":255
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode reiCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), toInt(iLoop), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_reiCalcBCCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iterc, PetscScalar __pyx_v_tf, PetscInt __pyx_v_Iterf, PetscInt __pyx_v_iLoop, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("reiCalcBCCB", 0);

  /* "tmm4py/tmm4py_core.pyx":256
 * 
 * cdef PetscErrorCode reiCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 256, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 256, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 256, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 256, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 256, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 256, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 256, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 256, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 256, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":257
 * cdef PetscErrorCode reiCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), toInt(iLoop), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iterc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iterf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_iLoop); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = PyTuple_New(6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 257, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 257, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_4);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_t_4) != (0)) __PYX_ERR(0, 257, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_3);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_6, 3, __pyx_t_3) != (0)) __PYX_ERR(0, 257, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_2);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_6, 4, __pyx_t_2) != (0)) __PYX_ERR(0, 257, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_6, 5, __pyx_v_State) != (0)) __PYX_ERR(0, 257, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyNumber_Add(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 257, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_2 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 257, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  } else {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 257, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  }
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":258
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode iniMonitorCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":255
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode reiCalcBCCB(PetscScalar tc, PetscInt Iterc, PetscScalar tf, PetscInt Iterf, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iterc), toReal(tf), toInt(Iterf), toInt(iLoop), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.reiCalcBCCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":260
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode iniMonitorCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_iniMonitorCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iter, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("iniMonitorCB", 0);

  /* "tmm4py/tmm4py_core.pyx":261
 * 
 * cdef PetscErrorCode iniMonitorCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 261, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 261, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 261, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 261, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 261, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 261, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 261, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 261, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 261, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":262
 * cdef PetscErrorCode iniMonitorCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 262, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 262, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 262, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 262, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_State) != (0)) __PYX_ERR(0, 262, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 262, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 262, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_5 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 262, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 262, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  }
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 262, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "tmm4py/tmm4py_core.pyx":263
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode calcMonitorCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":260
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode iniMonitorCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.iniMonitorCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":265
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode calcMonitorCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_calcMonitorCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_iLoop, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("calcMonitorCB", 0);

  /* "tmm4py/tmm4py_core.pyx":266
 * 
 * cdef PetscErrorCode calcMonitorCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 266, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 266, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 266, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 266, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 266, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 266, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 266, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 266, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 266, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":267
 * cdef PetscErrorCode calcMonitorCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 267, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_iLoop); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 267, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 267, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 267, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 267, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_State) != (0)) __PYX_ERR(0, 267, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 267, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 267, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 267, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_5 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 267, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 267, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  }
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 267, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "tmm4py/tmm4py_core.pyx":268
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode wriMonitorCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":265
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode calcMonitorCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.calcMonitorCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":270
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode wriMonitorCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_wriMonitorCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_iLoop, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("wriMonitorCB", 0);

  /* "tmm4py/tmm4py_core.pyx":271
 * 
 * cdef PetscErrorCode wriMonitorCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 271, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 271, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 271, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 271, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 271, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 271, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 271, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 271, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 271, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":272
 * cdef PetscErrorCode wriMonitorCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_iLoop); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 272, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 272, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_State) != (0)) __PYX_ERR(0, 272, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 272, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_5 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 272, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 272, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  }
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "tmm4py/tmm4py_core.pyx":273
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode finMonitorCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":270
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode wriMonitorCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.wriMonitorCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":275
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode finMonitorCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_finMonitorCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iter, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("finMonitorCB", 0);

  /* "tmm4py/tmm4py_core.pyx":276
 * 
 * cdef PetscErrorCode finMonitorCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 276, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 276, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 276, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 276, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 276, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 276, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":277
 * cdef PetscErrorCode finMonitorCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 277, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 277, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 277, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 277, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_State) != (0)) __PYX_ERR(0, 277, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 277, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 277, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_5 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 277, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 277, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  }
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 277, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "tmm4py/tmm4py_core.pyx":278
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode iniMisfitCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":275
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode finMonitorCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.finMonitorCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":280
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode iniMisfitCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_iniMisfitCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iter, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("iniMisfitCB", 0);

  /* "tmm4py/tmm4py_core.pyx":281
 * 
 * cdef PetscErrorCode iniMisfitCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 281, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 281, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 281, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 281, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 281, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 281, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 281, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 281, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 281, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":282
 * cdef PetscErrorCode iniMisfitCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 282, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 282, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 282, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 282, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 282, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_State) != (0)) __PYX_ERR(0, 282, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 282, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 282, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 282, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_5 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 282, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 282, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  }
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 282, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "tmm4py/tmm4py_core.pyx":283
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode calcMisfitCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":280
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode iniMisfitCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.iniMisfitCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":285
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode calcMisfitCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_calcMisfitCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_iLoop, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("calcMisfitCB", 0);

  /* "tmm4py/tmm4py_core.pyx":286
 * 
 * cdef PetscErrorCode calcMisfitCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 286, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 286, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 286, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 286, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 286, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 286, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 286, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 286, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":287
 * cdef PetscErrorCode calcMisfitCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_iLoop); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 287, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 287, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 287, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 287, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_State) != (0)) __PYX_ERR(0, 287, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 287, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 287, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_5 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 287, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 287, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  }
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 287, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "tmm4py/tmm4py_core.pyx":288
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode wriMisfitCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":285
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode calcMisfitCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.calcMisfitCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":290
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode wriMisfitCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_wriMisfitCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_iLoop, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("wriMisfitCB", 0);

  /* "tmm4py/tmm4py_core.pyx":291
 * 
 * cdef PetscErrorCode wriMisfitCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 291, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 291, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 291, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 291, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 291, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 291, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 291, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 291, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 291, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":292
 * cdef PetscErrorCode wriMisfitCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_iLoop); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 292, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 292, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 292, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 292, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_State) != (0)) __PYX_ERR(0, 292, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 292, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 292, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_5 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 292, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 292, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  }
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 292, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "tmm4py/tmm4py_core.pyx":293
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * cdef PetscErrorCode finMisfitCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":290
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode wriMisfitCB(PetscScalar tc, PetscInt iLoop, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(iLoop), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.wriMisfitCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":295
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode finMisfitCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
*/

static PetscErrorCode __pyx_f_6tmm4py_11tmm4py_core_finMisfitCB(PetscScalar __pyx_v_tc, PetscInt __pyx_v_Iter, CYTHON_UNUSED TMMState __pyx_v_state, void *__pyx_v_ctx) {
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_State = NULL;
  PetscErrorCode __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
  __Pyx_RefNannySetupContext("finMisfitCB", 0);

  /* "tmm4py/tmm4py_core.pyx":296
 * 
 * cdef PetscErrorCode finMisfitCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx             # <<<<<<<<<<<<<<
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
 *     return PETSC_SUCCESS
*/
  __pyx_t_1 = ((PyObject *)__pyx_v_ctx);
  __Pyx_INCREF(__pyx_t_1);
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
    if (unlikely(size != 4)) {
      if (size > 4) __Pyx_RaiseTooManyValuesError(4);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 296, __pyx_L1_error)
    }
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0);
      __Pyx_INCREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1);
      __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2);
      __Pyx_INCREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 3);
      __Pyx_INCREF(__pyx_t_5);
    } else {
      __pyx_t_2 = __Pyx_PyList_GetItemRef(sequence, 0);
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 296, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyList_GetItemRef(sequence, 1);
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 296, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyList_GetItemRef(sequence, 2);
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 296, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyList_GetItemRef(sequence, 3);
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 296, __pyx_L1_error)
      __Pyx_XGOTREF(__pyx_t_5);
    }
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
      for (i=0; i < 4; i++) {
        PyObject* item = __Pyx_PySequence_ITEM(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 296, __pyx_L1_error)
        __Pyx_GOTREF(item);
        *(temps[i]) = item;
      }
    }
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&__pyx_t_2,&__pyx_t_3,&__pyx_t_4,&__pyx_t_5};
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 296, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
    for (index=0; index < 4; index++) {
      PyObject* item = __pyx_t_7(__pyx_t_6); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      __Pyx_GOTREF(item);
      *(temps[index]) = item;
    }
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 4) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 296, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_function = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_args = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_kwargs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v_State = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":297
 * cdef PetscErrorCode finMisfitCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)             # <<<<<<<<<<<<<<
 *     return PETSC_SUCCESS
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 297, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 297, __pyx_L1_error);
  __Pyx_INCREF(__pyx_v_State);
  __Pyx_GIVEREF(__pyx_v_State);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_State) != (0)) __PYX_ERR(0, 297, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    __PYX_ERR(0, 297, __pyx_L1_error)
  }
  if (likely(PyDict_CheckExact(__pyx_v_kwargs))) {
    __pyx_t_5 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 297, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg((PyObject*)&PyDict_Type, __pyx_v_kwargs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 297, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  }
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_function, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "tmm4py/tmm4py_core.pyx":298
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
 *     return PETSC_SUCCESS             # <<<<<<<<<<<<<<
 * 
 * # This is to prevent someone from accidentally modifying TMMState.c, etc.
*/
  __pyx_r = PETSC_SUCCESS;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":295
 *     return PETSC_SUCCESS
 * 
 * cdef PetscErrorCode finMisfitCB(PetscScalar tc, PetscInt Iter, PetscTMMState state, void *ctx) noexcept with gil:             # <<<<<<<<<<<<<<
 *     (function, args, kwargs, State) = <object>ctx
 *     (<object>function)(toReal(tc), toInt(Iter), State, *args, **kwargs)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core.finMisfitCB", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = (PetscErrorCode) 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF(__pyx_v_State);
  __Pyx_RefNannyFinishContext();
  __Pyx_PyGILState_Release(__pyx_gilstate_save);
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":304
 * # with something else, or append or insert something in the list.
 * class _ImmutableList(list):
 *   def __setitem__(self, index, item):             # <<<<<<<<<<<<<<
 *     raise RuntimeError("List is not mutable")
 *   def insert(self, index, item):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_14_ImmutableList_1__setitem__(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_14_ImmutableList_1__setitem__ = {"__setitem__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_14_ImmutableList_1__setitem__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_14_ImmutableList_1__setitem__(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_index = 0;
  CYTHON_UNUSED PyObject *__pyx_v_item = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setitem__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_index,&__pyx_mstate_global->__pyx_n_u_item,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 304, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 304, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 304, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 304, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__setitem__", 0) < 0) __PYX_ERR(0, 304, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 3; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__setitem__", 1, 3, 3, i); __PYX_ERR(0, 304, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 304, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 304, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 304, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_index = values[1];
    __pyx_v_item = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__setitem__", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 304, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core._ImmutableList.__setitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_14_ImmutableList___setitem__(__pyx_self, __pyx_v_self, __pyx_v_index, __pyx_v_item);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_14_ImmutableList___setitem__(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_index, CYTHON_UNUSED PyObject *__pyx_v_item) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  size_t __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setitem__", 0);

  /* "tmm4py/tmm4py_core.pyx":305
 * class _ImmutableList(list):
 *   def __setitem__(self, index, item):
 *     raise RuntimeError("List is not mutable")             # <<<<<<<<<<<<<<
 *   def insert(self, index, item):
 *     raise RuntimeError("List is not insertable")
*/
  __pyx_t_2 = NULL;
  __Pyx_INCREF(__pyx_builtin_RuntimeError);
  __pyx_t_3 = __pyx_builtin_RuntimeError; 
  __pyx_t_4 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_mstate_global->__pyx_kp_u_List_is_not_mutable};
    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_ERR(0, 305, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":304
 * # with something else, or append or insert something in the list.
 * class _ImmutableList(list):
 *   def __setitem__(self, index, item):             # <<<<<<<<<<<<<<
 *     raise RuntimeError("List is not mutable")
 *   def insert(self, index, item):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("tmm4py.tmm4py_core._ImmutableList.__setitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":306
 *   def __setitem__(self, index, item):
 *     raise RuntimeError("List is not mutable")
 *   def insert(self, index, item):             # <<<<<<<<<<<<<<
 *     raise RuntimeError("List is not insertable")
 *   def append(self, item):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_14_ImmutableList_3insert(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_14_ImmutableList_3insert = {"insert", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_14_ImmutableList_3insert, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_14_ImmutableList_3insert(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_index = 0;
  CYTHON_UNUSED PyObject *__pyx_v_item = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("insert (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_index,&__pyx_mstate_global->__pyx_n_u_item,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 306, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 306, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 306, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 306, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "insert", 0) < 0) __PYX_ERR(0, 306, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 3; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("insert", 1, 3, 3, i); __PYX_ERR(0, 306, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 306, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 306, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 306, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_index = values[1];
    __pyx_v_item = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("insert", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 306, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core._ImmutableList.insert", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_14_ImmutableList_2insert(__pyx_self, __pyx_v_self, __pyx_v_index, __pyx_v_item);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_14_ImmutableList_2insert(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_index, CYTHON_UNUSED PyObject *__pyx_v_item) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  size_t __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("insert", 0);

  /* "tmm4py/tmm4py_core.pyx":307
 *     raise RuntimeError("List is not mutable")
 *   def insert(self, index, item):
 *     raise RuntimeError("List is not insertable")             # <<<<<<<<<<<<<<
 *   def append(self, item):
 *    raise RuntimeError("List is not appendable")
*/
  __pyx_t_2 = NULL;
  __Pyx_INCREF(__pyx_builtin_RuntimeError);
  __pyx_t_3 = __pyx_builtin_RuntimeError; 
  __pyx_t_4 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_mstate_global->__pyx_kp_u_List_is_not_insertable};
    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 307, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_ERR(0, 307, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":306
 *   def __setitem__(self, index, item):
 *     raise RuntimeError("List is not mutable")
 *   def insert(self, index, item):             # <<<<<<<<<<<<<<
 *     raise RuntimeError("List is not insertable")
 *   def append(self, item):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("tmm4py.tmm4py_core._ImmutableList.insert", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":308
 *   def insert(self, index, item):
 *     raise RuntimeError("List is not insertable")
 *   def append(self, item):             # <<<<<<<<<<<<<<
 *    raise RuntimeError("List is not appendable")
 * 
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_14_ImmutableList_5append(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_14_ImmutableList_5append = {"append", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_14_ImmutableList_5append, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_14_ImmutableList_5append(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_item = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("append (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_item,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 308, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 308, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 308, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "append", 0) < 0) __PYX_ERR(0, 308, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 2; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("append", 1, 2, 2, i); __PYX_ERR(0, 308, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 308, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 308, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_item = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("append", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 308, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core._ImmutableList.append", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_14_ImmutableList_4append(__pyx_self, __pyx_v_self, __pyx_v_item);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_14_ImmutableList_4append(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_item) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  size_t __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("append", 0);

  /* "tmm4py/tmm4py_core.pyx":309
 *     raise RuntimeError("List is not insertable")
 *   def append(self, item):
 *    raise RuntimeError("List is not appendable")             # <<<<<<<<<<<<<<
 * 
 * class Stub:
*/
  __pyx_t_2 = NULL;
  __Pyx_INCREF(__pyx_builtin_RuntimeError);
  __pyx_t_3 = __pyx_builtin_RuntimeError; 
  __pyx_t_4 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_mstate_global->__pyx_kp_u_List_is_not_appendable};
    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 309, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_ERR(0, 309, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":308
 *   def insert(self, index, item):
 *     raise RuntimeError("List is not insertable")
 *   def append(self, item):             # <<<<<<<<<<<<<<
 *    raise RuntimeError("List is not appendable")
 * 
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("tmm4py.tmm4py_core._ImmutableList.append", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":313
 * class Stub:
 * 
 *     def __init__(self, Id, prefix):             # <<<<<<<<<<<<<<
 *       self.Id = Id
 *     def iniExternalForcingFn(self, tc, Iter, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_1__init__(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_1__init__ = {"__init__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_1__init__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_1__init__(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_Id = 0;
  CYTHON_UNUSED PyObject *__pyx_v_prefix = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_Id,&__pyx_mstate_global->__pyx_n_u_prefix,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 313, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 313, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 313, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 313, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__init__", 0) < 0) __PYX_ERR(0, 313, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 3; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, i); __PYX_ERR(0, 313, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 313, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 313, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 313, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_Id = values[1];
    __pyx_v_prefix = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__init__", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 313, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub___init__(__pyx_self, __pyx_v_self, __pyx_v_Id, __pyx_v_prefix);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_Id, CYTHON_UNUSED PyObject *__pyx_v_prefix) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__init__", 0);

  /* "tmm4py/tmm4py_core.pyx":314
 * 
 *     def __init__(self, Id, prefix):
 *       self.Id = Id             # <<<<<<<<<<<<<<
 *     def iniExternalForcingFn(self, tc, Iter, state):
 *       pass
*/
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_mstate_global->__pyx_n_u_Id, __pyx_v_Id) < 0) __PYX_ERR(0, 314, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":313
 * class Stub:
 * 
 *     def __init__(self, Id, prefix):             # <<<<<<<<<<<<<<
 *       self.Id = Id
 *     def iniExternalForcingFn(self, tc, Iter, state):
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":315
 *     def __init__(self, Id, prefix):
 *       self.Id = Id
 *     def iniExternalForcingFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def calcExternalForcingFn(self, tc, Iter, iLoop, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_3iniExternalForcingFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_3iniExternalForcingFn = {"iniExternalForcingFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_3iniExternalForcingFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_3iniExternalForcingFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iter = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("iniExternalForcingFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iter,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 315, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 315, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 315, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 315, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 315, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "iniExternalForcingFn", 0) < 0) __PYX_ERR(0, 315, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 4; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("iniExternalForcingFn", 1, 4, 4, i); __PYX_ERR(0, 315, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 315, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 315, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 315, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 315, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iter = values[2];
    __pyx_v_state = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("iniExternalForcingFn", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 315, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.iniExternalForcingFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_2iniExternalForcingFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iter, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_2iniExternalForcingFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("iniExternalForcingFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":317
 *     def iniExternalForcingFn(self, tc, Iter, state):
 *       pass
 *     def calcExternalForcingFn(self, tc, Iter, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def writeExternalForcingFn(self, tc, Iter, iLoop, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_5calcExternalForcingFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_5calcExternalForcingFn = {"calcExternalForcingFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_5calcExternalForcingFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_5calcExternalForcingFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iter = 0;
  CYTHON_UNUSED PyObject *__pyx_v_iLoop = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[5] = {0,0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcExternalForcingFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iter,&__pyx_mstate_global->__pyx_n_u_iLoop,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 317, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  5:
        values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 317, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 317, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 317, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 317, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 317, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "calcExternalForcingFn", 0) < 0) __PYX_ERR(0, 317, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 5; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("calcExternalForcingFn", 1, 5, 5, i); __PYX_ERR(0, 317, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 5)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 317, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 317, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 317, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 317, __pyx_L3_error)
      values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 317, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iter = values[2];
    __pyx_v_iLoop = values[3];
    __pyx_v_state = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("calcExternalForcingFn", 1, 5, 5, __pyx_nargs); __PYX_ERR(0, 317, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.calcExternalForcingFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_4calcExternalForcingFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iter, __pyx_v_iLoop, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_4calcExternalForcingFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcExternalForcingFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":319
 *     def calcExternalForcingFn(self, tc, Iter, iLoop, state):
 *       pass
 *     def writeExternalForcingFn(self, tc, Iter, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def finalizeExternalForcingFn(self, tc, Iter, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_7writeExternalForcingFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_7writeExternalForcingFn = {"writeExternalForcingFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_7writeExternalForcingFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_7writeExternalForcingFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iter = 0;
  CYTHON_UNUSED PyObject *__pyx_v_iLoop = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[5] = {0,0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("writeExternalForcingFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iter,&__pyx_mstate_global->__pyx_n_u_iLoop,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 319, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  5:
        values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 319, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 319, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 319, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 319, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 319, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "writeExternalForcingFn", 0) < 0) __PYX_ERR(0, 319, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 5; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("writeExternalForcingFn", 1, 5, 5, i); __PYX_ERR(0, 319, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 5)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 319, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 319, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 319, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 319, __pyx_L3_error)
      values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 319, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iter = values[2];
    __pyx_v_iLoop = values[3];
    __pyx_v_state = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("writeExternalForcingFn", 1, 5, 5, __pyx_nargs); __PYX_ERR(0, 319, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.writeExternalForcingFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_6writeExternalForcingFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iter, __pyx_v_iLoop, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_6writeExternalForcingFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("writeExternalForcingFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":321
 *     def writeExternalForcingFn(self, tc, Iter, iLoop, state):
 *       pass
 *     def finalizeExternalForcingFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def reInitializeExternalForcingFn(self, tc, Iter, iLoop, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_9finalizeExternalForcingFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_9finalizeExternalForcingFn = {"finalizeExternalForcingFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_9finalizeExternalForcingFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_9finalizeExternalForcingFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iter = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("finalizeExternalForcingFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iter,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 321, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 321, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 321, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 321, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 321, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "finalizeExternalForcingFn", 0) < 0) __PYX_ERR(0, 321, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 4; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("finalizeExternalForcingFn", 1, 4, 4, i); __PYX_ERR(0, 321, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 321, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 321, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 321, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 321, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iter = values[2];
    __pyx_v_state = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("finalizeExternalForcingFn", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 321, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.finalizeExternalForcingFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_8finalizeExternalForcingFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iter, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_8finalizeExternalForcingFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("finalizeExternalForcingFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":323
 *     def finalizeExternalForcingFn(self, tc, Iter, state):
 *       pass
 *     def reInitializeExternalForcingFn(self, tc, Iter, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def iniCalcBCFn(self, tc, Iterc, tf, Iterf, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_11reInitializeExternalForcingFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_11reInitializeExternalForcingFn = {"reInitializeExternalForcingFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_11reInitializeExternalForcingFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_11reInitializeExternalForcingFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iter = 0;
  CYTHON_UNUSED PyObject *__pyx_v_iLoop = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[5] = {0,0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("reInitializeExternalForcingFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iter,&__pyx_mstate_global->__pyx_n_u_iLoop,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 323, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  5:
        values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 323, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 323, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 323, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 323, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 323, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "reInitializeExternalForcingFn", 0) < 0) __PYX_ERR(0, 323, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 5; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("reInitializeExternalForcingFn", 1, 5, 5, i); __PYX_ERR(0, 323, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 5)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 323, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 323, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 323, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 323, __pyx_L3_error)
      values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 323, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iter = values[2];
    __pyx_v_iLoop = values[3];
    __pyx_v_state = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("reInitializeExternalForcingFn", 1, 5, 5, __pyx_nargs); __PYX_ERR(0, 323, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.reInitializeExternalForcingFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_10reInitializeExternalForcingFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iter, __pyx_v_iLoop, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_10reInitializeExternalForcingFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("reInitializeExternalForcingFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":325
 *     def reInitializeExternalForcingFn(self, tc, Iter, iLoop, state):
 *       pass
 *     def iniCalcBCFn(self, tc, Iterc, tf, Iterf, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def calcCalcBCFn(self, tc, Iterc, tf, Iterf, iLoop, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_13iniCalcBCFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_13iniCalcBCFn = {"iniCalcBCFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_13iniCalcBCFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_13iniCalcBCFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iterc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tf = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iterf = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[6] = {0,0,0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("iniCalcBCFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iterc,&__pyx_mstate_global->__pyx_n_u_tf,&__pyx_mstate_global->__pyx_n_u_Iterf,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 325, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  6:
        values[5] = __Pyx_ArgRef_FASTCALL(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[5])) __PYX_ERR(0, 325, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 325, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 325, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 325, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 325, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 325, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "iniCalcBCFn", 0) < 0) __PYX_ERR(0, 325, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 6; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("iniCalcBCFn", 1, 6, 6, i); __PYX_ERR(0, 325, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 6)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 325, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 325, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 325, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 325, __pyx_L3_error)
      values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 325, __pyx_L3_error)
      values[5] = __Pyx_ArgRef_FASTCALL(__pyx_args, 5);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[5])) __PYX_ERR(0, 325, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iterc = values[2];
    __pyx_v_tf = values[3];
    __pyx_v_Iterf = values[4];
    __pyx_v_state = values[5];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("iniCalcBCFn", 1, 6, 6, __pyx_nargs); __PYX_ERR(0, 325, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.iniCalcBCFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_12iniCalcBCFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iterc, __pyx_v_tf, __pyx_v_Iterf, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_12iniCalcBCFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iterc, CYTHON_UNUSED PyObject *__pyx_v_tf, CYTHON_UNUSED PyObject *__pyx_v_Iterf, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("iniCalcBCFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":327
 *     def iniCalcBCFn(self, tc, Iterc, tf, Iterf, state):
 *       pass
 *     def calcCalcBCFn(self, tc, Iterc, tf, Iterf, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def writeCalcBCFn(self, tc, Iter, iLoop, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_15calcCalcBCFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_15calcCalcBCFn = {"calcCalcBCFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_15calcCalcBCFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_15calcCalcBCFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iterc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tf = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iterf = 0;
  CYTHON_UNUSED PyObject *__pyx_v_iLoop = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[7] = {0,0,0,0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcCalcBCFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iterc,&__pyx_mstate_global->__pyx_n_u_tf,&__pyx_mstate_global->__pyx_n_u_Iterf,&__pyx_mstate_global->__pyx_n_u_iLoop,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 327, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  7:
        values[6] = __Pyx_ArgRef_FASTCALL(__pyx_args, 6);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[6])) __PYX_ERR(0, 327, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  6:
        values[5] = __Pyx_ArgRef_FASTCALL(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[5])) __PYX_ERR(0, 327, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 327, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 327, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 327, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 327, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 327, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "calcCalcBCFn", 0) < 0) __PYX_ERR(0, 327, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 7; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("calcCalcBCFn", 1, 7, 7, i); __PYX_ERR(0, 327, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 7)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 327, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 327, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 327, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 327, __pyx_L3_error)
      values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 327, __pyx_L3_error)
      values[5] = __Pyx_ArgRef_FASTCALL(__pyx_args, 5);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[5])) __PYX_ERR(0, 327, __pyx_L3_error)
      values[6] = __Pyx_ArgRef_FASTCALL(__pyx_args, 6);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[6])) __PYX_ERR(0, 327, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iterc = values[2];
    __pyx_v_tf = values[3];
    __pyx_v_Iterf = values[4];
    __pyx_v_iLoop = values[5];
    __pyx_v_state = values[6];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("calcCalcBCFn", 1, 7, 7, __pyx_nargs); __PYX_ERR(0, 327, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.calcCalcBCFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_14calcCalcBCFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iterc, __pyx_v_tf, __pyx_v_Iterf, __pyx_v_iLoop, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_14calcCalcBCFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iterc, CYTHON_UNUSED PyObject *__pyx_v_tf, CYTHON_UNUSED PyObject *__pyx_v_Iterf, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcCalcBCFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":329
 *     def calcCalcBCFn(self, tc, Iterc, tf, Iterf, iLoop, state):
 *       pass
 *     def writeCalcBCFn(self, tc, Iter, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def finalizeCalcBCFn(self, tc, Iter, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_17writeCalcBCFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_17writeCalcBCFn = {"writeCalcBCFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_17writeCalcBCFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_17writeCalcBCFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iter = 0;
  CYTHON_UNUSED PyObject *__pyx_v_iLoop = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[5] = {0,0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("writeCalcBCFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iter,&__pyx_mstate_global->__pyx_n_u_iLoop,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 329, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  5:
        values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 329, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 329, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 329, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 329, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 329, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "writeCalcBCFn", 0) < 0) __PYX_ERR(0, 329, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 5; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("writeCalcBCFn", 1, 5, 5, i); __PYX_ERR(0, 329, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 5)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 329, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 329, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 329, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 329, __pyx_L3_error)
      values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 329, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iter = values[2];
    __pyx_v_iLoop = values[3];
    __pyx_v_state = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("writeCalcBCFn", 1, 5, 5, __pyx_nargs); __PYX_ERR(0, 329, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.writeCalcBCFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_16writeCalcBCFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iter, __pyx_v_iLoop, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_16writeCalcBCFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("writeCalcBCFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":331
 *     def writeCalcBCFn(self, tc, Iter, iLoop, state):
 *       pass
 *     def finalizeCalcBCFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *        pass
 *     def reInitializeCalcBCFn(self, tc, Iter, iLoop, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_19finalizeCalcBCFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_19finalizeCalcBCFn = {"finalizeCalcBCFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_19finalizeCalcBCFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_19finalizeCalcBCFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iter = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("finalizeCalcBCFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iter,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 331, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 331, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 331, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 331, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 331, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "finalizeCalcBCFn", 0) < 0) __PYX_ERR(0, 331, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 4; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("finalizeCalcBCFn", 1, 4, 4, i); __PYX_ERR(0, 331, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 331, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 331, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 331, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 331, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iter = values[2];
    __pyx_v_state = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("finalizeCalcBCFn", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 331, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.finalizeCalcBCFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_18finalizeCalcBCFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iter, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_18finalizeCalcBCFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("finalizeCalcBCFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":333
 *     def finalizeCalcBCFn(self, tc, Iter, state):
 *        pass
 *     def reInitializeCalcBCFn(self, tc, Iter, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def iniMonitorFn(self, tc, Iter, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_21reInitializeCalcBCFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_21reInitializeCalcBCFn = {"reInitializeCalcBCFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_21reInitializeCalcBCFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_21reInitializeCalcBCFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iter = 0;
  CYTHON_UNUSED PyObject *__pyx_v_iLoop = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[5] = {0,0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("reInitializeCalcBCFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iter,&__pyx_mstate_global->__pyx_n_u_iLoop,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 333, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  5:
        values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 333, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 333, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 333, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 333, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 333, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "reInitializeCalcBCFn", 0) < 0) __PYX_ERR(0, 333, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 5; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("reInitializeCalcBCFn", 1, 5, 5, i); __PYX_ERR(0, 333, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 5)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 333, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 333, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 333, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 333, __pyx_L3_error)
      values[4] = __Pyx_ArgRef_FASTCALL(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[4])) __PYX_ERR(0, 333, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iter = values[2];
    __pyx_v_iLoop = values[3];
    __pyx_v_state = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("reInitializeCalcBCFn", 1, 5, 5, __pyx_nargs); __PYX_ERR(0, 333, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.reInitializeCalcBCFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_20reInitializeCalcBCFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iter, __pyx_v_iLoop, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_20reInitializeCalcBCFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("reInitializeCalcBCFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":335
 *     def reInitializeCalcBCFn(self, tc, Iter, iLoop, state):
 *       pass
 *     def iniMonitorFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def calcMonitorFn(self, tc, iLoop, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_23iniMonitorFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_23iniMonitorFn = {"iniMonitorFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_23iniMonitorFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_23iniMonitorFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iter = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("iniMonitorFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iter,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 335, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 335, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 335, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 335, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 335, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "iniMonitorFn", 0) < 0) __PYX_ERR(0, 335, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 4; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("iniMonitorFn", 1, 4, 4, i); __PYX_ERR(0, 335, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 335, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 335, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 335, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 335, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iter = values[2];
    __pyx_v_state = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("iniMonitorFn", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 335, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.iniMonitorFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_22iniMonitorFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iter, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_22iniMonitorFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("iniMonitorFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":337
 *     def iniMonitorFn(self, tc, Iter, state):
 *       pass
 *     def calcMonitorFn(self, tc, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def writeMonitorFn(self, tc, iLoop, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_25calcMonitorFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_25calcMonitorFn = {"calcMonitorFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_25calcMonitorFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_25calcMonitorFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_iLoop = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcMonitorFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_iLoop,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 337, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 337, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 337, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 337, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 337, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "calcMonitorFn", 0) < 0) __PYX_ERR(0, 337, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 4; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("calcMonitorFn", 1, 4, 4, i); __PYX_ERR(0, 337, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 337, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 337, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 337, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 337, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_iLoop = values[2];
    __pyx_v_state = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("calcMonitorFn", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 337, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.calcMonitorFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_24calcMonitorFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_iLoop, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_24calcMonitorFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcMonitorFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":339
 *     def calcMonitorFn(self, tc, iLoop, state):
 *       pass
 *     def writeMonitorFn(self, tc, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def finalizeMonitorFn(self, tc, Iter, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_27writeMonitorFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_27writeMonitorFn = {"writeMonitorFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_27writeMonitorFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_27writeMonitorFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_iLoop = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("writeMonitorFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_iLoop,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 339, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 339, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 339, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 339, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 339, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "writeMonitorFn", 0) < 0) __PYX_ERR(0, 339, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 4; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("writeMonitorFn", 1, 4, 4, i); __PYX_ERR(0, 339, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 339, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 339, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 339, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 339, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_iLoop = values[2];
    __pyx_v_state = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("writeMonitorFn", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 339, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.writeMonitorFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_26writeMonitorFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_iLoop, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_26writeMonitorFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("writeMonitorFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":341
 *     def writeMonitorFn(self, tc, iLoop, state):
 *       pass
 *     def finalizeMonitorFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def iniMisfitFn(self, tc, Iter, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_29finalizeMonitorFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_29finalizeMonitorFn = {"finalizeMonitorFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_29finalizeMonitorFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_29finalizeMonitorFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iter = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("finalizeMonitorFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iter,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 341, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 341, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 341, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 341, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 341, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "finalizeMonitorFn", 0) < 0) __PYX_ERR(0, 341, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 4; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("finalizeMonitorFn", 1, 4, 4, i); __PYX_ERR(0, 341, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 341, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 341, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 341, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 341, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iter = values[2];
    __pyx_v_state = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("finalizeMonitorFn", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 341, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.finalizeMonitorFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_28finalizeMonitorFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iter, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_28finalizeMonitorFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("finalizeMonitorFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":343
 *     def finalizeMonitorFn(self, tc, Iter, state):
 *       pass
 *     def iniMisfitFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def calcMisfitFn(self, tc, iLoop, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_31iniMisfitFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_31iniMisfitFn = {"iniMisfitFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_31iniMisfitFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_31iniMisfitFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iter = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("iniMisfitFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iter,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 343, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 343, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 343, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 343, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 343, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "iniMisfitFn", 0) < 0) __PYX_ERR(0, 343, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 4; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("iniMisfitFn", 1, 4, 4, i); __PYX_ERR(0, 343, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 343, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 343, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 343, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 343, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iter = values[2];
    __pyx_v_state = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("iniMisfitFn", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 343, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.iniMisfitFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_30iniMisfitFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iter, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_30iniMisfitFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("iniMisfitFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":345
 *     def iniMisfitFn(self, tc, Iter, state):
 *       pass
 *     def calcMisfitFn(self, tc, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def writeMisfitFn(self, tc, iLoop, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_33calcMisfitFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_33calcMisfitFn = {"calcMisfitFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_33calcMisfitFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_33calcMisfitFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_iLoop = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcMisfitFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_iLoop,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 345, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 345, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 345, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 345, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 345, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "calcMisfitFn", 0) < 0) __PYX_ERR(0, 345, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 4; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("calcMisfitFn", 1, 4, 4, i); __PYX_ERR(0, 345, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 345, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 345, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 345, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 345, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_iLoop = values[2];
    __pyx_v_state = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("calcMisfitFn", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 345, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.calcMisfitFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_32calcMisfitFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_iLoop, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_32calcMisfitFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcMisfitFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":347
 *     def calcMisfitFn(self, tc, iLoop, state):
 *       pass
 *     def writeMisfitFn(self, tc, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def finalizeMisfitFn(self, tc, Iter, state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_35writeMisfitFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_35writeMisfitFn = {"writeMisfitFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_35writeMisfitFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_35writeMisfitFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_iLoop = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("writeMisfitFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_iLoop,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 347, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 347, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 347, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 347, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 347, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "writeMisfitFn", 0) < 0) __PYX_ERR(0, 347, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 4; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("writeMisfitFn", 1, 4, 4, i); __PYX_ERR(0, 347, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 347, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 347, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 347, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 347, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_iLoop = values[2];
    __pyx_v_state = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("writeMisfitFn", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 347, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.writeMisfitFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_34writeMisfitFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_iLoop, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_34writeMisfitFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_iLoop, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("writeMisfitFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":349
 *     def writeMisfitFn(self, tc, iLoop, state):
 *       pass
 *     def finalizeMisfitFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *       pass
 * 
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_37finalizeMisfitFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_4Stub_37finalizeMisfitFn = {"finalizeMisfitFn", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_4Stub_37finalizeMisfitFn, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_4Stub_37finalizeMisfitFn(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_self = 0;
  CYTHON_UNUSED PyObject *__pyx_v_tc = 0;
  CYTHON_UNUSED PyObject *__pyx_v_Iter = 0;
  CYTHON_UNUSED PyObject *__pyx_v_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("finalizeMisfitFn (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_self,&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iter,&__pyx_mstate_global->__pyx_n_u_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 349, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 349, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 349, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 349, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 349, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "finalizeMisfitFn", 0) < 0) __PYX_ERR(0, 349, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 4; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("finalizeMisfitFn", 1, 4, 4, i); __PYX_ERR(0, 349, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 349, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 349, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 349, __pyx_L3_error)
      values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 349, __pyx_L3_error)
    }
    __pyx_v_self = values[0];
    __pyx_v_tc = values[1];
    __pyx_v_Iter = values[2];
    __pyx_v_state = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("finalizeMisfitFn", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 349, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.Stub.finalizeMisfitFn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4Stub_36finalizeMisfitFn(__pyx_self, __pyx_v_self, __pyx_v_tc, __pyx_v_Iter, __pyx_v_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4Stub_36finalizeMisfitFn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_tc, CYTHON_UNUSED PyObject *__pyx_v_Iter, CYTHON_UNUSED PyObject *__pyx_v_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("finalizeMisfitFn", 0);

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":355
 * 
 * #     cdef PetscTMMState state
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.state = NULL
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__cinit__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState___cinit__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;

  /* "tmm4py/tmm4py_core.pyx":356
 * #     cdef PetscTMMState state
 *     def __cinit__(self):
 *         self.state = NULL             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self):
*/
  __pyx_v_self->state = NULL;

  /* "tmm4py/tmm4py_core.pyx":355
 * 
 * #     cdef PetscTMMState state
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.state = NULL
 * 
*/

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":358
 *         self.state = NULL
 * 
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         self.finiex = None
 *         self.fcalcex = None
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__init__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__init__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_2__init__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_2__init__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__init__", 0);

  /* "tmm4py/tmm4py_core.pyx":359
 * 
 *     def __init__(self):
 *         self.finiex = None             # <<<<<<<<<<<<<<
 *         self.fcalcex = None
 *         self.fwriex = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->finiex);
  __Pyx_DECREF(__pyx_v_self->finiex);
  __pyx_v_self->finiex = Py_None;

  /* "tmm4py/tmm4py_core.pyx":360
 *     def __init__(self):
 *         self.finiex = None
 *         self.fcalcex = None             # <<<<<<<<<<<<<<
 *         self.fwriex = None
 *         self.ffinex = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fcalcex);
  __Pyx_DECREF(__pyx_v_self->fcalcex);
  __pyx_v_self->fcalcex = Py_None;

  /* "tmm4py/tmm4py_core.pyx":361
 *         self.finiex = None
 *         self.fcalcex = None
 *         self.fwriex = None             # <<<<<<<<<<<<<<
 *         self.ffinex = None
 *         self.freiex = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fwriex);
  __Pyx_DECREF(__pyx_v_self->fwriex);
  __pyx_v_self->fwriex = Py_None;

  /* "tmm4py/tmm4py_core.pyx":362
 *         self.fcalcex = None
 *         self.fwriex = None
 *         self.ffinex = None             # <<<<<<<<<<<<<<
 *         self.freiex = None
 *         self.finicbc = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->ffinex);
  __Pyx_DECREF(__pyx_v_self->ffinex);
  __pyx_v_self->ffinex = Py_None;

  /* "tmm4py/tmm4py_core.pyx":363
 *         self.fwriex = None
 *         self.ffinex = None
 *         self.freiex = None             # <<<<<<<<<<<<<<
 *         self.finicbc = None
 *         self.fcalccbc = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->freiex);
  __Pyx_DECREF(__pyx_v_self->freiex);
  __pyx_v_self->freiex = Py_None;

  /* "tmm4py/tmm4py_core.pyx":364
 *         self.ffinex = None
 *         self.freiex = None
 *         self.finicbc = None             # <<<<<<<<<<<<<<
 *         self.fcalccbc = None
 *         self.fwricbc = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->finicbc);
  __Pyx_DECREF(__pyx_v_self->finicbc);
  __pyx_v_self->finicbc = Py_None;

  /* "tmm4py/tmm4py_core.pyx":365
 *         self.freiex = None
 *         self.finicbc = None
 *         self.fcalccbc = None             # <<<<<<<<<<<<<<
 *         self.fwricbc = None
 *         self.ffincbc = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fcalccbc);
  __Pyx_DECREF(__pyx_v_self->fcalccbc);
  __pyx_v_self->fcalccbc = Py_None;

  /* "tmm4py/tmm4py_core.pyx":366
 *         self.finicbc = None
 *         self.fcalccbc = None
 *         self.fwricbc = None             # <<<<<<<<<<<<<<
 *         self.ffincbc = None
 *         self.freicbc = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fwricbc);
  __Pyx_DECREF(__pyx_v_self->fwricbc);
  __pyx_v_self->fwricbc = Py_None;

  /* "tmm4py/tmm4py_core.pyx":367
 *         self.fcalccbc = None
 *         self.fwricbc = None
 *         self.ffincbc = None             # <<<<<<<<<<<<<<
 *         self.freicbc = None
 *         self.finimon = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->ffincbc);
  __Pyx_DECREF(__pyx_v_self->ffincbc);
  __pyx_v_self->ffincbc = Py_None;

  /* "tmm4py/tmm4py_core.pyx":368
 *         self.fwricbc = None
 *         self.ffincbc = None
 *         self.freicbc = None             # <<<<<<<<<<<<<<
 *         self.finimon = None
 *         self.fcalcmon = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->freicbc);
  __Pyx_DECREF(__pyx_v_self->freicbc);
  __pyx_v_self->freicbc = Py_None;

  /* "tmm4py/tmm4py_core.pyx":369
 *         self.ffincbc = None
 *         self.freicbc = None
 *         self.finimon = None             # <<<<<<<<<<<<<<
 *         self.fcalcmon = None
 *         self.fwrimon = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->finimon);
  __Pyx_DECREF(__pyx_v_self->finimon);
  __pyx_v_self->finimon = Py_None;

  /* "tmm4py/tmm4py_core.pyx":370
 *         self.freicbc = None
 *         self.finimon = None
 *         self.fcalcmon = None             # <<<<<<<<<<<<<<
 *         self.fwrimon = None
 *         self.ffinmon = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fcalcmon);
  __Pyx_DECREF(__pyx_v_self->fcalcmon);
  __pyx_v_self->fcalcmon = Py_None;

  /* "tmm4py/tmm4py_core.pyx":371
 *         self.finimon = None
 *         self.fcalcmon = None
 *         self.fwrimon = None             # <<<<<<<<<<<<<<
 *         self.ffinmon = None
 *         self.finimis = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fwrimon);
  __Pyx_DECREF(__pyx_v_self->fwrimon);
  __pyx_v_self->fwrimon = Py_None;

  /* "tmm4py/tmm4py_core.pyx":372
 *         self.fcalcmon = None
 *         self.fwrimon = None
 *         self.ffinmon = None             # <<<<<<<<<<<<<<
 *         self.finimis = None
 *         self.fcalcmis = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->ffinmon);
  __Pyx_DECREF(__pyx_v_self->ffinmon);
  __pyx_v_self->ffinmon = Py_None;

  /* "tmm4py/tmm4py_core.pyx":373
 *         self.fwrimon = None
 *         self.ffinmon = None
 *         self.finimis = None             # <<<<<<<<<<<<<<
 *         self.fcalcmis = None
 *         self.fwrimis = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->finimis);
  __Pyx_DECREF(__pyx_v_self->finimis);
  __pyx_v_self->finimis = Py_None;

  /* "tmm4py/tmm4py_core.pyx":374
 *         self.ffinmon = None
 *         self.finimis = None
 *         self.fcalcmis = None             # <<<<<<<<<<<<<<
 *         self.fwrimis = None
 *         self.ffinmis = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fcalcmis);
  __Pyx_DECREF(__pyx_v_self->fcalcmis);
  __pyx_v_self->fcalcmis = Py_None;

  /* "tmm4py/tmm4py_core.pyx":375
 *         self.finimis = None
 *         self.fcalcmis = None
 *         self.fwrimis = None             # <<<<<<<<<<<<<<
 *         self.ffinmis = None
 *         self.stateId = -1
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fwrimis);
  __Pyx_DECREF(__pyx_v_self->fwrimis);
  __pyx_v_self->fwrimis = Py_None;

  /* "tmm4py/tmm4py_core.pyx":376
 *         self.fcalcmis = None
 *         self.fwrimis = None
 *         self.ffinmis = None             # <<<<<<<<<<<<<<
 *         self.stateId = -1
 *         self.numTracers = 0
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->ffinmis);
  __Pyx_DECREF(__pyx_v_self->ffinmis);
  __pyx_v_self->ffinmis = Py_None;

  /* "tmm4py/tmm4py_core.pyx":377
 *         self.fwrimis = None
 *         self.ffinmis = None
 *         self.stateId = -1             # <<<<<<<<<<<<<<
 *         self.numTracers = 0
 *         self.config = None
*/
  __Pyx_INCREF(__pyx_mstate_global->__pyx_int_neg_1);
  __Pyx_GIVEREF(__pyx_mstate_global->__pyx_int_neg_1);
  __Pyx_GOTREF(__pyx_v_self->stateId);
  __Pyx_DECREF(__pyx_v_self->stateId);
  __pyx_v_self->stateId = __pyx_mstate_global->__pyx_int_neg_1;

  /* "tmm4py/tmm4py_core.pyx":378
 *         self.ffinmis = None
 *         self.stateId = -1
 *         self.numTracers = 0             # <<<<<<<<<<<<<<
 *         self.config = None
 *         self.tracerNames = None
*/
  __Pyx_INCREF(__pyx_mstate_global->__pyx_int_0);
  __Pyx_GIVEREF(__pyx_mstate_global->__pyx_int_0);
  __Pyx_GOTREF(__pyx_v_self->numTracers);
  __Pyx_DECREF(__pyx_v_self->numTracers);
  __pyx_v_self->numTracers = __pyx_mstate_global->__pyx_int_0;

  /* "tmm4py/tmm4py_core.pyx":379
 *         self.stateId = -1
 *         self.numTracers = 0
 *         self.config = None             # <<<<<<<<<<<<<<
 *         self.tracerNames = None
 *         self.c = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->config);
  __Pyx_DECREF(__pyx_v_self->config);
  __pyx_v_self->config = Py_None;

  /* "tmm4py/tmm4py_core.pyx":380
 *         self.numTracers = 0
 *         self.config = None
 *         self.tracerNames = None             # <<<<<<<<<<<<<<
 *         self.c = None
 *         self.qf = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->tracerNames);
  __Pyx_DECREF(__pyx_v_self->tracerNames);
  __pyx_v_self->tracerNames = Py_None;

  /* "tmm4py/tmm4py_core.pyx":381
 *         self.config = None
 *         self.tracerNames = None
 *         self.c = None             # <<<<<<<<<<<<<<
 *         self.qf = None
 *         self.qef = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->c);
  __Pyx_DECREF(__pyx_v_self->c);
  __pyx_v_self->c = Py_None;

  /* "tmm4py/tmm4py_core.pyx":382
 *         self.tracerNames = None
 *         self.c = None
 *         self.qf = None             # <<<<<<<<<<<<<<
 *         self.qef = None
 *         self.qrel = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->qf);
  __Pyx_DECREF(__pyx_v_self->qf);
  __pyx_v_self->qf = Py_None;

  /* "tmm4py/tmm4py_core.pyx":383
 *         self.c = None
 *         self.qf = None
 *         self.qef = None             # <<<<<<<<<<<<<<
 *         self.qrel = None
 *         self.cbc = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->qef);
  __Pyx_DECREF(__pyx_v_self->qef);
  __pyx_v_self->qef = Py_None;

  /* "tmm4py/tmm4py_core.pyx":384
 *         self.qf = None
 *         self.qef = None
 *         self.qrel = None             # <<<<<<<<<<<<<<
 *         self.cbc = None
 *         self.cbf = None
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->qrel);
  __Pyx_DECREF(__pyx_v_self->qrel);
  __pyx_v_self->qrel = Py_None;

  /* "tmm4py/tmm4py_core.pyx":385
 *         self.qef = None
 *         self.qrel = None
 *         self.cbc = None             # <<<<<<<<<<<<<<
 *         self.cbf = None
 *         _statescreated.append(self)
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->cbc);
  __Pyx_DECREF(__pyx_v_self->cbc);
  __pyx_v_self->cbc = Py_None;

  /* "tmm4py/tmm4py_core.pyx":386
 *         self.qrel = None
 *         self.cbc = None
 *         self.cbf = None             # <<<<<<<<<<<<<<
 *         _statescreated.append(self)
 * 
*/
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->cbf);
  __Pyx_DECREF(__pyx_v_self->cbf);
  __pyx_v_self->cbf = Py_None;

  /* "tmm4py/tmm4py_core.pyx":387
 *         self.cbc = None
 *         self.cbf = None
 *         _statescreated.append(self)             # <<<<<<<<<<<<<<
 * 
 *     def create(self):
*/
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_mstate_global->__pyx_n_u_statescreated); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 387, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Append(__pyx_t_1, ((PyObject *)__pyx_v_self)); if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 387, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":358
 *         self.state = NULL
 * 
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         self.finiex = None
 *         self.fcalcex = None
*/

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":389
 *         _statescreated.append(self)
 * 
 *     def create(self):             # <<<<<<<<<<<<<<
 * 
 *         cdef PetscErrorCode ierr
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_5create = {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("create (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("create", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("create", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_4create(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PetscErrorCode __pyx_v_ierr;
  TMMState __pyx_v_newstate;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("create", 0);

  /* "tmm4py/tmm4py_core.pyx":394
 * 
 *         cdef PetscTMMState newstate
 *         ierr = TMMCreate(&newstate)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.state=newstate
*/
  __pyx_v_ierr = TMMCreate((&__pyx_v_newstate));

  /* "tmm4py/tmm4py_core.pyx":395
 *         cdef PetscTMMState newstate
 *         ierr = TMMCreate(&newstate)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *         self.state=newstate
 * 
*/
  __pyx_t_1 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_1)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 395, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 395, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 395, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 395, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 395, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":396
 *         ierr = TMMCreate(&newstate)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.state=newstate             # <<<<<<<<<<<<<<
 * 
 *         return self
*/
  __pyx_v_self->state = __pyx_v_newstate;

  /* "tmm4py/tmm4py_core.pyx":398
 *         self.state=newstate
 * 
 *         return self             # <<<<<<<<<<<<<<
 * 
 * #   In the following setIni* functions we pack the name of the actual python
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":389
 *         _statescreated.append(self)
 * 
 *     def create(self):             # <<<<<<<<<<<<<<
 * 
 *         cdef PetscErrorCode ierr
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":412
 * #   arguments and the python state object.
 * 
 *     def setIniExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setIniExternalForcingFunction failed: -external_forcing not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7setIniExternalForcingFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_7setIniExternalForcingFunction = {"setIniExternalForcingFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7setIniExternalForcingFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7setIniExternalForcingFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setIniExternalForcingFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 412, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 412, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setIniExternalForcingFunction", 1) < 0) __PYX_ERR(0, 412, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setIniExternalForcingFunction", 0, 1, 1, i); __PYX_ERR(0, 412, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 412, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setIniExternalForcingFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 412, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setIniExternalForcingFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6setIniExternalForcingFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6setIniExternalForcingFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setIniExternalForcingFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":413
 * 
 *     def setIniExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setIniExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_useExternalForcing); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 413, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 413, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":414
 *     def setIniExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setIniExternalForcingFunction failed: -external_forcing not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setIniExternalForcingFunction_fa};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 414, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 414, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":413
 * 
 *     def setIniExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setIniExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":415
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setIniExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.finiex = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":416
 *             raise RuntimeError("setIniExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.finiex = context # this saves a pointer to context
 *             if debug: print(f"Ini exf forcing func is {context}")
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 416, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 416, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 416, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 416, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 416, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":417
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.finiex = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             if debug: print(f"Ini exf forcing func is {context}")
 *             ierr = TMMSetIniExtForcFunction(self.state, iniExternalForcingCB, <void*>context)
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->finiex);
    __Pyx_DECREF(__pyx_v_self->finiex);
    __pyx_v_self->finiex = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":418
 *             context = (func, args, kwargs, self)
 *             self.finiex = context # this saves a pointer to context
 *             if debug: print(f"Ini exf forcing func is {context}")             # <<<<<<<<<<<<<<
 *             ierr = TMMSetIniExtForcFunction(self.state, iniExternalForcingCB, <void*>context)
 * 
*/
    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_mstate_global->__pyx_n_u_debug); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 418, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_3) {
      __pyx_t_5 = NULL;
      __Pyx_INCREF(__pyx_builtin_print);
      __pyx_t_4 = __pyx_builtin_print; 
      __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_v_context, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 418, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_Ini_exf_forcing_func_is, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 418, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_6 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_8};
        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":419
 *             self.finiex = context # this saves a pointer to context
 *             if debug: print(f"Ini exf forcing func is {context}")
 *             ierr = TMMSetIniExtForcFunction(self.state, iniExternalForcingCB, <void*>context)             # <<<<<<<<<<<<<<
 * 
 *         else:
*/
    __pyx_v_ierr = TMMSetIniExtForcFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_iniExternalForcingCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":415
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setIniExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.finiex = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":422
 * 
 *         else:
 *             ierr = TMMSetIniExtForcFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetIniExtForcFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":423
 *         else:
 *             ierr = TMMSetIniExtForcFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetIniExtForcFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_4 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 423, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 423, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 423, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
      assert(__pyx_t_4);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_8};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 423, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":412
 * #   arguments and the python state object.
 * 
 *     def setIniExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setIniExternalForcingFunction failed: -external_forcing not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setIniExternalForcingFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":427
 * #             raise RuntimeError(f"TMMSetIniExtForcFunction failed with error code {ierr}")
 * 
 *     def setCalcExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setCalcExternalForcingFunction failed: -external_forcing not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_9setCalcExternalForcingFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_9setCalcExternalForcingFunction = {"setCalcExternalForcingFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_9setCalcExternalForcingFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_9setCalcExternalForcingFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setCalcExternalForcingFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 427, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 427, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setCalcExternalForcingFunction", 1) < 0) __PYX_ERR(0, 427, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setCalcExternalForcingFunction", 0, 1, 1, i); __PYX_ERR(0, 427, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 427, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setCalcExternalForcingFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 427, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setCalcExternalForcingFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8setCalcExternalForcingFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8setCalcExternalForcingFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setCalcExternalForcingFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":428
 * 
 *     def setCalcExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setCalcExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_useExternalForcing); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 428, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 428, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":429
 *     def setCalcExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setCalcExternalForcingFunction failed: -external_forcing not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setCalcExternalForcingFunction_f};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 429, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 429, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":428
 * 
 *     def setCalcExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setCalcExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":430
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setCalcExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fcalcex = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":431
 *             raise RuntimeError("setCalcExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.fcalcex = context # this saves a pointer to context
 *             ierr = TMMSetCalcExtForcFunction(self.state, calcExternalForcingCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 431, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 431, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 431, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 431, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 431, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":432
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.fcalcex = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetCalcExtForcFunction(self.state, calcExternalForcingCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->fcalcex);
    __Pyx_DECREF(__pyx_v_self->fcalcex);
    __pyx_v_self->fcalcex = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":433
 *             context = (func, args, kwargs, self)
 *             self.fcalcex = context # this saves a pointer to context
 *             ierr = TMMSetCalcExtForcFunction(self.state, calcExternalForcingCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetCalcExtForcFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetCalcExtForcFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_calcExternalForcingCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":430
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setCalcExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fcalcex = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":435
 *             ierr = TMMSetCalcExtForcFunction(self.state, calcExternalForcingCB, <void*>context)
 *         else:
 *             ierr = TMMSetCalcExtForcFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetCalcExtForcFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":436
 *         else:
 *             ierr = TMMSetCalcExtForcFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetCalcExtForcFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 436, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 436, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 436, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 436, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 436, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":427
 * #             raise RuntimeError(f"TMMSetIniExtForcFunction failed with error code {ierr}")
 * 
 *     def setCalcExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setCalcExternalForcingFunction failed: -external_forcing not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setCalcExternalForcingFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":440
 * #             raise RuntimeError(f"TMMSetCalcExtForcFunction failed with error code {ierr}")
 * 
 *     def setWriExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setWriExternalForcingFunction failed: -external_forcing not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_11setWriExternalForcingFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_11setWriExternalForcingFunction = {"setWriExternalForcingFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_11setWriExternalForcingFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_11setWriExternalForcingFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setWriExternalForcingFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 440, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 440, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setWriExternalForcingFunction", 1) < 0) __PYX_ERR(0, 440, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setWriExternalForcingFunction", 0, 1, 1, i); __PYX_ERR(0, 440, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 440, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setWriExternalForcingFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 440, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setWriExternalForcingFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_10setWriExternalForcingFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_10setWriExternalForcingFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setWriExternalForcingFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":441
 * 
 *     def setWriExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setWriExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_useExternalForcing); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 441, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":442
 *     def setWriExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setWriExternalForcingFunction failed: -external_forcing not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setWriExternalForcingFunction_fa};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 442, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 442, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":441
 * 
 *     def setWriExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setWriExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":443
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setWriExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fwriex = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":444
 *             raise RuntimeError("setWriExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.fwriex = context # this saves a pointer to context
 *             ierr = TMMSetWriExtForcFunction(self.state, wriExternalForcingCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 444, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 444, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 444, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 444, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 444, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":445
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.fwriex = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetWriExtForcFunction(self.state, wriExternalForcingCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->fwriex);
    __Pyx_DECREF(__pyx_v_self->fwriex);
    __pyx_v_self->fwriex = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":446
 *             context = (func, args, kwargs, self)
 *             self.fwriex = context # this saves a pointer to context
 *             ierr = TMMSetWriExtForcFunction(self.state, wriExternalForcingCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetWriExtForcFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetWriExtForcFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_wriExternalForcingCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":443
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setWriExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fwriex = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":448
 *             ierr = TMMSetWriExtForcFunction(self.state, wriExternalForcingCB, <void*>context)
 *         else:
 *             ierr = TMMSetWriExtForcFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetWriExtForcFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":449
 *         else:
 *             ierr = TMMSetWriExtForcFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetWriExtForcFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 449, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 449, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 449, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 449, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":440
 * #             raise RuntimeError(f"TMMSetCalcExtForcFunction failed with error code {ierr}")
 * 
 *     def setWriExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setWriExternalForcingFunction failed: -external_forcing not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setWriExternalForcingFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":453
 * #             raise RuntimeError(f"TMMSetWriExtForcFunction failed with error code {ierr}")
 * 
 *     def setFinExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setFinExternalForcingFunction failed: -external_forcing not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_13setFinExternalForcingFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_13setFinExternalForcingFunction = {"setFinExternalForcingFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_13setFinExternalForcingFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_13setFinExternalForcingFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setFinExternalForcingFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 453, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 453, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setFinExternalForcingFunction", 1) < 0) __PYX_ERR(0, 453, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setFinExternalForcingFunction", 0, 1, 1, i); __PYX_ERR(0, 453, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 453, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setFinExternalForcingFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 453, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setFinExternalForcingFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_12setFinExternalForcingFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_12setFinExternalForcingFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setFinExternalForcingFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":454
 * 
 *     def setFinExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setFinExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_useExternalForcing); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 454, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 454, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":455
 *     def setFinExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setFinExternalForcingFunction failed: -external_forcing not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setFinExternalForcingFunction_fa};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 455, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 455, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":454
 * 
 *     def setFinExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setFinExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":456
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setFinExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.ffinex = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":457
 *             raise RuntimeError("setFinExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.ffinex = context # this saves a pointer to context
 *             ierr = TMMSetFinExtForcFunction(self.state, finExternalForcingCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 457, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 457, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 457, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 457, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 457, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":458
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.ffinex = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetFinExtForcFunction(self.state, finExternalForcingCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->ffinex);
    __Pyx_DECREF(__pyx_v_self->ffinex);
    __pyx_v_self->ffinex = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":459
 *             context = (func, args, kwargs, self)
 *             self.ffinex = context # this saves a pointer to context
 *             ierr = TMMSetFinExtForcFunction(self.state, finExternalForcingCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetFinExtForcFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetFinExtForcFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_finExternalForcingCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":456
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setFinExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.ffinex = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":461
 *             ierr = TMMSetFinExtForcFunction(self.state, finExternalForcingCB, <void*>context)
 *         else:
 *             ierr = TMMSetFinExtForcFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetFinExtForcFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":462
 *         else:
 *             ierr = TMMSetFinExtForcFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetFinExtForcFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 462, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 462, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 462, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 462, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 462, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":453
 * #             raise RuntimeError(f"TMMSetWriExtForcFunction failed with error code {ierr}")
 * 
 *     def setFinExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setFinExternalForcingFunction failed: -external_forcing not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setFinExternalForcingFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":466
 * #             raise RuntimeError(f"TMMSetFinExtForcFunction failed with error code {ierr}")
 * 
 *     def setReiExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setReiExternalForcingFunction failed: -external_forcing not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_15setReiExternalForcingFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_15setReiExternalForcingFunction = {"setReiExternalForcingFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_15setReiExternalForcingFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_15setReiExternalForcingFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setReiExternalForcingFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 466, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 466, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setReiExternalForcingFunction", 1) < 0) __PYX_ERR(0, 466, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setReiExternalForcingFunction", 0, 1, 1, i); __PYX_ERR(0, 466, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 466, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setReiExternalForcingFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 466, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setReiExternalForcingFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_14setReiExternalForcingFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_14setReiExternalForcingFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setReiExternalForcingFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":467
 * 
 *     def setReiExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setReiExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_useExternalForcing); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 467, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 467, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":468
 *     def setReiExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setReiExternalForcingFunction failed: -external_forcing not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setReiExternalForcingFunction_fa};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 468, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":467
 * 
 *     def setReiExternalForcingFunction(self, func, *args, **kwargs):
 *         if not self.config['useExternalForcing']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setReiExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":469
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setReiExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.freiex = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":470
 *             raise RuntimeError("setReiExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.freiex = context # this saves a pointer to context
 *             ierr = TMMSetReiExtForcFunction(self.state, reiExternalForcingCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 470, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 470, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 470, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 470, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 470, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":471
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.freiex = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetReiExtForcFunction(self.state, reiExternalForcingCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->freiex);
    __Pyx_DECREF(__pyx_v_self->freiex);
    __pyx_v_self->freiex = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":472
 *             context = (func, args, kwargs, self)
 *             self.freiex = context # this saves a pointer to context
 *             ierr = TMMSetReiExtForcFunction(self.state, reiExternalForcingCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetReiExtForcFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetReiExtForcFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_reiExternalForcingCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":469
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setReiExternalForcingFunction failed: -external_forcing not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.freiex = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":474
 *             ierr = TMMSetReiExtForcFunction(self.state, reiExternalForcingCB, <void*>context)
 *         else:
 *             ierr = TMMSetReiExtForcFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetReiExtForcFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":475
 *         else:
 *             ierr = TMMSetReiExtForcFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetReiExtForcFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 475, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 475, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 475, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 475, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 475, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":466
 * #             raise RuntimeError(f"TMMSetFinExtForcFunction failed with error code {ierr}")
 * 
 *     def setReiExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setReiExternalForcingFunction failed: -external_forcing not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setReiExternalForcingFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":479
 * #             raise RuntimeError(f"TMMSetReiExtForcFunction failed with error code {ierr}")
 * 
 *     def setIniCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setIniCalcBCFunction failed: -calc_bc not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_17setIniCalcBCFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_17setIniCalcBCFunction = {"setIniCalcBCFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_17setIniCalcBCFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_17setIniCalcBCFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setIniCalcBCFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 479, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 479, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setIniCalcBCFunction", 1) < 0) __PYX_ERR(0, 479, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setIniCalcBCFunction", 0, 1, 1, i); __PYX_ERR(0, 479, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 479, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setIniCalcBCFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 479, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setIniCalcBCFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_16setIniCalcBCFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_16setIniCalcBCFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setIniCalcBCFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":480
 * 
 *     def setIniCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setIniCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_doCalcBC); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 480, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 480, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":481
 *     def setIniCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setIniCalcBCFunction failed: -calc_bc not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setIniCalcBCFunction_failed_calc};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 481, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 481, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":480
 * 
 *     def setIniCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setIniCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":482
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setIniCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.finicbc = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":483
 *             raise RuntimeError("setIniCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.finicbc = context # this saves a pointer to context
 *             ierr = TMMSetIniCalcBCFunction(self.state, iniCalcBCCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 483, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 483, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 483, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 483, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 483, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":484
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.finicbc = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetIniCalcBCFunction(self.state, iniCalcBCCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->finicbc);
    __Pyx_DECREF(__pyx_v_self->finicbc);
    __pyx_v_self->finicbc = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":485
 *             context = (func, args, kwargs, self)
 *             self.finicbc = context # this saves a pointer to context
 *             ierr = TMMSetIniCalcBCFunction(self.state, iniCalcBCCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetIniCalcBCFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetIniCalcBCFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_iniCalcBCCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":482
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setIniCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.finicbc = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":487
 *             ierr = TMMSetIniCalcBCFunction(self.state, iniCalcBCCB, <void*>context)
 *         else:
 *             ierr = TMMSetIniCalcBCFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetIniCalcBCFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":488
 *         else:
 *             ierr = TMMSetIniCalcBCFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetIniCalcBCFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 488, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 488, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 488, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 488, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":479
 * #             raise RuntimeError(f"TMMSetReiExtForcFunction failed with error code {ierr}")
 * 
 *     def setIniCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setIniCalcBCFunction failed: -calc_bc not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setIniCalcBCFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":492
 * #             raise RuntimeError(f"TMMSetIniCalcBCFunction failed with error code {ierr}")
 * 
 *     def setCalcCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setCalcCalcBCFunction failed: -calc_bc not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_19setCalcCalcBCFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_19setCalcCalcBCFunction = {"setCalcCalcBCFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_19setCalcCalcBCFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_19setCalcCalcBCFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setCalcCalcBCFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 492, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 492, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setCalcCalcBCFunction", 1) < 0) __PYX_ERR(0, 492, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setCalcCalcBCFunction", 0, 1, 1, i); __PYX_ERR(0, 492, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 492, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setCalcCalcBCFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 492, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setCalcCalcBCFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_18setCalcCalcBCFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_18setCalcCalcBCFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setCalcCalcBCFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":493
 * 
 *     def setCalcCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setCalcCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_doCalcBC); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 493, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 493, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":494
 *     def setCalcCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setCalcCalcBCFunction failed: -calc_bc not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setCalcCalcBCFunction_failed_cal};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 494, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":493
 * 
 *     def setCalcCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setCalcCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":495
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setCalcCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fcalccbc = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":496
 *             raise RuntimeError("setCalcCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.fcalccbc = context # this saves a pointer to context
 *             ierr = TMMSetCalcCalcBCFunction(self.state, calcCalcBCCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 496, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 496, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 496, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 496, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":497
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.fcalccbc = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetCalcCalcBCFunction(self.state, calcCalcBCCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->fcalccbc);
    __Pyx_DECREF(__pyx_v_self->fcalccbc);
    __pyx_v_self->fcalccbc = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":498
 *             context = (func, args, kwargs, self)
 *             self.fcalccbc = context # this saves a pointer to context
 *             ierr = TMMSetCalcCalcBCFunction(self.state, calcCalcBCCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetCalcCalcBCFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetCalcCalcBCFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_calcCalcBCCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":495
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setCalcCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fcalccbc = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":500
 *             ierr = TMMSetCalcCalcBCFunction(self.state, calcCalcBCCB, <void*>context)
 *         else:
 *             ierr = TMMSetCalcCalcBCFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetCalcCalcBCFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":501
 *         else:
 *             ierr = TMMSetCalcCalcBCFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetCalcCalcBCFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 501, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 501, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 501, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 501, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":492
 * #             raise RuntimeError(f"TMMSetIniCalcBCFunction failed with error code {ierr}")
 * 
 *     def setCalcCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setCalcCalcBCFunction failed: -calc_bc not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setCalcCalcBCFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":505
 * #             raise RuntimeError(f"TMMSetCalcCalcBCFunction failed with error code {ierr}")
 * 
 *     def setWriCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setWriCalcBCFunction failed: -calc_bc not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_21setWriCalcBCFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_21setWriCalcBCFunction = {"setWriCalcBCFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_21setWriCalcBCFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_21setWriCalcBCFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setWriCalcBCFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 505, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 505, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setWriCalcBCFunction", 1) < 0) __PYX_ERR(0, 505, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setWriCalcBCFunction", 0, 1, 1, i); __PYX_ERR(0, 505, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 505, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setWriCalcBCFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 505, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setWriCalcBCFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_20setWriCalcBCFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_20setWriCalcBCFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setWriCalcBCFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":506
 * 
 *     def setWriCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setWriCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_doCalcBC); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":507
 *     def setWriCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setWriCalcBCFunction failed: -calc_bc not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setWriCalcBCFunction_failed_calc};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 507, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":506
 * 
 *     def setWriCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setWriCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":508
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setWriCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fwricbc = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":509
 *             raise RuntimeError("setWriCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.fwricbc = context # this saves a pointer to context
 *             ierr = TMMSetWriCalcBCFunction(self.state, wriCalcBCCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 509, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 509, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 509, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 509, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":510
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.fwricbc = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetWriCalcBCFunction(self.state, wriCalcBCCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->fwricbc);
    __Pyx_DECREF(__pyx_v_self->fwricbc);
    __pyx_v_self->fwricbc = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":511
 *             context = (func, args, kwargs, self)
 *             self.fwricbc = context # this saves a pointer to context
 *             ierr = TMMSetWriCalcBCFunction(self.state, wriCalcBCCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetWriCalcBCFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetWriCalcBCFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_wriCalcBCCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":508
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setWriCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fwricbc = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":513
 *             ierr = TMMSetWriCalcBCFunction(self.state, wriCalcBCCB, <void*>context)
 *         else:
 *             ierr = TMMSetWriCalcBCFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetWriCalcBCFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":514
 *         else:
 *             ierr = TMMSetWriCalcBCFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetWriCalcBCFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 514, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 514, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 514, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 514, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":505
 * #             raise RuntimeError(f"TMMSetCalcCalcBCFunction failed with error code {ierr}")
 * 
 *     def setWriCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setWriCalcBCFunction failed: -calc_bc not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setWriCalcBCFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":518
 * #             raise RuntimeError(f"TMMSetWriCalcBCFunction failed with error code {ierr}")
 * 
 *     def setFinCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setFinCalcBCFunction failed: -calc_bc not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_23setFinCalcBCFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_23setFinCalcBCFunction = {"setFinCalcBCFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_23setFinCalcBCFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_23setFinCalcBCFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setFinCalcBCFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 518, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 518, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setFinCalcBCFunction", 1) < 0) __PYX_ERR(0, 518, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setFinCalcBCFunction", 0, 1, 1, i); __PYX_ERR(0, 518, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 518, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setFinCalcBCFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 518, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setFinCalcBCFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_22setFinCalcBCFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_22setFinCalcBCFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setFinCalcBCFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":519
 * 
 *     def setFinCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setFinCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_doCalcBC); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 519, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":520
 *     def setFinCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setFinCalcBCFunction failed: -calc_bc not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setFinCalcBCFunction_failed_calc};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 520, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 520, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":519
 * 
 *     def setFinCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setFinCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":521
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setFinCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.ffincbc = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":522
 *             raise RuntimeError("setFinCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.ffincbc = context # this saves a pointer to context
 *             ierr = TMMSetFinCalcBCFunction(self.state, finCalcBCCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 522, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 522, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 522, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 522, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 522, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":523
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.ffincbc = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetFinCalcBCFunction(self.state, finCalcBCCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->ffincbc);
    __Pyx_DECREF(__pyx_v_self->ffincbc);
    __pyx_v_self->ffincbc = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":524
 *             context = (func, args, kwargs, self)
 *             self.ffincbc = context # this saves a pointer to context
 *             ierr = TMMSetFinCalcBCFunction(self.state, finCalcBCCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetFinCalcBCFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetFinCalcBCFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_finCalcBCCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":521
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setFinCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.ffincbc = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":526
 *             ierr = TMMSetFinCalcBCFunction(self.state, finCalcBCCB, <void*>context)
 *         else:
 *             ierr = TMMSetFinCalcBCFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetFinCalcBCFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":527
 *         else:
 *             ierr = TMMSetFinCalcBCFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetFinCalcBCFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 527, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 527, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 527, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 527, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 527, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":518
 * #             raise RuntimeError(f"TMMSetWriCalcBCFunction failed with error code {ierr}")
 * 
 *     def setFinCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setFinCalcBCFunction failed: -calc_bc not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setFinCalcBCFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":531
 * #             raise RuntimeError(f"TMMSetFinCalcBCFunction failed with error code {ierr}")
 * 
 *     def setReiCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setReiCalcBCFunction failed: -calc_bc not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_25setReiCalcBCFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_25setReiCalcBCFunction = {"setReiCalcBCFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_25setReiCalcBCFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_25setReiCalcBCFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setReiCalcBCFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 531, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 531, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setReiCalcBCFunction", 1) < 0) __PYX_ERR(0, 531, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setReiCalcBCFunction", 0, 1, 1, i); __PYX_ERR(0, 531, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 531, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setReiCalcBCFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 531, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setReiCalcBCFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_24setReiCalcBCFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_24setReiCalcBCFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setReiCalcBCFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":532
 * 
 *     def setReiCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setReiCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_doCalcBC); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 532, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 532, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":533
 *     def setReiCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setReiCalcBCFunction failed: -calc_bc not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setReiCalcBCFunction_failed_calc};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 533, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 533, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":532
 * 
 *     def setReiCalcBCFunction(self, func, *args, **kwargs):
 *         if not self.config['doCalcBC']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setReiCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":534
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setReiCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.freicbc = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":535
 *             raise RuntimeError("setReiCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.freicbc = context # this saves a pointer to context
 *             ierr = TMMSetReiCalcBCFunction(self.state, reiCalcBCCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 535, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 535, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 535, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 535, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 535, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":536
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.freicbc = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetReiCalcBCFunction(self.state, reiCalcBCCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->freicbc);
    __Pyx_DECREF(__pyx_v_self->freicbc);
    __pyx_v_self->freicbc = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":537
 *             context = (func, args, kwargs, self)
 *             self.freicbc = context # this saves a pointer to context
 *             ierr = TMMSetReiCalcBCFunction(self.state, reiCalcBCCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetReiCalcBCFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetReiCalcBCFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_reiCalcBCCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":534
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setReiCalcBCFunction failed: -calc_bc not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.freicbc = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":539
 *             ierr = TMMSetReiCalcBCFunction(self.state, reiCalcBCCB, <void*>context)
 *         else:
 *             ierr = TMMSetReiCalcBCFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetReiCalcBCFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":540
 *         else:
 *             ierr = TMMSetReiCalcBCFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetReiCalcBCFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 540, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 540, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 540, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 540, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 540, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":531
 * #             raise RuntimeError(f"TMMSetFinCalcBCFunction failed with error code {ierr}")
 * 
 *     def setReiCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setReiCalcBCFunction failed: -calc_bc not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setReiCalcBCFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":544
 * #             raise RuntimeError(f"TMMSetReiCalcBCFunction failed with error code {ierr}")
 * 
 *     def setIniMonitorFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setIniMonitorFunction failed: -use_monitor not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_27setIniMonitorFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_27setIniMonitorFunction = {"setIniMonitorFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_27setIniMonitorFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_27setIniMonitorFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setIniMonitorFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 544, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 544, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setIniMonitorFunction", 1) < 0) __PYX_ERR(0, 544, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setIniMonitorFunction", 0, 1, 1, i); __PYX_ERR(0, 544, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 544, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setIniMonitorFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 544, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setIniMonitorFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_26setIniMonitorFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_26setIniMonitorFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setIniMonitorFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":545
 * 
 *     def setIniMonitorFunction(self, func, *args, **kwargs):
 *         if not self.config['useMonitor']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setIniMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_useMonitor); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 545, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 545, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":546
 *     def setIniMonitorFunction(self, func, *args, **kwargs):
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setIniMonitorFunction failed: -use_monitor not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setIniMonitorFunction_failed_use};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 546, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 546, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":545
 * 
 *     def setIniMonitorFunction(self, func, *args, **kwargs):
 *         if not self.config['useMonitor']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setIniMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":547
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setIniMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.finimon = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":548
 *             raise RuntimeError("setIniMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.finimon = context # this saves a pointer to context
 *             if debug: print(f"Ini monitor func is {context}")
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 548, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 548, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 548, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 548, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 548, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":549
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.finimon = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             if debug: print(f"Ini monitor func is {context}")
 *             ierr = TMMSetIniMonitorFunction(self.state, iniMonitorCB, <void*>context)
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->finimon);
    __Pyx_DECREF(__pyx_v_self->finimon);
    __pyx_v_self->finimon = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":550
 *             context = (func, args, kwargs, self)
 *             self.finimon = context # this saves a pointer to context
 *             if debug: print(f"Ini monitor func is {context}")             # <<<<<<<<<<<<<<
 *             ierr = TMMSetIniMonitorFunction(self.state, iniMonitorCB, <void*>context)
 *         else:
*/
    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_mstate_global->__pyx_n_u_debug); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 550, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 550, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_3) {
      __pyx_t_5 = NULL;
      __Pyx_INCREF(__pyx_builtin_print);
      __pyx_t_4 = __pyx_builtin_print; 
      __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_v_context, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 550, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_Ini_monitor_func_is, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 550, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_6 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_8};
        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 550, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":551
 *             self.finimon = context # this saves a pointer to context
 *             if debug: print(f"Ini monitor func is {context}")
 *             ierr = TMMSetIniMonitorFunction(self.state, iniMonitorCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetIniMonitorFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetIniMonitorFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_iniMonitorCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":547
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setIniMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.finimon = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":553
 *             ierr = TMMSetIniMonitorFunction(self.state, iniMonitorCB, <void*>context)
 *         else:
 *             ierr = TMMSetIniMonitorFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetIniMonitorFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":554
 *         else:
 *             ierr = TMMSetIniMonitorFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetIniMonitorFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_4 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 554, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 554, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 554, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
      assert(__pyx_t_4);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_8};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 554, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 554, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":544
 * #             raise RuntimeError(f"TMMSetReiCalcBCFunction failed with error code {ierr}")
 * 
 *     def setIniMonitorFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setIniMonitorFunction failed: -use_monitor not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setIniMonitorFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":558
 * #             raise RuntimeError(f"TMMSetIniMonitorFunction failed with error code {ierr}")
 * 
 *     def setCalcMonitorFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setCalcMonitorFunction failed: -use_monitor not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_29setCalcMonitorFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_29setCalcMonitorFunction = {"setCalcMonitorFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_29setCalcMonitorFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_29setCalcMonitorFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setCalcMonitorFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 558, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 558, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setCalcMonitorFunction", 1) < 0) __PYX_ERR(0, 558, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setCalcMonitorFunction", 0, 1, 1, i); __PYX_ERR(0, 558, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 558, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setCalcMonitorFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 558, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setCalcMonitorFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_28setCalcMonitorFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_28setCalcMonitorFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setCalcMonitorFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":559
 * 
 *     def setCalcMonitorFunction(self, func, *args, **kwargs):
 *         if not self.config['useMonitor']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setCalcMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_useMonitor); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 559, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 559, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":560
 *     def setCalcMonitorFunction(self, func, *args, **kwargs):
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setCalcMonitorFunction failed: -use_monitor not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setCalcMonitorFunction_failed_us};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 560, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":559
 * 
 *     def setCalcMonitorFunction(self, func, *args, **kwargs):
 *         if not self.config['useMonitor']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setCalcMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":561
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setCalcMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fcalcmon = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":562
 *             raise RuntimeError("setCalcMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.fcalcmon = context # this saves a pointer to context
 *             ierr = TMMSetCalcMonitorFunction(self.state, calcMonitorCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 562, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 562, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 562, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 562, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":563
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.fcalcmon = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetCalcMonitorFunction(self.state, calcMonitorCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->fcalcmon);
    __Pyx_DECREF(__pyx_v_self->fcalcmon);
    __pyx_v_self->fcalcmon = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":564
 *             context = (func, args, kwargs, self)
 *             self.fcalcmon = context # this saves a pointer to context
 *             ierr = TMMSetCalcMonitorFunction(self.state, calcMonitorCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetCalcMonitorFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetCalcMonitorFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_calcMonitorCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":561
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setCalcMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fcalcmon = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":566
 *             ierr = TMMSetCalcMonitorFunction(self.state, calcMonitorCB, <void*>context)
 *         else:
 *             ierr = TMMSetCalcMonitorFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetCalcMonitorFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":567
 *         else:
 *             ierr = TMMSetCalcMonitorFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetCalcMonitorFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 567, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 567, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 567, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 567, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 567, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":558
 * #             raise RuntimeError(f"TMMSetIniMonitorFunction failed with error code {ierr}")
 * 
 *     def setCalcMonitorFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setCalcMonitorFunction failed: -use_monitor not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setCalcMonitorFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":571
 * #             raise RuntimeError(f"TMMSetCalcMonitorFunction failed with error code {ierr}")
 * 
 *     def setWriMonitorFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setWriMonitorFunction failed: -use_monitor not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_31setWriMonitorFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_31setWriMonitorFunction = {"setWriMonitorFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_31setWriMonitorFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_31setWriMonitorFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setWriMonitorFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 571, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 571, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setWriMonitorFunction", 1) < 0) __PYX_ERR(0, 571, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setWriMonitorFunction", 0, 1, 1, i); __PYX_ERR(0, 571, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 571, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setWriMonitorFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 571, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setWriMonitorFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_30setWriMonitorFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_30setWriMonitorFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setWriMonitorFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":572
 * 
 *     def setWriMonitorFunction(self, func, *args, **kwargs):
 *         if not self.config['useMonitor']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setWriMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_useMonitor); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 572, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 572, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":573
 *     def setWriMonitorFunction(self, func, *args, **kwargs):
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setWriMonitorFunction failed: -use_monitor not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setWriMonitorFunction_failed_use};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 573, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 573, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":572
 * 
 *     def setWriMonitorFunction(self, func, *args, **kwargs):
 *         if not self.config['useMonitor']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setWriMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":574
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setWriMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fwrimon = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":575
 *             raise RuntimeError("setWriMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.fwrimon = context # this saves a pointer to context
 *             ierr = TMMSetWriMonitorFunction(self.state, wriMonitorCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 575, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 575, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 575, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 575, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 575, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":576
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.fwrimon = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetWriMonitorFunction(self.state, wriMonitorCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->fwrimon);
    __Pyx_DECREF(__pyx_v_self->fwrimon);
    __pyx_v_self->fwrimon = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":577
 *             context = (func, args, kwargs, self)
 *             self.fwrimon = context # this saves a pointer to context
 *             ierr = TMMSetWriMonitorFunction(self.state, wriMonitorCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetWriMonitorFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetWriMonitorFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_wriMonitorCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":574
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setWriMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fwrimon = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":579
 *             ierr = TMMSetWriMonitorFunction(self.state, wriMonitorCB, <void*>context)
 *         else:
 *             ierr = TMMSetWriMonitorFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetWriMonitorFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":580
 *         else:
 *             ierr = TMMSetWriMonitorFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetWriMonitorFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 580, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 580, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 580, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 580, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 580, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":571
 * #             raise RuntimeError(f"TMMSetCalcMonitorFunction failed with error code {ierr}")
 * 
 *     def setWriMonitorFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setWriMonitorFunction failed: -use_monitor not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setWriMonitorFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":584
 * #             raise RuntimeError(f"TMMSetWriMonitorFunction failed with error code {ierr}")
 * 
 *     def setFinMonitorFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setFinMonitorFunction failed: -use_monitor not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_33setFinMonitorFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_33setFinMonitorFunction = {"setFinMonitorFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_33setFinMonitorFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_33setFinMonitorFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setFinMonitorFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 584, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 584, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setFinMonitorFunction", 1) < 0) __PYX_ERR(0, 584, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setFinMonitorFunction", 0, 1, 1, i); __PYX_ERR(0, 584, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 584, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setFinMonitorFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 584, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setFinMonitorFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_32setFinMonitorFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_32setFinMonitorFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setFinMonitorFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":585
 * 
 *     def setFinMonitorFunction(self, func, *args, **kwargs):
 *         if not self.config['useMonitor']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setFinMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_useMonitor); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 585, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 585, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":586
 *     def setFinMonitorFunction(self, func, *args, **kwargs):
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setFinMonitorFunction failed: -use_monitor not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setFinMonitorFunction_failed_use};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 586, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":585
 * 
 *     def setFinMonitorFunction(self, func, *args, **kwargs):
 *         if not self.config['useMonitor']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setFinMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":587
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setFinMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.ffinmon = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":588
 *             raise RuntimeError("setFinMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.ffinmon = context # this saves a pointer to context
 *             ierr = TMMSetFinMonitorFunction(self.state, finMonitorCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 588, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 588, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 588, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 588, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 588, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":589
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.ffinmon = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetFinMonitorFunction(self.state, finMonitorCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->ffinmon);
    __Pyx_DECREF(__pyx_v_self->ffinmon);
    __pyx_v_self->ffinmon = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":590
 *             context = (func, args, kwargs, self)
 *             self.ffinmon = context # this saves a pointer to context
 *             ierr = TMMSetFinMonitorFunction(self.state, finMonitorCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetFinMonitorFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetFinMonitorFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_finMonitorCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":587
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setFinMonitorFunction failed: -use_monitor not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.ffinmon = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":592
 *             ierr = TMMSetFinMonitorFunction(self.state, finMonitorCB, <void*>context)
 *         else:
 *             ierr = TMMSetFinMonitorFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetFinMonitorFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":593
 *         else:
 *             ierr = TMMSetFinMonitorFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetFinMonitorFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 593, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 593, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 593, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 593, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 593, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":584
 * #             raise RuntimeError(f"TMMSetWriMonitorFunction failed with error code {ierr}")
 * 
 *     def setFinMonitorFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setFinMonitorFunction failed: -use_monitor not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setFinMonitorFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":597
 * #             raise RuntimeError(f"TMMSetFinMonitorFunction failed with error code {ierr}")
 * 
 *     def setIniMisfitFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setIniMisfitFunction failed: -calc_misfit not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_35setIniMisfitFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_35setIniMisfitFunction = {"setIniMisfitFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_35setIniMisfitFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_35setIniMisfitFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setIniMisfitFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 597, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 597, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setIniMisfitFunction", 1) < 0) __PYX_ERR(0, 597, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setIniMisfitFunction", 0, 1, 1, i); __PYX_ERR(0, 597, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 597, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setIniMisfitFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 597, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setIniMisfitFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_34setIniMisfitFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_34setIniMisfitFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setIniMisfitFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":598
 * 
 *     def setIniMisfitFunction(self, func, *args, **kwargs):
 *         if not self.config['doMisfit']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setIniMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_doMisfit); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 598, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 598, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":599
 *     def setIniMisfitFunction(self, func, *args, **kwargs):
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setIniMisfitFunction failed: -calc_misfit not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setIniMisfitFunction_failed_calc};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 599, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 599, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":598
 * 
 *     def setIniMisfitFunction(self, func, *args, **kwargs):
 *         if not self.config['doMisfit']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setIniMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":600
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setIniMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.finimis = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":601
 *             raise RuntimeError("setIniMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.finimis = context # this saves a pointer to context
 *             ierr = TMMSetIniMisfitFunction(self.state, iniMisfitCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 601, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 601, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 601, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 601, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 601, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":602
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.finimis = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetIniMisfitFunction(self.state, iniMisfitCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->finimis);
    __Pyx_DECREF(__pyx_v_self->finimis);
    __pyx_v_self->finimis = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":603
 *             context = (func, args, kwargs, self)
 *             self.finimis = context # this saves a pointer to context
 *             ierr = TMMSetIniMisfitFunction(self.state, iniMisfitCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetIniMisfitFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetIniMisfitFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_iniMisfitCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":600
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setIniMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.finimis = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":605
 *             ierr = TMMSetIniMisfitFunction(self.state, iniMisfitCB, <void*>context)
 *         else:
 *             ierr = TMMSetIniMisfitFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetIniMisfitFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":606
 *         else:
 *             ierr = TMMSetIniMisfitFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetIniMisfitFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 606, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 606, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 606, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 606, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 606, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":597
 * #             raise RuntimeError(f"TMMSetFinMonitorFunction failed with error code {ierr}")
 * 
 *     def setIniMisfitFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setIniMisfitFunction failed: -calc_misfit not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setIniMisfitFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":610
 * #             raise RuntimeError(f"TMMSetIniMisfitFunction failed with error code {ierr}")
 * 
 *     def setCalcMisfitFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setCalcMisfitFunction failed: -calc_misfit not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_37setCalcMisfitFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_37setCalcMisfitFunction = {"setCalcMisfitFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_37setCalcMisfitFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_37setCalcMisfitFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setCalcMisfitFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 610, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 610, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setCalcMisfitFunction", 1) < 0) __PYX_ERR(0, 610, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setCalcMisfitFunction", 0, 1, 1, i); __PYX_ERR(0, 610, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 610, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setCalcMisfitFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 610, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setCalcMisfitFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_36setCalcMisfitFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_36setCalcMisfitFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setCalcMisfitFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":611
 * 
 *     def setCalcMisfitFunction(self, func, *args, **kwargs):
 *         if not self.config['doMisfit']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setCalcMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_doMisfit); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 611, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 611, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":612
 *     def setCalcMisfitFunction(self, func, *args, **kwargs):
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setCalcMisfitFunction failed: -calc_misfit not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setCalcMisfitFunction_failed_cal};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 612, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":611
 * 
 *     def setCalcMisfitFunction(self, func, *args, **kwargs):
 *         if not self.config['doMisfit']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setCalcMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":613
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setCalcMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fcalcmis = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":614
 *             raise RuntimeError("setCalcMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.fcalcmis = context # this saves a pointer to context
 *             ierr = TMMSetCalcMisfitFunction(self.state, calcMisfitCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 614, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 614, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 614, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 614, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 614, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":615
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.fcalcmis = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetCalcMisfitFunction(self.state, calcMisfitCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->fcalcmis);
    __Pyx_DECREF(__pyx_v_self->fcalcmis);
    __pyx_v_self->fcalcmis = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":616
 *             context = (func, args, kwargs, self)
 *             self.fcalcmis = context # this saves a pointer to context
 *             ierr = TMMSetCalcMisfitFunction(self.state, calcMisfitCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetCalcMisfitFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetCalcMisfitFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_calcMisfitCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":613
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setCalcMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fcalcmis = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":618
 *             ierr = TMMSetCalcMisfitFunction(self.state, calcMisfitCB, <void*>context)
 *         else:
 *             ierr = TMMSetCalcMisfitFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetCalcMisfitFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":619
 *         else:
 *             ierr = TMMSetCalcMisfitFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetCalcMisfitFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 619, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 619, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 619, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 619, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":610
 * #             raise RuntimeError(f"TMMSetIniMisfitFunction failed with error code {ierr}")
 * 
 *     def setCalcMisfitFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setCalcMisfitFunction failed: -calc_misfit not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setCalcMisfitFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":623
 * #             raise RuntimeError(f"TMMSetCalcMisfitFunction failed with error code {ierr}")
 * 
 *     def setWriMisfitFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setWriMisfitFunction failed: -calc_misfit not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_39setWriMisfitFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_39setWriMisfitFunction = {"setWriMisfitFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_39setWriMisfitFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_39setWriMisfitFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setWriMisfitFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 623, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 623, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setWriMisfitFunction", 1) < 0) __PYX_ERR(0, 623, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setWriMisfitFunction", 0, 1, 1, i); __PYX_ERR(0, 623, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 623, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setWriMisfitFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 623, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setWriMisfitFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_38setWriMisfitFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_38setWriMisfitFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setWriMisfitFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":624
 * 
 *     def setWriMisfitFunction(self, func, *args, **kwargs):
 *         if not self.config['doMisfit']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setWriMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_doMisfit); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 624, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":625
 *     def setWriMisfitFunction(self, func, *args, **kwargs):
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setWriMisfitFunction failed: -calc_misfit not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setWriMisfitFunction_failed_calc};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 625, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":624
 * 
 *     def setWriMisfitFunction(self, func, *args, **kwargs):
 *         if not self.config['doMisfit']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setWriMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":626
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setWriMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fwrimis = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":627
 *             raise RuntimeError("setWriMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.fwrimis = context # this saves a pointer to context
 *             ierr = TMMSetWriMisfitFunction(self.state, wriMisfitCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 627, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 627, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 627, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 627, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":628
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.fwrimis = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetWriMisfitFunction(self.state, wriMisfitCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->fwrimis);
    __Pyx_DECREF(__pyx_v_self->fwrimis);
    __pyx_v_self->fwrimis = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":629
 *             context = (func, args, kwargs, self)
 *             self.fwrimis = context # this saves a pointer to context
 *             ierr = TMMSetWriMisfitFunction(self.state, wriMisfitCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetWriMisfitFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetWriMisfitFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_wriMisfitCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":626
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setWriMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.fwrimis = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":631
 *             ierr = TMMSetWriMisfitFunction(self.state, wriMisfitCB, <void*>context)
 *         else:
 *             ierr = TMMSetWriMisfitFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetWriMisfitFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":632
 *         else:
 *             ierr = TMMSetWriMisfitFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetWriMisfitFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 632, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 632, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 632, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 632, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":623
 * #             raise RuntimeError(f"TMMSetCalcMisfitFunction failed with error code {ierr}")
 * 
 *     def setWriMisfitFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setWriMisfitFunction failed: -calc_misfit not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setWriMisfitFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":636
 * #             raise RuntimeError(f"TMMSetWriMisfitFunction failed with error code {ierr}")
 * 
 *     def setFinMisfitFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setFinMisfitFunction failed: -calc_misfit not specified")
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_41setFinMisfitFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_41setFinMisfitFunction = {"setFinMisfitFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_41setFinMisfitFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_41setFinMisfitFunction(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setFinMisfitFunction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  __pyx_v_args = __Pyx_ArgsSlice_FASTCALL(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_v_args);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_func,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 636, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        default:
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 636, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      const Py_ssize_t used_pos_args = (kwd_pos_args < 1) ? kwd_pos_args : 1;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, __pyx_kwds_len, "setFinMisfitFunction", 1) < 0) __PYX_ERR(0, 636, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setFinMisfitFunction", 0, 1, 1, i); __PYX_ERR(0, 636, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs < 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 636, __pyx_L3_error)
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setFinMisfitFunction", 0, 1, 1, __pyx_nargs); __PYX_ERR(0, 636, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setFinMisfitFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_40setFinMisfitFunction(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_DECREF(__pyx_v_args);
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_40setFinMisfitFunction(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_context = NULL;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setFinMisfitFunction", 0);

  /* "tmm4py/tmm4py_core.pyx":637
 * 
 *     def setFinMisfitFunction(self, func, *args, **kwargs):
 *         if not self.config['doMisfit']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setFinMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_doMisfit); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 637, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (unlikely(__pyx_t_3)) {

    /* "tmm4py/tmm4py_core.pyx":638
 *     def setFinMisfitFunction(self, func, *args, **kwargs):
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setFinMisfitFunction failed: -calc_misfit not specified")             # <<<<<<<<<<<<<<
 *         if func is not None:
 *             context = (func, args, kwargs, self)
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_mstate_global->__pyx_kp_u_setFinMisfitFunction_failed_calc};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 638, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 638, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":637
 * 
 *     def setFinMisfitFunction(self, func, *args, **kwargs):
 *         if not self.config['doMisfit']:             # <<<<<<<<<<<<<<
 *             raise RuntimeError("setFinMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":639
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setFinMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.ffinmis = context # this saves a pointer to context
*/
  __pyx_t_3 = (__pyx_v_func != Py_None);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":640
 *             raise RuntimeError("setFinMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:
 *             context = (func, args, kwargs, self)             # <<<<<<<<<<<<<<
 *             self.ffinmis = context # this saves a pointer to context
 *             ierr = TMMSetFinMisfitFunction(self.state, finMisfitCB, <void*>context)
*/
    __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 640, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_func);
    __Pyx_GIVEREF(__pyx_v_func);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_func) != (0)) __PYX_ERR(0, 640, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_args) != (0)) __PYX_ERR(0, 640, __pyx_L1_error);
    __Pyx_INCREF(__pyx_v_kwargs);
    __Pyx_GIVEREF(__pyx_v_kwargs);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_kwargs) != (0)) __PYX_ERR(0, 640, __pyx_L1_error);
    __Pyx_INCREF((PyObject *)__pyx_v_self);
    __Pyx_GIVEREF((PyObject *)__pyx_v_self);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self)) != (0)) __PYX_ERR(0, 640, __pyx_L1_error);
    __pyx_v_context = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":641
 *         if func is not None:
 *             context = (func, args, kwargs, self)
 *             self.ffinmis = context # this saves a pointer to context             # <<<<<<<<<<<<<<
 *             ierr = TMMSetFinMisfitFunction(self.state, finMisfitCB, <void*>context)
 *         else:
*/
    __Pyx_INCREF(__pyx_v_context);
    __Pyx_GIVEREF(__pyx_v_context);
    __Pyx_GOTREF(__pyx_v_self->ffinmis);
    __Pyx_DECREF(__pyx_v_self->ffinmis);
    __pyx_v_self->ffinmis = __pyx_v_context;

    /* "tmm4py/tmm4py_core.pyx":642
 *             context = (func, args, kwargs, self)
 *             self.ffinmis = context # this saves a pointer to context
 *             ierr = TMMSetFinMisfitFunction(self.state, finMisfitCB, <void*>context)             # <<<<<<<<<<<<<<
 *         else:
 *             ierr = TMMSetFinMisfitFunction(self.state, NULL, NULL)
*/
    __pyx_v_ierr = TMMSetFinMisfitFunction(__pyx_v_self->state, __pyx_f_6tmm4py_11tmm4py_core_finMisfitCB, ((void *)__pyx_v_context));

    /* "tmm4py/tmm4py_core.pyx":639
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setFinMisfitFunction failed: -calc_misfit not specified")
 *         if func is not None:             # <<<<<<<<<<<<<<
 *             context = (func, args, kwargs, self)
 *             self.ffinmis = context # this saves a pointer to context
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":644
 *             ierr = TMMSetFinMisfitFunction(self.state, finMisfitCB, <void*>context)
 *         else:
 *             ierr = TMMSetFinMisfitFunction(self.state, NULL, NULL)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  /*else*/ {
    __pyx_v_ierr = TMMSetFinMisfitFunction(__pyx_v_self->state, NULL, NULL);
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":645
 *         else:
 *             ierr = TMMSetFinMisfitFunction(self.state, NULL, NULL)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetFinMisfitFunction failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 645, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 645, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 645, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 645, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 645, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":636
 * #             raise RuntimeError(f"TMMSetWriMisfitFunction failed with error code {ierr}")
 * 
 *     def setFinMisfitFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setFinMisfitFunction failed: -calc_misfit not specified")
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setFinMisfitFunction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_context);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":649
 * #             raise RuntimeError(f"TMMSetFinMisfitFunction failed with error code {ierr}")
 * 
 *     def getConfig(self):             # <<<<<<<<<<<<<<
 *         if True: #toBool(self.state.isInitialized):
 *           config = _getStateConfig(self.state)
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_43getConfig(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_43getConfig = {"getConfig", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_43getConfig, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_43getConfig(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("getConfig (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("getConfig", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("getConfig", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_42getConfig(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_42getConfig(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_v_config = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("getConfig", 0);

  /* "tmm4py/tmm4py_core.pyx":651
 *     def getConfig(self):
 *         if True: #toBool(self.state.isInitialized):
 *           config = _getStateConfig(self.state)             # <<<<<<<<<<<<<<
 *           return config
 *         else:
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core__getStateConfig(__pyx_v_self->state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 651, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_config = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":652
 *         if True: #toBool(self.state.isInitialized):
 *           config = _getStateConfig(self.state)
 *           return config             # <<<<<<<<<<<<<<
 *         else:
 *           raise RuntimeError("getConfig failed because state is uninitialized!")
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_config);
  __pyx_r = __pyx_v_config;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":649
 * #             raise RuntimeError(f"TMMSetFinMisfitFunction failed with error code {ierr}")
 * 
 *     def getConfig(self):             # <<<<<<<<<<<<<<
 *         if True: #toBool(self.state.isInitialized):
 *           config = _getStateConfig(self.state)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.getConfig", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_config);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":656
 *           raise RuntimeError("getConfig failed because state is uninitialized!")
 * 
 *     def getNumTracers(self):             # <<<<<<<<<<<<<<
 *         return toInt(self.state.numTracers)
 * 
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_45getNumTracers(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_45getNumTracers = {"getNumTracers", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_45getNumTracers, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_45getNumTracers(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("getNumTracers (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("getNumTracers", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("getNumTracers", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_44getNumTracers(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_44getNumTracers(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("getNumTracers", 0);

  /* "tmm4py/tmm4py_core.pyx":657
 * 
 *     def getNumTracers(self):
 *         return toInt(self.state.numTracers)             # <<<<<<<<<<<<<<
 * 
 *     def setFromOptions(self, prefix="", doOutput=True):
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_self->state->numTracers); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":656
 *           raise RuntimeError("getConfig failed because state is uninitialized!")
 * 
 *     def getNumTracers(self):             # <<<<<<<<<<<<<<
 *         return toInt(self.state.numTracers)
 * 
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.getNumTracers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":659
 *         return toInt(self.state.numTracers)
 * 
 *     def setFromOptions(self, prefix="", doOutput=True):             # <<<<<<<<<<<<<<
 *         cdef const char* pre
 *         cdef PetscScalar *data_pointer
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_47setFromOptions(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_47setFromOptions = {"setFromOptions", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_47setFromOptions, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_47setFromOptions(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_prefix = 0;
  PyObject *__pyx_v_doOutput = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setFromOptions (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_prefix,&__pyx_mstate_global->__pyx_n_u_doOutput,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 659, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 659, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 659, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "setFromOptions", 0) < 0) __PYX_ERR(0, 659, __pyx_L3_error)
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_kp_u_));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_True));
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 659, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 659, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_kp_u_));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_True));
    }
    __pyx_v_prefix = values[0];
    __pyx_v_doOutput = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setFromOptions", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 659, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setFromOptions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_46setFromOptions(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_prefix, __pyx_v_doOutput);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_46setFromOptions(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_prefix, PyObject *__pyx_v_doOutput) {
  char const *__pyx_v_pre;
  PetscScalar *__pyx_v_data_pointer;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_v_OptDBState = NULL;
  PyObject *__pyx_v_rank = NULL;
  PyObject *__pyx_v_c = NULL;
  PyObject *__pyx_v_itr = NULL;
  PyObject *__pyx_v_myId = NULL;
  PyObject *__pyx_v_qf = NULL;
  PyObject *__pyx_v_qef = NULL;
  PyObject *__pyx_v_qrel = NULL;
  PyObject *__pyx_v_cbc = NULL;
  PyObject *__pyx_v_cbf = NULL;
  CYTHON_UNUSED PyObject *__pyx_7genexpr__pyx_v_itr = NULL;
  CYTHON_UNUSED PyObject *__pyx_8genexpr1__pyx_v_itr = NULL;
  CYTHON_UNUSED PyObject *__pyx_8genexpr2__pyx_v_itr = NULL;
  CYTHON_UNUSED PyObject *__pyx_8genexpr3__pyx_v_itr = NULL;
  CYTHON_UNUSED PyObject *__pyx_8genexpr4__pyx_v_itr = NULL;
  CYTHON_UNUSED PyObject *__pyx_8genexpr5__pyx_v_itr = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  size_t __pyx_t_3;
  char *__pyx_t_4;
  PetscBool __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  PyObject *(*__pyx_t_10)(PyObject *);
  Py_ssize_t __pyx_t_11;
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13[6];
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setFromOptions", 0);

  /* "tmm4py/tmm4py_core.pyx":663
 *         cdef PetscScalar *data_pointer
 * 
 *         pre = PyBytes_AsString(prefix.encode())             # <<<<<<<<<<<<<<
 * 
 *         cdef PetscErrorCode ierr
*/
  __pyx_t_2 = __pyx_v_prefix;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 663, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_t_4 = PyBytes_AsString(__pyx_t_1); if (unlikely(__pyx_t_4 == ((char *)0))) __PYX_ERR(0, 663, __pyx_L1_error)
  __pyx_v_pre = __pyx_t_4;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":666
 * 
 *         cdef PetscErrorCode ierr
 *         ierr = TMMSetFromOptions(self.state, pre, asBool(doOutput))             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_asBool(__pyx_v_doOutput); if (unlikely(__pyx_t_5 == ((PetscBool)((PetscBool)0)) && PyErr_Occurred())) __PYX_ERR(0, 666, __pyx_L1_error)
  __pyx_v_ierr = TMMSetFromOptions(__pyx_v_self->state, __pyx_v_pre, __pyx_t_5);

  /* "tmm4py/tmm4py_core.pyx":667
 *         cdef PetscErrorCode ierr
 *         ierr = TMMSetFromOptions(self.state, pre, asBool(doOutput))
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMSetFromOptions failed with error code {ierr}")
*/
  __pyx_t_6 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_6)) {
    __pyx_t_2 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 667, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 667, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 667, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_3 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_8);
      assert(__pyx_t_2);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_8);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_8, __pyx__function);
      __pyx_t_3 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_7};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 667, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 667, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":671
 * #             raise RuntimeError(f"TMMSetFromOptions failed with error code {ierr}")
 * 
 *         self.stateId=toInt(self.state.stateId)             # <<<<<<<<<<<<<<
 *         self.numTracers=toInt(self.state.numTracers)
 *         self.config=_getStateConfig(self.state)
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_self->state->stateId); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 671, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->stateId);
  __Pyx_DECREF(__pyx_v_self->stateId);
  __pyx_v_self->stateId = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":672
 * 
 *         self.stateId=toInt(self.state.stateId)
 *         self.numTracers=toInt(self.state.numTracers)             # <<<<<<<<<<<<<<
 *         self.config=_getStateConfig(self.state)
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_self->state->numTracers); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->numTracers);
  __Pyx_DECREF(__pyx_v_self->numTracers);
  __pyx_v_self->numTracers = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":673
 *         self.stateId=toInt(self.state.stateId)
 *         self.numTracers=toInt(self.state.numTracers)
 *         self.config=_getStateConfig(self.state)             # <<<<<<<<<<<<<<
 * 
 *         OptDBState=PETSc.Options(prefix)
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core__getStateConfig(__pyx_v_self->state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 673, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->config);
  __Pyx_DECREF(__pyx_v_self->config);
  __pyx_v_self->config = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":675
 *         self.config=_getStateConfig(self.state)
 * 
 *         OptDBState=PETSc.Options(prefix)             # <<<<<<<<<<<<<<
 *         if OptDBState.hasName("tracer_names"):
 *           self.tracerNames=OptDBState.getString("tracer_names").split(",")
*/
  __pyx_t_8 = NULL;
  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 675, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_Options); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 675, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_3 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_2);
    assert(__pyx_t_8);
    PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_2);
    __Pyx_INCREF(__pyx_t_8);
    __Pyx_INCREF(__pyx__function);
    __Pyx_DECREF_SET(__pyx_t_2, __pyx__function);
    __pyx_t_3 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_prefix};
    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 675, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_v_OptDBState = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":676
 * 
 *         OptDBState=PETSc.Options(prefix)
 *         if OptDBState.hasName("tracer_names"):             # <<<<<<<<<<<<<<
 *           self.tracerNames=OptDBState.getString("tracer_names").split(",")
 *         else:
*/
  __pyx_t_2 = __pyx_v_OptDBState;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_mstate_global->__pyx_n_u_tracer_names};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_hasName, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 676, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 676, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":677
 *         OptDBState=PETSc.Options(prefix)
 *         if OptDBState.hasName("tracer_names"):
 *           self.tracerNames=OptDBState.getString("tracer_names").split(",")             # <<<<<<<<<<<<<<
 *         else:
 *           self.tracerNames=None
*/
    __pyx_t_7 = __pyx_v_OptDBState;
    __Pyx_INCREF(__pyx_t_7);
    __pyx_t_3 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_mstate_global->__pyx_n_u_tracer_names};
      __pyx_t_8 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_getString, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 677, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
    }
    __pyx_t_2 = __pyx_t_8;
    __Pyx_INCREF(__pyx_t_2);
    __pyx_t_3 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_mstate_global->__pyx_kp_u__2};
      __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_split, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_GIVEREF(__pyx_t_1);
    __Pyx_GOTREF(__pyx_v_self->tracerNames);
    __Pyx_DECREF(__pyx_v_self->tracerNames);
    __pyx_v_self->tracerNames = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":676
 * 
 *         OptDBState=PETSc.Options(prefix)
 *         if OptDBState.hasName("tracer_names"):             # <<<<<<<<<<<<<<
 *           self.tracerNames=OptDBState.getString("tracer_names").split(",")
 *         else:
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":679
 *           self.tracerNames=OptDBState.getString("tracer_names").split(",")
 *         else:
 *           self.tracerNames=None             # <<<<<<<<<<<<<<
 * 
 *         rank = petsc4py.PETSc.COMM_WORLD.getRank()
*/
  /*else*/ {
    __Pyx_INCREF(Py_None);
    __Pyx_GIVEREF(Py_None);
    __Pyx_GOTREF(__pyx_v_self->tracerNames);
    __Pyx_DECREF(__pyx_v_self->tracerNames);
    __pyx_v_self->tracerNames = Py_None;
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":681
 *           self.tracerNames=None
 * 
 *         rank = petsc4py.PETSc.COMM_WORLD.getRank()             # <<<<<<<<<<<<<<
 *         c = [[] for itr in range(self.numTracers)]
 *         for itr in range(self.numTracers):
*/
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_petsc4py); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 681, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 681, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_COMM_WORLD); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 681, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8 = __pyx_t_2;
  __Pyx_INCREF(__pyx_t_8);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_8, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_getRank, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 681, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_v_rank = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":682
 * 
 *         rank = petsc4py.PETSc.COMM_WORLD.getRank()
 *         c = [[] for itr in range(self.numTracers)]             # <<<<<<<<<<<<<<
 *         for itr in range(self.numTracers):
 * #           Get pointer to data
*/
  { /* enter inner scope */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 682, __pyx_L7_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_8 = NULL;
    __Pyx_INCREF(__pyx_builtin_range);
    __pyx_t_7 = __pyx_builtin_range; 
    __pyx_t_3 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_self->numTracers};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L7_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
      __pyx_t_7 = __pyx_t_2; __Pyx_INCREF(__pyx_t_7);
      __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 682, __pyx_L7_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_10 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 682, __pyx_L7_error)
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(PyList_CheckExact(__pyx_t_7))) {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_7);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 682, __pyx_L7_error)
            #endif
            if (__pyx_t_9 >= __pyx_temp) break;
          }
          __pyx_t_2 = __Pyx_PyList_GetItemRef(__pyx_t_7, __pyx_t_9);
          ++__pyx_t_9;
        } else {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_7);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 682, __pyx_L7_error)
            #endif
            if (__pyx_t_9 >= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_2 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_9));
          #else
          __pyx_t_2 = __Pyx_PySequence_ITEM(__pyx_t_7, __pyx_t_9);
          #endif
          ++__pyx_t_9;
        }
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L7_error)
      } else {
        __pyx_t_2 = __pyx_t_10(__pyx_t_7);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 682, __pyx_L7_error)
            PyErr_Clear();
          }
          break;
        }
      }
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_XDECREF_SET(__pyx_7genexpr__pyx_v_itr, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L7_error)
      __Pyx_GOTREF(__pyx_t_2);
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 682, __pyx_L7_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    }
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_XDECREF(__pyx_7genexpr__pyx_v_itr); __pyx_7genexpr__pyx_v_itr = 0;
    goto __pyx_L11_exit_scope;
    __pyx_L7_error:;
    __Pyx_XDECREF(__pyx_7genexpr__pyx_v_itr); __pyx_7genexpr__pyx_v_itr = 0;
    goto __pyx_L1_error;
    __pyx_L11_exit_scope:;
  } /* exit inner scope */
  __pyx_v_c = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":683
 *         rank = petsc4py.PETSc.COMM_WORLD.getRank()
 *         c = [[] for itr in range(self.numTracers)]
 *         for itr in range(self.numTracers):             # <<<<<<<<<<<<<<
 * #           Get pointer to data
 *             ierr = VecGetArray(self.state.c[itr], &data_pointer)
*/
  __pyx_t_7 = NULL;
  __Pyx_INCREF(__pyx_builtin_range);
  __pyx_t_2 = __pyx_builtin_range; 
  __pyx_t_3 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_v_self->numTracers};
    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 683, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2);
    __pyx_t_9 = 0;
    __pyx_t_10 = NULL;
  } else {
    __pyx_t_9 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 683, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_10 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 683, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_10)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        {
          Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_2);
          #if !CYTHON_ASSUME_SAFE_SIZE
          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 683, __pyx_L1_error)
          #endif
          if (__pyx_t_9 >= __pyx_temp) break;
        }
        __pyx_t_1 = __Pyx_PyList_GetItemRef(__pyx_t_2, __pyx_t_9);
        ++__pyx_t_9;
      } else {
        {
          Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_2);
          #if !CYTHON_ASSUME_SAFE_SIZE
          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 683, __pyx_L1_error)
          #endif
          if (__pyx_t_9 >= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_9));
        #else
        __pyx_t_1 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_9);
        #endif
        ++__pyx_t_9;
      }
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 683, __pyx_L1_error)
    } else {
      __pyx_t_1 = __pyx_t_10(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 683, __pyx_L1_error)
          PyErr_Clear();
        }
        break;
      }
    }
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_XDECREF_SET(__pyx_v_itr, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":685
 *         for itr in range(self.numTracers):
 * #           Get pointer to data
 *             ierr = VecGetArray(self.state.c[itr], &data_pointer)             # <<<<<<<<<<<<<<
 *             if ierr != 0: raise PETSc.Error(ierr)
 *             myId = f"Id={self.stateId}-c[{itr}], r={rank}"
*/
    __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 685, __pyx_L1_error)
    __pyx_v_ierr = VecGetArray((__pyx_v_self->state->c[__pyx_t_11]), (&__pyx_v_data_pointer));

    /* "tmm4py/tmm4py_core.pyx":686
 * #           Get pointer to data
 *             ierr = VecGetArray(self.state.c[itr], &data_pointer)
 *             if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *             myId = f"Id={self.stateId}-c[{itr}], r={rank}"
 *             c[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.c[itr], myId)
*/
    __pyx_t_6 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_6)) {
      __pyx_t_7 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 686, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 686, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 686, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_3 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_12))) {
        __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_12);
        assert(__pyx_t_7);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_12);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_12, __pyx__function);
        __pyx_t_3 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_8};
        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_12, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 686, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_Raise(__pyx_t_1, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __PYX_ERR(0, 686, __pyx_L1_error)
    }

    /* "tmm4py/tmm4py_core.pyx":687
 *             ierr = VecGetArray(self.state.c[itr], &data_pointer)
 *             if ierr != 0: raise PETSc.Error(ierr)
 *             myId = f"Id={self.stateId}-c[{itr}], r={rank}"             # <<<<<<<<<<<<<<
 *             c[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.c[itr], myId)
 *         self.c=_ImmutableList(c)
*/
    __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_v_self->stateId, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 687, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_12 = __Pyx_PyObject_FormatSimple(__pyx_v_itr, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 687, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_8 = __Pyx_PyObject_FormatSimple(__pyx_v_rank, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 687, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_13[0] = __pyx_mstate_global->__pyx_kp_u_Id_2;
    __pyx_t_13[1] = __pyx_t_1;
    __pyx_t_13[2] = __pyx_mstate_global->__pyx_kp_u_c;
    __pyx_t_13[3] = __pyx_t_12;
    __pyx_t_13[4] = __pyx_mstate_global->__pyx_kp_u_r;
    __pyx_t_13[5] = __pyx_t_8;
    __pyx_t_7 = __Pyx_PyUnicode_Join(__pyx_t_13, 6, 3 * 2 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_1) + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_12) + 5 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_8), 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_1) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_12) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_8));
    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 687, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __Pyx_XDECREF_SET(__pyx_v_myId, ((PyObject*)__pyx_t_7));
    __pyx_t_7 = 0;

    /* "tmm4py/tmm4py_core.pyx":688
 *             if ierr != 0: raise PETSc.Error(ierr)
 *             myId = f"Id={self.stateId}-c[{itr}], r={rank}"
 *             c[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.c[itr], myId)             # <<<<<<<<<<<<<<
 *         self.c=_ImmutableList(c)
 *         del c
*/
    __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 688, __pyx_L1_error)
    __pyx_t_7 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArray(lSize, __pyx_v_data_pointer, (__pyx_v_self->state->c[__pyx_t_11]), __pyx_v_myId); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 688, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    if (unlikely((PyObject_SetItem(__pyx_v_c, __pyx_v_itr, __pyx_t_7) < 0))) __PYX_ERR(0, 688, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

    /* "tmm4py/tmm4py_core.pyx":683
 *         rank = petsc4py.PETSc.COMM_WORLD.getRank()
 *         c = [[] for itr in range(self.numTracers)]
 *         for itr in range(self.numTracers):             # <<<<<<<<<<<<<<
 * #           Get pointer to data
 *             ierr = VecGetArray(self.state.c[itr], &data_pointer)
*/
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":689
 *             myId = f"Id={self.stateId}-c[{itr}], r={rank}"
 *             c[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.c[itr], myId)
 *         self.c=_ImmutableList(c)             # <<<<<<<<<<<<<<
 *         del c
 * 
*/
  __pyx_t_7 = NULL;
  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_ImmutableList); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __pyx_t_3 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(PyMethod_Check(__pyx_t_8))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_8);
    assert(__pyx_t_7);
    PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_8);
    __Pyx_INCREF(__pyx_t_7);
    __Pyx_INCREF(__pyx__function);
    __Pyx_DECREF_SET(__pyx_t_8, __pyx__function);
    __pyx_t_3 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_v_c};
    __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 689, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  }
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(__pyx_v_self->c);
  __Pyx_DECREF(__pyx_v_self->c);
  __pyx_v_self->c = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":690
 *             c[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.c[itr], myId)
 *         self.c=_ImmutableList(c)
 *         del c             # <<<<<<<<<<<<<<
 * 
 *         if self.config['useForcingFromFile']:
*/
  __Pyx_DECREF(__pyx_v_c); __pyx_v_c = 0;

  /* "tmm4py/tmm4py_core.pyx":692
 *         del c
 * 
 *         if self.config['useForcingFromFile']:             # <<<<<<<<<<<<<<
 *             qf = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):
*/
  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_useForcingFromFile); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 692, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 692, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":693
 * 
 *         if self.config['useForcingFromFile']:
 *             qf = [[] for itr in range(self.numTracers)]             # <<<<<<<<<<<<<<
 *             for itr in range(self.numTracers):
 * #               Get pointer to data
*/
    { /* enter inner scope */
      __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 693, __pyx_L19_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_7 = NULL;
      __Pyx_INCREF(__pyx_builtin_range);
      __pyx_t_12 = __pyx_builtin_range; 
      __pyx_t_3 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_v_self->numTracers};
        __pyx_t_8 = __Pyx_PyObject_FastCall(__pyx_t_12, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 693, __pyx_L19_error)
        __Pyx_GOTREF(__pyx_t_8);
      }
      if (likely(PyList_CheckExact(__pyx_t_8)) || PyTuple_CheckExact(__pyx_t_8)) {
        __pyx_t_12 = __pyx_t_8; __Pyx_INCREF(__pyx_t_12);
        __pyx_t_9 = 0;
        __pyx_t_10 = NULL;
      } else {
        __pyx_t_9 = -1; __pyx_t_12 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 693, __pyx_L19_error)
        __Pyx_GOTREF(__pyx_t_12);
        __pyx_t_10 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_12); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 693, __pyx_L19_error)
      }
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      for (;;) {
        if (likely(!__pyx_t_10)) {
          if (likely(PyList_CheckExact(__pyx_t_12))) {
            {
              Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_12);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 693, __pyx_L19_error)
              #endif
              if (__pyx_t_9 >= __pyx_temp) break;
            }
            __pyx_t_8 = __Pyx_PyList_GetItemRef(__pyx_t_12, __pyx_t_9);
            ++__pyx_t_9;
          } else {
            {
              Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_12);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 693, __pyx_L19_error)
              #endif
              if (__pyx_t_9 >= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_8 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_12, __pyx_t_9));
            #else
            __pyx_t_8 = __Pyx_PySequence_ITEM(__pyx_t_12, __pyx_t_9);
            #endif
            ++__pyx_t_9;
          }
          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 693, __pyx_L19_error)
        } else {
          __pyx_t_8 = __pyx_t_10(__pyx_t_12);
          if (unlikely(!__pyx_t_8)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 693, __pyx_L19_error)
              PyErr_Clear();
            }
            break;
          }
        }
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_XDECREF_SET(__pyx_8genexpr1__pyx_v_itr, __pyx_t_8);
        __pyx_t_8 = 0;
        __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 693, __pyx_L19_error)
        __Pyx_GOTREF(__pyx_t_8);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 693, __pyx_L19_error)
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      }
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_itr); __pyx_8genexpr1__pyx_v_itr = 0;
      goto __pyx_L23_exit_scope;
      __pyx_L19_error:;
      __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_itr); __pyx_8genexpr1__pyx_v_itr = 0;
      goto __pyx_L1_error;
      __pyx_L23_exit_scope:;
    } /* exit inner scope */
    __pyx_v_qf = ((PyObject*)__pyx_t_2);
    __pyx_t_2 = 0;

    /* "tmm4py/tmm4py_core.pyx":694
 *         if self.config['useForcingFromFile']:
 *             qf = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):             # <<<<<<<<<<<<<<
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.qf[itr], &data_pointer)
*/
    __pyx_t_12 = NULL;
    __Pyx_INCREF(__pyx_builtin_range);
    __pyx_t_8 = __pyx_builtin_range; 
    __pyx_t_3 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_v_self->numTracers};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 694, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
      __pyx_t_8 = __pyx_t_2; __Pyx_INCREF(__pyx_t_8);
      __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 694, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_10 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_8); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 694, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(PyList_CheckExact(__pyx_t_8))) {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_8);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 694, __pyx_L1_error)
            #endif
            if (__pyx_t_9 >= __pyx_temp) break;
          }
          __pyx_t_2 = __Pyx_PyList_GetItemRef(__pyx_t_8, __pyx_t_9);
          ++__pyx_t_9;
        } else {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_8);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 694, __pyx_L1_error)
            #endif
            if (__pyx_t_9 >= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_2 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_9));
          #else
          __pyx_t_2 = __Pyx_PySequence_ITEM(__pyx_t_8, __pyx_t_9);
          #endif
          ++__pyx_t_9;
        }
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 694, __pyx_L1_error)
      } else {
        __pyx_t_2 = __pyx_t_10(__pyx_t_8);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 694, __pyx_L1_error)
            PyErr_Clear();
          }
          break;
        }
      }
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_XDECREF_SET(__pyx_v_itr, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "tmm4py/tmm4py_core.pyx":696
 *             for itr in range(self.numTracers):
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.qf[itr], &data_pointer)             # <<<<<<<<<<<<<<
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-qf[{itr}], r={rank}"
*/
      __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 696, __pyx_L1_error)
      __pyx_v_ierr = VecGetArray((__pyx_v_self->state->qf[__pyx_t_11]), (&__pyx_v_data_pointer));

      /* "tmm4py/tmm4py_core.pyx":697
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.qf[itr], &data_pointer)
 *                 if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *                 myId = f"Id={self.stateId}-qf[{itr}], r={rank}"
 *                 qf[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qf[itr], myId)
*/
      __pyx_t_6 = (__pyx_v_ierr != 0);
      if (unlikely(__pyx_t_6)) {
        __pyx_t_12 = NULL;
        __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 697, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 697, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 697, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_3 = 1;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(PyMethod_Check(__pyx_t_1))) {
          __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_1);
          assert(__pyx_t_12);
          PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_12);
          __Pyx_INCREF(__pyx__function);
          __Pyx_DECREF_SET(__pyx_t_1, __pyx__function);
          __pyx_t_3 = 0;
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_t_7};
          __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 697, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
        }
        __Pyx_Raise(__pyx_t_2, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __PYX_ERR(0, 697, __pyx_L1_error)
      }

      /* "tmm4py/tmm4py_core.pyx":698
 *                 ierr = VecGetArray(self.state.qf[itr], &data_pointer)
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-qf[{itr}], r={rank}"             # <<<<<<<<<<<<<<
 *                 qf[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qf[itr], myId)
 *             self.qf=_ImmutableList(qf)
*/
      __pyx_t_2 = __Pyx_PyObject_FormatSimple(__pyx_v_self->stateId, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 698, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_v_itr, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_v_rank, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 698, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_13[0] = __pyx_mstate_global->__pyx_kp_u_Id_2;
      __pyx_t_13[1] = __pyx_t_2;
      __pyx_t_13[2] = __pyx_mstate_global->__pyx_kp_u_qf;
      __pyx_t_13[3] = __pyx_t_1;
      __pyx_t_13[4] = __pyx_mstate_global->__pyx_kp_u_r;
      __pyx_t_13[5] = __pyx_t_7;
      __pyx_t_12 = __Pyx_PyUnicode_Join(__pyx_t_13, 6, 3 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_2) + 4 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_1) + 5 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_7), 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_1) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7));
      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 698, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_XDECREF_SET(__pyx_v_myId, ((PyObject*)__pyx_t_12));
      __pyx_t_12 = 0;

      /* "tmm4py/tmm4py_core.pyx":699
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-qf[{itr}], r={rank}"
 *                 qf[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qf[itr], myId)             # <<<<<<<<<<<<<<
 *             self.qf=_ImmutableList(qf)
 *             del qf
*/
      __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 699, __pyx_L1_error)
      __pyx_t_12 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArray(lSize, __pyx_v_data_pointer, (__pyx_v_self->state->qf[__pyx_t_11]), __pyx_v_myId); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 699, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      if (unlikely((PyObject_SetItem(__pyx_v_qf, __pyx_v_itr, __pyx_t_12) < 0))) __PYX_ERR(0, 699, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

      /* "tmm4py/tmm4py_core.pyx":694
 *         if self.config['useForcingFromFile']:
 *             qf = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):             # <<<<<<<<<<<<<<
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.qf[itr], &data_pointer)
*/
    }
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

    /* "tmm4py/tmm4py_core.pyx":700
 *                 myId = f"Id={self.stateId}-qf[{itr}], r={rank}"
 *                 qf[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qf[itr], myId)
 *             self.qf=_ImmutableList(qf)             # <<<<<<<<<<<<<<
 *             del qf
 * 
*/
    __pyx_t_12 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_ImmutableList); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 700, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_3 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_12);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_12);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_3 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_v_qf};
      __pyx_t_8 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 700, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
    }
    __Pyx_GIVEREF(__pyx_t_8);
    __Pyx_GOTREF(__pyx_v_self->qf);
    __Pyx_DECREF(__pyx_v_self->qf);
    __pyx_v_self->qf = __pyx_t_8;
    __pyx_t_8 = 0;

    /* "tmm4py/tmm4py_core.pyx":701
 *                 qf[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qf[itr], myId)
 *             self.qf=_ImmutableList(qf)
 *             del qf             # <<<<<<<<<<<<<<
 * 
 *         if self.config['useExternalForcing']:
*/
    __Pyx_DECREF(__pyx_v_qf); __pyx_v_qf = 0;

    /* "tmm4py/tmm4py_core.pyx":692
 *         del c
 * 
 *         if self.config['useForcingFromFile']:             # <<<<<<<<<<<<<<
 *             qf = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):
*/
  }

  /* "tmm4py/tmm4py_core.pyx":703
 *             del qf
 * 
 *         if self.config['useExternalForcing']:             # <<<<<<<<<<<<<<
 *             qef = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):
*/
  __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_useExternalForcing); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 703, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 703, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":704
 * 
 *         if self.config['useExternalForcing']:
 *             qef = [[] for itr in range(self.numTracers)]             # <<<<<<<<<<<<<<
 *             for itr in range(self.numTracers):
 * #               Get pointer to data
*/
    { /* enter inner scope */
      __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 704, __pyx_L31_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_12 = NULL;
      __Pyx_INCREF(__pyx_builtin_range);
      __pyx_t_1 = __pyx_builtin_range; 
      __pyx_t_3 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_v_self->numTracers};
        __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 704, __pyx_L31_error)
        __Pyx_GOTREF(__pyx_t_7);
      }
      if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
        __pyx_t_1 = __pyx_t_7; __Pyx_INCREF(__pyx_t_1);
        __pyx_t_9 = 0;
        __pyx_t_10 = NULL;
      } else {
        __pyx_t_9 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 704, __pyx_L31_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_10 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 704, __pyx_L31_error)
      }
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      for (;;) {
        if (likely(!__pyx_t_10)) {
          if (likely(PyList_CheckExact(__pyx_t_1))) {
            {
              Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_1);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 704, __pyx_L31_error)
              #endif
              if (__pyx_t_9 >= __pyx_temp) break;
            }
            __pyx_t_7 = __Pyx_PyList_GetItemRef(__pyx_t_1, __pyx_t_9);
            ++__pyx_t_9;
          } else {
            {
              Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_1);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 704, __pyx_L31_error)
              #endif
              if (__pyx_t_9 >= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_7 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_9));
            #else
            __pyx_t_7 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_9);
            #endif
            ++__pyx_t_9;
          }
          if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 704, __pyx_L31_error)
        } else {
          __pyx_t_7 = __pyx_t_10(__pyx_t_1);
          if (unlikely(!__pyx_t_7)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 704, __pyx_L31_error)
              PyErr_Clear();
            }
            break;
          }
        }
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_XDECREF_SET(__pyx_8genexpr2__pyx_v_itr, __pyx_t_7);
        __pyx_t_7 = 0;
        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 704, __pyx_L31_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_8, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 704, __pyx_L31_error)
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_itr); __pyx_8genexpr2__pyx_v_itr = 0;
      goto __pyx_L35_exit_scope;
      __pyx_L31_error:;
      __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_itr); __pyx_8genexpr2__pyx_v_itr = 0;
      goto __pyx_L1_error;
      __pyx_L35_exit_scope:;
    } /* exit inner scope */
    __pyx_v_qef = ((PyObject*)__pyx_t_8);
    __pyx_t_8 = 0;

    /* "tmm4py/tmm4py_core.pyx":705
 *         if self.config['useExternalForcing']:
 *             qef = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):             # <<<<<<<<<<<<<<
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.qef[itr], &data_pointer)
*/
    __pyx_t_1 = NULL;
    __Pyx_INCREF(__pyx_builtin_range);
    __pyx_t_7 = __pyx_builtin_range; 
    __pyx_t_3 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_self->numTracers};
      __pyx_t_8 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 705, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
    }
    if (likely(PyList_CheckExact(__pyx_t_8)) || PyTuple_CheckExact(__pyx_t_8)) {
      __pyx_t_7 = __pyx_t_8; __Pyx_INCREF(__pyx_t_7);
      __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 705, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_10 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 705, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(PyList_CheckExact(__pyx_t_7))) {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_7);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 705, __pyx_L1_error)
            #endif
            if (__pyx_t_9 >= __pyx_temp) break;
          }
          __pyx_t_8 = __Pyx_PyList_GetItemRef(__pyx_t_7, __pyx_t_9);
          ++__pyx_t_9;
        } else {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_7);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 705, __pyx_L1_error)
            #endif
            if (__pyx_t_9 >= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_8 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_9));
          #else
          __pyx_t_8 = __Pyx_PySequence_ITEM(__pyx_t_7, __pyx_t_9);
          #endif
          ++__pyx_t_9;
        }
        if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 705, __pyx_L1_error)
      } else {
        __pyx_t_8 = __pyx_t_10(__pyx_t_7);
        if (unlikely(!__pyx_t_8)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 705, __pyx_L1_error)
            PyErr_Clear();
          }
          break;
        }
      }
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_XDECREF_SET(__pyx_v_itr, __pyx_t_8);
      __pyx_t_8 = 0;

      /* "tmm4py/tmm4py_core.pyx":707
 *             for itr in range(self.numTracers):
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.qef[itr], &data_pointer)             # <<<<<<<<<<<<<<
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-qef[{itr}], r={rank}"
*/
      __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 707, __pyx_L1_error)
      __pyx_v_ierr = VecGetArray((__pyx_v_self->state->qef[__pyx_t_11]), (&__pyx_v_data_pointer));

      /* "tmm4py/tmm4py_core.pyx":708
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.qef[itr], &data_pointer)
 *                 if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *                 myId = f"Id={self.stateId}-qef[{itr}], r={rank}"
 *                 qef[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qef[itr], myId)
*/
      __pyx_t_6 = (__pyx_v_ierr != 0);
      if (unlikely(__pyx_t_6)) {
        __pyx_t_1 = NULL;
        __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 708, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 708, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 708, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __pyx_t_3 = 1;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
          assert(__pyx_t_1);
          PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_1);
          __Pyx_INCREF(__pyx__function);
          __Pyx_DECREF_SET(__pyx_t_2, __pyx__function);
          __pyx_t_3 = 0;
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_12};
          __pyx_t_8 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 708, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
        }
        __Pyx_Raise(__pyx_t_8, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __PYX_ERR(0, 708, __pyx_L1_error)
      }

      /* "tmm4py/tmm4py_core.pyx":709
 *                 ierr = VecGetArray(self.state.qef[itr], &data_pointer)
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-qef[{itr}], r={rank}"             # <<<<<<<<<<<<<<
 *                 qef[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qef[itr], myId)
 *             self.qef=_ImmutableList(qef)
*/
      __pyx_t_8 = __Pyx_PyObject_FormatSimple(__pyx_v_self->stateId, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 709, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_2 = __Pyx_PyObject_FormatSimple(__pyx_v_itr, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 709, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_12 = __Pyx_PyObject_FormatSimple(__pyx_v_rank, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 709, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __pyx_t_13[0] = __pyx_mstate_global->__pyx_kp_u_Id_2;
      __pyx_t_13[1] = __pyx_t_8;
      __pyx_t_13[2] = __pyx_mstate_global->__pyx_kp_u_qef;
      __pyx_t_13[3] = __pyx_t_2;
      __pyx_t_13[4] = __pyx_mstate_global->__pyx_kp_u_r;
      __pyx_t_13[5] = __pyx_t_12;
      __pyx_t_1 = __Pyx_PyUnicode_Join(__pyx_t_13, 6, 3 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_8) + 5 * 2 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_2) + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_12), 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_8) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_12));
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 709, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __Pyx_XDECREF_SET(__pyx_v_myId, ((PyObject*)__pyx_t_1));
      __pyx_t_1 = 0;

      /* "tmm4py/tmm4py_core.pyx":710
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-qef[{itr}], r={rank}"
 *                 qef[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qef[itr], myId)             # <<<<<<<<<<<<<<
 *             self.qef=_ImmutableList(qef)
 *             del qef
*/
      __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 710, __pyx_L1_error)
      __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArray(lSize, __pyx_v_data_pointer, (__pyx_v_self->state->qef[__pyx_t_11]), __pyx_v_myId); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 710, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      if (unlikely((PyObject_SetItem(__pyx_v_qef, __pyx_v_itr, __pyx_t_1) < 0))) __PYX_ERR(0, 710, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "tmm4py/tmm4py_core.pyx":705
 *         if self.config['useExternalForcing']:
 *             qef = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):             # <<<<<<<<<<<<<<
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.qef[itr], &data_pointer)
*/
    }
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

    /* "tmm4py/tmm4py_core.pyx":711
 *                 myId = f"Id={self.stateId}-qef[{itr}], r={rank}"
 *                 qef[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qef[itr], myId)
 *             self.qef=_ImmutableList(qef)             # <<<<<<<<<<<<<<
 *             del qef
 * 
*/
    __pyx_t_1 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_mstate_global->__pyx_n_u_ImmutableList); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 711, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_3 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_12))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_12);
      assert(__pyx_t_1);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_12);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_12, __pyx__function);
      __pyx_t_3 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_qef};
      __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_12, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 711, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
    }
    __Pyx_GIVEREF(__pyx_t_7);
    __Pyx_GOTREF(__pyx_v_self->qef);
    __Pyx_DECREF(__pyx_v_self->qef);
    __pyx_v_self->qef = __pyx_t_7;
    __pyx_t_7 = 0;

    /* "tmm4py/tmm4py_core.pyx":712
 *                 qef[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qef[itr], myId)
 *             self.qef=_ImmutableList(qef)
 *             del qef             # <<<<<<<<<<<<<<
 * 
 *         if self.config['relaxTracer']:
*/
    __Pyx_DECREF(__pyx_v_qef); __pyx_v_qef = 0;

    /* "tmm4py/tmm4py_core.pyx":703
 *             del qf
 * 
 *         if self.config['useExternalForcing']:             # <<<<<<<<<<<<<<
 *             qef = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):
*/
  }

  /* "tmm4py/tmm4py_core.pyx":714
 *             del qef
 * 
 *         if self.config['relaxTracer']:             # <<<<<<<<<<<<<<
 *             qrel = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):
*/
  __pyx_t_7 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_relaxTracer); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 714, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 714, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":715
 * 
 *         if self.config['relaxTracer']:
 *             qrel = [[] for itr in range(self.numTracers)]             # <<<<<<<<<<<<<<
 *             for itr in range(self.numTracers):
 * #               Get pointer to data
*/
    { /* enter inner scope */
      __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 715, __pyx_L43_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_1 = NULL;
      __Pyx_INCREF(__pyx_builtin_range);
      __pyx_t_2 = __pyx_builtin_range; 
      __pyx_t_3 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_self->numTracers};
        __pyx_t_12 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 715, __pyx_L43_error)
        __Pyx_GOTREF(__pyx_t_12);
      }
      if (likely(PyList_CheckExact(__pyx_t_12)) || PyTuple_CheckExact(__pyx_t_12)) {
        __pyx_t_2 = __pyx_t_12; __Pyx_INCREF(__pyx_t_2);
        __pyx_t_9 = 0;
        __pyx_t_10 = NULL;
      } else {
        __pyx_t_9 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_12); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 715, __pyx_L43_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_10 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 715, __pyx_L43_error)
      }
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      for (;;) {
        if (likely(!__pyx_t_10)) {
          if (likely(PyList_CheckExact(__pyx_t_2))) {
            {
              Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_2);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 715, __pyx_L43_error)
              #endif
              if (__pyx_t_9 >= __pyx_temp) break;
            }
            __pyx_t_12 = __Pyx_PyList_GetItemRef(__pyx_t_2, __pyx_t_9);
            ++__pyx_t_9;
          } else {
            {
              Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_2);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 715, __pyx_L43_error)
              #endif
              if (__pyx_t_9 >= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_12 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_9));
            #else
            __pyx_t_12 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_9);
            #endif
            ++__pyx_t_9;
          }
          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 715, __pyx_L43_error)
        } else {
          __pyx_t_12 = __pyx_t_10(__pyx_t_2);
          if (unlikely(!__pyx_t_12)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 715, __pyx_L43_error)
              PyErr_Clear();
            }
            break;
          }
        }
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_XDECREF_SET(__pyx_8genexpr3__pyx_v_itr, __pyx_t_12);
        __pyx_t_12 = 0;
        __pyx_t_12 = PyList_New(0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 715, __pyx_L43_error)
        __Pyx_GOTREF(__pyx_t_12);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_12))) __PYX_ERR(0, 715, __pyx_L43_error)
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_itr); __pyx_8genexpr3__pyx_v_itr = 0;
      goto __pyx_L47_exit_scope;
      __pyx_L43_error:;
      __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_itr); __pyx_8genexpr3__pyx_v_itr = 0;
      goto __pyx_L1_error;
      __pyx_L47_exit_scope:;
    } /* exit inner scope */
    __pyx_v_qrel = ((PyObject*)__pyx_t_7);
    __pyx_t_7 = 0;

    /* "tmm4py/tmm4py_core.pyx":716
 *         if self.config['relaxTracer']:
 *             qrel = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):             # <<<<<<<<<<<<<<
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.qrel[itr], &data_pointer)
*/
    __pyx_t_2 = NULL;
    __Pyx_INCREF(__pyx_builtin_range);
    __pyx_t_12 = __pyx_builtin_range; 
    __pyx_t_3 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_self->numTracers};
      __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_12, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 716, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
    }
    if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
      __pyx_t_12 = __pyx_t_7; __Pyx_INCREF(__pyx_t_12);
      __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_12 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 716, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __pyx_t_10 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_12); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 716, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(PyList_CheckExact(__pyx_t_12))) {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_12);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 716, __pyx_L1_error)
            #endif
            if (__pyx_t_9 >= __pyx_temp) break;
          }
          __pyx_t_7 = __Pyx_PyList_GetItemRef(__pyx_t_12, __pyx_t_9);
          ++__pyx_t_9;
        } else {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_12);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 716, __pyx_L1_error)
            #endif
            if (__pyx_t_9 >= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_7 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_12, __pyx_t_9));
          #else
          __pyx_t_7 = __Pyx_PySequence_ITEM(__pyx_t_12, __pyx_t_9);
          #endif
          ++__pyx_t_9;
        }
        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 716, __pyx_L1_error)
      } else {
        __pyx_t_7 = __pyx_t_10(__pyx_t_12);
        if (unlikely(!__pyx_t_7)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 716, __pyx_L1_error)
            PyErr_Clear();
          }
          break;
        }
      }
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_XDECREF_SET(__pyx_v_itr, __pyx_t_7);
      __pyx_t_7 = 0;

      /* "tmm4py/tmm4py_core.pyx":718
 *             for itr in range(self.numTracers):
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.qrel[itr], &data_pointer)             # <<<<<<<<<<<<<<
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-qrel[{itr}], r={rank}"
*/
      __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 718, __pyx_L1_error)
      __pyx_v_ierr = VecGetArray((__pyx_v_self->state->qrel[__pyx_t_11]), (&__pyx_v_data_pointer));

      /* "tmm4py/tmm4py_core.pyx":719
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.qrel[itr], &data_pointer)
 *                 if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *                 myId = f"Id={self.stateId}-qrel[{itr}], r={rank}"
 *                 self.qrel[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qrel[itr], myId)
*/
      __pyx_t_6 = (__pyx_v_ierr != 0);
      if (unlikely(__pyx_t_6)) {
        __pyx_t_2 = NULL;
        __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 719, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_3 = 1;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(PyMethod_Check(__pyx_t_8))) {
          __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_8);
          assert(__pyx_t_2);
          PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_8);
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(__pyx__function);
          __Pyx_DECREF_SET(__pyx_t_8, __pyx__function);
          __pyx_t_3 = 0;
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_1};
          __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 719, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
        }
        __Pyx_Raise(__pyx_t_7, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __PYX_ERR(0, 719, __pyx_L1_error)
      }

      /* "tmm4py/tmm4py_core.pyx":720
 *                 ierr = VecGetArray(self.state.qrel[itr], &data_pointer)
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-qrel[{itr}], r={rank}"             # <<<<<<<<<<<<<<
 *                 self.qrel[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qrel[itr], myId)
 *             self.qrel=_ImmutableList(qrel)
*/
      __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_v_self->stateId, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 720, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = __Pyx_PyObject_FormatSimple(__pyx_v_itr, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 720, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_v_rank, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_13[0] = __pyx_mstate_global->__pyx_kp_u_Id_2;
      __pyx_t_13[1] = __pyx_t_7;
      __pyx_t_13[2] = __pyx_mstate_global->__pyx_kp_u_qrel;
      __pyx_t_13[3] = __pyx_t_8;
      __pyx_t_13[4] = __pyx_mstate_global->__pyx_kp_u_r;
      __pyx_t_13[5] = __pyx_t_1;
      __pyx_t_2 = __Pyx_PyUnicode_Join(__pyx_t_13, 6, 3 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_7) + 6 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_8) + 5 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_1), 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_8) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_1));
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_XDECREF_SET(__pyx_v_myId, ((PyObject*)__pyx_t_2));
      __pyx_t_2 = 0;

      /* "tmm4py/tmm4py_core.pyx":721
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-qrel[{itr}], r={rank}"
 *                 self.qrel[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qrel[itr], myId)             # <<<<<<<<<<<<<<
 *             self.qrel=_ImmutableList(qrel)
 *             del qrel
*/
      __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 721, __pyx_L1_error)
      __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArray(lSize, __pyx_v_data_pointer, (__pyx_v_self->state->qrel[__pyx_t_11]), __pyx_v_myId); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 721, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      if (unlikely((PyObject_SetItem(__pyx_v_self->qrel, __pyx_v_itr, __pyx_t_2) < 0))) __PYX_ERR(0, 721, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "tmm4py/tmm4py_core.pyx":716
 *         if self.config['relaxTracer']:
 *             qrel = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):             # <<<<<<<<<<<<<<
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.qrel[itr], &data_pointer)
*/
    }
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

    /* "tmm4py/tmm4py_core.pyx":722
 *                 myId = f"Id={self.stateId}-qrel[{itr}], r={rank}"
 *                 self.qrel[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qrel[itr], myId)
 *             self.qrel=_ImmutableList(qrel)             # <<<<<<<<<<<<<<
 *             del qrel
 * 
*/
    __pyx_t_2 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_mstate_global->__pyx_n_u_ImmutableList); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 722, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
      assert(__pyx_t_2);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_1, __pyx__function);
      __pyx_t_3 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_qrel};
      __pyx_t_12 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 722, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
    }
    __Pyx_GIVEREF(__pyx_t_12);
    __Pyx_GOTREF(__pyx_v_self->qrel);
    __Pyx_DECREF(__pyx_v_self->qrel);
    __pyx_v_self->qrel = __pyx_t_12;
    __pyx_t_12 = 0;

    /* "tmm4py/tmm4py_core.pyx":723
 *                 self.qrel[itr] = _ToNumpyRealArray(lSize, data_pointer, self.state.qrel[itr], myId)
 *             self.qrel=_ImmutableList(qrel)
 *             del qrel             # <<<<<<<<<<<<<<
 * 
 *         if self.config['usePrescribedBC']:
*/
    __Pyx_DECREF(__pyx_v_qrel); __pyx_v_qrel = 0;

    /* "tmm4py/tmm4py_core.pyx":714
 *             del qef
 * 
 *         if self.config['relaxTracer']:             # <<<<<<<<<<<<<<
 *             qrel = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):
*/
  }

  /* "tmm4py/tmm4py_core.pyx":725
 *             del qrel
 * 
 *         if self.config['usePrescribedBC']:             # <<<<<<<<<<<<<<
 *             cbc = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):
*/
  __pyx_t_12 = __Pyx_PyObject_Dict_GetItem(__pyx_v_self->config, __pyx_mstate_global->__pyx_n_u_usePrescribedBC); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 725, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_12);
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_12); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 725, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":726
 * 
 *         if self.config['usePrescribedBC']:
 *             cbc = [[] for itr in range(self.numTracers)]             # <<<<<<<<<<<<<<
 *             for itr in range(self.numTracers):
 * #               Get pointer to data
*/
    { /* enter inner scope */
      __pyx_t_12 = PyList_New(0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 726, __pyx_L55_error)
      __Pyx_GOTREF(__pyx_t_12);
      __pyx_t_2 = NULL;
      __Pyx_INCREF(__pyx_builtin_range);
      __pyx_t_8 = __pyx_builtin_range; 
      __pyx_t_3 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_self->numTracers};
        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L55_error)
        __Pyx_GOTREF(__pyx_t_1);
      }
      if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
        __pyx_t_8 = __pyx_t_1; __Pyx_INCREF(__pyx_t_8);
        __pyx_t_9 = 0;
        __pyx_t_10 = NULL;
      } else {
        __pyx_t_9 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 726, __pyx_L55_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_10 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_8); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 726, __pyx_L55_error)
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      for (;;) {
        if (likely(!__pyx_t_10)) {
          if (likely(PyList_CheckExact(__pyx_t_8))) {
            {
              Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_8);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 726, __pyx_L55_error)
              #endif
              if (__pyx_t_9 >= __pyx_temp) break;
            }
            __pyx_t_1 = __Pyx_PyList_GetItemRef(__pyx_t_8, __pyx_t_9);
            ++__pyx_t_9;
          } else {
            {
              Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_8);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 726, __pyx_L55_error)
              #endif
              if (__pyx_t_9 >= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_1 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_9));
            #else
            __pyx_t_1 = __Pyx_PySequence_ITEM(__pyx_t_8, __pyx_t_9);
            #endif
            ++__pyx_t_9;
          }
          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L55_error)
        } else {
          __pyx_t_1 = __pyx_t_10(__pyx_t_8);
          if (unlikely(!__pyx_t_1)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 726, __pyx_L55_error)
              PyErr_Clear();
            }
            break;
          }
        }
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_XDECREF_SET(__pyx_8genexpr4__pyx_v_itr, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L55_error)
        __Pyx_GOTREF(__pyx_t_1);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_12, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 726, __pyx_L55_error)
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      }
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_XDECREF(__pyx_8genexpr4__pyx_v_itr); __pyx_8genexpr4__pyx_v_itr = 0;
      goto __pyx_L59_exit_scope;
      __pyx_L55_error:;
      __Pyx_XDECREF(__pyx_8genexpr4__pyx_v_itr); __pyx_8genexpr4__pyx_v_itr = 0;
      goto __pyx_L1_error;
      __pyx_L59_exit_scope:;
    } /* exit inner scope */
    __pyx_v_cbc = ((PyObject*)__pyx_t_12);
    __pyx_t_12 = 0;

    /* "tmm4py/tmm4py_core.pyx":727
 *         if self.config['usePrescribedBC']:
 *             cbc = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):             # <<<<<<<<<<<<<<
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.cbc[itr],&data_pointer)
*/
    __pyx_t_8 = NULL;
    __Pyx_INCREF(__pyx_builtin_range);
    __pyx_t_1 = __pyx_builtin_range; 
    __pyx_t_3 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_self->numTracers};
      __pyx_t_12 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 727, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
    }
    if (likely(PyList_CheckExact(__pyx_t_12)) || PyTuple_CheckExact(__pyx_t_12)) {
      __pyx_t_1 = __pyx_t_12; __Pyx_INCREF(__pyx_t_1);
      __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 727, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_10 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 727, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(PyList_CheckExact(__pyx_t_1))) {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 727, __pyx_L1_error)
            #endif
            if (__pyx_t_9 >= __pyx_temp) break;
          }
          __pyx_t_12 = __Pyx_PyList_GetItemRef(__pyx_t_1, __pyx_t_9);
          ++__pyx_t_9;
        } else {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 727, __pyx_L1_error)
            #endif
            if (__pyx_t_9 >= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_12 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_9));
          #else
          __pyx_t_12 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_9);
          #endif
          ++__pyx_t_9;
        }
        if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 727, __pyx_L1_error)
      } else {
        __pyx_t_12 = __pyx_t_10(__pyx_t_1);
        if (unlikely(!__pyx_t_12)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 727, __pyx_L1_error)
            PyErr_Clear();
          }
          break;
        }
      }
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_XDECREF_SET(__pyx_v_itr, __pyx_t_12);
      __pyx_t_12 = 0;

      /* "tmm4py/tmm4py_core.pyx":729
 *             for itr in range(self.numTracers):
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.cbc[itr],&data_pointer)             # <<<<<<<<<<<<<<
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-cbc[{itr}], r={rank}"
*/
      __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 729, __pyx_L1_error)
      __pyx_v_ierr = VecGetArray((__pyx_v_self->state->cbc[__pyx_t_11]), (&__pyx_v_data_pointer));

      /* "tmm4py/tmm4py_core.pyx":730
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.cbc[itr],&data_pointer)
 *                 if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *                 myId = f"Id={self.stateId}-cbc[{itr}], r={rank}"
 *                 cbc[itr] = _ToNumpyRealArray(lBCSize, data_pointer, self.state.cbc[itr], myId)
*/
      __pyx_t_6 = (__pyx_v_ierr != 0);
      if (unlikely(__pyx_t_6)) {
        __pyx_t_8 = NULL;
        __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 730, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 730, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 730, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_3 = 1;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(PyMethod_Check(__pyx_t_7))) {
          __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
          assert(__pyx_t_8);
          PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
          __Pyx_INCREF(__pyx_t_8);
          __Pyx_INCREF(__pyx__function);
          __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
          __pyx_t_3 = 0;
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_t_2};
          __pyx_t_12 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 730, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
        }
        __Pyx_Raise(__pyx_t_12, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __PYX_ERR(0, 730, __pyx_L1_error)
      }

      /* "tmm4py/tmm4py_core.pyx":731
 *                 ierr = VecGetArray(self.state.cbc[itr],&data_pointer)
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-cbc[{itr}], r={rank}"             # <<<<<<<<<<<<<<
 *                 cbc[itr] = _ToNumpyRealArray(lBCSize, data_pointer, self.state.cbc[itr], myId)
 *             self.cbc=_ImmutableList(cbc)
*/
      __pyx_t_12 = __Pyx_PyObject_FormatSimple(__pyx_v_self->stateId, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 731, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_v_itr, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 731, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_2 = __Pyx_PyObject_FormatSimple(__pyx_v_rank, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 731, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_13[0] = __pyx_mstate_global->__pyx_kp_u_Id_2;
      __pyx_t_13[1] = __pyx_t_12;
      __pyx_t_13[2] = __pyx_mstate_global->__pyx_kp_u_cbc;
      __pyx_t_13[3] = __pyx_t_7;
      __pyx_t_13[4] = __pyx_mstate_global->__pyx_kp_u_r;
      __pyx_t_13[5] = __pyx_t_2;
      __pyx_t_8 = __Pyx_PyUnicode_Join(__pyx_t_13, 6, 3 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_12) + 5 * 2 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_7) + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_2), 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_12) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2));
      if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 731, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_XDECREF_SET(__pyx_v_myId, ((PyObject*)__pyx_t_8));
      __pyx_t_8 = 0;

      /* "tmm4py/tmm4py_core.pyx":732
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-cbc[{itr}], r={rank}"
 *                 cbc[itr] = _ToNumpyRealArray(lBCSize, data_pointer, self.state.cbc[itr], myId)             # <<<<<<<<<<<<<<
 *             self.cbc=_ImmutableList(cbc)
 *             del cbc
*/
      __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 732, __pyx_L1_error)
      __pyx_t_8 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArray(lBCSize, __pyx_v_data_pointer, (__pyx_v_self->state->cbc[__pyx_t_11]), __pyx_v_myId); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 732, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      if (unlikely((PyObject_SetItem(__pyx_v_cbc, __pyx_v_itr, __pyx_t_8) < 0))) __PYX_ERR(0, 732, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

      /* "tmm4py/tmm4py_core.pyx":727
 *         if self.config['usePrescribedBC']:
 *             cbc = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):             # <<<<<<<<<<<<<<
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.cbc[itr],&data_pointer)
*/
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":733
 *                 myId = f"Id={self.stateId}-cbc[{itr}], r={rank}"
 *                 cbc[itr] = _ToNumpyRealArray(lBCSize, data_pointer, self.state.cbc[itr], myId)
 *             self.cbc=_ImmutableList(cbc)             # <<<<<<<<<<<<<<
 *             del cbc
 * 
*/
    __pyx_t_8 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_ImmutableList); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 733, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_2);
      assert(__pyx_t_8);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_8);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_2, __pyx__function);
      __pyx_t_3 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_cbc};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 733, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_GIVEREF(__pyx_t_1);
    __Pyx_GOTREF(__pyx_v_self->cbc);
    __Pyx_DECREF(__pyx_v_self->cbc);
    __pyx_v_self->cbc = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":734
 *                 cbc[itr] = _ToNumpyRealArray(lBCSize, data_pointer, self.state.cbc[itr], myId)
 *             self.cbc=_ImmutableList(cbc)
 *             del cbc             # <<<<<<<<<<<<<<
 * 
 *             cbf = [[] for itr in range(self.numTracers)]
*/
    __Pyx_DECREF(__pyx_v_cbc); __pyx_v_cbc = 0;

    /* "tmm4py/tmm4py_core.pyx":736
 *             del cbc
 * 
 *             cbf = [[] for itr in range(self.numTracers)]             # <<<<<<<<<<<<<<
 *             for itr in range(self.numTracers):
 * #               Get pointer to data
*/
    { /* enter inner scope */
      __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L66_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_8 = NULL;
      __Pyx_INCREF(__pyx_builtin_range);
      __pyx_t_7 = __pyx_builtin_range; 
      __pyx_t_3 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_self->numTracers};
        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L66_error)
        __Pyx_GOTREF(__pyx_t_2);
      }
      if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
        __pyx_t_7 = __pyx_t_2; __Pyx_INCREF(__pyx_t_7);
        __pyx_t_9 = 0;
        __pyx_t_10 = NULL;
      } else {
        __pyx_t_9 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 736, __pyx_L66_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_10 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 736, __pyx_L66_error)
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      for (;;) {
        if (likely(!__pyx_t_10)) {
          if (likely(PyList_CheckExact(__pyx_t_7))) {
            {
              Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_7);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 736, __pyx_L66_error)
              #endif
              if (__pyx_t_9 >= __pyx_temp) break;
            }
            __pyx_t_2 = __Pyx_PyList_GetItemRef(__pyx_t_7, __pyx_t_9);
            ++__pyx_t_9;
          } else {
            {
              Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_7);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 736, __pyx_L66_error)
              #endif
              if (__pyx_t_9 >= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_2 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_9));
            #else
            __pyx_t_2 = __Pyx_PySequence_ITEM(__pyx_t_7, __pyx_t_9);
            #endif
            ++__pyx_t_9;
          }
          if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L66_error)
        } else {
          __pyx_t_2 = __pyx_t_10(__pyx_t_7);
          if (unlikely(!__pyx_t_2)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 736, __pyx_L66_error)
              PyErr_Clear();
            }
            break;
          }
        }
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_XDECREF_SET(__pyx_8genexpr5__pyx_v_itr, __pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L66_error)
        __Pyx_GOTREF(__pyx_t_2);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 736, __pyx_L66_error)
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      }
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_XDECREF(__pyx_8genexpr5__pyx_v_itr); __pyx_8genexpr5__pyx_v_itr = 0;
      goto __pyx_L70_exit_scope;
      __pyx_L66_error:;
      __Pyx_XDECREF(__pyx_8genexpr5__pyx_v_itr); __pyx_8genexpr5__pyx_v_itr = 0;
      goto __pyx_L1_error;
      __pyx_L70_exit_scope:;
    } /* exit inner scope */
    __pyx_v_cbf = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":737
 * 
 *             cbf = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):             # <<<<<<<<<<<<<<
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.cbf[itr],&data_pointer)
*/
    __pyx_t_7 = NULL;
    __Pyx_INCREF(__pyx_builtin_range);
    __pyx_t_2 = __pyx_builtin_range; 
    __pyx_t_3 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_v_self->numTracers};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 737, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
      __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2);
      __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 737, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_10 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 737, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(PyList_CheckExact(__pyx_t_2))) {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_2);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 737, __pyx_L1_error)
            #endif
            if (__pyx_t_9 >= __pyx_temp) break;
          }
          __pyx_t_1 = __Pyx_PyList_GetItemRef(__pyx_t_2, __pyx_t_9);
          ++__pyx_t_9;
        } else {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_2);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 737, __pyx_L1_error)
            #endif
            if (__pyx_t_9 >= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_9));
          #else
          __pyx_t_1 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_9);
          #endif
          ++__pyx_t_9;
        }
        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 737, __pyx_L1_error)
      } else {
        __pyx_t_1 = __pyx_t_10(__pyx_t_2);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 737, __pyx_L1_error)
            PyErr_Clear();
          }
          break;
        }
      }
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_itr, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "tmm4py/tmm4py_core.pyx":739
 *             for itr in range(self.numTracers):
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.cbf[itr],&data_pointer)             # <<<<<<<<<<<<<<
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-cbf[{itr}], r={rank}"
*/
      __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 739, __pyx_L1_error)
      __pyx_v_ierr = VecGetArray((__pyx_v_self->state->cbf[__pyx_t_11]), (&__pyx_v_data_pointer));

      /* "tmm4py/tmm4py_core.pyx":740
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.cbf[itr],&data_pointer)
 *                 if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *                 myId = f"Id={self.stateId}-cbf[{itr}], r={rank}"
 *                 cbf[itr] = _ToNumpyRealArray(lBCSize, data_pointer, self.state.cbf[itr], myId)
*/
      __pyx_t_6 = (__pyx_v_ierr != 0);
      if (unlikely(__pyx_t_6)) {
        __pyx_t_7 = NULL;
        __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 740, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 740, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 740, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_3 = 1;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(PyMethod_Check(__pyx_t_12))) {
          __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_12);
          assert(__pyx_t_7);
          PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_12);
          __Pyx_INCREF(__pyx_t_7);
          __Pyx_INCREF(__pyx__function);
          __Pyx_DECREF_SET(__pyx_t_12, __pyx__function);
          __pyx_t_3 = 0;
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_8};
          __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_12, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
        }
        __Pyx_Raise(__pyx_t_1, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __PYX_ERR(0, 740, __pyx_L1_error)
      }

      /* "tmm4py/tmm4py_core.pyx":741
 *                 ierr = VecGetArray(self.state.cbf[itr],&data_pointer)
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-cbf[{itr}], r={rank}"             # <<<<<<<<<<<<<<
 *                 cbf[itr] = _ToNumpyRealArray(lBCSize, data_pointer, self.state.cbf[itr], myId)
 *             self.cbf=_ImmutableList(cbf)
*/
      __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_v_self->stateId, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 741, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_12 = __Pyx_PyObject_FormatSimple(__pyx_v_itr, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 741, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __pyx_t_8 = __Pyx_PyObject_FormatSimple(__pyx_v_rank, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 741, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_13[0] = __pyx_mstate_global->__pyx_kp_u_Id_2;
      __pyx_t_13[1] = __pyx_t_1;
      __pyx_t_13[2] = __pyx_mstate_global->__pyx_kp_u_cbf;
      __pyx_t_13[3] = __pyx_t_12;
      __pyx_t_13[4] = __pyx_mstate_global->__pyx_kp_u_r;
      __pyx_t_13[5] = __pyx_t_8;
      __pyx_t_7 = __Pyx_PyUnicode_Join(__pyx_t_13, 6, 3 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_1) + 5 * 2 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_12) + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_8), 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_1) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_12) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_8));
      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_XDECREF_SET(__pyx_v_myId, ((PyObject*)__pyx_t_7));
      __pyx_t_7 = 0;

      /* "tmm4py/tmm4py_core.pyx":742
 *                 if ierr != 0: raise PETSc.Error(ierr)
 *                 myId = f"Id={self.stateId}-cbf[{itr}], r={rank}"
 *                 cbf[itr] = _ToNumpyRealArray(lBCSize, data_pointer, self.state.cbf[itr], myId)             # <<<<<<<<<<<<<<
 *             self.cbf=_ImmutableList(cbf)
 *             del cbf
*/
      __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 742, __pyx_L1_error)
      __pyx_t_7 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArray(lBCSize, __pyx_v_data_pointer, (__pyx_v_self->state->cbf[__pyx_t_11]), __pyx_v_myId); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 742, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      if (unlikely((PyObject_SetItem(__pyx_v_cbf, __pyx_v_itr, __pyx_t_7) < 0))) __PYX_ERR(0, 742, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

      /* "tmm4py/tmm4py_core.pyx":737
 * 
 *             cbf = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):             # <<<<<<<<<<<<<<
 * #               Get pointer to data
 *                 ierr = VecGetArray(self.state.cbf[itr],&data_pointer)
*/
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "tmm4py/tmm4py_core.pyx":743
 *                 myId = f"Id={self.stateId}-cbf[{itr}], r={rank}"
 *                 cbf[itr] = _ToNumpyRealArray(lBCSize, data_pointer, self.state.cbf[itr], myId)
 *             self.cbf=_ImmutableList(cbf)             # <<<<<<<<<<<<<<
 *             del cbf
 * 
*/
    __pyx_t_7 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_ImmutableList); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 743, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_3 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_8);
      assert(__pyx_t_7);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_8);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_8, __pyx__function);
      __pyx_t_3 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_v_cbf};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 743, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_GIVEREF(__pyx_t_2);
    __Pyx_GOTREF(__pyx_v_self->cbf);
    __Pyx_DECREF(__pyx_v_self->cbf);
    __pyx_v_self->cbf = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "tmm4py/tmm4py_core.pyx":744
 *                 cbf[itr] = _ToNumpyRealArray(lBCSize, data_pointer, self.state.cbf[itr], myId)
 *             self.cbf=_ImmutableList(cbf)
 *             del cbf             # <<<<<<<<<<<<<<
 * 
 *     def forcingUpdate(self, tc, Iterc, iLoop):
*/
    __Pyx_DECREF(__pyx_v_cbf); __pyx_v_cbf = 0;

    /* "tmm4py/tmm4py_core.pyx":725
 *             del qrel
 * 
 *         if self.config['usePrescribedBC']:             # <<<<<<<<<<<<<<
 *             cbc = [[] for itr in range(self.numTracers)]
 *             for itr in range(self.numTracers):
*/
  }

  /* "tmm4py/tmm4py_core.pyx":659
 *         return toInt(self.state.numTracers)
 * 
 *     def setFromOptions(self, prefix="", doOutput=True):             # <<<<<<<<<<<<<<
 *         cdef const char* pre
 *         cdef PetscScalar *data_pointer
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setFromOptions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_OptDBState);
  __Pyx_XDECREF(__pyx_v_rank);
  __Pyx_XDECREF(__pyx_v_c);
  __Pyx_XDECREF(__pyx_v_itr);
  __Pyx_XDECREF(__pyx_v_myId);
  __Pyx_XDECREF(__pyx_v_qf);
  __Pyx_XDECREF(__pyx_v_qef);
  __Pyx_XDECREF(__pyx_v_qrel);
  __Pyx_XDECREF(__pyx_v_cbc);
  __Pyx_XDECREF(__pyx_v_cbf);
  __Pyx_XDECREF(__pyx_7genexpr__pyx_v_itr);
  __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_itr);
  __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_itr);
  __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_itr);
  __Pyx_XDECREF(__pyx_8genexpr4__pyx_v_itr);
  __Pyx_XDECREF(__pyx_8genexpr5__pyx_v_itr);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":746
 *             del cbf
 * 
 *     def forcingUpdate(self, tc, Iterc, iLoop):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_49forcingUpdate(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_49forcingUpdate = {"forcingUpdate", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_49forcingUpdate, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_49forcingUpdate(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_tc = 0;
  PyObject *__pyx_v_Iterc = 0;
  PyObject *__pyx_v_iLoop = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("forcingUpdate (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iterc,&__pyx_mstate_global->__pyx_n_u_iLoop,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 746, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 746, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 746, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 746, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "forcingUpdate", 0) < 0) __PYX_ERR(0, 746, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 3; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("forcingUpdate", 1, 3, 3, i); __PYX_ERR(0, 746, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 746, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 746, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 746, __pyx_L3_error)
    }
    __pyx_v_tc = values[0];
    __pyx_v_Iterc = values[1];
    __pyx_v_iLoop = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("forcingUpdate", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 746, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.forcingUpdate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_48forcingUpdate(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_tc, __pyx_v_Iterc, __pyx_v_iLoop);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_48forcingUpdate(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_tc, PyObject *__pyx_v_Iterc, PyObject *__pyx_v_iLoop) {
  PetscScalar __pyx_v_tcc;
  PetscInt __pyx_v_Itercc;
  PetscInt __pyx_v_iLoopc;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscReal __pyx_t_1;
  PetscInt __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  size_t __pyx_t_8;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("forcingUpdate", 0);

  /* "tmm4py/tmm4py_core.pyx":747
 * 
 *     def forcingUpdate(self, tc, Iterc, iLoop):
 *         cdef PetscScalar tcc = asReal(tc)             # <<<<<<<<<<<<<<
 *         cdef PetscInt Itercc = asInt(Iterc)
 *         cdef PetscInt iLoopc = asInt(iLoop)
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asReal(__pyx_v_tc); if (unlikely(__pyx_t_1 == ((PetscReal)-1.0) && PyErr_Occurred())) __PYX_ERR(0, 747, __pyx_L1_error)
  __pyx_v_tcc = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":748
 *     def forcingUpdate(self, tc, Iterc, iLoop):
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)             # <<<<<<<<<<<<<<
 *         cdef PetscInt iLoopc = asInt(iLoop)
 *         cdef PetscErrorCode ierr
*/
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_v_Iterc); if (unlikely(__pyx_t_2 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 748, __pyx_L1_error)
  __pyx_v_Itercc = __pyx_t_2;

  /* "tmm4py/tmm4py_core.pyx":749
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
 *         cdef PetscInt iLoopc = asInt(iLoop)             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         ierr = TMMForcingUpdate(tcc, Itercc, iLoopc, self.state)
*/
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_v_iLoop); if (unlikely(__pyx_t_2 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 749, __pyx_L1_error)
  __pyx_v_iLoopc = __pyx_t_2;

  /* "tmm4py/tmm4py_core.pyx":751
 *         cdef PetscInt iLoopc = asInt(iLoop)
 *         cdef PetscErrorCode ierr
 *         ierr = TMMForcingUpdate(tcc, Itercc, iLoopc, self.state)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  __pyx_v_ierr = TMMForcingUpdate(__pyx_v_tcc, __pyx_v_Itercc, __pyx_v_iLoopc, __pyx_v_self->state);

  /* "tmm4py/tmm4py_core.pyx":752
 *         cdef PetscErrorCode ierr
 *         ierr = TMMForcingUpdate(tcc, Itercc, iLoopc, self.state)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMForcingUpdate failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 752, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 752, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 752, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_8 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_8 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_6};
      __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_8, (2-__pyx_t_8) | (__pyx_t_8*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 752, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_ERR(0, 752, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":746
 *             del cbf
 * 
 *     def forcingUpdate(self, tc, Iterc, iLoop):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.forcingUpdate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":756
 * #             raise RuntimeError(f"TMMForcingUpdate failed with error code {ierr}")
 * 
 *     def timeStep(self, tc, Iterc, iLoop):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_51timeStep(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_51timeStep = {"timeStep", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_51timeStep, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_51timeStep(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_tc = 0;
  PyObject *__pyx_v_Iterc = 0;
  PyObject *__pyx_v_iLoop = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("timeStep (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iterc,&__pyx_mstate_global->__pyx_n_u_iLoop,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 756, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 756, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 756, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 756, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "timeStep", 0) < 0) __PYX_ERR(0, 756, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 3; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("timeStep", 1, 3, 3, i); __PYX_ERR(0, 756, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 756, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 756, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 756, __pyx_L3_error)
    }
    __pyx_v_tc = values[0];
    __pyx_v_Iterc = values[1];
    __pyx_v_iLoop = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("timeStep", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 756, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.timeStep", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_50timeStep(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_tc, __pyx_v_Iterc, __pyx_v_iLoop);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_50timeStep(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_tc, PyObject *__pyx_v_Iterc, PyObject *__pyx_v_iLoop) {
  PetscScalar __pyx_v_tcc;
  PetscInt __pyx_v_Itercc;
  PetscInt __pyx_v_iLoopc;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscReal __pyx_t_1;
  PetscInt __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  size_t __pyx_t_8;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("timeStep", 0);

  /* "tmm4py/tmm4py_core.pyx":757
 * 
 *     def timeStep(self, tc, Iterc, iLoop):
 *         cdef PetscScalar tcc = asReal(tc)             # <<<<<<<<<<<<<<
 *         cdef PetscInt Itercc = asInt(Iterc)
 *         cdef PetscInt iLoopc = asInt(iLoop)
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asReal(__pyx_v_tc); if (unlikely(__pyx_t_1 == ((PetscReal)-1.0) && PyErr_Occurred())) __PYX_ERR(0, 757, __pyx_L1_error)
  __pyx_v_tcc = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":758
 *     def timeStep(self, tc, Iterc, iLoop):
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)             # <<<<<<<<<<<<<<
 *         cdef PetscInt iLoopc = asInt(iLoop)
 *         cdef PetscErrorCode ierr
*/
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_v_Iterc); if (unlikely(__pyx_t_2 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 758, __pyx_L1_error)
  __pyx_v_Itercc = __pyx_t_2;

  /* "tmm4py/tmm4py_core.pyx":759
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
 *         cdef PetscInt iLoopc = asInt(iLoop)             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         ierr = TMMTimeStep(tcc, Itercc, iLoopc, self.state)
*/
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_v_iLoop); if (unlikely(__pyx_t_2 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 759, __pyx_L1_error)
  __pyx_v_iLoopc = __pyx_t_2;

  /* "tmm4py/tmm4py_core.pyx":761
 *         cdef PetscInt iLoopc = asInt(iLoop)
 *         cdef PetscErrorCode ierr
 *         ierr = TMMTimeStep(tcc, Itercc, iLoopc, self.state)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  __pyx_v_ierr = TMMTimeStep(__pyx_v_tcc, __pyx_v_Itercc, __pyx_v_iLoopc, __pyx_v_self->state);

  /* "tmm4py/tmm4py_core.pyx":762
 *         cdef PetscErrorCode ierr
 *         ierr = TMMTimeStep(tcc, Itercc, iLoopc, self.state)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMTimeStep failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 762, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 762, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 762, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_8 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_8 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_6};
      __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_8, (2-__pyx_t_8) | (__pyx_t_8*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 762, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_ERR(0, 762, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":756
 * #             raise RuntimeError(f"TMMForcingUpdate failed with error code {ierr}")
 * 
 *     def timeStep(self, tc, Iterc, iLoop):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.timeStep", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":766
 * #             raise RuntimeError(f"TMMTimeStep failed with error code {ierr}")
 * 
 *     def timeStepPost(self, tc, Iterc, iLoop):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_53timeStepPost(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_53timeStepPost = {"timeStepPost", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_53timeStepPost, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_53timeStepPost(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_tc = 0;
  PyObject *__pyx_v_Iterc = 0;
  PyObject *__pyx_v_iLoop = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("timeStepPost (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iterc,&__pyx_mstate_global->__pyx_n_u_iLoop,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 766, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 766, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 766, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 766, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "timeStepPost", 0) < 0) __PYX_ERR(0, 766, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 3; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("timeStepPost", 1, 3, 3, i); __PYX_ERR(0, 766, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 766, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 766, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 766, __pyx_L3_error)
    }
    __pyx_v_tc = values[0];
    __pyx_v_Iterc = values[1];
    __pyx_v_iLoop = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("timeStepPost", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 766, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.timeStepPost", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_52timeStepPost(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_tc, __pyx_v_Iterc, __pyx_v_iLoop);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_52timeStepPost(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_tc, PyObject *__pyx_v_Iterc, PyObject *__pyx_v_iLoop) {
  PetscScalar __pyx_v_tcc;
  CYTHON_UNUSED PetscInt __pyx_v_Itercc;
  CYTHON_UNUSED PetscInt __pyx_v_iLoopc;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscReal __pyx_t_1;
  PetscInt __pyx_t_2;
  PetscInt __pyx_t_3;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  size_t __pyx_t_9;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("timeStepPost", 0);

  /* "tmm4py/tmm4py_core.pyx":767
 * 
 *     def timeStepPost(self, tc, Iterc, iLoop):
 *         cdef PetscScalar tcc = asReal(tc)             # <<<<<<<<<<<<<<
 *         cdef PetscInt Itercc = asInt(Iterc)
 *         cdef PetscInt iLoopc = asInt(iLoop)
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asReal(__pyx_v_tc); if (unlikely(__pyx_t_1 == ((PetscReal)-1.0) && PyErr_Occurred())) __PYX_ERR(0, 767, __pyx_L1_error)
  __pyx_v_tcc = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":768
 *     def timeStepPost(self, tc, Iterc, iLoop):
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)             # <<<<<<<<<<<<<<
 *         cdef PetscInt iLoopc = asInt(iLoop)
 *         cdef PetscErrorCode ierr
*/
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_v_Iterc); if (unlikely(__pyx_t_2 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 768, __pyx_L1_error)
  __pyx_v_Itercc = __pyx_t_2;

  /* "tmm4py/tmm4py_core.pyx":769
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
 *         cdef PetscInt iLoopc = asInt(iLoop)             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         # Careful; need to pass time at end of time step
*/
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_v_iLoop); if (unlikely(__pyx_t_2 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 769, __pyx_L1_error)
  __pyx_v_iLoopc = __pyx_t_2;

  /* "tmm4py/tmm4py_core.pyx":772
 *         cdef PetscErrorCode ierr
 *         # Careful; need to pass time at end of time step
 *         ierr = TMMTimeStepPost(tcc, Iterc, iLoop, self.state)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  __pyx_t_2 = __Pyx_PyLong_As_PetscInt(__pyx_v_Iterc); if (unlikely((__pyx_t_2 == ((PetscInt)-1)) && PyErr_Occurred())) __PYX_ERR(0, 772, __pyx_L1_error)
  __pyx_t_3 = __Pyx_PyLong_As_PetscInt(__pyx_v_iLoop); if (unlikely((__pyx_t_3 == ((PetscInt)-1)) && PyErr_Occurred())) __PYX_ERR(0, 772, __pyx_L1_error)
  __pyx_v_ierr = TMMTimeStepPost(__pyx_v_tcc, __pyx_t_2, __pyx_t_3, __pyx_v_self->state);

  /* "tmm4py/tmm4py_core.pyx":773
 *         # Careful; need to pass time at end of time step
 *         ierr = TMMTimeStepPost(tcc, Iterc, iLoop, self.state)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMTimeStepPost failed with error code {ierr}")
*/
  __pyx_t_4 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_4)) {
    __pyx_t_6 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 773, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 773, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 773, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_9 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_8);
      assert(__pyx_t_6);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_8);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_8, __pyx__function);
      __pyx_t_9 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_7};
      __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_9, (2-__pyx_t_9) | (__pyx_t_9*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 773, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __PYX_ERR(0, 773, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":766
 * #             raise RuntimeError(f"TMMTimeStep failed with error code {ierr}")
 * 
 *     def timeStepPost(self, tc, Iterc, iLoop):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.timeStepPost", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":777
 * #             raise RuntimeError(f"TMMTimeStepPost failed with error code {ierr}")
 * 
 *     def output(self, tc, Iterc, iLoop):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_55output(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_55output = {"output", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_55output, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_55output(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_tc = 0;
  PyObject *__pyx_v_Iterc = 0;
  PyObject *__pyx_v_iLoop = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("output (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_Iterc,&__pyx_mstate_global->__pyx_n_u_iLoop,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 777, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 777, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 777, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 777, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "output", 0) < 0) __PYX_ERR(0, 777, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 3; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("output", 1, 3, 3, i); __PYX_ERR(0, 777, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 777, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 777, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 777, __pyx_L3_error)
    }
    __pyx_v_tc = values[0];
    __pyx_v_Iterc = values[1];
    __pyx_v_iLoop = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("output", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 777, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.output", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_54output(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_tc, __pyx_v_Iterc, __pyx_v_iLoop);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_54output(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_tc, PyObject *__pyx_v_Iterc, PyObject *__pyx_v_iLoop) {
  PetscScalar __pyx_v_tcc;
  PetscInt __pyx_v_Itercc;
  PetscInt __pyx_v_iLoopc;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscReal __pyx_t_1;
  PetscInt __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  size_t __pyx_t_8;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("output", 0);

  /* "tmm4py/tmm4py_core.pyx":778
 * 
 *     def output(self, tc, Iterc, iLoop):
 *         cdef PetscScalar tcc = asReal(tc)             # <<<<<<<<<<<<<<
 *         cdef PetscInt Itercc = asInt(Iterc)
 *         cdef PetscInt iLoopc = asInt(iLoop)
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asReal(__pyx_v_tc); if (unlikely(__pyx_t_1 == ((PetscReal)-1.0) && PyErr_Occurred())) __PYX_ERR(0, 778, __pyx_L1_error)
  __pyx_v_tcc = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":779
 *     def output(self, tc, Iterc, iLoop):
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)             # <<<<<<<<<<<<<<
 *         cdef PetscInt iLoopc = asInt(iLoop)
 *         cdef PetscErrorCode ierr
*/
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_v_Iterc); if (unlikely(__pyx_t_2 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 779, __pyx_L1_error)
  __pyx_v_Itercc = __pyx_t_2;

  /* "tmm4py/tmm4py_core.pyx":780
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
 *         cdef PetscInt iLoopc = asInt(iLoop)             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         # Careful; need to pass time at end of time step
*/
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_v_iLoop); if (unlikely(__pyx_t_2 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 780, __pyx_L1_error)
  __pyx_v_iLoopc = __pyx_t_2;

  /* "tmm4py/tmm4py_core.pyx":783
 *         cdef PetscErrorCode ierr
 *         # Careful; need to pass time at end of time step
 *         ierr = TMMOutput(tcc, Itercc, iLoopc, self.state)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  __pyx_v_ierr = TMMOutput(__pyx_v_tcc, __pyx_v_Itercc, __pyx_v_iLoopc, __pyx_v_self->state);

  /* "tmm4py/tmm4py_core.pyx":784
 *         # Careful; need to pass time at end of time step
 *         ierr = TMMOutput(tcc, Itercc, iLoopc, self.state)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMOutput failed with error code {ierr}")
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 784, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 784, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 784, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_8 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_8 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_6};
      __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_8, (2-__pyx_t_8) | (__pyx_t_8*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 784, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_ERR(0, 784, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":777
 * #             raise RuntimeError(f"TMMTimeStepPost failed with error code {ierr}")
 * 
 *     def output(self, tc, Iterc, iLoop):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.output", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":788
 * #             raise RuntimeError(f"TMMOutput failed with error code {ierr}")
 * 
 *     def pushConfigVar(self,**kwargs):             # <<<<<<<<<<<<<<
 *         for key in kwargs:
 *           if key=='isInitializedExternalForcing':
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_57pushConfigVar(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_57pushConfigVar = {"pushConfigVar", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_57pushConfigVar, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_57pushConfigVar(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("pushConfigVar (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("pushConfigVar", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (__pyx_kwds_len > 0) {
    if (unlikely(__Pyx_CheckKeywordStrings("pushConfigVar", __pyx_kwds) == -1)) return NULL;
    __pyx_v_kwargs = __Pyx_KwargsAsDict_FASTCALL(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    __Pyx_GOTREF(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = PyDict_New();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    __Pyx_GOTREF(__pyx_v_kwargs);
  }
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_56pushConfigVar(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_kwargs);

  /* function exit code */
  __Pyx_DECREF(__pyx_v_kwargs);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_56pushConfigVar(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_key = NULL;
  PyObject *__pyx_v_val = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  Py_ssize_t __pyx_t_3;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  int __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11[3];
  PyObject *__pyx_t_12 = NULL;
  size_t __pyx_t_13;
  PetscBool __pyx_t_14;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("pushConfigVar", 0);

  /* "tmm4py/tmm4py_core.pyx":789
 * 
 *     def pushConfigVar(self,**kwargs):
 *         for key in kwargs:             # <<<<<<<<<<<<<<
 *           if key=='isInitializedExternalForcing':
 *             val=kwargs[key]
*/
  __pyx_t_2 = 0;
  __pyx_t_5 = __Pyx_dict_iterator(__pyx_v_kwargs, 1, ((PyObject *)NULL), (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 789, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_1);
  __pyx_t_1 = __pyx_t_5;
  __pyx_t_5 = 0;
  while (1) {
    __pyx_t_6 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_3, &__pyx_t_2, &__pyx_t_5, NULL, NULL, __pyx_t_4);
    if (unlikely(__pyx_t_6 == 0)) break;
    if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 789, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_XDECREF_SET(__pyx_v_key, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "tmm4py/tmm4py_core.pyx":790
 *     def pushConfigVar(self,**kwargs):
 *         for key in kwargs:
 *           if key=='isInitializedExternalForcing':             # <<<<<<<<<<<<<<
 *             val=kwargs[key]
 *             if type(val) is not bool:
*/
    __pyx_t_7 = (__Pyx_PyUnicode_Equals(__pyx_v_key, __pyx_mstate_global->__pyx_n_u_isInitializedExternalForcing, Py_EQ)); if (unlikely((__pyx_t_7 < 0))) __PYX_ERR(0, 790, __pyx_L1_error)
    if (__pyx_t_7) {

      /* "tmm4py/tmm4py_core.pyx":791
 *         for key in kwargs:
 *           if key=='isInitializedExternalForcing':
 *             val=kwargs[key]             # <<<<<<<<<<<<<<
 *             if type(val) is not bool:
 *               raise RuntimeError(f"Incorrect type for {key}. Must be a bool!")
*/
      __pyx_t_5 = __Pyx_PyDict_GetItem(__pyx_v_kwargs, __pyx_v_key); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 791, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_XDECREF_SET(__pyx_v_val, __pyx_t_5);
      __pyx_t_5 = 0;

      /* "tmm4py/tmm4py_core.pyx":792
 *           if key=='isInitializedExternalForcing':
 *             val=kwargs[key]
 *             if type(val) is not bool:             # <<<<<<<<<<<<<<
 *               raise RuntimeError(f"Incorrect type for {key}. Must be a bool!")
 *             self.state.isInitializedExternalForcing=asBool(val)
*/
      __pyx_t_7 = (((PyObject *)Py_TYPE(__pyx_v_val)) != ((PyObject*)&PyBool_Type));
      if (unlikely(__pyx_t_7)) {

        /* "tmm4py/tmm4py_core.pyx":793
 *             val=kwargs[key]
 *             if type(val) is not bool:
 *               raise RuntimeError(f"Incorrect type for {key}. Must be a bool!")             # <<<<<<<<<<<<<<
 *             self.state.isInitializedExternalForcing=asBool(val)
 *           elif key=='isInitializedCalcBC':
*/
        __pyx_t_8 = NULL;
        __Pyx_INCREF(__pyx_builtin_RuntimeError);
        __pyx_t_9 = __pyx_builtin_RuntimeError; 
        __pyx_t_10 = __Pyx_PyObject_FormatSimple(__pyx_v_key, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 793, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_11[0] = __pyx_mstate_global->__pyx_kp_u_Incorrect_type_for;
        __pyx_t_11[1] = __pyx_t_10;
        __pyx_t_11[2] = __pyx_mstate_global->__pyx_kp_u_Must_be_a_bool;
        __pyx_t_12 = __Pyx_PyUnicode_Join(__pyx_t_11, 3, 19 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_10) + 17, 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_10));
        if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 793, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_13 = 1;
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_t_12};
          __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_9, __pyx_callargs+__pyx_t_13, (2-__pyx_t_13) | (__pyx_t_13*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 793, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
        }
        __Pyx_Raise(__pyx_t_5, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __PYX_ERR(0, 793, __pyx_L1_error)

        /* "tmm4py/tmm4py_core.pyx":792
 *           if key=='isInitializedExternalForcing':
 *             val=kwargs[key]
 *             if type(val) is not bool:             # <<<<<<<<<<<<<<
 *               raise RuntimeError(f"Incorrect type for {key}. Must be a bool!")
 *             self.state.isInitializedExternalForcing=asBool(val)
*/
      }

      /* "tmm4py/tmm4py_core.pyx":794
 *             if type(val) is not bool:
 *               raise RuntimeError(f"Incorrect type for {key}. Must be a bool!")
 *             self.state.isInitializedExternalForcing=asBool(val)             # <<<<<<<<<<<<<<
 *           elif key=='isInitializedCalcBC':
 *             val=kwargs[key]
*/
      __pyx_t_14 = __pyx_f_6tmm4py_11tmm4py_core_asBool(__pyx_v_val); if (unlikely(__pyx_t_14 == ((PetscBool)((PetscBool)0)) && PyErr_Occurred())) __PYX_ERR(0, 794, __pyx_L1_error)
      __pyx_v_self->state->isInitializedExternalForcing = __pyx_t_14;

      /* "tmm4py/tmm4py_core.pyx":790
 *     def pushConfigVar(self,**kwargs):
 *         for key in kwargs:
 *           if key=='isInitializedExternalForcing':             # <<<<<<<<<<<<<<
 *             val=kwargs[key]
 *             if type(val) is not bool:
*/
      goto __pyx_L5;
    }

    /* "tmm4py/tmm4py_core.pyx":795
 *               raise RuntimeError(f"Incorrect type for {key}. Must be a bool!")
 *             self.state.isInitializedExternalForcing=asBool(val)
 *           elif key=='isInitializedCalcBC':             # <<<<<<<<<<<<<<
 *             val=kwargs[key]
 *             if type(val) is not bool:
*/
    __pyx_t_7 = (__Pyx_PyUnicode_Equals(__pyx_v_key, __pyx_mstate_global->__pyx_n_u_isInitializedCalcBC, Py_EQ)); if (unlikely((__pyx_t_7 < 0))) __PYX_ERR(0, 795, __pyx_L1_error)
    if (__pyx_t_7) {

      /* "tmm4py/tmm4py_core.pyx":796
 *             self.state.isInitializedExternalForcing=asBool(val)
 *           elif key=='isInitializedCalcBC':
 *             val=kwargs[key]             # <<<<<<<<<<<<<<
 *             if type(val) is not bool:
 *               raise RuntimeError(f"Incorrect type for {key}. Must be a bool!")
*/
      __pyx_t_5 = __Pyx_PyDict_GetItem(__pyx_v_kwargs, __pyx_v_key); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 796, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_XDECREF_SET(__pyx_v_val, __pyx_t_5);
      __pyx_t_5 = 0;

      /* "tmm4py/tmm4py_core.pyx":797
 *           elif key=='isInitializedCalcBC':
 *             val=kwargs[key]
 *             if type(val) is not bool:             # <<<<<<<<<<<<<<
 *               raise RuntimeError(f"Incorrect type for {key}. Must be a bool!")
 *             self.state.isInitializedCalcBC=asBool(val)
*/
      __pyx_t_7 = (((PyObject *)Py_TYPE(__pyx_v_val)) != ((PyObject*)&PyBool_Type));
      if (unlikely(__pyx_t_7)) {

        /* "tmm4py/tmm4py_core.pyx":798
 *             val=kwargs[key]
 *             if type(val) is not bool:
 *               raise RuntimeError(f"Incorrect type for {key}. Must be a bool!")             # <<<<<<<<<<<<<<
 *             self.state.isInitializedCalcBC=asBool(val)
 *         # Update config
*/
        __pyx_t_9 = NULL;
        __Pyx_INCREF(__pyx_builtin_RuntimeError);
        __pyx_t_12 = __pyx_builtin_RuntimeError; 
        __pyx_t_8 = __Pyx_PyObject_FormatSimple(__pyx_v_key, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 798, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_11[0] = __pyx_mstate_global->__pyx_kp_u_Incorrect_type_for;
        __pyx_t_11[1] = __pyx_t_8;
        __pyx_t_11[2] = __pyx_mstate_global->__pyx_kp_u_Must_be_a_bool;
        __pyx_t_10 = __Pyx_PyUnicode_Join(__pyx_t_11, 3, 19 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_8) + 17, 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_8));
        if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 798, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_13 = 1;
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_10};
          __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_12, __pyx_callargs+__pyx_t_13, (2-__pyx_t_13) | (__pyx_t_13*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 798, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
        }
        __Pyx_Raise(__pyx_t_5, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __PYX_ERR(0, 798, __pyx_L1_error)

        /* "tmm4py/tmm4py_core.pyx":797
 *           elif key=='isInitializedCalcBC':
 *             val=kwargs[key]
 *             if type(val) is not bool:             # <<<<<<<<<<<<<<
 *               raise RuntimeError(f"Incorrect type for {key}. Must be a bool!")
 *             self.state.isInitializedCalcBC=asBool(val)
*/
      }

      /* "tmm4py/tmm4py_core.pyx":799
 *             if type(val) is not bool:
 *               raise RuntimeError(f"Incorrect type for {key}. Must be a bool!")
 *             self.state.isInitializedCalcBC=asBool(val)             # <<<<<<<<<<<<<<
 *         # Update config
 *         self.config=_getStateConfig(self.state)
*/
      __pyx_t_14 = __pyx_f_6tmm4py_11tmm4py_core_asBool(__pyx_v_val); if (unlikely(__pyx_t_14 == ((PetscBool)((PetscBool)0)) && PyErr_Occurred())) __PYX_ERR(0, 799, __pyx_L1_error)
      __pyx_v_self->state->isInitializedCalcBC = __pyx_t_14;

      /* "tmm4py/tmm4py_core.pyx":795
 *               raise RuntimeError(f"Incorrect type for {key}. Must be a bool!")
 *             self.state.isInitializedExternalForcing=asBool(val)
 *           elif key=='isInitializedCalcBC':             # <<<<<<<<<<<<<<
 *             val=kwargs[key]
 *             if type(val) is not bool:
*/
    }
    __pyx_L5:;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":801
 *             self.state.isInitializedCalcBC=asBool(val)
 *         # Update config
 *         self.config=_getStateConfig(self.state)             # <<<<<<<<<<<<<<
 * 
 *     def destroy(self, tc):
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core__getStateConfig(__pyx_v_self->state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 801, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->config);
  __Pyx_DECREF(__pyx_v_self->config);
  __pyx_v_self->config = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":788
 * #             raise RuntimeError(f"TMMOutput failed with error code {ierr}")
 * 
 *     def pushConfigVar(self,**kwargs):             # <<<<<<<<<<<<<<
 *         for key in kwargs:
 *           if key=='isInitializedExternalForcing':
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.pushConfigVar", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_key);
  __Pyx_XDECREF(__pyx_v_val);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":803
 *         self.config=_getStateConfig(self.state)
 * 
 *     def destroy(self, tc):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_59destroy(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_59destroy = {"destroy", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_59destroy, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_59destroy(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_tc = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("destroy (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_tc,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 803, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 803, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "destroy", 0) < 0) __PYX_ERR(0, 803, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("destroy", 1, 1, 1, i); __PYX_ERR(0, 803, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 803, __pyx_L3_error)
    }
    __pyx_v_tc = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("destroy", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 803, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.destroy", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_58destroy(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_tc);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_58destroy(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_tc) {
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  size_t __pyx_t_7;
  PetscReal __pyx_t_8;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("destroy", 0);

  /* "tmm4py/tmm4py_core.pyx":806
 *         cdef PetscErrorCode ierr
 * 
 *         if debug: print(f"Within destroy at time {tc}")             # <<<<<<<<<<<<<<
 * 
 *         if self.c:
*/
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_mstate_global->__pyx_n_u_debug); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 806, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 806, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
    __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_builtin_print);
    __pyx_t_4 = __pyx_builtin_print; 
    __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_v_tc, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 806, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_Within_destroy_at_time, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 806, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_6};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 806, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "tmm4py/tmm4py_core.pyx":808
 *         if debug: print(f"Within destroy at time {tc}")
 * 
 *         if self.c:             # <<<<<<<<<<<<<<
 *             del self.c
 * 
*/
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_self->c); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 808, __pyx_L1_error)
  if (__pyx_t_2) {

    /* "tmm4py/tmm4py_core.pyx":809
 * 
 *         if self.c:
 *             del self.c             # <<<<<<<<<<<<<<
 * 
 *         if self.qf:
*/
    if (__Pyx_PyObject_DelAttrStr(((PyObject *)__pyx_v_self), __pyx_mstate_global->__pyx_n_u_c_2) < 0) __PYX_ERR(0, 809, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":808
 *         if debug: print(f"Within destroy at time {tc}")
 * 
 *         if self.c:             # <<<<<<<<<<<<<<
 *             del self.c
 * 
*/
  }

  /* "tmm4py/tmm4py_core.pyx":811
 *             del self.c
 * 
 *         if self.qf:             # <<<<<<<<<<<<<<
 *             del self.qf
 * 
*/
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_self->qf); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 811, __pyx_L1_error)
  if (__pyx_t_2) {

    /* "tmm4py/tmm4py_core.pyx":812
 * 
 *         if self.qf:
 *             del self.qf             # <<<<<<<<<<<<<<
 * 
 *         if self.qef:
*/
    if (__Pyx_PyObject_DelAttrStr(((PyObject *)__pyx_v_self), __pyx_mstate_global->__pyx_n_u_qf_2) < 0) __PYX_ERR(0, 812, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":811
 *             del self.c
 * 
 *         if self.qf:             # <<<<<<<<<<<<<<
 *             del self.qf
 * 
*/
  }

  /* "tmm4py/tmm4py_core.pyx":814
 *             del self.qf
 * 
 *         if self.qef:             # <<<<<<<<<<<<<<
 *             del self.qef
 * 
*/
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_self->qef); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 814, __pyx_L1_error)
  if (__pyx_t_2) {

    /* "tmm4py/tmm4py_core.pyx":815
 * 
 *         if self.qef:
 *             del self.qef             # <<<<<<<<<<<<<<
 * 
 *         if self.qrel:
*/
    if (__Pyx_PyObject_DelAttrStr(((PyObject *)__pyx_v_self), __pyx_mstate_global->__pyx_n_u_qef_2) < 0) __PYX_ERR(0, 815, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":814
 *             del self.qf
 * 
 *         if self.qef:             # <<<<<<<<<<<<<<
 *             del self.qef
 * 
*/
  }

  /* "tmm4py/tmm4py_core.pyx":817
 *             del self.qef
 * 
 *         if self.qrel:             # <<<<<<<<<<<<<<
 *             del self.qrel
 * 
*/
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_self->qrel); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 817, __pyx_L1_error)
  if (__pyx_t_2) {

    /* "tmm4py/tmm4py_core.pyx":818
 * 
 *         if self.qrel:
 *             del self.qrel             # <<<<<<<<<<<<<<
 * 
 *         if self.cbc:
*/
    if (__Pyx_PyObject_DelAttrStr(((PyObject *)__pyx_v_self), __pyx_mstate_global->__pyx_n_u_qrel_2) < 0) __PYX_ERR(0, 818, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":817
 *             del self.qef
 * 
 *         if self.qrel:             # <<<<<<<<<<<<<<
 *             del self.qrel
 * 
*/
  }

  /* "tmm4py/tmm4py_core.pyx":820
 *             del self.qrel
 * 
 *         if self.cbc:             # <<<<<<<<<<<<<<
 *             del self.cbc
 * 
*/
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_self->cbc); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 820, __pyx_L1_error)
  if (__pyx_t_2) {

    /* "tmm4py/tmm4py_core.pyx":821
 * 
 *         if self.cbc:
 *             del self.cbc             # <<<<<<<<<<<<<<
 * 
 *         if self.cbf:
*/
    if (__Pyx_PyObject_DelAttrStr(((PyObject *)__pyx_v_self), __pyx_mstate_global->__pyx_n_u_cbc_2) < 0) __PYX_ERR(0, 821, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":820
 *             del self.qrel
 * 
 *         if self.cbc:             # <<<<<<<<<<<<<<
 *             del self.cbc
 * 
*/
  }

  /* "tmm4py/tmm4py_core.pyx":823
 *             del self.cbc
 * 
 *         if self.cbf:             # <<<<<<<<<<<<<<
 *             del self.cbf
 * 
*/
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_self->cbf); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 823, __pyx_L1_error)
  if (__pyx_t_2) {

    /* "tmm4py/tmm4py_core.pyx":824
 * 
 *         if self.cbf:
 *             del self.cbf             # <<<<<<<<<<<<<<
 * 
 *         ierr = TMMDestroy(asReal(tc), &self.state)
*/
    if (__Pyx_PyObject_DelAttrStr(((PyObject *)__pyx_v_self), __pyx_mstate_global->__pyx_n_u_cbf_2) < 0) __PYX_ERR(0, 824, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":823
 *             del self.cbc
 * 
 *         if self.cbf:             # <<<<<<<<<<<<<<
 *             del self.cbf
 * 
*/
  }

  /* "tmm4py/tmm4py_core.pyx":826
 *             del self.cbf
 * 
 *         ierr = TMMDestroy(asReal(tc), &self.state)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #         if ierr != 0:
*/
  __pyx_t_8 = __pyx_f_6tmm4py_11tmm4py_core_asReal(__pyx_v_tc); if (unlikely(__pyx_t_8 == ((PetscReal)-1.0) && PyErr_Occurred())) __PYX_ERR(0, 826, __pyx_L1_error)
  __pyx_v_ierr = TMMDestroy(__pyx_t_8, (&__pyx_v_self->state));

  /* "tmm4py/tmm4py_core.pyx":827
 * 
 *         ierr = TMMDestroy(asReal(tc), &self.state)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         if ierr != 0:
 * #             raise RuntimeError(f"TMMDestroy failed with error code {ierr}")
*/
  __pyx_t_2 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_2)) {
    __pyx_t_4 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_3, __pyx__function);
      __pyx_t_7 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_6};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 827, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 827, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":803
 *         self.config=_getStateConfig(self.state)
 * 
 *     def destroy(self, tc):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.destroy", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":831
 * #             raise RuntimeError(f"TMMDestroy failed with error code {ierr}")
 * 
 *     def setTracer(self, alpha, itr=0):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar sval = asReal(alpha)
 *         cdef PetscErrorCode ierr
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_61setTracer(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_61setTracer = {"setTracer", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_61setTracer, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_61setTracer(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_alpha = 0;
  PyObject *__pyx_v_itr = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("setTracer (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_alpha,&__pyx_mstate_global->__pyx_n_u_itr,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 831, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 831, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 831, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "setTracer", 0) < 0) __PYX_ERR(0, 831, __pyx_L3_error)
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_int_0));
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("setTracer", 0, 1, 2, i); __PYX_ERR(0, 831, __pyx_L3_error) }
      }
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 831, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 831, __pyx_L3_error)
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_int_0));
    }
    __pyx_v_alpha = values[0];
    __pyx_v_itr = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("setTracer", 0, 1, 2, __pyx_nargs); __PYX_ERR(0, 831, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setTracer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_60setTracer(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_alpha, __pyx_v_itr);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_60setTracer(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_alpha, PyObject *__pyx_v_itr) {
  PetscScalar __pyx_v_sval;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscReal __pyx_t_1;
  Py_ssize_t __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  size_t __pyx_t_8;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("setTracer", 0);

  /* "tmm4py/tmm4py_core.pyx":832
 * 
 *     def setTracer(self, alpha, itr=0):
 *         cdef PetscScalar sval = asReal(alpha)             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         ierr = VecSet(self.state.c[itr], sval)
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asReal(__pyx_v_alpha); if (unlikely(__pyx_t_1 == ((PetscReal)-1.0) && PyErr_Occurred())) __PYX_ERR(0, 832, __pyx_L1_error)
  __pyx_v_sval = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":834
 *         cdef PetscScalar sval = asReal(alpha)
 *         cdef PetscErrorCode ierr
 *         ierr = VecSet(self.state.c[itr], sval)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_t_2 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_2 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 834, __pyx_L1_error)
  __pyx_v_ierr = VecSet((__pyx_v_self->state->c[__pyx_t_2]), __pyx_v_sval);

  /* "tmm4py/tmm4py_core.pyx":835
 *         cdef PetscErrorCode ierr
 *         ierr = VecSet(self.state.c[itr], sval)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 *     def loadTracerFromFile(self, typ, filename, itr, iRec=0):
*/
  __pyx_t_3 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_3)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 835, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 835, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 835, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_8 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_8 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_6};
      __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_8, (2-__pyx_t_8) | (__pyx_t_8*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 835, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_ERR(0, 835, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":831
 * #             raise RuntimeError(f"TMMDestroy failed with error code {ierr}")
 * 
 *     def setTracer(self, alpha, itr=0):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar sval = asReal(alpha)
 *         cdef PetscErrorCode ierr
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.setTracer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":837
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def loadTracerFromFile(self, typ, filename, itr, iRec=0):             # <<<<<<<<<<<<<<
 * #     Note: iRec is 0-based while VecLoadIntoVectorRandomAccessFromFile is 1-based
 *       cdef PetscErrorCode ierr
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_63loadTracerFromFile(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_63loadTracerFromFile = {"loadTracerFromFile", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_63loadTracerFromFile, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_63loadTracerFromFile(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_typ = 0;
  PyObject *__pyx_v_filename = 0;
  PyObject *__pyx_v_itr = 0;
  PyObject *__pyx_v_iRec = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("loadTracerFromFile (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_typ,&__pyx_mstate_global->__pyx_n_u_filename,&__pyx_mstate_global->__pyx_n_u_itr,&__pyx_mstate_global->__pyx_n_u_iRec,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 837, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 837, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 837, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 837, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 837, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "loadTracerFromFile", 0) < 0) __PYX_ERR(0, 837, __pyx_L3_error)
      if (!values[3]) values[3] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_int_0));
      for (Py_ssize_t i = __pyx_nargs; i < 3; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("loadTracerFromFile", 0, 3, 4, i); __PYX_ERR(0, 837, __pyx_L3_error) }
      }
    } else {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 837, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 837, __pyx_L3_error)
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 837, __pyx_L3_error)
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 837, __pyx_L3_error)
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[3]) values[3] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_int_0));
    }
    __pyx_v_typ = values[0];
    __pyx_v_filename = values[1];
    __pyx_v_itr = values[2];
    __pyx_v_iRec = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("loadTracerFromFile", 0, 3, 4, __pyx_nargs); __PYX_ERR(0, 837, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.loadTracerFromFile", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_62loadTracerFromFile(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v_typ, __pyx_v_filename, __pyx_v_itr, __pyx_v_iRec);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_62loadTracerFromFile(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_typ, PyObject *__pyx_v_filename, PyObject *__pyx_v_itr, PyObject *__pyx_v_iRec) {
  PetscErrorCode __pyx_v_ierr;
  char const *__pyx_v_c_filename;
  PetscInt __pyx_v_iRecc;
  PetscInt __pyx_v_nl;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscInt __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  size_t __pyx_t_4;
  char *__pyx_t_5;
  int __pyx_t_6;
  Py_ssize_t __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10[3];
  PyObject *__pyx_t_11 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("loadTracerFromFile", 0);

  /* "tmm4py/tmm4py_core.pyx":841
 *       cdef PetscErrorCode ierr
 *       cdef const char* c_filename
 *       cdef PetscInt iRecc = asInt(iRec)+1             # <<<<<<<<<<<<<<
 *       c_filename = PyBytes_AsString(filename.encode())
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_v_iRec); if (unlikely(__pyx_t_1 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 841, __pyx_L1_error)
  __pyx_v_iRecc = (__pyx_t_1 + 1);

  /* "tmm4py/tmm4py_core.pyx":842
 *       cdef const char* c_filename
 *       cdef PetscInt iRecc = asInt(iRec)+1
 *       c_filename = PyBytes_AsString(filename.encode())             # <<<<<<<<<<<<<<
 * 
 *       if typ is 'tracer':
*/
  __pyx_t_3 = __pyx_v_filename;
  __Pyx_INCREF(__pyx_t_3);
  __pyx_t_4 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_2 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 842, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  }
  __pyx_t_5 = PyBytes_AsString(__pyx_t_2); if (unlikely(__pyx_t_5 == ((char *)0))) __PYX_ERR(0, 842, __pyx_L1_error)
  __pyx_v_c_filename = __pyx_t_5;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":844
 *       c_filename = PyBytes_AsString(filename.encode())
 * 
 *       if typ is 'tracer':             # <<<<<<<<<<<<<<
 *         nl = nb
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.c[itr], asInt(nl), iRecc)
*/
  __pyx_t_6 = (__pyx_v_typ == __pyx_mstate_global->__pyx_n_u_tracer);
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":845
 * 
 *       if typ is 'tracer':
 *         nl = nb             # <<<<<<<<<<<<<<
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.c[itr], asInt(nl), iRecc)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
    __pyx_v_nl = nb;

    /* "tmm4py/tmm4py_core.pyx":846
 *       if typ is 'tracer':
 *         nl = nb
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.c[itr], asInt(nl), iRecc)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *       elif typ is 'cbc':
*/
    __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 846, __pyx_L1_error)
    __pyx_t_2 = __Pyx_PyLong_From_PetscInt(__pyx_v_nl); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 846, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_t_2); if (unlikely(__pyx_t_1 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 846, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_ierr = VecLoadIntoVectorRandomAccessFromFile(__pyx_v_c_filename, (__pyx_v_self->state->c[__pyx_t_7]), __pyx_t_1, __pyx_v_iRecc);

    /* "tmm4py/tmm4py_core.pyx":847
 *         nl = nb
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.c[itr], asInt(nl), iRecc)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *       elif typ is 'cbc':
 *         nl = gBCSize
*/
    __pyx_t_6 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_6)) {
      __pyx_t_3 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 847, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 847, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 847, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_4 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_9))) {
        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_9);
        assert(__pyx_t_3);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_9);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_9, __pyx__function);
        __pyx_t_4 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_8};
        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_9, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 847, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __PYX_ERR(0, 847, __pyx_L1_error)
    }

    /* "tmm4py/tmm4py_core.pyx":844
 *       c_filename = PyBytes_AsString(filename.encode())
 * 
 *       if typ is 'tracer':             # <<<<<<<<<<<<<<
 *         nl = nb
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.c[itr], asInt(nl), iRecc)
*/
    goto __pyx_L3;
  }

  /* "tmm4py/tmm4py_core.pyx":848
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.c[itr], asInt(nl), iRecc)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *       elif typ is 'cbc':             # <<<<<<<<<<<<<<
 *         nl = gBCSize
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.cbc[itr], asInt(nl), iRecc)
*/
  __pyx_t_6 = (__pyx_v_typ == __pyx_mstate_global->__pyx_n_u_cbc_2);
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":849
 *         if ierr != 0: raise PETSc.Error(ierr)
 *       elif typ is 'cbc':
 *         nl = gBCSize             # <<<<<<<<<<<<<<
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.cbc[itr], asInt(nl), iRecc)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
    __pyx_v_nl = gBCSize;

    /* "tmm4py/tmm4py_core.pyx":850
 *       elif typ is 'cbc':
 *         nl = gBCSize
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.cbc[itr], asInt(nl), iRecc)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *       elif typ is 'cbf':
*/
    __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 850, __pyx_L1_error)
    __pyx_t_2 = __Pyx_PyLong_From_PetscInt(__pyx_v_nl); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 850, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_t_2); if (unlikely(__pyx_t_1 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 850, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_ierr = VecLoadIntoVectorRandomAccessFromFile(__pyx_v_c_filename, (__pyx_v_self->state->cbc[__pyx_t_7]), __pyx_t_1, __pyx_v_iRecc);

    /* "tmm4py/tmm4py_core.pyx":851
 *         nl = gBCSize
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.cbc[itr], asInt(nl), iRecc)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *       elif typ is 'cbf':
 *         nl = gBCSize
*/
    __pyx_t_6 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_6)) {
      __pyx_t_9 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 851, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 851, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 851, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_4 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_3);
        assert(__pyx_t_9);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_3, __pyx__function);
        __pyx_t_4 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_8};
        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 851, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __PYX_ERR(0, 851, __pyx_L1_error)
    }

    /* "tmm4py/tmm4py_core.pyx":848
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.c[itr], asInt(nl), iRecc)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *       elif typ is 'cbc':             # <<<<<<<<<<<<<<
 *         nl = gBCSize
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.cbc[itr], asInt(nl), iRecc)
*/
    goto __pyx_L3;
  }

  /* "tmm4py/tmm4py_core.pyx":852
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.cbc[itr], asInt(nl), iRecc)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *       elif typ is 'cbf':             # <<<<<<<<<<<<<<
 *         nl = gBCSize
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.cbf[itr], asInt(nl), iRecc)
*/
  __pyx_t_6 = (__pyx_v_typ == __pyx_mstate_global->__pyx_n_u_cbf_2);
  if (likely(__pyx_t_6)) {

    /* "tmm4py/tmm4py_core.pyx":853
 *         if ierr != 0: raise PETSc.Error(ierr)
 *       elif typ is 'cbf':
 *         nl = gBCSize             # <<<<<<<<<<<<<<
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.cbf[itr], asInt(nl), iRecc)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
    __pyx_v_nl = gBCSize;

    /* "tmm4py/tmm4py_core.pyx":854
 *       elif typ is 'cbf':
 *         nl = gBCSize
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.cbf[itr], asInt(nl), iRecc)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *       else:
*/
    __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_v_itr); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 854, __pyx_L1_error)
    __pyx_t_2 = __Pyx_PyLong_From_PetscInt(__pyx_v_nl); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 854, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_t_2); if (unlikely(__pyx_t_1 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 854, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_ierr = VecLoadIntoVectorRandomAccessFromFile(__pyx_v_c_filename, (__pyx_v_self->state->cbf[__pyx_t_7]), __pyx_t_1, __pyx_v_iRecc);

    /* "tmm4py/tmm4py_core.pyx":855
 *         nl = gBCSize
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.cbf[itr], asInt(nl), iRecc)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *       else:
 *         raise RuntimeError(f"Unknown type of vector {typ} when loading")
*/
    __pyx_t_6 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_6)) {
      __pyx_t_3 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 855, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 855, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 855, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_4 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_9))) {
        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_9);
        assert(__pyx_t_3);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_9);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_9, __pyx__function);
        __pyx_t_4 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_8};
        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_9, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 855, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __PYX_ERR(0, 855, __pyx_L1_error)
    }

    /* "tmm4py/tmm4py_core.pyx":852
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.cbc[itr], asInt(nl), iRecc)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *       elif typ is 'cbf':             # <<<<<<<<<<<<<<
 *         nl = gBCSize
 *         ierr = VecLoadIntoVectorRandomAccessFromFile(c_filename,self.state.cbf[itr], asInt(nl), iRecc)
*/
    goto __pyx_L3;
  }

  /* "tmm4py/tmm4py_core.pyx":857
 *         if ierr != 0: raise PETSc.Error(ierr)
 *       else:
 *         raise RuntimeError(f"Unknown type of vector {typ} when loading")             # <<<<<<<<<<<<<<
 * 
 * def _cleanUp():
*/
  /*else*/ {
    __pyx_t_9 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_8 = __pyx_builtin_RuntimeError; 
    __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_v_typ, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_10[0] = __pyx_mstate_global->__pyx_kp_u_Unknown_type_of_vector;
    __pyx_t_10[1] = __pyx_t_3;
    __pyx_t_10[2] = __pyx_mstate_global->__pyx_kp_u_when_loading;
    __pyx_t_11 = __Pyx_PyUnicode_Join(__pyx_t_10, 3, 23 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_3) + 13, 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_3));
    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 857, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_4 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_11};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 857, __pyx_L1_error)
  }
  __pyx_L3:;

  /* "tmm4py/tmm4py_core.pyx":837
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def loadTracerFromFile(self, typ, filename, itr, iRec=0):             # <<<<<<<<<<<<<<
 * #     Note: iRec is 0-based while VecLoadIntoVectorRandomAccessFromFile is 1-based
 *       cdef PetscErrorCode ierr
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.loadTracerFromFile", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":127
 *     cdef PetscTMMState state
 *     cdef public:
 *       object finiex             # <<<<<<<<<<<<<<
 *       object fcalcex
 *       object fwriex
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6finiex_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6finiex_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6finiex___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6finiex___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->finiex);
  __pyx_r = __pyx_v_self->finiex;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6finiex_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6finiex_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6finiex_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6finiex_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->finiex);
  __Pyx_DECREF(__pyx_v_self->finiex);
  __pyx_v_self->finiex = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6finiex_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6finiex_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6finiex_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6finiex_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->finiex);
  __Pyx_DECREF(__pyx_v_self->finiex);
  __pyx_v_self->finiex = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":128
 *     cdef public:
 *       object finiex
 *       object fcalcex             # <<<<<<<<<<<<<<
 *       object fwriex
 *       object ffinex
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fcalcex___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fcalcex___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->fcalcex);
  __pyx_r = __pyx_v_self->fcalcex;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->fcalcex);
  __Pyx_DECREF(__pyx_v_self->fcalcex);
  __pyx_v_self->fcalcex = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fcalcex);
  __Pyx_DECREF(__pyx_v_self->fcalcex);
  __pyx_v_self->fcalcex = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":129
 *       object finiex
 *       object fcalcex
 *       object fwriex             # <<<<<<<<<<<<<<
 *       object ffinex
 *       object freiex
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6fwriex_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6fwriex_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6fwriex___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6fwriex___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->fwriex);
  __pyx_r = __pyx_v_self->fwriex;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6fwriex_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6fwriex_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6fwriex_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6fwriex_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->fwriex);
  __Pyx_DECREF(__pyx_v_self->fwriex);
  __pyx_v_self->fwriex = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6fwriex_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6fwriex_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6fwriex_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6fwriex_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fwriex);
  __Pyx_DECREF(__pyx_v_self->fwriex);
  __pyx_v_self->fwriex = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":130
 *       object fcalcex
 *       object fwriex
 *       object ffinex             # <<<<<<<<<<<<<<
 *       object freiex
 *       object finicbc
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6ffinex_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6ffinex_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6ffinex___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6ffinex___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->ffinex);
  __pyx_r = __pyx_v_self->ffinex;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6ffinex_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6ffinex_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6ffinex_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6ffinex_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->ffinex);
  __Pyx_DECREF(__pyx_v_self->ffinex);
  __pyx_v_self->ffinex = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6ffinex_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6ffinex_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6ffinex_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6ffinex_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->ffinex);
  __Pyx_DECREF(__pyx_v_self->ffinex);
  __pyx_v_self->ffinex = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":131
 *       object fwriex
 *       object ffinex
 *       object freiex             # <<<<<<<<<<<<<<
 *       object finicbc
 *       object fcalccbc
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6freiex_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6freiex_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6freiex___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6freiex___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->freiex);
  __pyx_r = __pyx_v_self->freiex;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6freiex_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6freiex_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6freiex_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6freiex_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->freiex);
  __Pyx_DECREF(__pyx_v_self->freiex);
  __pyx_v_self->freiex = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6freiex_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6freiex_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6freiex_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6freiex_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->freiex);
  __Pyx_DECREF(__pyx_v_self->freiex);
  __pyx_v_self->freiex = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":132
 *       object ffinex
 *       object freiex
 *       object finicbc             # <<<<<<<<<<<<<<
 *       object fcalccbc
 *       object fwricbc
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finicbc_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finicbc_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finicbc___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finicbc___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->finicbc);
  __pyx_r = __pyx_v_self->finicbc;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finicbc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finicbc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finicbc_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finicbc_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->finicbc);
  __Pyx_DECREF(__pyx_v_self->finicbc);
  __pyx_v_self->finicbc = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finicbc_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finicbc_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finicbc_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finicbc_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->finicbc);
  __Pyx_DECREF(__pyx_v_self->finicbc);
  __pyx_v_self->finicbc = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":133
 *       object freiex
 *       object finicbc
 *       object fcalccbc             # <<<<<<<<<<<<<<
 *       object fwricbc
 *       object ffincbc
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->fcalccbc);
  __pyx_r = __pyx_v_self->fcalccbc;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->fcalccbc);
  __Pyx_DECREF(__pyx_v_self->fcalccbc);
  __pyx_v_self->fcalccbc = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fcalccbc);
  __Pyx_DECREF(__pyx_v_self->fcalccbc);
  __pyx_v_self->fcalccbc = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":134
 *       object finicbc
 *       object fcalccbc
 *       object fwricbc             # <<<<<<<<<<<<<<
 *       object ffincbc
 *       object freicbc
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwricbc___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwricbc___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->fwricbc);
  __pyx_r = __pyx_v_self->fwricbc;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->fwricbc);
  __Pyx_DECREF(__pyx_v_self->fwricbc);
  __pyx_v_self->fwricbc = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fwricbc);
  __Pyx_DECREF(__pyx_v_self->fwricbc);
  __pyx_v_self->fwricbc = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":135
 *       object fcalccbc
 *       object fwricbc
 *       object ffincbc             # <<<<<<<<<<<<<<
 *       object freicbc
 *       object finimon
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffincbc___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffincbc___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->ffincbc);
  __pyx_r = __pyx_v_self->ffincbc;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->ffincbc);
  __Pyx_DECREF(__pyx_v_self->ffincbc);
  __pyx_v_self->ffincbc = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->ffincbc);
  __Pyx_DECREF(__pyx_v_self->ffincbc);
  __pyx_v_self->ffincbc = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":136
 *       object fwricbc
 *       object ffincbc
 *       object freicbc             # <<<<<<<<<<<<<<
 *       object finimon
 *       object fcalcmon
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7freicbc_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7freicbc_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7freicbc___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7freicbc___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->freicbc);
  __pyx_r = __pyx_v_self->freicbc;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7freicbc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7freicbc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7freicbc_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7freicbc_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->freicbc);
  __Pyx_DECREF(__pyx_v_self->freicbc);
  __pyx_v_self->freicbc = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7freicbc_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7freicbc_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7freicbc_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7freicbc_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->freicbc);
  __Pyx_DECREF(__pyx_v_self->freicbc);
  __pyx_v_self->freicbc = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":137
 *       object ffincbc
 *       object freicbc
 *       object finimon             # <<<<<<<<<<<<<<
 *       object fcalcmon
 *       object fwrimon
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimon_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimon_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimon___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimon___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->finimon);
  __pyx_r = __pyx_v_self->finimon;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimon_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimon_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimon_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimon_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->finimon);
  __Pyx_DECREF(__pyx_v_self->finimon);
  __pyx_v_self->finimon = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimon_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimon_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimon_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimon_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->finimon);
  __Pyx_DECREF(__pyx_v_self->finimon);
  __pyx_v_self->finimon = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":138
 *       object freicbc
 *       object finimon
 *       object fcalcmon             # <<<<<<<<<<<<<<
 *       object fwrimon
 *       object ffinmon
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->fcalcmon);
  __pyx_r = __pyx_v_self->fcalcmon;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->fcalcmon);
  __Pyx_DECREF(__pyx_v_self->fcalcmon);
  __pyx_v_self->fcalcmon = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fcalcmon);
  __Pyx_DECREF(__pyx_v_self->fcalcmon);
  __pyx_v_self->fcalcmon = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":139
 *       object finimon
 *       object fcalcmon
 *       object fwrimon             # <<<<<<<<<<<<<<
 *       object ffinmon
 *       object finimis
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimon___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimon___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->fwrimon);
  __pyx_r = __pyx_v_self->fwrimon;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->fwrimon);
  __Pyx_DECREF(__pyx_v_self->fwrimon);
  __pyx_v_self->fwrimon = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fwrimon);
  __Pyx_DECREF(__pyx_v_self->fwrimon);
  __pyx_v_self->fwrimon = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":140
 *       object fcalcmon
 *       object fwrimon
 *       object ffinmon             # <<<<<<<<<<<<<<
 *       object finimis
 *       object fcalcmis
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmon___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmon___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->ffinmon);
  __pyx_r = __pyx_v_self->ffinmon;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->ffinmon);
  __Pyx_DECREF(__pyx_v_self->ffinmon);
  __pyx_v_self->ffinmon = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->ffinmon);
  __Pyx_DECREF(__pyx_v_self->ffinmon);
  __pyx_v_self->ffinmon = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":141
 *       object fwrimon
 *       object ffinmon
 *       object finimis             # <<<<<<<<<<<<<<
 *       object fcalcmis
 *       object fwrimis
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimis_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimis_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimis___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimis___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->finimis);
  __pyx_r = __pyx_v_self->finimis;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimis_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimis_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimis_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimis_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->finimis);
  __Pyx_DECREF(__pyx_v_self->finimis);
  __pyx_v_self->finimis = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimis_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimis_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimis_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7finimis_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->finimis);
  __Pyx_DECREF(__pyx_v_self->finimis);
  __pyx_v_self->finimis = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":142
 *       object ffinmon
 *       object finimis
 *       object fcalcmis             # <<<<<<<<<<<<<<
 *       object fwrimis
 *       object ffinmis
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->fcalcmis);
  __pyx_r = __pyx_v_self->fcalcmis;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->fcalcmis);
  __Pyx_DECREF(__pyx_v_self->fcalcmis);
  __pyx_v_self->fcalcmis = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fcalcmis);
  __Pyx_DECREF(__pyx_v_self->fcalcmis);
  __pyx_v_self->fcalcmis = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":143
 *       object finimis
 *       object fcalcmis
 *       object fwrimis             # <<<<<<<<<<<<<<
 *       object ffinmis
 *       object stateId
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimis___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimis___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->fwrimis);
  __pyx_r = __pyx_v_self->fwrimis;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->fwrimis);
  __Pyx_DECREF(__pyx_v_self->fwrimis);
  __pyx_v_self->fwrimis = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->fwrimis);
  __Pyx_DECREF(__pyx_v_self->fwrimis);
  __pyx_v_self->fwrimis = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":144
 *       object fcalcmis
 *       object fwrimis
 *       object ffinmis             # <<<<<<<<<<<<<<
 *       object stateId
 *       object numTracers
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmis___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmis___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->ffinmis);
  __pyx_r = __pyx_v_self->ffinmis;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->ffinmis);
  __Pyx_DECREF(__pyx_v_self->ffinmis);
  __pyx_v_self->ffinmis = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->ffinmis);
  __Pyx_DECREF(__pyx_v_self->ffinmis);
  __pyx_v_self->ffinmis = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":145
 *       object fwrimis
 *       object ffinmis
 *       object stateId             # <<<<<<<<<<<<<<
 *       object numTracers
 *       object config
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7stateId_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7stateId_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7stateId___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7stateId___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->stateId);
  __pyx_r = __pyx_v_self->stateId;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7stateId_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7stateId_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7stateId_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7stateId_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->stateId);
  __Pyx_DECREF(__pyx_v_self->stateId);
  __pyx_v_self->stateId = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7stateId_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7stateId_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7stateId_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_7stateId_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->stateId);
  __Pyx_DECREF(__pyx_v_self->stateId);
  __pyx_v_self->stateId = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":146
 *       object ffinmis
 *       object stateId
 *       object numTracers             # <<<<<<<<<<<<<<
 *       object config
 *       object tracerNames
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_10numTracers_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_10numTracers_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_10numTracers___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_10numTracers___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->numTracers);
  __pyx_r = __pyx_v_self->numTracers;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_10numTracers_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_10numTracers_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_10numTracers_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_10numTracers_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->numTracers);
  __Pyx_DECREF(__pyx_v_self->numTracers);
  __pyx_v_self->numTracers = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_10numTracers_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_10numTracers_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_10numTracers_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_10numTracers_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->numTracers);
  __Pyx_DECREF(__pyx_v_self->numTracers);
  __pyx_v_self->numTracers = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":147
 *       object stateId
 *       object numTracers
 *       object config             # <<<<<<<<<<<<<<
 *       object tracerNames
 *       object c
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6config_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6config_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6config___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6config___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->config);
  __pyx_r = __pyx_v_self->config;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6config_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6config_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6config_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6config_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->config);
  __Pyx_DECREF(__pyx_v_self->config);
  __pyx_v_self->config = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6config_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6config_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6config_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_6config_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->config);
  __Pyx_DECREF(__pyx_v_self->config);
  __pyx_v_self->config = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":148
 *       object numTracers
 *       object config
 *       object tracerNames             # <<<<<<<<<<<<<<
 *       object c
 *       object qf
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_11tracerNames___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_11tracerNames___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->tracerNames);
  __pyx_r = __pyx_v_self->tracerNames;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->tracerNames);
  __Pyx_DECREF(__pyx_v_self->tracerNames);
  __pyx_v_self->tracerNames = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->tracerNames);
  __Pyx_DECREF(__pyx_v_self->tracerNames);
  __pyx_v_self->tracerNames = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":149
 *       object config
 *       object tracerNames
 *       object c             # <<<<<<<<<<<<<<
 *       object qf
 *       object qef
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_1c_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_1c_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_1c___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_1c___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->c);
  __pyx_r = __pyx_v_self->c;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_1c_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_1c_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_1c_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_1c_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->c);
  __Pyx_DECREF(__pyx_v_self->c);
  __pyx_v_self->c = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_1c_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_1c_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_1c_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_1c_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->c);
  __Pyx_DECREF(__pyx_v_self->c);
  __pyx_v_self->c = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":150
 *       object tracerNames
 *       object c
 *       object qf             # <<<<<<<<<<<<<<
 *       object qef
 *       object qrel
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_2qf_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_2qf_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_2qf___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_2qf___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->qf);
  __pyx_r = __pyx_v_self->qf;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_2qf_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_2qf_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_2qf_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_2qf_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->qf);
  __Pyx_DECREF(__pyx_v_self->qf);
  __pyx_v_self->qf = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_2qf_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_2qf_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_2qf_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_2qf_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->qf);
  __Pyx_DECREF(__pyx_v_self->qf);
  __pyx_v_self->qf = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":151
 *       object c
 *       object qf
 *       object qef             # <<<<<<<<<<<<<<
 *       object qrel
 *       object cbc
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3qef_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3qef_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3qef___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3qef___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->qef);
  __pyx_r = __pyx_v_self->qef;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3qef_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3qef_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3qef_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3qef_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->qef);
  __Pyx_DECREF(__pyx_v_self->qef);
  __pyx_v_self->qef = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3qef_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3qef_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3qef_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3qef_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->qef);
  __Pyx_DECREF(__pyx_v_self->qef);
  __pyx_v_self->qef = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":152
 *       object qf
 *       object qef
 *       object qrel             # <<<<<<<<<<<<<<
 *       object cbc
 *       object cbf
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_4qrel_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_4qrel_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_4qrel___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_4qrel___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->qrel);
  __pyx_r = __pyx_v_self->qrel;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_4qrel_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_4qrel_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_4qrel_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_4qrel_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->qrel);
  __Pyx_DECREF(__pyx_v_self->qrel);
  __pyx_v_self->qrel = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_4qrel_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_4qrel_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_4qrel_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_4qrel_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->qrel);
  __Pyx_DECREF(__pyx_v_self->qrel);
  __pyx_v_self->qrel = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":153
 *       object qef
 *       object qrel
 *       object cbc             # <<<<<<<<<<<<<<
 *       object cbf
 * 
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbc_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbc_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbc___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbc___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->cbc);
  __pyx_r = __pyx_v_self->cbc;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbc_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbc_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbc_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->cbc);
  __Pyx_DECREF(__pyx_v_self->cbc);
  __pyx_v_self->cbc = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbc_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbc_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbc_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbc_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->cbc);
  __Pyx_DECREF(__pyx_v_self->cbc);
  __pyx_v_self->cbc = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":154
 *       object qrel
 *       object cbc
 *       object cbf             # <<<<<<<<<<<<<<
 * 
 * cdef class StepTimer:
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbf_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbf_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbf___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbf___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->cbf);
  __pyx_r = __pyx_v_self->cbf;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbf_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbf_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbf_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbf_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->cbf);
  __Pyx_DECREF(__pyx_v_self->cbf);
  __pyx_v_self->cbf = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbf_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbf_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbf_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_3cbf_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->cbf);
  __Pyx_DECREF(__pyx_v_self->cbf);
  __pyx_v_self->cbf = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_65__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_65__reduce_cython__ = {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_65__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_65__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__reduce_cython__", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__reduce_cython__", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_64__reduce_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_64__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce_cython__", 0);

  /* "(tree fragment)":2
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 2, __pyx_L1_error)

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_67__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_67__setstate_cython__ = {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_67__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_67__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v___pyx_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_pyx_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__setstate_cython__", 0) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, i); __PYX_ERR(1, 3, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
    }
    __pyx_v___pyx_state = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, __pyx_nargs); __PYX_ERR(1, 3, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8TMMState_66__setstate_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)__pyx_v_self), __pyx_v___pyx_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8TMMState_66__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setstate_cython__", 0);

  /* "(tree fragment)":4
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 4, __pyx_L1_error)

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TMMState.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":859
 *         raise RuntimeError(f"Unknown type of vector {typ} when loading")
 * 
 * def _cleanUp():             # <<<<<<<<<<<<<<
 *     tconfig=getTimeConfig()
 *     tc = tconfig['time0'] + tconfig['deltaTClock']*tconfig['maxSteps']
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_1_cleanUp(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_1_cleanUp = {"_cleanUp", (PyCFunction)__pyx_pw_6tmm4py_11tmm4py_core_1_cleanUp, METH_NOARGS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_1_cleanUp(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_cleanUp (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core__cleanUp(__pyx_self);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core__cleanUp(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_v_tconfig = NULL;
  PyObject *__pyx_v_tc = NULL;
  PyObject *__pyx_v_s = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  size_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  int __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10[6];
  PyObject *__pyx_t_11 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_cleanUp", 0);

  /* "tmm4py/tmm4py_core.pyx":860
 * 
 * def _cleanUp():
 *     tconfig=getTimeConfig()             # <<<<<<<<<<<<<<
 *     tc = tconfig['time0'] + tconfig['deltaTClock']*tconfig['maxSteps']
 *     while len(_statescreated)>0:
*/
  __pyx_t_2 = NULL;
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_getTimeConfig); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 860, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
    assert(__pyx_t_2);
    PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_3);
    __Pyx_INCREF(__pyx_t_2);
    __Pyx_INCREF(__pyx__function);
    __Pyx_DECREF_SET(__pyx_t_3, __pyx__function);
    __pyx_t_4 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 860, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_v_tconfig = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":861
 * def _cleanUp():
 *     tconfig=getTimeConfig()
 *     tc = tconfig['time0'] + tconfig['deltaTClock']*tconfig['maxSteps']             # <<<<<<<<<<<<<<
 *     while len(_statescreated)>0:
 *       s=_statescreated.pop(0)
*/
  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_tconfig, __pyx_mstate_global->__pyx_n_u_time0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 861, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_tconfig, __pyx_mstate_global->__pyx_n_u_deltaTClock); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 861, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_tconfig, __pyx_mstate_global->__pyx_n_u_maxSteps); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 861, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = PyNumber_Multiply(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 861, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 861, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_tc = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":862
 *     tconfig=getTimeConfig()
 *     tc = tconfig['time0'] + tconfig['deltaTClock']*tconfig['maxSteps']
 *     while len(_statescreated)>0:             # <<<<<<<<<<<<<<
 *       s=_statescreated.pop(0)
 *       if debug: print(f"Calling destroy at time {tc}")
*/
  while (1) {
    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_statescreated); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 862, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 862, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_7 = (__pyx_t_6 > 0);
    if (!__pyx_t_7) break;

    /* "tmm4py/tmm4py_core.pyx":863
 *     tc = tconfig['time0'] + tconfig['deltaTClock']*tconfig['maxSteps']
 *     while len(_statescreated)>0:
 *       s=_statescreated.pop(0)             # <<<<<<<<<<<<<<
 *       if debug: print(f"Calling destroy at time {tc}")
 *       s.destroy(tc)
*/
    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_statescreated); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 863, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = __Pyx_PyObject_PopIndex(__pyx_t_2, __pyx_mstate_global->__pyx_int_0, 0, 1, Py_ssize_t, PyLong_FromSsize_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 863, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_XDECREF_SET(__pyx_v_s, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "tmm4py/tmm4py_core.pyx":864
 *     while len(_statescreated)>0:
 *       s=_statescreated.pop(0)
 *       if debug: print(f"Calling destroy at time {tc}")             # <<<<<<<<<<<<<<
 *       s.destroy(tc)
 *     if debug: print(f"Calling finalize at time {time0}, {maxSteps}, {tc}")
*/
    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_debug); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely((__pyx_t_7 < 0))) __PYX_ERR(0, 864, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_7) {
      __pyx_t_2 = NULL;
      __Pyx_INCREF(__pyx_builtin_print);
      __pyx_t_1 = __pyx_builtin_print; 
      __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_v_tc, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_Calling_destroy_at_time, __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 864, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_4 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_8};
        __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
      }
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":865
 *       s=_statescreated.pop(0)
 *       if debug: print(f"Calling destroy at time {tc}")
 *       s.destroy(tc)             # <<<<<<<<<<<<<<
 *     if debug: print(f"Calling finalize at time {time0}, {maxSteps}, {tc}")
 *     finalize(tc)
*/
    __pyx_t_1 = __pyx_v_s;
    __Pyx_INCREF(__pyx_t_1);
    __pyx_t_4 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_tc};
      __pyx_t_5 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_destroy, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 865, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }

  /* "tmm4py/tmm4py_core.pyx":866
 *       if debug: print(f"Calling destroy at time {tc}")
 *       s.destroy(tc)
 *     if debug: print(f"Calling finalize at time {time0}, {maxSteps}, {tc}")             # <<<<<<<<<<<<<<
 *     finalize(tc)
 * 
*/
  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_debug); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 866, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely((__pyx_t_7 < 0))) __PYX_ERR(0, 866, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (__pyx_t_7) {
    __pyx_t_1 = NULL;
    __Pyx_INCREF(__pyx_builtin_print);
    __pyx_t_8 = __pyx_builtin_print; 
    __pyx_t_2 = PyFloat_FromDouble(time0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 866, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_t_2, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 866, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyLong_From_PetscInt(maxSteps); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 866, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_t_2, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 866, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyObject_FormatSimple(__pyx_v_tc, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 866, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_10[0] = __pyx_mstate_global->__pyx_kp_u_Calling_finalize_at_time;
    __pyx_t_10[1] = __pyx_t_3;
    __pyx_t_10[2] = __pyx_mstate_global->__pyx_kp_u__3;
    __pyx_t_10[3] = __pyx_t_9;
    __pyx_t_10[4] = __pyx_mstate_global->__pyx_kp_u__3;
    __pyx_t_10[5] = __pyx_t_2;
    __pyx_t_11 = __Pyx_PyUnicode_Join(__pyx_t_10, 6, 25 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_3) + 2 * 2 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_9) + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_2), 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_3) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2));
    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 866, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_11};
      __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 866, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }

  /* "tmm4py/tmm4py_core.pyx":867
 *       s.destroy(tc)
 *     if debug: print(f"Calling finalize at time {time0}, {maxSteps}, {tc}")
 *     finalize(tc)             # <<<<<<<<<<<<<<
 * 
 * atexit.register(_cleanUp)
*/
  __pyx_t_8 = NULL;
  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_mstate_global->__pyx_n_u_finalize); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 867, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __pyx_t_4 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(PyMethod_Check(__pyx_t_11))) {
    __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_11);
    assert(__pyx_t_8);
    PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_11);
    __Pyx_INCREF(__pyx_t_8);
    __Pyx_INCREF(__pyx__function);
    __Pyx_DECREF_SET(__pyx_t_11, __pyx__function);
    __pyx_t_4 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_tc};
    __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_11, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 867, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":859
 *         raise RuntimeError(f"Unknown type of vector {typ} when loading")
 * 
 * def _cleanUp():             # <<<<<<<<<<<<<<
 *     tconfig=getTimeConfig()
 *     tc = tconfig['time0'] + tconfig['deltaTClock']*tconfig['maxSteps']
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_AddTraceback("tmm4py.tmm4py_core._cleanUp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_tconfig);
  __Pyx_XDECREF(__pyx_v_tc);
  __Pyx_XDECREF(__pyx_v_s);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":871
 * atexit.register(_cleanUp)
 * 
 * def initialize():             # <<<<<<<<<<<<<<
 * 
 *     cdef PetscInt Iter0ret
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_3initialize(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_3initialize = {"initialize", (PyCFunction)__pyx_pw_6tmm4py_11tmm4py_core_3initialize, METH_NOARGS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_3initialize(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("initialize (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_2initialize(__pyx_self);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_2initialize(CYTHON_UNUSED PyObject *__pyx_self) {
  PetscInt __pyx_v_Iter0ret;
  PetscInt __pyx_v_maxStepsret;
  PetscScalar __pyx_v_time0ret;
  PetscScalar __pyx_v_deltaTClockret;
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("initialize", 0);

  /* "tmm4py/tmm4py_core.pyx":880
 * 
 *     # Call the C function
 *     ierr = TMMInitialize(&Iter0ret, &maxStepsret, &time0ret, &deltaTClockret)             # <<<<<<<<<<<<<<
 *     if ierr != 0: raise PETSc.Error(ierr)
 * #     if ierr != 0:
*/
  __pyx_v_ierr = TMMInitialize((&__pyx_v_Iter0ret), (&__pyx_v_maxStepsret), (&__pyx_v_time0ret), (&__pyx_v_deltaTClockret));

  /* "tmm4py/tmm4py_core.pyx":881
 *     # Call the C function
 *     ierr = TMMInitialize(&Iter0ret, &maxStepsret, &time0ret, &deltaTClockret)
 *     if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #     if ierr != 0:
 * #         raise RuntimeError(f"TMMInitialize failed with error code {ierr}")
*/
  __pyx_t_1 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_1)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 881, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 881, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 881, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 881, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 881, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":886
 * 
 *     # Return results as a Python tuple
 *     return toInt(Iter0ret), toInt(maxStepsret), toReal(time0ret), toReal(deltaTClockret)             # <<<<<<<<<<<<<<
 * 
 * def updateTMs(tc):
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_Iter0ret); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 886, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_maxStepsret); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 886, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_time0ret); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 886, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_deltaTClockret); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 886, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_7 = PyTuple_New(4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 886, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_2);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2) != (0)) __PYX_ERR(0, 886, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_5);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_5) != (0)) __PYX_ERR(0, 886, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_4);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_4) != (0)) __PYX_ERR(0, 886, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_3);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 3, __pyx_t_3) != (0)) __PYX_ERR(0, 886, __pyx_L1_error);
  __pyx_t_2 = 0;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":871
 * atexit.register(_cleanUp)
 * 
 * def initialize():             # <<<<<<<<<<<<<<
 * 
 *     cdef PetscInt Iter0ret
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.initialize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":888
 *     return toInt(Iter0ret), toInt(maxStepsret), toReal(time0ret), toReal(deltaTClockret)
 * 
 * def updateTMs(tc):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar tcc = asReal(tc)
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_5updateTMs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_5updateTMs = {"updateTMs", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_5updateTMs, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_5updateTMs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_tc = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("updateTMs (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_tc,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 888, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 888, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "updateTMs", 0) < 0) __PYX_ERR(0, 888, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("updateTMs", 1, 1, 1, i); __PYX_ERR(0, 888, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 888, __pyx_L3_error)
    }
    __pyx_v_tc = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("updateTMs", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 888, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.updateTMs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_4updateTMs(__pyx_self, __pyx_v_tc);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_4updateTMs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tc) {
  PetscErrorCode __pyx_v_ierr;
  PetscScalar __pyx_v_tcc;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscReal __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  size_t __pyx_t_7;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("updateTMs", 0);

  /* "tmm4py/tmm4py_core.pyx":890
 * def updateTMs(tc):
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar tcc = asReal(tc)             # <<<<<<<<<<<<<<
 *     ierr = TMMUpdateTMs(tcc)
 *     if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asReal(__pyx_v_tc); if (unlikely(__pyx_t_1 == ((PetscReal)-1.0) && PyErr_Occurred())) __PYX_ERR(0, 890, __pyx_L1_error)
  __pyx_v_tcc = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":891
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar tcc = asReal(tc)
 *     ierr = TMMUpdateTMs(tcc)             # <<<<<<<<<<<<<<
 *     if ierr != 0: raise PETSc.Error(ierr)
 * #     if ierr != 0:
*/
  __pyx_v_ierr = TMMUpdateTMs(__pyx_v_tcc);

  /* "tmm4py/tmm4py_core.pyx":892
 *     cdef PetscScalar tcc = asReal(tc)
 *     ierr = TMMUpdateTMs(tcc)
 *     if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #     if ierr != 0:
 * #         raise RuntimeError(f"TMMUpdateTMs failed with error code {ierr}")
*/
  __pyx_t_2 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_2)) {
    __pyx_t_4 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 892, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 892, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
      assert(__pyx_t_4);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_6, __pyx__function);
      __pyx_t_7 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_5};
      __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 892, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_ERR(0, 892, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":888
 *     return toInt(Iter0ret), toInt(maxStepsret), toReal(time0ret), toReal(deltaTClockret)
 * 
 * def updateTMs(tc):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar tcc = asReal(tc)
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.updateTMs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":896
 * #         raise RuntimeError(f"TMMUpdateTMs failed with error code {ierr}")
 * 
 * def finalize(tc):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar tcc = asReal(tc)
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_7finalize(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_7finalize = {"finalize", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_7finalize, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_7finalize(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_tc = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("finalize (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_tc,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 896, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 896, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "finalize", 0) < 0) __PYX_ERR(0, 896, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("finalize", 1, 1, 1, i); __PYX_ERR(0, 896, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 896, __pyx_L3_error)
    }
    __pyx_v_tc = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("finalize", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 896, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.finalize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_6finalize(__pyx_self, __pyx_v_tc);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_6finalize(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_tc) {
  PetscErrorCode __pyx_v_ierr;
  PetscScalar __pyx_v_tcc;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscReal __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  size_t __pyx_t_7;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("finalize", 0);

  /* "tmm4py/tmm4py_core.pyx":898
 * def finalize(tc):
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar tcc = asReal(tc)             # <<<<<<<<<<<<<<
 *     ierr = TMMFinalize(tcc)
 *     if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asReal(__pyx_v_tc); if (unlikely(__pyx_t_1 == ((PetscReal)-1.0) && PyErr_Occurred())) __PYX_ERR(0, 898, __pyx_L1_error)
  __pyx_v_tcc = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":899
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar tcc = asReal(tc)
 *     ierr = TMMFinalize(tcc)             # <<<<<<<<<<<<<<
 *     if ierr != 0: raise PETSc.Error(ierr)
 * #     if ierr != 0:
*/
  __pyx_v_ierr = TMMFinalize(__pyx_v_tcc);

  /* "tmm4py/tmm4py_core.pyx":900
 *     cdef PetscScalar tcc = asReal(tc)
 *     ierr = TMMFinalize(tcc)
 *     if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #     if ierr != 0:
 * #         raise RuntimeError(f"TMMFinalize failed with error code {ierr}")
*/
  __pyx_t_2 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_2)) {
    __pyx_t_4 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 900, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 900, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 900, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
      assert(__pyx_t_4);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_6, __pyx__function);
      __pyx_t_7 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_5};
      __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 900, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_ERR(0, 900, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":896
 * #         raise RuntimeError(f"TMMUpdateTMs failed with error code {ierr}")
 * 
 * def finalize(tc):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar tcc = asReal(tc)
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.finalize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":904
 * #         raise RuntimeError(f"TMMFinalize failed with error code {ierr}")
 * 
 * def getProfileConfig():             # <<<<<<<<<<<<<<
 *     config = {key: False for key in profileVars}
 *     if toBool(useProfiles):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9getProfileConfig(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_9getProfileConfig = {"getProfileConfig", (PyCFunction)__pyx_pw_6tmm4py_11tmm4py_core_9getProfileConfig, METH_NOARGS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9getProfileConfig(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("getProfileConfig (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_8getProfileConfig(__pyx_self);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_8getProfileConfig(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_v_config = NULL;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_8genexpr6__pyx_v_key = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *(*__pyx_t_5)(PyObject *);
  int __pyx_t_6;
  Py_ssize_t __pyx_t_7;
  int __pyx_t_8;
  int __pyx_t_9;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("getProfileConfig", 0);

  /* "tmm4py/tmm4py_core.pyx":905
 * 
 * def getProfileConfig():
 *     config = {key: False for key in profileVars}             # <<<<<<<<<<<<<<
 *     if toBool(useProfiles):
 *         config["useProfiles"] = toBool(useProfiles)
*/
  { /* enter inner scope */
    __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 905, __pyx_L5_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_profileVars); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 905, __pyx_L5_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
      __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = 0;
      __pyx_t_5 = NULL;
    } else {
      __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 905, __pyx_L5_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_5 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 905, __pyx_L5_error)
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    for (;;) {
      if (likely(!__pyx_t_5)) {
        if (likely(PyList_CheckExact(__pyx_t_3))) {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_3);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 905, __pyx_L5_error)
            #endif
            if (__pyx_t_4 >= __pyx_temp) break;
          }
          __pyx_t_2 = __Pyx_PyList_GetItemRef(__pyx_t_3, __pyx_t_4);
          ++__pyx_t_4;
        } else {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_3);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 905, __pyx_L5_error)
            #endif
            if (__pyx_t_4 >= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_2 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4));
          #else
          __pyx_t_2 = __Pyx_PySequence_ITEM(__pyx_t_3, __pyx_t_4);
          #endif
          ++__pyx_t_4;
        }
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 905, __pyx_L5_error)
      } else {
        __pyx_t_2 = __pyx_t_5(__pyx_t_3);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 905, __pyx_L5_error)
            PyErr_Clear();
          }
          break;
        }
      }
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_XDECREF_SET(__pyx_8genexpr6__pyx_v_key, __pyx_t_2);
      __pyx_t_2 = 0;
      if (unlikely(PyDict_SetItem(__pyx_t_1, (PyObject*)__pyx_8genexpr6__pyx_v_key, (PyObject*)Py_False))) __PYX_ERR(0, 905, __pyx_L5_error)
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_key); __pyx_8genexpr6__pyx_v_key = 0;
    goto __pyx_L9_exit_scope;
    __pyx_L5_error:;
    __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_key); __pyx_8genexpr6__pyx_v_key = 0;
    goto __pyx_L1_error;
    __pyx_L9_exit_scope:;
  } /* exit inner scope */
  __pyx_v_config = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":906
 * def getProfileConfig():
 *     config = {key: False for key in profileVars}
 *     if toBool(useProfiles):             # <<<<<<<<<<<<<<
 *         config["useProfiles"] = toBool(useProfiles)
 *         for k in config.keys():
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toBool(useProfiles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 906, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 906, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":907
 *     config = {key: False for key in profileVars}
 *     if toBool(useProfiles):
 *         config["useProfiles"] = toBool(useProfiles)             # <<<<<<<<<<<<<<
 *         for k in config.keys():
 *           if k == "lSize":
*/
    __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toBool(useProfiles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 907, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_mstate_global->__pyx_n_u_useProfiles, __pyx_t_1) < 0))) __PYX_ERR(0, 907, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":908
 *     if toBool(useProfiles):
 *         config["useProfiles"] = toBool(useProfiles)
 *         for k in config.keys():             # <<<<<<<<<<<<<<
 *           if k == "lSize":
 *               config[k] = toInt(lSize)
*/
    __pyx_t_4 = 0;
    __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_config, 1, __pyx_mstate_global->__pyx_n_u_keys, (&__pyx_t_7), (&__pyx_t_8)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_1);
    __pyx_t_1 = __pyx_t_3;
    __pyx_t_3 = 0;
    while (1) {
      __pyx_t_9 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_7, &__pyx_t_4, &__pyx_t_3, NULL, NULL, __pyx_t_8);
      if (unlikely(__pyx_t_9 == 0)) break;
      if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 908, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_XDECREF_SET(__pyx_v_k, __pyx_t_3);
      __pyx_t_3 = 0;

      /* "tmm4py/tmm4py_core.pyx":909
 *         config["useProfiles"] = toBool(useProfiles)
 *         for k in config.keys():
 *           if k == "lSize":             # <<<<<<<<<<<<<<
 *               config[k] = toInt(lSize)
 *           if k == "lNumProfiles":
*/
      __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_lSize, Py_EQ)); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 909, __pyx_L1_error)
      if (__pyx_t_6) {

        /* "tmm4py/tmm4py_core.pyx":910
 *         for k in config.keys():
 *           if k == "lSize":
 *               config[k] = toInt(lSize)             # <<<<<<<<<<<<<<
 *           if k == "lNumProfiles":
 *               config[k] = toInt(lNumProfiles)
*/
        __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toInt(lSize); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 910, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

        /* "tmm4py/tmm4py_core.pyx":909
 *         config["useProfiles"] = toBool(useProfiles)
 *         for k in config.keys():
 *           if k == "lSize":             # <<<<<<<<<<<<<<
 *               config[k] = toInt(lSize)
 *           if k == "lNumProfiles":
*/
      }

      /* "tmm4py/tmm4py_core.pyx":911
 *           if k == "lSize":
 *               config[k] = toInt(lSize)
 *           if k == "lNumProfiles":             # <<<<<<<<<<<<<<
 *               config[k] = toInt(lNumProfiles)
 *           if k == "totalNumProfiles":
*/
      __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_lNumProfiles, Py_EQ)); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 911, __pyx_L1_error)
      if (__pyx_t_6) {

        /* "tmm4py/tmm4py_core.pyx":912
 *               config[k] = toInt(lSize)
 *           if k == "lNumProfiles":
 *               config[k] = toInt(lNumProfiles)             # <<<<<<<<<<<<<<
 *           if k == "totalNumProfiles":
 *               config[k] = toInt(totalNumProfiles)
*/
        __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toInt(lNumProfiles); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 912, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 912, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

        /* "tmm4py/tmm4py_core.pyx":911
 *           if k == "lSize":
 *               config[k] = toInt(lSize)
 *           if k == "lNumProfiles":             # <<<<<<<<<<<<<<
 *               config[k] = toInt(lNumProfiles)
 *           if k == "totalNumProfiles":
*/
      }

      /* "tmm4py/tmm4py_core.pyx":913
 *           if k == "lNumProfiles":
 *               config[k] = toInt(lNumProfiles)
 *           if k == "totalNumProfiles":             # <<<<<<<<<<<<<<
 *               config[k] = toInt(totalNumProfiles)
 *           # We copy these as we don't want a user to accidentally change the values!
*/
      __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_totalNumProfiles, Py_EQ)); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 913, __pyx_L1_error)
      if (__pyx_t_6) {

        /* "tmm4py/tmm4py_core.pyx":914
 *               config[k] = toInt(lNumProfiles)
 *           if k == "totalNumProfiles":
 *               config[k] = toInt(totalNumProfiles)             # <<<<<<<<<<<<<<
 *           # We copy these as we don't want a user to accidentally change the values!
 *           if k == "lProfileLength":
*/
        __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toInt(totalNumProfiles); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 914, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 914, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

        /* "tmm4py/tmm4py_core.pyx":913
 *           if k == "lNumProfiles":
 *               config[k] = toInt(lNumProfiles)
 *           if k == "totalNumProfiles":             # <<<<<<<<<<<<<<
 *               config[k] = toInt(totalNumProfiles)
 *           # We copy these as we don't want a user to accidentally change the values!
*/
      }

      /* "tmm4py/tmm4py_core.pyx":916
 *               config[k] = toInt(totalNumProfiles)
 *           # We copy these as we don't want a user to accidentally change the values!
 *           if k == "lProfileLength":             # <<<<<<<<<<<<<<
 *               config[k] = copyNumpyIntArrayFromPointer(lProfileLength, lNumProfiles)
 *           if k == "lStartIndices":
*/
      __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_lProfileLength, Py_EQ)); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 916, __pyx_L1_error)
      if (__pyx_t_6) {

        /* "tmm4py/tmm4py_core.pyx":917
 *           # We copy these as we don't want a user to accidentally change the values!
 *           if k == "lProfileLength":
 *               config[k] = copyNumpyIntArrayFromPointer(lProfileLength, lNumProfiles)             # <<<<<<<<<<<<<<
 *           if k == "lStartIndices":
 *               config[k] = copyNumpyIntArrayFromPointer(lStartIndices, lNumProfiles)
*/
        __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_copyNumpyIntArrayFromPointer(lProfileLength, lNumProfiles); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 917, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 917, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

        /* "tmm4py/tmm4py_core.pyx":916
 *               config[k] = toInt(totalNumProfiles)
 *           # We copy these as we don't want a user to accidentally change the values!
 *           if k == "lProfileLength":             # <<<<<<<<<<<<<<
 *               config[k] = copyNumpyIntArrayFromPointer(lProfileLength, lNumProfiles)
 *           if k == "lStartIndices":
*/
      }

      /* "tmm4py/tmm4py_core.pyx":918
 *           if k == "lProfileLength":
 *               config[k] = copyNumpyIntArrayFromPointer(lProfileLength, lNumProfiles)
 *           if k == "lStartIndices":             # <<<<<<<<<<<<<<
 *               config[k] = copyNumpyIntArrayFromPointer(lStartIndices, lNumProfiles)
 *           if k == "lEndIndices":
*/
      __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_lStartIndices, Py_EQ)); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 918, __pyx_L1_error)
      if (__pyx_t_6) {

        /* "tmm4py/tmm4py_core.pyx":919
 *               config[k] = copyNumpyIntArrayFromPointer(lProfileLength, lNumProfiles)
 *           if k == "lStartIndices":
 *               config[k] = copyNumpyIntArrayFromPointer(lStartIndices, lNumProfiles)             # <<<<<<<<<<<<<<
 *           if k == "lEndIndices":
 *               config[k] = copyNumpyIntArrayFromPointer(lEndIndices, lNumProfiles)
*/
        __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_copyNumpyIntArrayFromPointer(lStartIndices, lNumProfiles); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 919, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

        /* "tmm4py/tmm4py_core.pyx":918
 *           if k == "lProfileLength":
 *               config[k] = copyNumpyIntArrayFromPointer(lProfileLength, lNumProfiles)
 *           if k == "lStartIndices":             # <<<<<<<<<<<<<<
 *               config[k] = copyNumpyIntArrayFromPointer(lStartIndices, lNumProfiles)
 *           if k == "lEndIndices":
*/
      }

      /* "tmm4py/tmm4py_core.pyx":920
 *           if k == "lStartIndices":
 *               config[k] = copyNumpyIntArrayFromPointer(lStartIndices, lNumProfiles)
 *           if k == "lEndIndices":             # <<<<<<<<<<<<<<
 *               config[k] = copyNumpyIntArrayFromPointer(lEndIndices, lNumProfiles)
 *     else:
*/
      __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_lEndIndices, Py_EQ)); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 920, __pyx_L1_error)
      if (__pyx_t_6) {

        /* "tmm4py/tmm4py_core.pyx":921
 *               config[k] = copyNumpyIntArrayFromPointer(lStartIndices, lNumProfiles)
 *           if k == "lEndIndices":
 *               config[k] = copyNumpyIntArrayFromPointer(lEndIndices, lNumProfiles)             # <<<<<<<<<<<<<<
 *     else:
 *         config = None
*/
        __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_copyNumpyIntArrayFromPointer(lEndIndices, lNumProfiles); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 921, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 921, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

        /* "tmm4py/tmm4py_core.pyx":920
 *           if k == "lStartIndices":
 *               config[k] = copyNumpyIntArrayFromPointer(lStartIndices, lNumProfiles)
 *           if k == "lEndIndices":             # <<<<<<<<<<<<<<
 *               config[k] = copyNumpyIntArrayFromPointer(lEndIndices, lNumProfiles)
 *     else:
*/
      }
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":906
 * def getProfileConfig():
 *     config = {key: False for key in profileVars}
 *     if toBool(useProfiles):             # <<<<<<<<<<<<<<
 *         config["useProfiles"] = toBool(useProfiles)
 *         for k in config.keys():
*/
    goto __pyx_L10;
  }

  /* "tmm4py/tmm4py_core.pyx":923
 *               config[k] = copyNumpyIntArrayFromPointer(lEndIndices, lNumProfiles)
 *     else:
 *         config = None             # <<<<<<<<<<<<<<
 *     return config
 * 
*/
  /*else*/ {
    __Pyx_INCREF(Py_None);
    __Pyx_DECREF_SET(__pyx_v_config, ((PyObject*)Py_None));
  }
  __pyx_L10:;

  /* "tmm4py/tmm4py_core.pyx":924
 *     else:
 *         config = None
 *     return config             # <<<<<<<<<<<<<<
 * 
 * def getTimeConfig():
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_config);
  __pyx_r = __pyx_v_config;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":904
 * #         raise RuntimeError(f"TMMFinalize failed with error code {ierr}")
 * 
 * def getProfileConfig():             # <<<<<<<<<<<<<<
 *     config = {key: False for key in profileVars}
 *     if toBool(useProfiles):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.getProfileConfig", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_config);
  __Pyx_XDECREF(__pyx_v_k);
  __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_key);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":926
 *     return config
 * 
 * def getTimeConfig():             # <<<<<<<<<<<<<<
 *     config = {'Iter0': toInt(Iter0), 'time0': toReal(time0), 'maxSteps': toInt(maxSteps), 'deltaTClock': toReal(deltaTClock)}
 *     return config
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11getTimeConfig(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_11getTimeConfig = {"getTimeConfig", (PyCFunction)__pyx_pw_6tmm4py_11tmm4py_core_11getTimeConfig, METH_NOARGS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11getTimeConfig(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("getTimeConfig (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_10getTimeConfig(__pyx_self);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_10getTimeConfig(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_v_config = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("getTimeConfig", 0);

  /* "tmm4py/tmm4py_core.pyx":927
 * 
 * def getTimeConfig():
 *     config = {'Iter0': toInt(Iter0), 'time0': toReal(time0), 'maxSteps': toInt(maxSteps), 'deltaTClock': toReal(deltaTClock)}             # <<<<<<<<<<<<<<
 *     return config
 * 
*/
  __pyx_t_1 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 927, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_toInt(Iter0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 927, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_1, __pyx_mstate_global->__pyx_n_u_Iter0, __pyx_t_2) < 0) __PYX_ERR(0, 927, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_toReal(time0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 927, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_1, __pyx_mstate_global->__pyx_n_u_time0, __pyx_t_2) < 0) __PYX_ERR(0, 927, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_toInt(maxSteps); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 927, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_1, __pyx_mstate_global->__pyx_n_u_maxSteps, __pyx_t_2) < 0) __PYX_ERR(0, 927, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_toReal(deltaTClock); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 927, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_1, __pyx_mstate_global->__pyx_n_u_deltaTClock, __pyx_t_2) < 0) __PYX_ERR(0, 927, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_config = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":928
 * def getTimeConfig():
 *     config = {'Iter0': toInt(Iter0), 'time0': toReal(time0), 'maxSteps': toInt(maxSteps), 'deltaTClock': toReal(deltaTClock)}
 *     return config             # <<<<<<<<<<<<<<
 * 
 * def getSizes():
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_config);
  __pyx_r = __pyx_v_config;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":926
 *     return config
 * 
 * def getTimeConfig():             # <<<<<<<<<<<<<<
 *     config = {'Iter0': toInt(Iter0), 'time0': toReal(time0), 'maxSteps': toInt(maxSteps), 'deltaTClock': toReal(deltaTClock)}
 *     return config
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.getTimeConfig", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_config);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":930
 *     return config
 * 
 * def getSizes():             # <<<<<<<<<<<<<<
 *     return toInt(nb), toInt(lSize)
 * 
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13getSizes(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_13getSizes = {"getSizes", (PyCFunction)__pyx_pw_6tmm4py_11tmm4py_core_13getSizes, METH_NOARGS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13getSizes(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("getSizes (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_12getSizes(__pyx_self);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_12getSizes(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("getSizes", 0);

  /* "tmm4py/tmm4py_core.pyx":931
 * 
 * def getSizes():
 *     return toInt(nb), toInt(lSize)             # <<<<<<<<<<<<<<
 * 
 * def getBCSizes():
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toInt(nb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 931, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core_toInt(lSize); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 931, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 931, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 931, __pyx_L1_error);
  __Pyx_GIVEREF(__pyx_t_2);
  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2) != (0)) __PYX_ERR(0, 931, __pyx_L1_error);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":930
 *     return config
 * 
 * def getSizes():             # <<<<<<<<<<<<<<
 *     return toInt(nb), toInt(lSize)
 * 
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.getSizes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":933
 *     return toInt(nb), toInt(lSize)
 * 
 * def getBCSizes():             # <<<<<<<<<<<<<<
 *     if toBool(prescribedBCInUse):
 *       return toInt(gBCSize), toInt(lBCSize)
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_15getBCSizes(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_15getBCSizes = {"getBCSizes", (PyCFunction)__pyx_pw_6tmm4py_11tmm4py_core_15getBCSizes, METH_NOARGS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_15getBCSizes(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("getBCSizes (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_14getBCSizes(__pyx_self);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_14getBCSizes(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  size_t __pyx_t_5;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("getBCSizes", 0);

  /* "tmm4py/tmm4py_core.pyx":934
 * 
 * def getBCSizes():
 *     if toBool(prescribedBCInUse):             # <<<<<<<<<<<<<<
 *       return toInt(gBCSize), toInt(lBCSize)
 *     else:
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toBool(prescribedBCInUse); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 934, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 934, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(__pyx_t_2)) {

    /* "tmm4py/tmm4py_core.pyx":935
 * def getBCSizes():
 *     if toBool(prescribedBCInUse):
 *       return toInt(gBCSize), toInt(lBCSize)             # <<<<<<<<<<<<<<
 *     else:
 *       raise RuntimeError("getBCSizes failed because no prescribed BCs are in use!")
*/
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_toInt(gBCSize); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toInt(lBCSize); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 935, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 935, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_1);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1) != (0)) __PYX_ERR(0, 935, __pyx_L1_error);
    __Pyx_GIVEREF(__pyx_t_3);
    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3) != (0)) __PYX_ERR(0, 935, __pyx_L1_error);
    __pyx_t_1 = 0;
    __pyx_t_3 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    /* "tmm4py/tmm4py_core.pyx":934
 * 
 * def getBCSizes():
 *     if toBool(prescribedBCInUse):             # <<<<<<<<<<<<<<
 *       return toInt(gBCSize), toInt(lBCSize)
 *     else:
*/
  }

  /* "tmm4py/tmm4py_core.pyx":937
 *       return toInt(gBCSize), toInt(lBCSize)
 *     else:
 *       raise RuntimeError("getBCSizes failed because no prescribed BCs are in use!")             # <<<<<<<<<<<<<<
 * 
 * cdef _getStateConfig(PetscTMMState state):
*/
  /*else*/ {
    __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_1 = __pyx_builtin_RuntimeError; 
    __pyx_t_5 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global->__pyx_kp_u_getBCSizes_failed_because_no_pre};
      __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 937, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_ERR(0, 937, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":933
 *     return toInt(nb), toInt(lSize)
 * 
 * def getBCSizes():             # <<<<<<<<<<<<<<
 *     if toBool(prescribedBCInUse):
 *       return toInt(gBCSize), toInt(lBCSize)
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.getBCSizes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":939
 *       raise RuntimeError("getBCSizes failed because no prescribed BCs are in use!")
 * 
 * cdef _getStateConfig(PetscTMMState state):             # <<<<<<<<<<<<<<
 *     if True: #toBool(state.isInitialized):
 *       config = {key: False for key in configVars}
*/

static PyObject *__pyx_f_6tmm4py_11tmm4py_core__getStateConfig(TMMState __pyx_v_state) {
  PyObject *__pyx_v_config = NULL;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_8genexpr7__pyx_v_key = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *(*__pyx_t_5)(PyObject *);
  Py_ssize_t __pyx_t_6;
  int __pyx_t_7;
  int __pyx_t_8;
  int __pyx_t_9;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_getStateConfig", 0);

  /* "tmm4py/tmm4py_core.pyx":941
 * cdef _getStateConfig(PetscTMMState state):
 *     if True: #toBool(state.isInitialized):
 *       config = {key: False for key in configVars}             # <<<<<<<<<<<<<<
 *       for k in config.keys():
 *         if k == "useExternalForcing": config[k] = toBool(state.useExternalForcing)
*/
  { /* enter inner scope */
    __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 941, __pyx_L5_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_configVars); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 941, __pyx_L5_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
      __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3);
      __pyx_t_4 = 0;
      __pyx_t_5 = NULL;
    } else {
      __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 941, __pyx_L5_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_5 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : __Pyx_PyObject_GetIterNextFunc(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 941, __pyx_L5_error)
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    for (;;) {
      if (likely(!__pyx_t_5)) {
        if (likely(PyList_CheckExact(__pyx_t_3))) {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_3);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 941, __pyx_L5_error)
            #endif
            if (__pyx_t_4 >= __pyx_temp) break;
          }
          __pyx_t_2 = __Pyx_PyList_GetItemRef(__pyx_t_3, __pyx_t_4);
          ++__pyx_t_4;
        } else {
          {
            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_3);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 941, __pyx_L5_error)
            #endif
            if (__pyx_t_4 >= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_2 = __Pyx_NewRef(PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4));
          #else
          __pyx_t_2 = __Pyx_PySequence_ITEM(__pyx_t_3, __pyx_t_4);
          #endif
          ++__pyx_t_4;
        }
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 941, __pyx_L5_error)
      } else {
        __pyx_t_2 = __pyx_t_5(__pyx_t_3);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) __PYX_ERR(0, 941, __pyx_L5_error)
            PyErr_Clear();
          }
          break;
        }
      }
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_XDECREF_SET(__pyx_8genexpr7__pyx_v_key, __pyx_t_2);
      __pyx_t_2 = 0;
      if (unlikely(PyDict_SetItem(__pyx_t_1, (PyObject*)__pyx_8genexpr7__pyx_v_key, (PyObject*)Py_False))) __PYX_ERR(0, 941, __pyx_L5_error)
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_XDECREF(__pyx_8genexpr7__pyx_v_key); __pyx_8genexpr7__pyx_v_key = 0;
    goto __pyx_L9_exit_scope;
    __pyx_L5_error:;
    __Pyx_XDECREF(__pyx_8genexpr7__pyx_v_key); __pyx_8genexpr7__pyx_v_key = 0;
    goto __pyx_L1_error;
    __pyx_L9_exit_scope:;
  } /* exit inner scope */
  __pyx_v_config = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":942
 *     if True: #toBool(state.isInitialized):
 *       config = {key: False for key in configVars}
 *       for k in config.keys():             # <<<<<<<<<<<<<<
 *         if k == "useExternalForcing": config[k] = toBool(state.useExternalForcing)
 *         if k == "useForcingFromFile": config[k] = toBool(state.useForcingFromFile)
*/
  __pyx_t_4 = 0;
  __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_config, 1, __pyx_mstate_global->__pyx_n_u_keys, (&__pyx_t_6), (&__pyx_t_7)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 942, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_1);
  __pyx_t_1 = __pyx_t_3;
  __pyx_t_3 = 0;
  while (1) {
    __pyx_t_8 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_6, &__pyx_t_4, &__pyx_t_3, NULL, NULL, __pyx_t_7);
    if (unlikely(__pyx_t_8 == 0)) break;
    if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_XDECREF_SET(__pyx_v_k, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "tmm4py/tmm4py_core.pyx":943
 *       config = {key: False for key in configVars}
 *       for k in config.keys():
 *         if k == "useExternalForcing": config[k] = toBool(state.useExternalForcing)             # <<<<<<<<<<<<<<
 *         if k == "useForcingFromFile": config[k] = toBool(state.useForcingFromFile)
 *         if k == "usePrescribedBC": config[k] = toBool(state.usePrescribedBC)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_useExternalForcing, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 943, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->useExternalForcing); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 943, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 943, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":944
 *       for k in config.keys():
 *         if k == "useExternalForcing": config[k] = toBool(state.useExternalForcing)
 *         if k == "useForcingFromFile": config[k] = toBool(state.useForcingFromFile)             # <<<<<<<<<<<<<<
 *         if k == "usePrescribedBC": config[k] = toBool(state.usePrescribedBC)
 *         if k == "applyExternalForcing": config[k] = toBool(state.applyExternalForcing)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_useForcingFromFile, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 944, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->useForcingFromFile); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 944, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":945
 *         if k == "useExternalForcing": config[k] = toBool(state.useExternalForcing)
 *         if k == "useForcingFromFile": config[k] = toBool(state.useForcingFromFile)
 *         if k == "usePrescribedBC": config[k] = toBool(state.usePrescribedBC)             # <<<<<<<<<<<<<<
 *         if k == "applyExternalForcing": config[k] = toBool(state.applyExternalForcing)
 *         if k == "applyForcingFromFile": config[k] = toBool(state.applyForcingFromFile)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_usePrescribedBC, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 945, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->usePrescribedBC); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 945, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 945, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":946
 *         if k == "useForcingFromFile": config[k] = toBool(state.useForcingFromFile)
 *         if k == "usePrescribedBC": config[k] = toBool(state.usePrescribedBC)
 *         if k == "applyExternalForcing": config[k] = toBool(state.applyExternalForcing)             # <<<<<<<<<<<<<<
 *         if k == "applyForcingFromFile": config[k] = toBool(state.applyForcingFromFile)
 *         if k == "applyBC": config[k] = toBool(state.applyBC)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_applyExternalForcing, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 946, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->applyExternalForcing); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 946, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 946, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":947
 *         if k == "usePrescribedBC": config[k] = toBool(state.usePrescribedBC)
 *         if k == "applyExternalForcing": config[k] = toBool(state.applyExternalForcing)
 *         if k == "applyForcingFromFile": config[k] = toBool(state.applyForcingFromFile)             # <<<<<<<<<<<<<<
 *         if k == "applyBC": config[k] = toBool(state.applyBC)
 *         if k == "periodicForcing": config[k] = toBool(state.periodicForcing)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_applyForcingFromFile, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 947, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->applyForcingFromFile); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 947, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 947, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":948
 *         if k == "applyExternalForcing": config[k] = toBool(state.applyExternalForcing)
 *         if k == "applyForcingFromFile": config[k] = toBool(state.applyForcingFromFile)
 *         if k == "applyBC": config[k] = toBool(state.applyBC)             # <<<<<<<<<<<<<<
 *         if k == "periodicForcing": config[k] = toBool(state.periodicForcing)
 *         if k == "timeDependentForcing": config[k] = toBool(state.timeDependentForcing)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_applyBC, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 948, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->applyBC); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 948, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 948, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":949
 *         if k == "applyForcingFromFile": config[k] = toBool(state.applyForcingFromFile)
 *         if k == "applyBC": config[k] = toBool(state.applyBC)
 *         if k == "periodicForcing": config[k] = toBool(state.periodicForcing)             # <<<<<<<<<<<<<<
 *         if k == "timeDependentForcing": config[k] = toBool(state.timeDependentForcing)
 *         if k == "constantForcing": config[k] = toBool(state.constantForcing)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_periodicForcing, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 949, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->periodicForcing); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 949, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 949, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":950
 *         if k == "applyBC": config[k] = toBool(state.applyBC)
 *         if k == "periodicForcing": config[k] = toBool(state.periodicForcing)
 *         if k == "timeDependentForcing": config[k] = toBool(state.timeDependentForcing)             # <<<<<<<<<<<<<<
 *         if k == "constantForcing": config[k] = toBool(state.constantForcing)
 *         if k == "periodicBC": config[k] = toBool(state.periodicBC)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_timeDependentForcing, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 950, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->timeDependentForcing); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 950, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 950, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":951
 *         if k == "periodicForcing": config[k] = toBool(state.periodicForcing)
 *         if k == "timeDependentForcing": config[k] = toBool(state.timeDependentForcing)
 *         if k == "constantForcing": config[k] = toBool(state.constantForcing)             # <<<<<<<<<<<<<<
 *         if k == "periodicBC": config[k] = toBool(state.periodicBC)
 *         if k == "timeDependentBC": config[k] = toBool(state.timeDependentBC)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_constantForcing, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 951, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->constantForcing); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 951, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 951, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":952
 *         if k == "timeDependentForcing": config[k] = toBool(state.timeDependentForcing)
 *         if k == "constantForcing": config[k] = toBool(state.constantForcing)
 *         if k == "periodicBC": config[k] = toBool(state.periodicBC)             # <<<<<<<<<<<<<<
 *         if k == "timeDependentBC": config[k] = toBool(state.timeDependentBC)
 *         if k == "constantBC": config[k] = toBool(state.constantBC)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_periodicBC, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 952, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->periodicBC); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 952, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 952, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":953
 *         if k == "constantForcing": config[k] = toBool(state.constantForcing)
 *         if k == "periodicBC": config[k] = toBool(state.periodicBC)
 *         if k == "timeDependentBC": config[k] = toBool(state.timeDependentBC)             # <<<<<<<<<<<<<<
 *         if k == "constantBC": config[k] = toBool(state.constantBC)
 *         if k == "doCalcBC": config[k] = toBool(state.doCalcBC)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_timeDependentBC, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 953, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->timeDependentBC); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 953, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 953, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":954
 *         if k == "periodicBC": config[k] = toBool(state.periodicBC)
 *         if k == "timeDependentBC": config[k] = toBool(state.timeDependentBC)
 *         if k == "constantBC": config[k] = toBool(state.constantBC)             # <<<<<<<<<<<<<<
 *         if k == "doCalcBC": config[k] = toBool(state.doCalcBC)
 *         if k == "useMonitor": config[k] = toBool(state.useMonitor)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_constantBC, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 954, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->constantBC); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 954, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 954, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":955
 *         if k == "timeDependentBC": config[k] = toBool(state.timeDependentBC)
 *         if k == "constantBC": config[k] = toBool(state.constantBC)
 *         if k == "doCalcBC": config[k] = toBool(state.doCalcBC)             # <<<<<<<<<<<<<<
 *         if k == "useMonitor": config[k] = toBool(state.useMonitor)
 *         if k == "doMisfit": config[k] = toBool(state.doMisfit)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_doCalcBC, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 955, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->doCalcBC); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 955, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":956
 *         if k == "constantBC": config[k] = toBool(state.constantBC)
 *         if k == "doCalcBC": config[k] = toBool(state.doCalcBC)
 *         if k == "useMonitor": config[k] = toBool(state.useMonitor)             # <<<<<<<<<<<<<<
 *         if k == "doMisfit": config[k] = toBool(state.doMisfit)
 *         if k == "relaxTracer": config[k] = toBool(state.relaxTracer)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_useMonitor, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 956, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->useMonitor); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 956, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 956, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":957
 *         if k == "doCalcBC": config[k] = toBool(state.doCalcBC)
 *         if k == "useMonitor": config[k] = toBool(state.useMonitor)
 *         if k == "doMisfit": config[k] = toBool(state.doMisfit)             # <<<<<<<<<<<<<<
 *         if k == "relaxTracer": config[k] = toBool(state.relaxTracer)
 *         if k == "isInitializedExternalForcing": config[k] = toBool(state.isInitializedExternalForcing)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_doMisfit, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 957, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->doMisfit); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 957, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 957, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":958
 *         if k == "useMonitor": config[k] = toBool(state.useMonitor)
 *         if k == "doMisfit": config[k] = toBool(state.doMisfit)
 *         if k == "relaxTracer": config[k] = toBool(state.relaxTracer)             # <<<<<<<<<<<<<<
 *         if k == "isInitializedExternalForcing": config[k] = toBool(state.isInitializedExternalForcing)
 *         if k == "isInitializedCalcBC": config[k] = toBool(state.isInitializedCalcBC)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_relaxTracer, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 958, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->relaxTracer); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 958, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 958, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":959
 *         if k == "doMisfit": config[k] = toBool(state.doMisfit)
 *         if k == "relaxTracer": config[k] = toBool(state.relaxTracer)
 *         if k == "isInitializedExternalForcing": config[k] = toBool(state.isInitializedExternalForcing)             # <<<<<<<<<<<<<<
 *         if k == "isInitializedCalcBC": config[k] = toBool(state.isInitializedCalcBC)
 *         if k == "doOutput": config[k] = toBool(state.doOutput)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_isInitializedExternalForcing, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 959, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->isInitializedExternalForcing); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 959, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 959, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":960
 *         if k == "relaxTracer": config[k] = toBool(state.relaxTracer)
 *         if k == "isInitializedExternalForcing": config[k] = toBool(state.isInitializedExternalForcing)
 *         if k == "isInitializedCalcBC": config[k] = toBool(state.isInitializedCalcBC)             # <<<<<<<<<<<<<<
 *         if k == "doOutput": config[k] = toBool(state.doOutput)
 *         if k == "appendOutput": config[k] = toBool(state.appendOutput)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_isInitializedCalcBC, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 960, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->isInitializedCalcBC); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 960, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 960, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":961
 *         if k == "isInitializedExternalForcing": config[k] = toBool(state.isInitializedExternalForcing)
 *         if k == "isInitializedCalcBC": config[k] = toBool(state.isInitializedCalcBC)
 *         if k == "doOutput": config[k] = toBool(state.doOutput)             # <<<<<<<<<<<<<<
 *         if k == "appendOutput": config[k] = toBool(state.appendOutput)
 *         if k == "writePickup": config[k] = toBool(state.writePickup)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_doOutput, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 961, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->doOutput); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 961, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 961, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":962
 *         if k == "isInitializedCalcBC": config[k] = toBool(state.isInitializedCalcBC)
 *         if k == "doOutput": config[k] = toBool(state.doOutput)
 *         if k == "appendOutput": config[k] = toBool(state.appendOutput)             # <<<<<<<<<<<<<<
 *         if k == "writePickup": config[k] = toBool(state.writePickup)
 *         if k == "doWriteBC": config[k] = toBool(state.doWriteBC)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_appendOutput, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 962, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->appendOutput); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 962, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 962, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":963
 *         if k == "doOutput": config[k] = toBool(state.doOutput)
 *         if k == "appendOutput": config[k] = toBool(state.appendOutput)
 *         if k == "writePickup": config[k] = toBool(state.writePickup)             # <<<<<<<<<<<<<<
 *         if k == "doWriteBC": config[k] = toBool(state.doWriteBC)
 *         if k == "doWriteQF": config[k] = toBool(state.doWriteQF)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_writePickup, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 963, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->writePickup); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 963, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 963, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":964
 *         if k == "appendOutput": config[k] = toBool(state.appendOutput)
 *         if k == "writePickup": config[k] = toBool(state.writePickup)
 *         if k == "doWriteBC": config[k] = toBool(state.doWriteBC)             # <<<<<<<<<<<<<<
 *         if k == "doWriteQF": config[k] = toBool(state.doWriteQF)
 *         if k == "doWriteQEF": config[k] = toBool(state.doWriteQEF)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_doWriteBC, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 964, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->doWriteBC); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 964, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 964, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":965
 *         if k == "writePickup": config[k] = toBool(state.writePickup)
 *         if k == "doWriteBC": config[k] = toBool(state.doWriteBC)
 *         if k == "doWriteQF": config[k] = toBool(state.doWriteQF)             # <<<<<<<<<<<<<<
 *         if k == "doWriteQEF": config[k] = toBool(state.doWriteQEF)
 *         if k == "pickupFromFile": config[k] = toBool(state.pickupFromFile)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_doWriteQF, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 965, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->doWriteQF); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 965, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 965, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":966
 *         if k == "doWriteBC": config[k] = toBool(state.doWriteBC)
 *         if k == "doWriteQF": config[k] = toBool(state.doWriteQF)
 *         if k == "doWriteQEF": config[k] = toBool(state.doWriteQEF)             # <<<<<<<<<<<<<<
 *         if k == "pickupFromFile": config[k] = toBool(state.pickupFromFile)
 *         if k == "doTimeAverage": config[k] = toBool(state.doTimeAverage)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_doWriteQEF, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 966, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->doWriteQEF); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 966, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":967
 *         if k == "doWriteQF": config[k] = toBool(state.doWriteQF)
 *         if k == "doWriteQEF": config[k] = toBool(state.doWriteQEF)
 *         if k == "pickupFromFile": config[k] = toBool(state.pickupFromFile)             # <<<<<<<<<<<<<<
 *         if k == "doTimeAverage": config[k] = toBool(state.doTimeAverage)
 *         if k == "avgAppendOutput": config[k] = toBool(state.avgAppendOutput)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_pickupFromFile, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 967, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->pickupFromFile); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 967, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 967, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":968
 *         if k == "doWriteQEF": config[k] = toBool(state.doWriteQEF)
 *         if k == "pickupFromFile": config[k] = toBool(state.pickupFromFile)
 *         if k == "doTimeAverage": config[k] = toBool(state.doTimeAverage)             # <<<<<<<<<<<<<<
 *         if k == "avgAppendOutput": config[k] = toBool(state.avgAppendOutput)
 *         if k == "doExtraWrite": config[k] = toBool(state.doExtraWrite)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_doTimeAverage, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 968, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->doTimeAverage); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 968, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 968, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":969
 *         if k == "pickupFromFile": config[k] = toBool(state.pickupFromFile)
 *         if k == "doTimeAverage": config[k] = toBool(state.doTimeAverage)
 *         if k == "avgAppendOutput": config[k] = toBool(state.avgAppendOutput)             # <<<<<<<<<<<<<<
 *         if k == "doExtraWrite": config[k] = toBool(state.doExtraWrite)
 *         if k == "numTracers": config[k] = toInt(state.numTracers)
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_avgAppendOutput, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 969, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->avgAppendOutput); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 969, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 969, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":970
 *         if k == "doTimeAverage": config[k] = toBool(state.doTimeAverage)
 *         if k == "avgAppendOutput": config[k] = toBool(state.avgAppendOutput)
 *         if k == "doExtraWrite": config[k] = toBool(state.doExtraWrite)             # <<<<<<<<<<<<<<
 *         if k == "numTracers": config[k] = toInt(state.numTracers)
 *       return config
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_doExtraWrite, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 970, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toBool(__pyx_v_state->doExtraWrite); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 970, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 970, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":971
 *         if k == "avgAppendOutput": config[k] = toBool(state.avgAppendOutput)
 *         if k == "doExtraWrite": config[k] = toBool(state.doExtraWrite)
 *         if k == "numTracers": config[k] = toInt(state.numTracers)             # <<<<<<<<<<<<<<
 *       return config
 *     else:
*/
    __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_k, __pyx_mstate_global->__pyx_n_u_numTracers, Py_EQ)); if (unlikely((__pyx_t_9 < 0))) __PYX_ERR(0, 971, __pyx_L1_error)
    if (__pyx_t_9) {
      __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toInt(__pyx_v_state->numTracers); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 971, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely((PyDict_SetItem(__pyx_v_config, __pyx_v_k, __pyx_t_3) < 0))) __PYX_ERR(0, 971, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":972
 *         if k == "doExtraWrite": config[k] = toBool(state.doExtraWrite)
 *         if k == "numTracers": config[k] = toInt(state.numTracers)
 *       return config             # <<<<<<<<<<<<<<
 *     else:
 *       raise RuntimeError("getConfig failed because state is uninitialized!")
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_config);
  __pyx_r = __pyx_v_config;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":939
 *       raise RuntimeError("getBCSizes failed because no prescribed BCs are in use!")
 * 
 * cdef _getStateConfig(PetscTMMState state):             # <<<<<<<<<<<<<<
 *     if True: #toBool(state.isInitialized):
 *       config = {key: False for key in configVars}
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("tmm4py.tmm4py_core._getStateConfig", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_config);
  __Pyx_XDECREF(__pyx_v_k);
  __Pyx_XDECREF(__pyx_8genexpr7__pyx_v_key);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":978
 * cdef class StepTimer():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.timer = NULL
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__cinit__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer___cinit__(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self) {
  int __pyx_r;

  /* "tmm4py/tmm4py_core.pyx":979
 * 
 *     def __cinit__(self):
 *         self.timer = NULL             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self):
*/
  __pyx_v_self->timer = NULL;

  /* "tmm4py/tmm4py_core.pyx":978
 * cdef class StepTimer():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.timer = NULL
 * 
*/

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":981
 *         self.timer = NULL
 * 
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         pass
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__init__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__init__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_2__init__(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self) {
  int __pyx_r;

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":984
 *         pass
 * 
 *     def create(self, prefix="", prefix2prefix=None, PetscInt startTimeStep=0):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_pre
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_9StepTimer_5create = {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_prefix = 0;
  PyObject *__pyx_v_prefix2prefix = 0;
  PetscInt __pyx_v_startTimeStep;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("create (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_prefix,&__pyx_mstate_global->__pyx_n_u_prefix2prefix,&__pyx_mstate_global->__pyx_n_u_startTimeStep,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 984, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 984, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 984, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 984, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "create", 0) < 0) __PYX_ERR(0, 984, __pyx_L3_error)
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_kp_u_));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
    } else {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 984, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 984, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 984, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_kp_u_));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
    }
    __pyx_v_prefix = values[0];
    __pyx_v_prefix2prefix = values[1];
    if (values[2]) {
      __pyx_v_startTimeStep = __Pyx_PyLong_As_PetscInt(values[2]); if (unlikely((__pyx_v_startTimeStep == ((PetscInt)-1)) && PyErr_Occurred())) __PYX_ERR(0, 984, __pyx_L3_error)
    } else {
      __pyx_v_startTimeStep = ((PetscInt)0);
    }
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("create", 0, 0, 3, __pyx_nargs); __PYX_ERR(0, 984, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.StepTimer.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_4create(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self), __pyx_v_prefix, __pyx_v_prefix2prefix, __pyx_v_startTimeStep);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self, PyObject *__pyx_v_prefix, PyObject *__pyx_v_prefix2prefix, PetscInt __pyx_v_startTimeStep) {
  PetscErrorCode __pyx_v_ierr;
  char const *__pyx_v_c_pre;
  char const *__pyx_v_c_pre2pre;
  StepTimer __pyx_v_newtimer;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  size_t __pyx_t_3;
  char *__pyx_t_4;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("create", 0);

  /* "tmm4py/tmm4py_core.pyx":989
 *         cdef const char* c_pre2pre
 *         cdef PetscStepTimer newtimer
 *         c_pre = PyBytes_AsString(prefix.encode())             # <<<<<<<<<<<<<<
 *         if prefix2prefix is None:
 *           c_pre2pre = NULL
*/
  __pyx_t_2 = __pyx_v_prefix;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 989, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_t_4 = PyBytes_AsString(__pyx_t_1); if (unlikely(__pyx_t_4 == ((char *)0))) __PYX_ERR(0, 989, __pyx_L1_error)
  __pyx_v_c_pre = __pyx_t_4;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":990
 *         cdef PetscStepTimer newtimer
 *         c_pre = PyBytes_AsString(prefix.encode())
 *         if prefix2prefix is None:             # <<<<<<<<<<<<<<
 *           c_pre2pre = NULL
 *         else:
*/
  __pyx_t_5 = (__pyx_v_prefix2prefix == Py_None);
  if (__pyx_t_5) {

    /* "tmm4py/tmm4py_core.pyx":991
 *         c_pre = PyBytes_AsString(prefix.encode())
 *         if prefix2prefix is None:
 *           c_pre2pre = NULL             # <<<<<<<<<<<<<<
 *         else:
 *           c_pre2pre = PyBytes_AsString(prefix2prefix.encode())
*/
    __pyx_v_c_pre2pre = NULL;

    /* "tmm4py/tmm4py_core.pyx":990
 *         cdef PetscStepTimer newtimer
 *         c_pre = PyBytes_AsString(prefix.encode())
 *         if prefix2prefix is None:             # <<<<<<<<<<<<<<
 *           c_pre2pre = NULL
 *         else:
*/
    goto __pyx_L3;
  }

  /* "tmm4py/tmm4py_core.pyx":993
 *           c_pre2pre = NULL
 *         else:
 *           c_pre2pre = PyBytes_AsString(prefix2prefix.encode())             # <<<<<<<<<<<<<<
 *         ierr = StepTimerCreate(&newtimer)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  /*else*/ {
    __pyx_t_2 = __pyx_v_prefix2prefix;
    __Pyx_INCREF(__pyx_t_2);
    __pyx_t_3 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
      __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 993, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __pyx_t_4 = PyBytes_AsString(__pyx_t_1); if (unlikely(__pyx_t_4 == ((char *)0))) __PYX_ERR(0, 993, __pyx_L1_error)
    __pyx_v_c_pre2pre = __pyx_t_4;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_L3:;

  /* "tmm4py/tmm4py_core.pyx":994
 *         else:
 *           c_pre2pre = PyBytes_AsString(prefix2prefix.encode())
 *         ierr = StepTimerCreate(&newtimer)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.timer=newtimer
*/
  __pyx_v_ierr = StepTimerCreate((&__pyx_v_newtimer));

  /* "tmm4py/tmm4py_core.pyx":995
 *           c_pre2pre = PyBytes_AsString(prefix2prefix.encode())
 *         ierr = StepTimerCreate(&newtimer)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *         self.timer=newtimer
 *         ierr = StepTimerIni(c_pre, c_pre2pre, startTimeStep, self.timer)
*/
  __pyx_t_5 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_5)) {
    __pyx_t_2 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 995, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 995, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 995, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_3 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_7);
      assert(__pyx_t_2);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
      __pyx_t_3 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_6};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 995, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 995, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":996
 *         ierr = StepTimerCreate(&newtimer)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.timer=newtimer             # <<<<<<<<<<<<<<
 *         ierr = StepTimerIni(c_pre, c_pre2pre, startTimeStep, self.timer)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_v_self->timer = __pyx_v_newtimer;

  /* "tmm4py/tmm4py_core.pyx":997
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.timer=newtimer
 *         ierr = StepTimerIni(c_pre, c_pre2pre, startTimeStep, self.timer)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #SPK do I need a toInt here?
*/
  __pyx_v_ierr = StepTimerIni(__pyx_v_c_pre, __pyx_v_c_pre2pre, __pyx_v_startTimeStep, __pyx_v_self->timer);

  /* "tmm4py/tmm4py_core.pyx":998
 *         self.timer=newtimer
 *         ierr = StepTimerIni(c_pre, c_pre2pre, startTimeStep, self.timer)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #SPK do I need a toInt here?
 *         self.count = self.timer.count
*/
  __pyx_t_5 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_5)) {
    __pyx_t_7 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 998, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 998, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 998, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_3 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
      assert(__pyx_t_7);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_2, __pyx__function);
      __pyx_t_3 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_6};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 998, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 998, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1000
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #SPK do I need a toInt here?
 *         self.count = self.timer.count             # <<<<<<<<<<<<<<
 *         self.startTimeStep = self.timer.startTimeStep
 *         self.numTimeSteps = self.timer.numTimeSteps
*/
  __pyx_t_1 = __Pyx_PyLong_From_PetscInt(__pyx_v_self->timer->count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1000, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->count);
  __Pyx_DECREF(__pyx_v_self->count);
  __pyx_v_self->count = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1001
 * #SPK do I need a toInt here?
 *         self.count = self.timer.count
 *         self.startTimeStep = self.timer.startTimeStep             # <<<<<<<<<<<<<<
 *         self.numTimeSteps = self.timer.numTimeSteps
 * 
*/
  __pyx_t_1 = __Pyx_PyLong_From_PetscInt(__pyx_v_self->timer->startTimeStep); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1001, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->startTimeStep);
  __Pyx_DECREF(__pyx_v_self->startTimeStep);
  __pyx_v_self->startTimeStep = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1002
 *         self.count = self.timer.count
 *         self.startTimeStep = self.timer.startTimeStep
 *         self.numTimeSteps = self.timer.numTimeSteps             # <<<<<<<<<<<<<<
 * 
 *         return self
*/
  __pyx_t_1 = __Pyx_PyLong_From_PetscInt(__pyx_v_self->timer->numTimeSteps); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1002, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->numTimeSteps);
  __Pyx_DECREF(__pyx_v_self->numTimeSteps);
  __pyx_v_self->numTimeSteps = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1004
 *         self.numTimeSteps = self.timer.numTimeSteps
 * 
 *         return self             # <<<<<<<<<<<<<<
 * 
 *     def update(self, PetscInt Iter):
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":984
 *         pass
 * 
 *     def create(self, prefix="", prefix2prefix=None, PetscInt startTimeStep=0):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_pre
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.StepTimer.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1006
 *         return self
 * 
 *     def update(self, PetscInt Iter):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         ierr = StepTimerUpdate(Iter, self.timer)
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_7update(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_9StepTimer_7update = {"update", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_7update, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_7update(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PetscInt __pyx_v_Iter;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("update (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_Iter,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1006, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1006, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "update", 0) < 0) __PYX_ERR(0, 1006, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("update", 1, 1, 1, i); __PYX_ERR(0, 1006, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1006, __pyx_L3_error)
    }
    __pyx_v_Iter = __Pyx_PyLong_As_PetscInt(values[0]); if (unlikely((__pyx_v_Iter == ((PetscInt)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1006, __pyx_L3_error)
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("update", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1006, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.StepTimer.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_6update(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self), __pyx_v_Iter);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_6update(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self, PetscInt __pyx_v_Iter) {
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("update", 0);

  /* "tmm4py/tmm4py_core.pyx":1008
 *     def update(self, PetscInt Iter):
 *         cdef PetscErrorCode ierr
 *         ierr = StepTimerUpdate(Iter, self.timer)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.count = self.timer.count
*/
  __pyx_v_ierr = StepTimerUpdate(__pyx_v_Iter, __pyx_v_self->timer);

  /* "tmm4py/tmm4py_core.pyx":1009
 *         cdef PetscErrorCode ierr
 *         ierr = StepTimerUpdate(Iter, self.timer)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *         self.count = self.timer.count
 *         self.startTimeStep = self.timer.startTimeStep
*/
  __pyx_t_1 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_1)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1009, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1009, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1009, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1009, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1009, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1010
 *         ierr = StepTimerUpdate(Iter, self.timer)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.count = self.timer.count             # <<<<<<<<<<<<<<
 *         self.startTimeStep = self.timer.startTimeStep
 *         self.numTimeSteps = self.timer.numTimeSteps
*/
  __pyx_t_2 = __Pyx_PyLong_From_PetscInt(__pyx_v_self->timer->count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1010, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(__pyx_v_self->count);
  __Pyx_DECREF(__pyx_v_self->count);
  __pyx_v_self->count = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":1011
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.count = self.timer.count
 *         self.startTimeStep = self.timer.startTimeStep             # <<<<<<<<<<<<<<
 *         self.numTimeSteps = self.timer.numTimeSteps
 * 
*/
  __pyx_t_2 = __Pyx_PyLong_From_PetscInt(__pyx_v_self->timer->startTimeStep); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1011, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(__pyx_v_self->startTimeStep);
  __Pyx_DECREF(__pyx_v_self->startTimeStep);
  __pyx_v_self->startTimeStep = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":1012
 *         self.count = self.timer.count
 *         self.startTimeStep = self.timer.startTimeStep
 *         self.numTimeSteps = self.timer.numTimeSteps             # <<<<<<<<<<<<<<
 * 
 *     def incr(self):
*/
  __pyx_t_2 = __Pyx_PyLong_From_PetscInt(__pyx_v_self->timer->numTimeSteps); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1012, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(__pyx_v_self->numTimeSteps);
  __Pyx_DECREF(__pyx_v_self->numTimeSteps);
  __pyx_v_self->numTimeSteps = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":1006
 *         return self
 * 
 *     def update(self, PetscInt Iter):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         ierr = StepTimerUpdate(Iter, self.timer)
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.StepTimer.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1014
 *         self.numTimeSteps = self.timer.numTimeSteps
 * 
 *     def incr(self):             # <<<<<<<<<<<<<<
 *         self.timer.count = self.timer.count + 1
 *         self.count = self.timer.count
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_9incr(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_9StepTimer_9incr = {"incr", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_9incr, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_9incr(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("incr (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("incr", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("incr", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_8incr(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_8incr(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("incr", 0);

  /* "tmm4py/tmm4py_core.pyx":1015
 * 
 *     def incr(self):
 *         self.timer.count = self.timer.count + 1             # <<<<<<<<<<<<<<
 *         self.count = self.timer.count
 * 
*/
  __pyx_v_self->timer->count = (__pyx_v_self->timer->count + 1);

  /* "tmm4py/tmm4py_core.pyx":1016
 *     def incr(self):
 *         self.timer.count = self.timer.count + 1
 *         self.count = self.timer.count             # <<<<<<<<<<<<<<
 * 
 * cdef class PeriodicTimer():
*/
  __pyx_t_1 = __Pyx_PyLong_From_PetscInt(__pyx_v_self->timer->count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1016, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_self->count);
  __Pyx_DECREF(__pyx_v_self->count);
  __pyx_v_self->count = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1014
 *         self.numTimeSteps = self.timer.numTimeSteps
 * 
 *     def incr(self):             # <<<<<<<<<<<<<<
 *         self.timer.count = self.timer.count + 1
 *         self.count = self.timer.count
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.StepTimer.incr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":159
 *     cdef PetscStepTimer timer
 *     cdef public:
 *       object count             # <<<<<<<<<<<<<<
 *       object startTimeStep
 *       object numTimeSteps
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_5count_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_5count_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_5count___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_5count___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->count);
  __pyx_r = __pyx_v_self->count;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_5count_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_5count_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_5count_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_5count_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->count);
  __Pyx_DECREF(__pyx_v_self->count);
  __pyx_v_self->count = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_5count_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_5count_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_5count_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_5count_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->count);
  __Pyx_DECREF(__pyx_v_self->count);
  __pyx_v_self->count = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":160
 *     cdef public:
 *       object count
 *       object startTimeStep             # <<<<<<<<<<<<<<
 *       object numTimeSteps
 * 
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->startTimeStep);
  __pyx_r = __pyx_v_self->startTimeStep;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->startTimeStep);
  __Pyx_DECREF(__pyx_v_self->startTimeStep);
  __pyx_v_self->startTimeStep = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->startTimeStep);
  __Pyx_DECREF(__pyx_v_self->startTimeStep);
  __pyx_v_self->startTimeStep = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":161
 *       object count
 *       object startTimeStep
 *       object numTimeSteps             # <<<<<<<<<<<<<<
 * 
 * cdef class PeriodicTimer:
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->numTimeSteps);
  __pyx_r = __pyx_v_self->numTimeSteps;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->numTimeSteps);
  __Pyx_DECREF(__pyx_v_self->numTimeSteps);
  __pyx_v_self->numTimeSteps = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->numTimeSteps);
  __Pyx_DECREF(__pyx_v_self->numTimeSteps);
  __pyx_v_self->numTimeSteps = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_11__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_9StepTimer_11__reduce_cython__ = {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_11__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_11__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__reduce_cython__", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__reduce_cython__", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_10__reduce_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_10__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce_cython__", 0);

  /* "(tree fragment)":2
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 2, __pyx_L1_error)

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.StepTimer.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_13__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_9StepTimer_13__setstate_cython__ = {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_13__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_13__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v___pyx_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_pyx_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__setstate_cython__", 0) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, i); __PYX_ERR(1, 3, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
    }
    __pyx_v___pyx_state = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, __pyx_nargs); __PYX_ERR(1, 3, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.StepTimer.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_12__setstate_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)__pyx_v_self), __pyx_v___pyx_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_9StepTimer_12__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setstate_cython__", 0);

  /* "(tree fragment)":4
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 4, __pyx_L1_error)

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.StepTimer.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1020
 * cdef class PeriodicTimer():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.timer = NULL
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__cinit__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer___cinit__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_self) {
  int __pyx_r;

  /* "tmm4py/tmm4py_core.pyx":1021
 * 
 *     def __cinit__(self):
 *         self.timer = NULL             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self):
*/
  __pyx_v_self->timer = NULL;

  /* "tmm4py/tmm4py_core.pyx":1020
 * cdef class PeriodicTimer():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.timer = NULL
 * 
*/

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1023
 *         self.timer = NULL
 * 
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         pass
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__init__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__init__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer_2__init__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_self) {
  int __pyx_r;

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1026
 *         pass
 * 
 *     def create(self, prefix="", prefix2prefix=None, np.ndarray[double, ndim=1, mode="c"] tdp=None, cyclePeriod=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_pre
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicTimer_5create = {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_prefix = 0;
  PyObject *__pyx_v_prefix2prefix = 0;
  PyArrayObject *__pyx_v_tdp = 0;
  PyObject *__pyx_v_cyclePeriod = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("create (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_prefix,&__pyx_mstate_global->__pyx_n_u_prefix2prefix,&__pyx_mstate_global->__pyx_n_u_tdp,&__pyx_mstate_global->__pyx_n_u_cyclePeriod,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1026, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 1026, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1026, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1026, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1026, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "create", 0) < 0) __PYX_ERR(0, 1026, __pyx_L3_error)
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_kp_u_));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
      if (!values[2]) values[2] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
      if (!values[3]) values[3] = __Pyx_NewRef(((PyObject *)Py_None));
    } else {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 1026, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1026, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1026, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1026, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_kp_u_));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
      if (!values[2]) values[2] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
      if (!values[3]) values[3] = __Pyx_NewRef(((PyObject *)Py_None));
    }
    __pyx_v_prefix = values[0];
    __pyx_v_prefix2prefix = values[1];
    __pyx_v_tdp = ((PyArrayObject *)values[2]);
    __pyx_v_cyclePeriod = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("create", 0, 0, 4, __pyx_nargs); __PYX_ERR(0, 1026, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicTimer.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_tdp), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 1, "tdp", 0))) __PYX_ERR(0, 1026, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer_4create(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *)__pyx_v_self), __pyx_v_prefix, __pyx_v_prefix2prefix, __pyx_v_tdp, __pyx_v_cyclePeriod);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_self, PyObject *__pyx_v_prefix, PyObject *__pyx_v_prefix2prefix, PyArrayObject *__pyx_v_tdp, PyObject *__pyx_v_cyclePeriod) {
  PetscErrorCode __pyx_v_ierr;
  char const *__pyx_v_c_pre;
  char const *__pyx_v_c_pre2pre;
  PetscScalar *__pyx_v_c_tdp;
  PeriodicTimer __pyx_v_newtimer;
  PyObject *__pyx_v_OptDB = NULL;
  PyObject *__pyx_v_pre = NULL;
  PyObject *__pyx_v_n = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_tdp;
  __Pyx_Buffer __pyx_pybuffer_tdp;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  size_t __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  Py_ssize_t __pyx_t_10;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13 = NULL;
  PyObject *__pyx_t_14[6];
  int __pyx_t_15;
  PyObject *__pyx_t_16 = NULL;
  PyObject *__pyx_t_17[3];
  Py_ssize_t __pyx_t_18;
  char *__pyx_t_19;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("create", 0);
  __pyx_pybuffer_tdp.pybuffer.buf = NULL;
  __pyx_pybuffer_tdp.refcount = 0;
  __pyx_pybuffernd_tdp.data = NULL;
  __pyx_pybuffernd_tdp.rcbuffer = &__pyx_pybuffer_tdp;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_tdp.rcbuffer->pybuffer, (PyObject*)__pyx_v_tdp, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1026, __pyx_L1_error)
  }
  __pyx_pybuffernd_tdp.diminfo[0].strides = __pyx_pybuffernd_tdp.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_tdp.diminfo[0].shape = __pyx_pybuffernd_tdp.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1033
 *         cdef PetscPeriodicTimer newtimer
 * 
 *         OptDB = PETSc.Options() # This needs to be here; moving it below somehow corrupts c_pre             # <<<<<<<<<<<<<<
 * 
 *         if prefix2prefix is None:
*/
  __pyx_t_2 = NULL;
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1033, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_Options); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1033, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
    assert(__pyx_t_2);
    PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_4);
    __Pyx_INCREF(__pyx_t_2);
    __Pyx_INCREF(__pyx__function);
    __Pyx_DECREF_SET(__pyx_t_4, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1033, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_v_OptDB = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1035
 *         OptDB = PETSc.Options() # This needs to be here; moving it below somehow corrupts c_pre
 * 
 *         if prefix2prefix is None:             # <<<<<<<<<<<<<<
 *           pre=prefix
 *         else:
*/
  __pyx_t_6 = (__pyx_v_prefix2prefix == Py_None);
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":1036
 * 
 *         if prefix2prefix is None:
 *           pre=prefix             # <<<<<<<<<<<<<<
 *         else:
 *           pre=prefix2prefix+prefix
*/
    __Pyx_INCREF(__pyx_v_prefix);
    __pyx_v_pre = __pyx_v_prefix;

    /* "tmm4py/tmm4py_core.pyx":1035
 *         OptDB = PETSc.Options() # This needs to be here; moving it below somehow corrupts c_pre
 * 
 *         if prefix2prefix is None:             # <<<<<<<<<<<<<<
 *           pre=prefix
 *         else:
*/
    goto __pyx_L3;
  }

  /* "tmm4py/tmm4py_core.pyx":1038
 *           pre=prefix
 *         else:
 *           pre=prefix2prefix+prefix             # <<<<<<<<<<<<<<
 * 
 * #       This needs to be here as well. OptDB.setValue somehow corrupts c_pre.
*/
  /*else*/ {
    __pyx_t_1 = PyNumber_Add(__pyx_v_prefix2prefix, __pyx_v_prefix); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1038, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_pre = __pyx_t_1;
    __pyx_t_1 = 0;
  }
  __pyx_L3:;

  /* "tmm4py/tmm4py_core.pyx":1041
 * 
 * #       This needs to be here as well. OptDB.setValue somehow corrupts c_pre.
 *         if tdp is None:             # <<<<<<<<<<<<<<
 *           c_tdp = NULL
 *         else:
*/
  __pyx_t_6 = (((PyObject *)__pyx_v_tdp) == Py_None);
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":1042
 * #       This needs to be here as well. OptDB.setValue somehow corrupts c_pre.
 *         if tdp is None:
 *           c_tdp = NULL             # <<<<<<<<<<<<<<
 *         else:
 *           try:
*/
    __pyx_v_c_tdp = NULL;

    /* "tmm4py/tmm4py_core.pyx":1041
 * 
 * #       This needs to be here as well. OptDB.setValue somehow corrupts c_pre.
 *         if tdp is None:             # <<<<<<<<<<<<<<
 *           c_tdp = NULL
 *         else:
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":1044
 *           c_tdp = NULL
 *         else:
 *           try:             # <<<<<<<<<<<<<<
 * #             Check the size ...
 *               n=OptDB.getInt(pre+"num_per_period")
*/
  /*else*/ {
    {
      __Pyx_PyThreadState_declare
      __Pyx_PyThreadState_assign
      __Pyx_ExceptionSave(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9);
      __Pyx_XGOTREF(__pyx_t_7);
      __Pyx_XGOTREF(__pyx_t_8);
      __Pyx_XGOTREF(__pyx_t_9);
      /*try:*/ {

        /* "tmm4py/tmm4py_core.pyx":1046
 *           try:
 * #             Check the size ...
 *               n=OptDB.getInt(pre+"num_per_period")             # <<<<<<<<<<<<<<
 *               if n != len(tdp):   # tdp.shape[0] gives a compilation error
 *                 raise RuntimeError(f"Length of tdp array ({len(tdp)}) does not match size specified in options database ({n}) for {pre+'num_per_period'}")
*/
        __pyx_t_4 = __pyx_v_OptDB;
        __Pyx_INCREF(__pyx_t_4);
        __pyx_t_2 = PyNumber_Add(__pyx_v_pre, __pyx_mstate_global->__pyx_n_u_num_per_period); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1046, __pyx_L5_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_5 = 0;
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
          __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_getInt, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1046, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_1);
        }
        __pyx_v_n = __pyx_t_1;
        __pyx_t_1 = 0;

        /* "tmm4py/tmm4py_core.pyx":1047
 * #             Check the size ...
 *               n=OptDB.getInt(pre+"num_per_period")
 *               if n != len(tdp):   # tdp.shape[0] gives a compilation error             # <<<<<<<<<<<<<<
 *                 raise RuntimeError(f"Length of tdp array ({len(tdp)}) does not match size specified in options database ({n}) for {pre+'num_per_period'}")
 *           except KeyError:
*/
        __pyx_t_10 = PyObject_Length(((PyObject *)__pyx_v_tdp)); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1047, __pyx_L5_error)
        __pyx_t_1 = PyLong_FromSsize_t(__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1047, __pyx_L5_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_2 = PyObject_RichCompare(__pyx_v_n, __pyx_t_1, Py_NE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1047, __pyx_L5_error)
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 1047, __pyx_L5_error)
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(__pyx_t_6)) {

          /* "tmm4py/tmm4py_core.pyx":1048
 *               n=OptDB.getInt(pre+"num_per_period")
 *               if n != len(tdp):   # tdp.shape[0] gives a compilation error
 *                 raise RuntimeError(f"Length of tdp array ({len(tdp)}) does not match size specified in options database ({n}) for {pre+'num_per_period'}")             # <<<<<<<<<<<<<<
 *           except KeyError:
 *               print(f"Warning: no options database value found for {pre+'num_per_period'}. Setting options database.")
*/
          __pyx_t_1 = NULL;
          __Pyx_INCREF(__pyx_builtin_RuntimeError);
          __pyx_t_4 = __pyx_builtin_RuntimeError; 
          __pyx_t_10 = PyObject_Length(((PyObject *)__pyx_v_tdp)); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1048, __pyx_L5_error)
          __pyx_t_3 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_10, 0, ' ', 'd'); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1048, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_11 = __Pyx_PyObject_FormatSimple(__pyx_v_n, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1048, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_11);
          __pyx_t_12 = PyNumber_Add(__pyx_v_pre, __pyx_mstate_global->__pyx_n_u_num_per_period); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1048, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_12);
          __pyx_t_13 = __Pyx_PyObject_FormatSimple(__pyx_t_12, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1048, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_13);
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __pyx_t_14[0] = __pyx_mstate_global->__pyx_kp_u_Length_of_tdp_array;
          __pyx_t_14[1] = __pyx_t_3;
          __pyx_t_14[2] = __pyx_mstate_global->__pyx_kp_u_does_not_match_size_specified_i;
          __pyx_t_14[3] = __pyx_t_11;
          __pyx_t_14[4] = __pyx_mstate_global->__pyx_kp_u_for;
          __pyx_t_14[5] = __pyx_t_13;
          __pyx_t_12 = __Pyx_PyUnicode_Join(__pyx_t_14, 6, 21 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_3) + 53 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_11) + 6 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_13), 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_11) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_13));
          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1048, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_12);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
          __pyx_t_5 = 1;
          {
            PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_12};
            __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
            __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
            __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1048, __pyx_L5_error)
            __Pyx_GOTREF(__pyx_t_2);
          }
          __Pyx_Raise(__pyx_t_2, 0, 0, 0);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __PYX_ERR(0, 1048, __pyx_L5_error)

          /* "tmm4py/tmm4py_core.pyx":1047
 * #             Check the size ...
 *               n=OptDB.getInt(pre+"num_per_period")
 *               if n != len(tdp):   # tdp.shape[0] gives a compilation error             # <<<<<<<<<<<<<<
 *                 raise RuntimeError(f"Length of tdp array ({len(tdp)}) does not match size specified in options database ({n}) for {pre+'num_per_period'}")
 *           except KeyError:
*/
        }

        /* "tmm4py/tmm4py_core.pyx":1044
 *           c_tdp = NULL
 *         else:
 *           try:             # <<<<<<<<<<<<<<
 * #             Check the size ...
 *               n=OptDB.getInt(pre+"num_per_period")
*/
      }
      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L10_try_end;
      __pyx_L5_error:;
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
      __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
      __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;

      /* "tmm4py/tmm4py_core.pyx":1049
 *               if n != len(tdp):   # tdp.shape[0] gives a compilation error
 *                 raise RuntimeError(f"Length of tdp array ({len(tdp)}) does not match size specified in options database ({n}) for {pre+'num_per_period'}")
 *           except KeyError:             # <<<<<<<<<<<<<<
 *               print(f"Warning: no options database value found for {pre+'num_per_period'}. Setting options database.")
 *               OptDB.setValue(pre+"num_per_period",len(tdp))
*/
      __pyx_t_15 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_KeyError);
      if (__pyx_t_15) {
        __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicTimer.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_4, &__pyx_t_12) < 0) __PYX_ERR(0, 1049, __pyx_L7_except_error)
        __Pyx_XGOTREF(__pyx_t_2);
        __Pyx_XGOTREF(__pyx_t_4);
        __Pyx_XGOTREF(__pyx_t_12);

        /* "tmm4py/tmm4py_core.pyx":1050
 *                 raise RuntimeError(f"Length of tdp array ({len(tdp)}) does not match size specified in options database ({n}) for {pre+'num_per_period'}")
 *           except KeyError:
 *               print(f"Warning: no options database value found for {pre+'num_per_period'}. Setting options database.")             # <<<<<<<<<<<<<<
 *               OptDB.setValue(pre+"num_per_period",len(tdp))
 *           c_tdp = &tdp[0]
*/
        __pyx_t_13 = NULL;
        __Pyx_INCREF(__pyx_builtin_print);
        __pyx_t_11 = __pyx_builtin_print; 
        __pyx_t_3 = PyNumber_Add(__pyx_v_pre, __pyx_mstate_global->__pyx_n_u_num_per_period); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1050, __pyx_L7_except_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_16 = __Pyx_PyObject_FormatSimple(__pyx_t_3, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1050, __pyx_L7_except_error)
        __Pyx_GOTREF(__pyx_t_16);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_17[0] = __pyx_mstate_global->__pyx_kp_u_Warning_no_options_database_valu;
        __pyx_t_17[1] = __pyx_t_16;
        __pyx_t_17[2] = __pyx_mstate_global->__pyx_kp_u_Setting_options_database;
        __pyx_t_3 = __Pyx_PyUnicode_Join(__pyx_t_17, 3, 45 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_16) + 27, 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_16));
        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1050, __pyx_L7_except_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
        __pyx_t_5 = 1;
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_13, __pyx_t_3};
          __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_11, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1050, __pyx_L7_except_error)
          __Pyx_GOTREF(__pyx_t_1);
        }
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "tmm4py/tmm4py_core.pyx":1051
 *           except KeyError:
 *               print(f"Warning: no options database value found for {pre+'num_per_period'}. Setting options database.")
 *               OptDB.setValue(pre+"num_per_period",len(tdp))             # <<<<<<<<<<<<<<
 *           c_tdp = &tdp[0]
 * 
*/
        __pyx_t_11 = __pyx_v_OptDB;
        __Pyx_INCREF(__pyx_t_11);
        __pyx_t_3 = PyNumber_Add(__pyx_v_pre, __pyx_mstate_global->__pyx_n_u_num_per_period); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1051, __pyx_L7_except_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_10 = PyObject_Length(((PyObject *)__pyx_v_tdp)); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1051, __pyx_L7_except_error)
        __pyx_t_13 = PyLong_FromSsize_t(__pyx_t_10); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1051, __pyx_L7_except_error)
        __Pyx_GOTREF(__pyx_t_13);
        __pyx_t_5 = 0;
        {
          PyObject *__pyx_callargs[3] = {__pyx_t_11, __pyx_t_3, __pyx_t_13};
          __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_setValue, __pyx_callargs+__pyx_t_5, (3-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1051, __pyx_L7_except_error)
          __Pyx_GOTREF(__pyx_t_1);
        }
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
        goto __pyx_L6_exception_handled;
      }
      goto __pyx_L7_except_error;

      /* "tmm4py/tmm4py_core.pyx":1044
 *           c_tdp = NULL
 *         else:
 *           try:             # <<<<<<<<<<<<<<
 * #             Check the size ...
 *               n=OptDB.getInt(pre+"num_per_period")
*/
      __pyx_L7_except_error:;
      __Pyx_XGIVEREF(__pyx_t_7);
      __Pyx_XGIVEREF(__pyx_t_8);
      __Pyx_XGIVEREF(__pyx_t_9);
      __Pyx_ExceptionReset(__pyx_t_7, __pyx_t_8, __pyx_t_9);
      goto __pyx_L1_error;
      __pyx_L6_exception_handled:;
      __Pyx_XGIVEREF(__pyx_t_7);
      __Pyx_XGIVEREF(__pyx_t_8);
      __Pyx_XGIVEREF(__pyx_t_9);
      __Pyx_ExceptionReset(__pyx_t_7, __pyx_t_8, __pyx_t_9);
      __pyx_L10_try_end:;
    }

    /* "tmm4py/tmm4py_core.pyx":1052
 *               print(f"Warning: no options database value found for {pre+'num_per_period'}. Setting options database.")
 *               OptDB.setValue(pre+"num_per_period",len(tdp))
 *           c_tdp = &tdp[0]             # <<<<<<<<<<<<<<
 * 
 *         if cyclePeriod is not None:
*/
    __pyx_t_18 = 0;
    __pyx_t_15 = -1;
    if (__pyx_t_18 < 0) {
      __pyx_t_18 += __pyx_pybuffernd_tdp.diminfo[0].shape;
      if (unlikely(__pyx_t_18 < 0)) __pyx_t_15 = 0;
    } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_tdp.diminfo[0].shape)) __pyx_t_15 = 0;
    if (unlikely(__pyx_t_15 != -1)) {
      __Pyx_RaiseBufferIndexError(__pyx_t_15);
      __PYX_ERR(0, 1052, __pyx_L1_error)
    }
    __pyx_v_c_tdp = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_tdp.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_tdp.diminfo[0].strides)));
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":1054
 *           c_tdp = &tdp[0]
 * 
 *         if cyclePeriod is not None:             # <<<<<<<<<<<<<<
 *             print(f"Setting options database for {pre+'cycle_period'}. This will override any previously set value.")
 *             OptDB.setValue(pre+"cycle_period",cyclePeriod)
*/
  __pyx_t_6 = (__pyx_v_cyclePeriod != Py_None);
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":1055
 * 
 *         if cyclePeriod is not None:
 *             print(f"Setting options database for {pre+'cycle_period'}. This will override any previously set value.")             # <<<<<<<<<<<<<<
 *             OptDB.setValue(pre+"cycle_period",cyclePeriod)
 * 
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_print);
    __pyx_t_2 = __pyx_builtin_print; 
    __pyx_t_1 = PyNumber_Add(__pyx_v_pre, __pyx_mstate_global->__pyx_n_u_cycle_period); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1055, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_13 = __Pyx_PyObject_FormatSimple(__pyx_t_1, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1055, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_13);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_17[0] = __pyx_mstate_global->__pyx_kp_u_Setting_options_database_for;
    __pyx_t_17[1] = __pyx_t_13;
    __pyx_t_17[2] = __pyx_mstate_global->__pyx_kp_u_This_will_override_any_previous;
    __pyx_t_1 = __Pyx_PyUnicode_Join(__pyx_t_17, 3, 29 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_13) + 46, 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_13));
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1055, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_5 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_1};
      __pyx_t_12 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1055, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
    }
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

    /* "tmm4py/tmm4py_core.pyx":1056
 *         if cyclePeriod is not None:
 *             print(f"Setting options database for {pre+'cycle_period'}. This will override any previously set value.")
 *             OptDB.setValue(pre+"cycle_period",cyclePeriod)             # <<<<<<<<<<<<<<
 * 
 *         c_pre = PyBytes_AsString(prefix.encode())
*/
    __pyx_t_2 = __pyx_v_OptDB;
    __Pyx_INCREF(__pyx_t_2);
    __pyx_t_1 = PyNumber_Add(__pyx_v_pre, __pyx_mstate_global->__pyx_n_u_cycle_period); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1056, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = 0;
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_t_1, __pyx_v_cyclePeriod};
      __pyx_t_12 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_setValue, __pyx_callargs+__pyx_t_5, (3-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1056, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
    }
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

    /* "tmm4py/tmm4py_core.pyx":1054
 *           c_tdp = &tdp[0]
 * 
 *         if cyclePeriod is not None:             # <<<<<<<<<<<<<<
 *             print(f"Setting options database for {pre+'cycle_period'}. This will override any previously set value.")
 *             OptDB.setValue(pre+"cycle_period",cyclePeriod)
*/
  }

  /* "tmm4py/tmm4py_core.pyx":1058
 *             OptDB.setValue(pre+"cycle_period",cyclePeriod)
 * 
 *         c_pre = PyBytes_AsString(prefix.encode())             # <<<<<<<<<<<<<<
 *         if prefix2prefix is None:
 *           c_pre2pre = NULL
*/
  __pyx_t_1 = __pyx_v_prefix;
  __Pyx_INCREF(__pyx_t_1);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
    __pyx_t_12 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1058, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
  }
  __pyx_t_19 = PyBytes_AsString(__pyx_t_12); if (unlikely(__pyx_t_19 == ((char *)0))) __PYX_ERR(0, 1058, __pyx_L1_error)
  __pyx_v_c_pre = __pyx_t_19;
  __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

  /* "tmm4py/tmm4py_core.pyx":1059
 * 
 *         c_pre = PyBytes_AsString(prefix.encode())
 *         if prefix2prefix is None:             # <<<<<<<<<<<<<<
 *           c_pre2pre = NULL
 *         else:
*/
  __pyx_t_6 = (__pyx_v_prefix2prefix == Py_None);
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":1060
 *         c_pre = PyBytes_AsString(prefix.encode())
 *         if prefix2prefix is None:
 *           c_pre2pre = NULL             # <<<<<<<<<<<<<<
 *         else:
 *           c_pre2pre = PyBytes_AsString(prefix2prefix.encode())
*/
    __pyx_v_c_pre2pre = NULL;

    /* "tmm4py/tmm4py_core.pyx":1059
 * 
 *         c_pre = PyBytes_AsString(prefix.encode())
 *         if prefix2prefix is None:             # <<<<<<<<<<<<<<
 *           c_pre2pre = NULL
 *         else:
*/
    goto __pyx_L15;
  }

  /* "tmm4py/tmm4py_core.pyx":1062
 *           c_pre2pre = NULL
 *         else:
 *           c_pre2pre = PyBytes_AsString(prefix2prefix.encode())             # <<<<<<<<<<<<<<
 * 
 *         ierr = PeriodicTimerCreate(&newtimer)
*/
  /*else*/ {
    __pyx_t_1 = __pyx_v_prefix2prefix;
    __Pyx_INCREF(__pyx_t_1);
    __pyx_t_5 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
      __pyx_t_12 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1062, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
    }
    __pyx_t_19 = PyBytes_AsString(__pyx_t_12); if (unlikely(__pyx_t_19 == ((char *)0))) __PYX_ERR(0, 1062, __pyx_L1_error)
    __pyx_v_c_pre2pre = __pyx_t_19;
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
  }
  __pyx_L15:;

  /* "tmm4py/tmm4py_core.pyx":1064
 *           c_pre2pre = PyBytes_AsString(prefix2prefix.encode())
 * 
 *         ierr = PeriodicTimerCreate(&newtimer)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.timer=newtimer
*/
  __pyx_v_ierr = PeriodicTimerCreate((&__pyx_v_newtimer));

  /* "tmm4py/tmm4py_core.pyx":1065
 * 
 *         ierr = PeriodicTimerCreate(&newtimer)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *         self.timer=newtimer
 *         ierr = PeriodicTimerIni(c_pre, c_pre2pre, c_tdp, self.timer)
*/
  __pyx_t_6 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_6)) {
    __pyx_t_1 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1065, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1065, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1065, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
      assert(__pyx_t_1);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_2};
      __pyx_t_12 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1065, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
    }
    __Pyx_Raise(__pyx_t_12, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __PYX_ERR(0, 1065, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1066
 *         ierr = PeriodicTimerCreate(&newtimer)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.timer=newtimer             # <<<<<<<<<<<<<<
 *         ierr = PeriodicTimerIni(c_pre, c_pre2pre, c_tdp, self.timer)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_v_self->timer = __pyx_v_newtimer;

  /* "tmm4py/tmm4py_core.pyx":1067
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.timer=newtimer
 *         ierr = PeriodicTimerIni(c_pre, c_pre2pre, c_tdp, self.timer)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_v_ierr = PeriodicTimerIni(__pyx_v_c_pre, __pyx_v_c_pre2pre, __pyx_v_c_tdp, __pyx_v_self->timer);

  /* "tmm4py/tmm4py_core.pyx":1068
 *         self.timer=newtimer
 *         ierr = PeriodicTimerIni(c_pre, c_pre2pre, c_tdp, self.timer)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 *         return self
*/
  __pyx_t_6 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_6)) {
    __pyx_t_4 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1068, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1068, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1068, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
      assert(__pyx_t_4);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_1, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
      __pyx_t_12 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1068, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
    }
    __Pyx_Raise(__pyx_t_12, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __PYX_ERR(0, 1068, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1070
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *         return self             # <<<<<<<<<<<<<<
 * 
 * cdef class TimeDependentTimer():
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1026
 *         pass
 * 
 *     def create(self, prefix="", prefix2prefix=None, np.ndarray[double, ndim=1, mode="c"] tdp=None, cyclePeriod=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_pre
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_XDECREF(__pyx_t_16);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_tdp.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicTimer.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_tdp.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF(__pyx_v_OptDB);
  __Pyx_XDECREF(__pyx_v_pre);
  __Pyx_XDECREF(__pyx_v_n);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_7__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicTimer_7__reduce_cython__ = {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_7__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_7__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__reduce_cython__", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__reduce_cython__", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer_6__reduce_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer_6__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce_cython__", 0);

  /* "(tree fragment)":2
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 2, __pyx_L1_error)

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicTimer.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_9__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicTimer_9__setstate_cython__ = {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_9__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_9__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v___pyx_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_pyx_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__setstate_cython__", 0) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, i); __PYX_ERR(1, 3, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
    }
    __pyx_v___pyx_state = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, __pyx_nargs); __PYX_ERR(1, 3, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicTimer.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer_8__setstate_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *)__pyx_v_self), __pyx_v___pyx_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicTimer_8__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setstate_cython__", 0);

  /* "(tree fragment)":4
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 4, __pyx_L1_error)

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicTimer.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1074
 * cdef class TimeDependentTimer():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.timer = NULL
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__cinit__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer___cinit__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_self) {
  int __pyx_r;

  /* "tmm4py/tmm4py_core.pyx":1075
 * 
 *     def __cinit__(self):
 *         self.timer = NULL             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self):
*/
  __pyx_v_self->timer = NULL;

  /* "tmm4py/tmm4py_core.pyx":1074
 * cdef class TimeDependentTimer():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.timer = NULL
 * 
*/

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1077
 *         self.timer = NULL
 * 
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         pass
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__init__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__init__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer_2__init__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_self) {
  int __pyx_r;

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1080
 *         pass
 * 
 *     def create(self, prefix="", prefix2prefix=None, np.ndarray[double, ndim=1, mode="c"] tdt=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_pre
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentTimer_5create = {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_prefix = 0;
  PyObject *__pyx_v_prefix2prefix = 0;
  PyArrayObject *__pyx_v_tdt = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("create (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_prefix,&__pyx_mstate_global->__pyx_n_u_prefix2prefix,&__pyx_mstate_global->__pyx_n_u_tdt,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1080, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1080, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1080, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1080, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "create", 0) < 0) __PYX_ERR(0, 1080, __pyx_L3_error)
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_kp_u_));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
      if (!values[2]) values[2] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
    } else {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1080, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1080, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1080, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_kp_u_));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
      if (!values[2]) values[2] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
    }
    __pyx_v_prefix = values[0];
    __pyx_v_prefix2prefix = values[1];
    __pyx_v_tdt = ((PyArrayObject *)values[2]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("create", 0, 0, 3, __pyx_nargs); __PYX_ERR(0, 1080, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentTimer.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_tdt), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 1, "tdt", 0))) __PYX_ERR(0, 1080, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer_4create(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *)__pyx_v_self), __pyx_v_prefix, __pyx_v_prefix2prefix, __pyx_v_tdt);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_self, PyObject *__pyx_v_prefix, PyObject *__pyx_v_prefix2prefix, PyArrayObject *__pyx_v_tdt) {
  PetscErrorCode __pyx_v_ierr;
  char const *__pyx_v_c_pre;
  char const *__pyx_v_c_pre2pre;
  PetscScalar *__pyx_v_c_tdt;
  TimeDependentTimer __pyx_v_newtimer;
  PyObject *__pyx_v_OptDB = NULL;
  PyObject *__pyx_v_pre = NULL;
  PyObject *__pyx_v_n = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_tdt;
  __Pyx_Buffer __pyx_pybuffer_tdt;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  size_t __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  Py_ssize_t __pyx_t_10;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13 = NULL;
  PyObject *__pyx_t_14[6];
  int __pyx_t_15;
  PyObject *__pyx_t_16 = NULL;
  PyObject *__pyx_t_17[3];
  Py_ssize_t __pyx_t_18;
  char *__pyx_t_19;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("create", 0);
  __pyx_pybuffer_tdt.pybuffer.buf = NULL;
  __pyx_pybuffer_tdt.refcount = 0;
  __pyx_pybuffernd_tdt.data = NULL;
  __pyx_pybuffernd_tdt.rcbuffer = &__pyx_pybuffer_tdt;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_tdt.rcbuffer->pybuffer, (PyObject*)__pyx_v_tdt, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1080, __pyx_L1_error)
  }
  __pyx_pybuffernd_tdt.diminfo[0].strides = __pyx_pybuffernd_tdt.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_tdt.diminfo[0].shape = __pyx_pybuffernd_tdt.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1087
 *         cdef PetscTimeDependentTimer newtimer
 * 
 *         OptDB = PETSc.Options() # This needs to be here; moving it below somehow corrupts c_pre             # <<<<<<<<<<<<<<
 * 
 *         if prefix2prefix is None:
*/
  __pyx_t_2 = NULL;
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_Options); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1087, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
    assert(__pyx_t_2);
    PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_4);
    __Pyx_INCREF(__pyx_t_2);
    __Pyx_INCREF(__pyx__function);
    __Pyx_DECREF_SET(__pyx_t_4, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_v_OptDB = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1089
 *         OptDB = PETSc.Options() # This needs to be here; moving it below somehow corrupts c_pre
 * 
 *         if prefix2prefix is None:             # <<<<<<<<<<<<<<
 *           pre=prefix
 *         else:
*/
  __pyx_t_6 = (__pyx_v_prefix2prefix == Py_None);
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":1090
 * 
 *         if prefix2prefix is None:
 *           pre=prefix             # <<<<<<<<<<<<<<
 *         else:
 *           pre=prefix2prefix+prefix
*/
    __Pyx_INCREF(__pyx_v_prefix);
    __pyx_v_pre = __pyx_v_prefix;

    /* "tmm4py/tmm4py_core.pyx":1089
 *         OptDB = PETSc.Options() # This needs to be here; moving it below somehow corrupts c_pre
 * 
 *         if prefix2prefix is None:             # <<<<<<<<<<<<<<
 *           pre=prefix
 *         else:
*/
    goto __pyx_L3;
  }

  /* "tmm4py/tmm4py_core.pyx":1092
 *           pre=prefix
 *         else:
 *           pre=prefix2prefix+prefix             # <<<<<<<<<<<<<<
 * 
 * #       This needs to be here as well. OptDB.setValue somehow corrupts c_pre.
*/
  /*else*/ {
    __pyx_t_1 = PyNumber_Add(__pyx_v_prefix2prefix, __pyx_v_prefix); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_pre = __pyx_t_1;
    __pyx_t_1 = 0;
  }
  __pyx_L3:;

  /* "tmm4py/tmm4py_core.pyx":1095
 * 
 * #       This needs to be here as well. OptDB.setValue somehow corrupts c_pre.
 *         if tdt is None:             # <<<<<<<<<<<<<<
 *           c_tdt = NULL
 *         else:
*/
  __pyx_t_6 = (((PyObject *)__pyx_v_tdt) == Py_None);
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":1096
 * #       This needs to be here as well. OptDB.setValue somehow corrupts c_pre.
 *         if tdt is None:
 *           c_tdt = NULL             # <<<<<<<<<<<<<<
 *         else:
 *           try:
*/
    __pyx_v_c_tdt = NULL;

    /* "tmm4py/tmm4py_core.pyx":1095
 * 
 * #       This needs to be here as well. OptDB.setValue somehow corrupts c_pre.
 *         if tdt is None:             # <<<<<<<<<<<<<<
 *           c_tdt = NULL
 *         else:
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":1098
 *           c_tdt = NULL
 *         else:
 *           try:             # <<<<<<<<<<<<<<
 * #             Check the size ...
 *               n=OptDB.getInt(pre+"num_times")
*/
  /*else*/ {
    {
      __Pyx_PyThreadState_declare
      __Pyx_PyThreadState_assign
      __Pyx_ExceptionSave(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9);
      __Pyx_XGOTREF(__pyx_t_7);
      __Pyx_XGOTREF(__pyx_t_8);
      __Pyx_XGOTREF(__pyx_t_9);
      /*try:*/ {

        /* "tmm4py/tmm4py_core.pyx":1100
 *           try:
 * #             Check the size ...
 *               n=OptDB.getInt(pre+"num_times")             # <<<<<<<<<<<<<<
 *               if n != len(tdt):   # tdt.shape[0] gives a compilation error
 *                 raise RuntimeError(f"Length of tdt array ({len(tdt)}) does not match size specified in options database ({n}) for {pre+'num_times'}")
*/
        __pyx_t_4 = __pyx_v_OptDB;
        __Pyx_INCREF(__pyx_t_4);
        __pyx_t_2 = PyNumber_Add(__pyx_v_pre, __pyx_mstate_global->__pyx_n_u_num_times); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1100, __pyx_L5_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_5 = 0;
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
          __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_getInt, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_1);
        }
        __pyx_v_n = __pyx_t_1;
        __pyx_t_1 = 0;

        /* "tmm4py/tmm4py_core.pyx":1101
 * #             Check the size ...
 *               n=OptDB.getInt(pre+"num_times")
 *               if n != len(tdt):   # tdt.shape[0] gives a compilation error             # <<<<<<<<<<<<<<
 *                 raise RuntimeError(f"Length of tdt array ({len(tdt)}) does not match size specified in options database ({n}) for {pre+'num_times'}")
 *           except KeyError:
*/
        __pyx_t_10 = PyObject_Length(((PyObject *)__pyx_v_tdt)); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1101, __pyx_L5_error)
        __pyx_t_1 = PyLong_FromSsize_t(__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1101, __pyx_L5_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_2 = PyObject_RichCompare(__pyx_v_n, __pyx_t_1, Py_NE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1101, __pyx_L5_error)
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 1101, __pyx_L5_error)
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(__pyx_t_6)) {

          /* "tmm4py/tmm4py_core.pyx":1102
 *               n=OptDB.getInt(pre+"num_times")
 *               if n != len(tdt):   # tdt.shape[0] gives a compilation error
 *                 raise RuntimeError(f"Length of tdt array ({len(tdt)}) does not match size specified in options database ({n}) for {pre+'num_times'}")             # <<<<<<<<<<<<<<
 *           except KeyError:
 *               print(f"Warning: no options database value found for {pre+'num_times'}. Setting options database.")
*/
          __pyx_t_1 = NULL;
          __Pyx_INCREF(__pyx_builtin_RuntimeError);
          __pyx_t_4 = __pyx_builtin_RuntimeError; 
          __pyx_t_10 = PyObject_Length(((PyObject *)__pyx_v_tdt)); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1102, __pyx_L5_error)
          __pyx_t_3 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_10, 0, ' ', 'd'); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1102, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_11 = __Pyx_PyObject_FormatSimple(__pyx_v_n, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1102, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_11);
          __pyx_t_12 = PyNumber_Add(__pyx_v_pre, __pyx_mstate_global->__pyx_n_u_num_times); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1102, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_12);
          __pyx_t_13 = __Pyx_PyObject_FormatSimple(__pyx_t_12, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1102, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_13);
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __pyx_t_14[0] = __pyx_mstate_global->__pyx_kp_u_Length_of_tdt_array;
          __pyx_t_14[1] = __pyx_t_3;
          __pyx_t_14[2] = __pyx_mstate_global->__pyx_kp_u_does_not_match_size_specified_i;
          __pyx_t_14[3] = __pyx_t_11;
          __pyx_t_14[4] = __pyx_mstate_global->__pyx_kp_u_for;
          __pyx_t_14[5] = __pyx_t_13;
          __pyx_t_12 = __Pyx_PyUnicode_Join(__pyx_t_14, 6, 21 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_3) + 53 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_11) + 6 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_13), 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_11) | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_13));
          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1102, __pyx_L5_error)
          __Pyx_GOTREF(__pyx_t_12);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
          __pyx_t_5 = 1;
          {
            PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_12};
            __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
            __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
            __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1102, __pyx_L5_error)
            __Pyx_GOTREF(__pyx_t_2);
          }
          __Pyx_Raise(__pyx_t_2, 0, 0, 0);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __PYX_ERR(0, 1102, __pyx_L5_error)

          /* "tmm4py/tmm4py_core.pyx":1101
 * #             Check the size ...
 *               n=OptDB.getInt(pre+"num_times")
 *               if n != len(tdt):   # tdt.shape[0] gives a compilation error             # <<<<<<<<<<<<<<
 *                 raise RuntimeError(f"Length of tdt array ({len(tdt)}) does not match size specified in options database ({n}) for {pre+'num_times'}")
 *           except KeyError:
*/
        }

        /* "tmm4py/tmm4py_core.pyx":1098
 *           c_tdt = NULL
 *         else:
 *           try:             # <<<<<<<<<<<<<<
 * #             Check the size ...
 *               n=OptDB.getInt(pre+"num_times")
*/
      }
      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L10_try_end;
      __pyx_L5_error:;
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
      __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
      __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;

      /* "tmm4py/tmm4py_core.pyx":1103
 *               if n != len(tdt):   # tdt.shape[0] gives a compilation error
 *                 raise RuntimeError(f"Length of tdt array ({len(tdt)}) does not match size specified in options database ({n}) for {pre+'num_times'}")
 *           except KeyError:             # <<<<<<<<<<<<<<
 *               print(f"Warning: no options database value found for {pre+'num_times'}. Setting options database.")
 *               OptDB.setValue(pre+"num_times",len(tdt))
*/
      __pyx_t_15 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_KeyError);
      if (__pyx_t_15) {
        __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentTimer.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_4, &__pyx_t_12) < 0) __PYX_ERR(0, 1103, __pyx_L7_except_error)
        __Pyx_XGOTREF(__pyx_t_2);
        __Pyx_XGOTREF(__pyx_t_4);
        __Pyx_XGOTREF(__pyx_t_12);

        /* "tmm4py/tmm4py_core.pyx":1104
 *                 raise RuntimeError(f"Length of tdt array ({len(tdt)}) does not match size specified in options database ({n}) for {pre+'num_times'}")
 *           except KeyError:
 *               print(f"Warning: no options database value found for {pre+'num_times'}. Setting options database.")             # <<<<<<<<<<<<<<
 *               OptDB.setValue(pre+"num_times",len(tdt))
 *           c_tdt = &tdt[0]
*/
        __pyx_t_13 = NULL;
        __Pyx_INCREF(__pyx_builtin_print);
        __pyx_t_11 = __pyx_builtin_print; 
        __pyx_t_3 = PyNumber_Add(__pyx_v_pre, __pyx_mstate_global->__pyx_n_u_num_times); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1104, __pyx_L7_except_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_16 = __Pyx_PyObject_FormatSimple(__pyx_t_3, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1104, __pyx_L7_except_error)
        __Pyx_GOTREF(__pyx_t_16);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_17[0] = __pyx_mstate_global->__pyx_kp_u_Warning_no_options_database_valu;
        __pyx_t_17[1] = __pyx_t_16;
        __pyx_t_17[2] = __pyx_mstate_global->__pyx_kp_u_Setting_options_database;
        __pyx_t_3 = __Pyx_PyUnicode_Join(__pyx_t_17, 3, 45 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_16) + 27, 127 | __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_16));
        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1104, __pyx_L7_except_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
        __pyx_t_5 = 1;
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_13, __pyx_t_3};
          __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_11, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1104, __pyx_L7_except_error)
          __Pyx_GOTREF(__pyx_t_1);
        }
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "tmm4py/tmm4py_core.pyx":1105
 *           except KeyError:
 *               print(f"Warning: no options database value found for {pre+'num_times'}. Setting options database.")
 *               OptDB.setValue(pre+"num_times",len(tdt))             # <<<<<<<<<<<<<<
 *           c_tdt = &tdt[0]
 * 
*/
        __pyx_t_11 = __pyx_v_OptDB;
        __Pyx_INCREF(__pyx_t_11);
        __pyx_t_3 = PyNumber_Add(__pyx_v_pre, __pyx_mstate_global->__pyx_n_u_num_times); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1105, __pyx_L7_except_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_10 = PyObject_Length(((PyObject *)__pyx_v_tdt)); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1105, __pyx_L7_except_error)
        __pyx_t_13 = PyLong_FromSsize_t(__pyx_t_10); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1105, __pyx_L7_except_error)
        __Pyx_GOTREF(__pyx_t_13);
        __pyx_t_5 = 0;
        {
          PyObject *__pyx_callargs[3] = {__pyx_t_11, __pyx_t_3, __pyx_t_13};
          __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_setValue, __pyx_callargs+__pyx_t_5, (3-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1105, __pyx_L7_except_error)
          __Pyx_GOTREF(__pyx_t_1);
        }
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
        goto __pyx_L6_exception_handled;
      }
      goto __pyx_L7_except_error;

      /* "tmm4py/tmm4py_core.pyx":1098
 *           c_tdt = NULL
 *         else:
 *           try:             # <<<<<<<<<<<<<<
 * #             Check the size ...
 *               n=OptDB.getInt(pre+"num_times")
*/
      __pyx_L7_except_error:;
      __Pyx_XGIVEREF(__pyx_t_7);
      __Pyx_XGIVEREF(__pyx_t_8);
      __Pyx_XGIVEREF(__pyx_t_9);
      __Pyx_ExceptionReset(__pyx_t_7, __pyx_t_8, __pyx_t_9);
      goto __pyx_L1_error;
      __pyx_L6_exception_handled:;
      __Pyx_XGIVEREF(__pyx_t_7);
      __Pyx_XGIVEREF(__pyx_t_8);
      __Pyx_XGIVEREF(__pyx_t_9);
      __Pyx_ExceptionReset(__pyx_t_7, __pyx_t_8, __pyx_t_9);
      __pyx_L10_try_end:;
    }

    /* "tmm4py/tmm4py_core.pyx":1106
 *               print(f"Warning: no options database value found for {pre+'num_times'}. Setting options database.")
 *               OptDB.setValue(pre+"num_times",len(tdt))
 *           c_tdt = &tdt[0]             # <<<<<<<<<<<<<<
 * 
 *         c_pre = PyBytes_AsString(prefix.encode())
*/
    __pyx_t_18 = 0;
    __pyx_t_15 = -1;
    if (__pyx_t_18 < 0) {
      __pyx_t_18 += __pyx_pybuffernd_tdt.diminfo[0].shape;
      if (unlikely(__pyx_t_18 < 0)) __pyx_t_15 = 0;
    } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_tdt.diminfo[0].shape)) __pyx_t_15 = 0;
    if (unlikely(__pyx_t_15 != -1)) {
      __Pyx_RaiseBufferIndexError(__pyx_t_15);
      __PYX_ERR(0, 1106, __pyx_L1_error)
    }
    __pyx_v_c_tdt = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_tdt.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_tdt.diminfo[0].strides)));
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":1108
 *           c_tdt = &tdt[0]
 * 
 *         c_pre = PyBytes_AsString(prefix.encode())             # <<<<<<<<<<<<<<
 *         if prefix2prefix is None:
 *           c_pre2pre = NULL
*/
  __pyx_t_4 = __pyx_v_prefix;
  __Pyx_INCREF(__pyx_t_4);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
    __pyx_t_12 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1108, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
  }
  __pyx_t_19 = PyBytes_AsString(__pyx_t_12); if (unlikely(__pyx_t_19 == ((char *)0))) __PYX_ERR(0, 1108, __pyx_L1_error)
  __pyx_v_c_pre = __pyx_t_19;
  __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

  /* "tmm4py/tmm4py_core.pyx":1109
 * 
 *         c_pre = PyBytes_AsString(prefix.encode())
 *         if prefix2prefix is None:             # <<<<<<<<<<<<<<
 *           c_pre2pre = NULL
 *         else:
*/
  __pyx_t_6 = (__pyx_v_prefix2prefix == Py_None);
  if (__pyx_t_6) {

    /* "tmm4py/tmm4py_core.pyx":1110
 *         c_pre = PyBytes_AsString(prefix.encode())
 *         if prefix2prefix is None:
 *           c_pre2pre = NULL             # <<<<<<<<<<<<<<
 *         else:
 *           c_pre2pre = PyBytes_AsString(prefix2prefix.encode())
*/
    __pyx_v_c_pre2pre = NULL;

    /* "tmm4py/tmm4py_core.pyx":1109
 * 
 *         c_pre = PyBytes_AsString(prefix.encode())
 *         if prefix2prefix is None:             # <<<<<<<<<<<<<<
 *           c_pre2pre = NULL
 *         else:
*/
    goto __pyx_L14;
  }

  /* "tmm4py/tmm4py_core.pyx":1112
 *           c_pre2pre = NULL
 *         else:
 *           c_pre2pre = PyBytes_AsString(prefix2prefix.encode())             # <<<<<<<<<<<<<<
 * 
 *         ierr = TimeDependentTimerCreate(&newtimer)
*/
  /*else*/ {
    __pyx_t_4 = __pyx_v_prefix2prefix;
    __Pyx_INCREF(__pyx_t_4);
    __pyx_t_5 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
      __pyx_t_12 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1112, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
    }
    __pyx_t_19 = PyBytes_AsString(__pyx_t_12); if (unlikely(__pyx_t_19 == ((char *)0))) __PYX_ERR(0, 1112, __pyx_L1_error)
    __pyx_v_c_pre2pre = __pyx_t_19;
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
  }
  __pyx_L14:;

  /* "tmm4py/tmm4py_core.pyx":1114
 *           c_pre2pre = PyBytes_AsString(prefix2prefix.encode())
 * 
 *         ierr = TimeDependentTimerCreate(&newtimer)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.timer=newtimer
*/
  __pyx_v_ierr = TimeDependentTimerCreate((&__pyx_v_newtimer));

  /* "tmm4py/tmm4py_core.pyx":1115
 * 
 *         ierr = TimeDependentTimerCreate(&newtimer)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *         self.timer=newtimer
 *         ierr = TimeDependentTimerIni(c_pre, c_pre2pre, c_tdt, self.timer)
*/
  __pyx_t_6 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_6)) {
    __pyx_t_4 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1115, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1115, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1115, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
      assert(__pyx_t_4);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_1, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
      __pyx_t_12 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1115, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
    }
    __Pyx_Raise(__pyx_t_12, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __PYX_ERR(0, 1115, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1116
 *         ierr = TimeDependentTimerCreate(&newtimer)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.timer=newtimer             # <<<<<<<<<<<<<<
 *         ierr = TimeDependentTimerIni(c_pre, c_pre2pre, c_tdt, self.timer)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_v_self->timer = __pyx_v_newtimer;

  /* "tmm4py/tmm4py_core.pyx":1117
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.timer=newtimer
 *         ierr = TimeDependentTimerIni(c_pre, c_pre2pre, c_tdt, self.timer)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_v_ierr = TimeDependentTimerIni(__pyx_v_c_pre, __pyx_v_c_pre2pre, __pyx_v_c_tdt, __pyx_v_self->timer);

  /* "tmm4py/tmm4py_core.pyx":1118
 *         self.timer=newtimer
 *         ierr = TimeDependentTimerIni(c_pre, c_pre2pre, c_tdt, self.timer)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 *         return self
*/
  __pyx_t_6 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_6)) {
    __pyx_t_1 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1118, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1118, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1118, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
      assert(__pyx_t_1);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_2};
      __pyx_t_12 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1118, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
    }
    __Pyx_Raise(__pyx_t_12, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __PYX_ERR(0, 1118, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1120
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *         return self             # <<<<<<<<<<<<<<
 * 
 * cdef class PeriodicVec():
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1080
 *         pass
 * 
 *     def create(self, prefix="", prefix2prefix=None, np.ndarray[double, ndim=1, mode="c"] tdt=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_pre
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_XDECREF(__pyx_t_16);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_tdt.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentTimer.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_tdt.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF(__pyx_v_OptDB);
  __Pyx_XDECREF(__pyx_v_pre);
  __Pyx_XDECREF(__pyx_v_n);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_7__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentTimer_7__reduce_cython__ = {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_7__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_7__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__reduce_cython__", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__reduce_cython__", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer_6__reduce_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer_6__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce_cython__", 0);

  /* "(tree fragment)":2
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 2, __pyx_L1_error)

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentTimer.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_9__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentTimer_9__setstate_cython__ = {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_9__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_9__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v___pyx_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_pyx_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__setstate_cython__", 0) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, i); __PYX_ERR(1, 3, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
    }
    __pyx_v___pyx_state = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, __pyx_nargs); __PYX_ERR(1, 3, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentTimer.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer_8__setstate_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *)__pyx_v_self), __pyx_v___pyx_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentTimer_8__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setstate_cython__", 0);

  /* "(tree fragment)":4
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 4, __pyx_L1_error)

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentTimer.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1124
 * cdef class PeriodicVec():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.pvec = NULL
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__cinit__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec___cinit__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self) {
  int __pyx_r;

  /* "tmm4py/tmm4py_core.pyx":1125
 * 
 *     def __cinit__(self):
 *         self.pvec = NULL             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self):
*/
  __pyx_v_self->pvec = NULL;

  /* "tmm4py/tmm4py_core.pyx":1124
 * cdef class PeriodicVec():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.pvec = NULL
 * 
*/

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1127
 *         self.pvec = NULL
 * 
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         pass
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__init__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__init__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_2__init__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self) {
  int __pyx_r;

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1130
 *         pass
 * 
 *     def create(self, typ='tracer', np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscPeriodicVec newvec
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_11PeriodicVec_5create = {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_typ = 0;
  PyArrayObject *__pyx_v_buf = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("create (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_typ,&__pyx_mstate_global->__pyx_n_u_buf,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1130, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1130, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1130, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "create", 0) < 0) __PYX_ERR(0, 1130, __pyx_L3_error)
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_n_u_tracer));
      if (!values[1]) values[1] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1130, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1130, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_n_u_tracer));
      if (!values[1]) values[1] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
    }
    __pyx_v_typ = values[0];
    __pyx_v_buf = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("create", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1130, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicVec.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_buf), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 1, "buf", 0))) __PYX_ERR(0, 1130, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_4create(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)__pyx_v_self), __pyx_v_typ, __pyx_v_buf);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self, PyObject *__pyx_v_typ, PyArrayObject *__pyx_v_buf) {
  PetscErrorCode __pyx_v_ierr;
  PeriodicVec __pyx_v_newvec;
  PetscScalar *__pyx_v_data_pointer;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_buf;
  __Pyx_Buffer __pyx_pybuffer_buf;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  int __pyx_t_7;
  Py_ssize_t __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  Py_ssize_t __pyx_t_10;
  int __pyx_t_11;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("create", 0);
  __pyx_pybuffer_buf.pybuffer.buf = NULL;
  __pyx_pybuffer_buf.refcount = 0;
  __pyx_pybuffernd_buf.data = NULL;
  __pyx_pybuffernd_buf.rcbuffer = &__pyx_pybuffer_buf;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_buf.rcbuffer->pybuffer, (PyObject*)__pyx_v_buf, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1130, __pyx_L1_error)
  }
  __pyx_pybuffernd_buf.diminfo[0].strides = __pyx_pybuffernd_buf.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_buf.diminfo[0].shape = __pyx_pybuffernd_buf.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1135
 *         cdef PetscScalar *data_pointer
 * 
 *         ierr = PeriodicVecCreate(&newvec)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.pvec=newvec
*/
  __pyx_v_ierr = PeriodicVecCreate((&__pyx_v_newvec));

  /* "tmm4py/tmm4py_core.pyx":1136
 * 
 *         ierr = PeriodicVecCreate(&newvec)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *         self.pvec=newvec
 * 
*/
  __pyx_t_1 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_1)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1136, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1137
 *         ierr = PeriodicVecCreate(&newvec)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.pvec=newvec             # <<<<<<<<<<<<<<
 * 
 *         if typ is None or typ is 'tracer':
*/
  __pyx_v_self->pvec = __pyx_v_newvec;

  /* "tmm4py/tmm4py_core.pyx":1139
 *         self.pvec=newvec
 * 
 *         if typ is None or typ is 'tracer':             # <<<<<<<<<<<<<<
 *           self.lDim = lSize
 *         else:
*/
  __pyx_t_7 = (__pyx_v_typ == Py_None);
  if (!__pyx_t_7) {
  } else {
    __pyx_t_1 = __pyx_t_7;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_7 = (__pyx_v_typ == __pyx_mstate_global->__pyx_n_u_tracer);
  __pyx_t_1 = __pyx_t_7;
  __pyx_L5_bool_binop_done:;
  if (__pyx_t_1) {

    /* "tmm4py/tmm4py_core.pyx":1140
 * 
 *         if typ is None or typ is 'tracer':
 *           self.lDim = lSize             # <<<<<<<<<<<<<<
 *         else:
 *           self.lDim = lBCSize
*/
    __pyx_v_self->lDim = lSize;

    /* "tmm4py/tmm4py_core.pyx":1139
 *         self.pvec=newvec
 * 
 *         if typ is None or typ is 'tracer':             # <<<<<<<<<<<<<<
 *           self.lDim = lSize
 *         else:
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":1142
 *           self.lDim = lSize
 *         else:
 *           self.lDim = lBCSize             # <<<<<<<<<<<<<<
 * 
 *         if buf is None:
*/
  /*else*/ {
    __pyx_v_self->lDim = lBCSize;
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":1144
 *           self.lDim = lBCSize
 * 
 *         if buf is None:             # <<<<<<<<<<<<<<
 *           self.frombuf = 0
 *           ierr = VecCreateFromLocalSize(self.lDim, &self.c)
*/
  __pyx_t_1 = (((PyObject *)__pyx_v_buf) == Py_None);
  if (__pyx_t_1) {

    /* "tmm4py/tmm4py_core.pyx":1145
 * 
 *         if buf is None:
 *           self.frombuf = 0             # <<<<<<<<<<<<<<
 *           ierr = VecCreateFromLocalSize(self.lDim, &self.c)
 *           if ierr != 0: raise PETSc.Error(ierr)
*/
    __pyx_v_self->frombuf = 0;

    /* "tmm4py/tmm4py_core.pyx":1146
 *         if buf is None:
 *           self.frombuf = 0
 *           ierr = VecCreateFromLocalSize(self.lDim, &self.c)             # <<<<<<<<<<<<<<
 *           if ierr != 0: raise PETSc.Error(ierr)
 *           ierr = VecGetArray(self.c, &data_pointer)
*/
    __pyx_v_ierr = VecCreateFromLocalSize(__pyx_v_self->lDim, (&__pyx_v_self->c));

    /* "tmm4py/tmm4py_core.pyx":1147
 *           self.frombuf = 0
 *           ierr = VecCreateFromLocalSize(self.lDim, &self.c)
 *           if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *           ierr = VecGetArray(self.c, &data_pointer)
 *           if ierr != 0: raise PETSc.Error(ierr)
*/
    __pyx_t_1 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_1)) {
      __pyx_t_5 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1147, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1147, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1147, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_6 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
        assert(__pyx_t_5);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_3, __pyx__function);
        __pyx_t_6 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1147, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __PYX_ERR(0, 1147, __pyx_L1_error)
    }

    /* "tmm4py/tmm4py_core.pyx":1148
 *           ierr = VecCreateFromLocalSize(self.lDim, &self.c)
 *           if ierr != 0: raise PETSc.Error(ierr)
 *           ierr = VecGetArray(self.c, &data_pointer)             # <<<<<<<<<<<<<<
 *           if ierr != 0: raise PETSc.Error(ierr)
 * #         Note: the memory is owned by self.c
*/
    __pyx_v_ierr = VecGetArray(__pyx_v_self->c, (&__pyx_v_data_pointer));

    /* "tmm4py/tmm4py_core.pyx":1149
 *           if ierr != 0: raise PETSc.Error(ierr)
 *           ierr = VecGetArray(self.c, &data_pointer)
 *           if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         Note: the memory is owned by self.c
 *         else:
*/
    __pyx_t_1 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_1)) {
      __pyx_t_3 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1149, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1149, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1149, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_6 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_5))) {
        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
        assert(__pyx_t_3);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
        __pyx_t_6 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1149, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __PYX_ERR(0, 1149, __pyx_L1_error)
    }

    /* "tmm4py/tmm4py_core.pyx":1144
 *           self.lDim = lBCSize
 * 
 *         if buf is None:             # <<<<<<<<<<<<<<
 *           self.frombuf = 0
 *           ierr = VecCreateFromLocalSize(self.lDim, &self.c)
*/
    goto __pyx_L7;
  }

  /* "tmm4py/tmm4py_core.pyx":1152
 * #         Note: the memory is owned by self.c
 *         else:
 *           if len(buf) != self.lDim:             # <<<<<<<<<<<<<<
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1
*/
  /*else*/ {
    __pyx_t_8 = PyObject_Length(((PyObject *)__pyx_v_buf)); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1152, __pyx_L1_error)
    __pyx_t_1 = (__pyx_t_8 != __pyx_v_self->lDim);
    if (unlikely(__pyx_t_1)) {

      /* "tmm4py/tmm4py_core.pyx":1153
 *         else:
 *           if len(buf) != self.lDim:
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")             # <<<<<<<<<<<<<<
 *           self.frombuf = 1
 *           data_pointer = &buf[0]
*/
      __pyx_t_5 = NULL;
      __Pyx_INCREF(__pyx_builtin_RuntimeError);
      __pyx_t_4 = __pyx_builtin_RuntimeError; 
      __pyx_t_3 = __Pyx_PyLong_From_PetscInt(__pyx_v_self->lDim); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1153, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_t_3, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1153, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_Provided_array_length_does_not_m, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1153, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_6 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_3};
        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1153, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __PYX_ERR(0, 1153, __pyx_L1_error)

      /* "tmm4py/tmm4py_core.pyx":1152
 * #         Note: the memory is owned by self.c
 *         else:
 *           if len(buf) != self.lDim:             # <<<<<<<<<<<<<<
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1
*/
    }

    /* "tmm4py/tmm4py_core.pyx":1154
 *           if len(buf) != self.lDim:
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1             # <<<<<<<<<<<<<<
 *           data_pointer = &buf[0]
 *           ierr = VecCreateWithArrayFromLocalSize(self.lDim, data_pointer, &self.c)
*/
    __pyx_v_self->frombuf = 1;

    /* "tmm4py/tmm4py_core.pyx":1155
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1
 *           data_pointer = &buf[0]             # <<<<<<<<<<<<<<
 *           ierr = VecCreateWithArrayFromLocalSize(self.lDim, data_pointer, &self.c)
 *           if ierr != 0: raise PETSc.Error(ierr)
*/
    __pyx_t_10 = 0;
    __pyx_t_11 = -1;
    if (__pyx_t_10 < 0) {
      __pyx_t_10 += __pyx_pybuffernd_buf.diminfo[0].shape;
      if (unlikely(__pyx_t_10 < 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 >= __pyx_pybuffernd_buf.diminfo[0].shape)) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      __Pyx_RaiseBufferIndexError(__pyx_t_11);
      __PYX_ERR(0, 1155, __pyx_L1_error)
    }
    __pyx_v_data_pointer = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_buf.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_buf.diminfo[0].strides)));

    /* "tmm4py/tmm4py_core.pyx":1156
 *           self.frombuf = 1
 *           data_pointer = &buf[0]
 *           ierr = VecCreateWithArrayFromLocalSize(self.lDim, data_pointer, &self.c)             # <<<<<<<<<<<<<<
 *           if ierr != 0: raise PETSc.Error(ierr)
 * #         Note: the memory is owned by the array buf (which may be owned by a vec)
*/
    __pyx_v_ierr = VecCreateWithArrayFromLocalSize(__pyx_v_self->lDim, __pyx_v_data_pointer, (&__pyx_v_self->c));

    /* "tmm4py/tmm4py_core.pyx":1157
 *           data_pointer = &buf[0]
 *           ierr = VecCreateWithArrayFromLocalSize(self.lDim, data_pointer, &self.c)
 *           if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         Note: the memory is owned by the array buf (which may be owned by a vec)
 * 
*/
    __pyx_t_1 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_1)) {
      __pyx_t_4 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1157, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1157, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1157, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_6 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_5))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
        assert(__pyx_t_4);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
        __pyx_t_6 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_3};
        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1157, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __PYX_ERR(0, 1157, __pyx_L1_error)
    }
  }
  __pyx_L7:;

  /* "tmm4py/tmm4py_core.pyx":1160
 * #         Note: the memory is owned by the array buf (which may be owned by a vec)
 * 
 *         self.arr = _ToNumpyRealArray(self.lDim, data_pointer, self.c, "")             # <<<<<<<<<<<<<<
 * 
 *         return self
*/
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArray(__pyx_v_self->lDim, __pyx_v_data_pointer, __pyx_v_self->c, __pyx_mstate_global->__pyx_kp_u_); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(__pyx_v_self->arr);
  __Pyx_DECREF(__pyx_v_self->arr);
  __pyx_v_self->arr = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":1162
 *         self.arr = _ToNumpyRealArray(self.lDim, data_pointer, self.c, "")
 * 
 *         return self             # <<<<<<<<<<<<<<
 * 
 *     def interp(self, tc, PeriodicTimer timer, filename):
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1130
 *         pass
 * 
 *     def create(self, typ='tracer', np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscPeriodicVec newvec
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_9);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_buf.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicVec.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_buf.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1164
 *         return self
 * 
 *     def interp(self, tc, PeriodicTimer timer, filename):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscErrorCode ierr
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_7interp(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_11PeriodicVec_7interp = {"interp", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_7interp, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_7interp(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_tc = 0;
  struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_timer = 0;
  PyObject *__pyx_v_filename = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("interp (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_timer,&__pyx_mstate_global->__pyx_n_u_filename,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1164, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1164, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1164, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1164, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "interp", 0) < 0) __PYX_ERR(0, 1164, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 3; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("interp", 1, 3, 3, i); __PYX_ERR(0, 1164, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1164, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1164, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1164, __pyx_L3_error)
    }
    __pyx_v_tc = values[0];
    __pyx_v_timer = ((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *)values[1]);
    __pyx_v_filename = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("interp", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 1164, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicVec.interp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_timer), __pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer, 1, "timer", 0))) __PYX_ERR(0, 1164, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_6interp(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)__pyx_v_self), __pyx_v_tc, __pyx_v_timer, __pyx_v_filename);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_6interp(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self, PyObject *__pyx_v_tc, struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_timer, PyObject *__pyx_v_filename) {
  PetscScalar __pyx_v_tcc;
  PetscErrorCode __pyx_v_ierr;
  char const *__pyx_v_c_filename;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscReal __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  size_t __pyx_t_4;
  char *__pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("interp", 0);

  /* "tmm4py/tmm4py_core.pyx":1165
 * 
 *     def interp(self, tc, PeriodicTimer timer, filename):
 *         cdef PetscScalar tcc = asReal(tc)             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_filename
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asReal(__pyx_v_tc); if (unlikely(__pyx_t_1 == ((PetscReal)-1.0) && PyErr_Occurred())) __PYX_ERR(0, 1165, __pyx_L1_error)
  __pyx_v_tcc = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":1169
 *         cdef const char* c_filename
 * 
 *         c_filename = PyBytes_AsString(filename.encode())             # <<<<<<<<<<<<<<
 *         ierr = PeriodicVecInterp(tcc, &self.c, timer.timer.cyclePeriod, timer.timer.numPerPeriod, timer.timer.tdp, self.pvec, c_filename)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_t_3 = __pyx_v_filename;
  __Pyx_INCREF(__pyx_t_3);
  __pyx_t_4 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_2 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1169, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  }
  __pyx_t_5 = PyBytes_AsString(__pyx_t_2); if (unlikely(__pyx_t_5 == ((char *)0))) __PYX_ERR(0, 1169, __pyx_L1_error)
  __pyx_v_c_filename = __pyx_t_5;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":1170
 * 
 *         c_filename = PyBytes_AsString(filename.encode())
 *         ierr = PeriodicVecInterp(tcc, &self.c, timer.timer.cyclePeriod, timer.timer.numPerPeriod, timer.timer.tdp, self.pvec, c_filename)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_v_ierr = PeriodicVecInterp(__pyx_v_tcc, (&__pyx_v_self->c), __pyx_v_timer->timer->cyclePeriod, __pyx_v_timer->timer->numPerPeriod, __pyx_v_timer->timer->tdp, __pyx_v_self->pvec, __pyx_v_c_filename);

  /* "tmm4py/tmm4py_core.pyx":1171
 *         c_filename = PyBytes_AsString(filename.encode())
 *         ierr = PeriodicVecInterp(tcc, &self.c, timer.timer.cyclePeriod, timer.timer.numPerPeriod, timer.timer.tdp, self.pvec, c_filename)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 *     def destroy(self):
*/
  __pyx_t_6 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_6)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1171, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1171, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1171, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_4 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_8);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_8);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_8, __pyx__function);
      __pyx_t_4 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_7};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1171, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1171, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1164
 *         return self
 * 
 *     def interp(self, tc, PeriodicTimer timer, filename):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscErrorCode ierr
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicVec.interp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1173
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def destroy(self):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_9destroy(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_11PeriodicVec_9destroy = {"destroy", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_9destroy, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_9destroy(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("destroy (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("destroy", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("destroy", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_8destroy(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_8destroy(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self) {
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("destroy", 0);

  /* "tmm4py/tmm4py_core.pyx":1176
 *         cdef PetscErrorCode ierr
 * 
 *         del self.arr # calls VecRestoreArray (??????)             # <<<<<<<<<<<<<<
 *         ierr = VecDestroy(&self.c)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  if (__Pyx_PyObject_DelAttrStr(((PyObject *)__pyx_v_self), __pyx_mstate_global->__pyx_n_u_arr) < 0) __PYX_ERR(0, 1176, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":1177
 * 
 *         del self.arr # calls VecRestoreArray (??????)
 *         ierr = VecDestroy(&self.c)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         ierr = PeriodicVecDestroy(&self.pvec)
*/
  __pyx_v_ierr = VecDestroy((&__pyx_v_self->c));

  /* "tmm4py/tmm4py_core.pyx":1178
 *         del self.arr # calls VecRestoreArray (??????)
 *         ierr = VecDestroy(&self.c)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *         ierr = PeriodicVecDestroy(&self.pvec)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_t_1 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_1)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1178, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1178, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1178, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1178, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1178, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1179
 *         ierr = VecDestroy(&self.c)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         ierr = PeriodicVecDestroy(&self.pvec)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_v_ierr = PeriodicVecDestroy((&__pyx_v_self->pvec));

  /* "tmm4py/tmm4py_core.pyx":1180
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         ierr = PeriodicVecDestroy(&self.pvec)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 * cdef class TimeDependentVec():
*/
  __pyx_t_1 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_1)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1180, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1180, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1180, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_3, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1180, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1180, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1173
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def destroy(self):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicVec.destroy", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":175
 *     cdef PetscInt frombuf
 *     cdef public:
 *       object arr             # <<<<<<<<<<<<<<
 * 
 * cdef class TimeDependentVec:
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_3arr___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_3arr___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->arr);
  __pyx_r = __pyx_v_self->arr;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->arr);
  __Pyx_DECREF(__pyx_v_self->arr);
  __pyx_v_self->arr = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->arr);
  __Pyx_DECREF(__pyx_v_self->arr);
  __pyx_v_self->arr = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_11__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_11PeriodicVec_11__reduce_cython__ = {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_11__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_11__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__reduce_cython__", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__reduce_cython__", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_10__reduce_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_10__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce_cython__", 0);

  /* "(tree fragment)":2
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 2, __pyx_L1_error)

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicVec.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_13__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_11PeriodicVec_13__setstate_cython__ = {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_13__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_13__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v___pyx_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_pyx_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__setstate_cython__", 0) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, i); __PYX_ERR(1, 3, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
    }
    __pyx_v___pyx_state = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, __pyx_nargs); __PYX_ERR(1, 3, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicVec.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_12__setstate_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)__pyx_v_self), __pyx_v___pyx_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_11PeriodicVec_12__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setstate_cython__", 0);

  /* "(tree fragment)":4
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 4, __pyx_L1_error)

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicVec.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1184
 * cdef class TimeDependentVec():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.pvec = NULL
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__cinit__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec___cinit__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self) {
  int __pyx_r;

  /* "tmm4py/tmm4py_core.pyx":1185
 * 
 *     def __cinit__(self):
 *         self.pvec = NULL             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self):
*/
  __pyx_v_self->pvec = NULL;

  /* "tmm4py/tmm4py_core.pyx":1184
 * cdef class TimeDependentVec():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.pvec = NULL
 * 
*/

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1187
 *         self.pvec = NULL
 * 
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         pass
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__init__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__init__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_2__init__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self) {
  int __pyx_r;

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1190
 *         pass
 * 
 *     def create(self, typ='tracer', np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscTimeDependentVec newvec
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_16TimeDependentVec_5create = {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_typ = 0;
  PyArrayObject *__pyx_v_buf = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("create (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_typ,&__pyx_mstate_global->__pyx_n_u_buf,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1190, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1190, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1190, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "create", 0) < 0) __PYX_ERR(0, 1190, __pyx_L3_error)
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_n_u_tracer));
      if (!values[1]) values[1] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1190, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1190, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)__pyx_mstate_global->__pyx_n_u_tracer));
      if (!values[1]) values[1] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
    }
    __pyx_v_typ = values[0];
    __pyx_v_buf = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("create", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1190, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentVec.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_buf), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 1, "buf", 0))) __PYX_ERR(0, 1190, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_4create(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)__pyx_v_self), __pyx_v_typ, __pyx_v_buf);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self, PyObject *__pyx_v_typ, PyArrayObject *__pyx_v_buf) {
  PetscErrorCode __pyx_v_ierr;
  TimeDependentVec __pyx_v_newvec;
  PetscScalar *__pyx_v_data_pointer;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_buf;
  __Pyx_Buffer __pyx_pybuffer_buf;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  int __pyx_t_7;
  Py_ssize_t __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  Py_ssize_t __pyx_t_10;
  int __pyx_t_11;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("create", 0);
  __pyx_pybuffer_buf.pybuffer.buf = NULL;
  __pyx_pybuffer_buf.refcount = 0;
  __pyx_pybuffernd_buf.data = NULL;
  __pyx_pybuffernd_buf.rcbuffer = &__pyx_pybuffer_buf;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_buf.rcbuffer->pybuffer, (PyObject*)__pyx_v_buf, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1190, __pyx_L1_error)
  }
  __pyx_pybuffernd_buf.diminfo[0].strides = __pyx_pybuffernd_buf.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_buf.diminfo[0].shape = __pyx_pybuffernd_buf.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1195
 *         cdef PetscScalar *data_pointer
 * 
 *         ierr = TimeDependentVecCreate(&newvec)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.pvec=newvec
*/
  __pyx_v_ierr = TimeDependentVecCreate((&__pyx_v_newvec));

  /* "tmm4py/tmm4py_core.pyx":1196
 * 
 *         ierr = TimeDependentVecCreate(&newvec)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *         self.pvec=newvec
 * 
*/
  __pyx_t_1 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_1)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1196, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1196, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1196, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1196, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1196, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1197
 *         ierr = TimeDependentVecCreate(&newvec)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.pvec=newvec             # <<<<<<<<<<<<<<
 * 
 *         if typ is None or typ is 'tracer':
*/
  __pyx_v_self->pvec = __pyx_v_newvec;

  /* "tmm4py/tmm4py_core.pyx":1199
 *         self.pvec=newvec
 * 
 *         if typ is None or typ is 'tracer':             # <<<<<<<<<<<<<<
 *           self.lDim = lSize
 *         else:
*/
  __pyx_t_7 = (__pyx_v_typ == Py_None);
  if (!__pyx_t_7) {
  } else {
    __pyx_t_1 = __pyx_t_7;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_7 = (__pyx_v_typ == __pyx_mstate_global->__pyx_n_u_tracer);
  __pyx_t_1 = __pyx_t_7;
  __pyx_L5_bool_binop_done:;
  if (__pyx_t_1) {

    /* "tmm4py/tmm4py_core.pyx":1200
 * 
 *         if typ is None or typ is 'tracer':
 *           self.lDim = lSize             # <<<<<<<<<<<<<<
 *         else:
 *           self.lDim = lBCSize
*/
    __pyx_v_self->lDim = lSize;

    /* "tmm4py/tmm4py_core.pyx":1199
 *         self.pvec=newvec
 * 
 *         if typ is None or typ is 'tracer':             # <<<<<<<<<<<<<<
 *           self.lDim = lSize
 *         else:
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":1202
 *           self.lDim = lSize
 *         else:
 *           self.lDim = lBCSize             # <<<<<<<<<<<<<<
 * 
 *         if buf is None:
*/
  /*else*/ {
    __pyx_v_self->lDim = lBCSize;
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":1204
 *           self.lDim = lBCSize
 * 
 *         if buf is None:             # <<<<<<<<<<<<<<
 *           self.frombuf = 0
 *           ierr = VecCreateFromLocalSize(self.lDim, &self.c)
*/
  __pyx_t_1 = (((PyObject *)__pyx_v_buf) == Py_None);
  if (__pyx_t_1) {

    /* "tmm4py/tmm4py_core.pyx":1205
 * 
 *         if buf is None:
 *           self.frombuf = 0             # <<<<<<<<<<<<<<
 *           ierr = VecCreateFromLocalSize(self.lDim, &self.c)
 *           if ierr != 0: raise PETSc.Error(ierr)
*/
    __pyx_v_self->frombuf = 0;

    /* "tmm4py/tmm4py_core.pyx":1206
 *         if buf is None:
 *           self.frombuf = 0
 *           ierr = VecCreateFromLocalSize(self.lDim, &self.c)             # <<<<<<<<<<<<<<
 *           if ierr != 0: raise PETSc.Error(ierr)
 *           ierr = VecGetArray(self.c, &data_pointer)
*/
    __pyx_v_ierr = VecCreateFromLocalSize(__pyx_v_self->lDim, (&__pyx_v_self->c));

    /* "tmm4py/tmm4py_core.pyx":1207
 *           self.frombuf = 0
 *           ierr = VecCreateFromLocalSize(self.lDim, &self.c)
 *           if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *           ierr = VecGetArray(self.c, &data_pointer)
 *           if ierr != 0: raise PETSc.Error(ierr)
*/
    __pyx_t_1 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_1)) {
      __pyx_t_5 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1207, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1207, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1207, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_6 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
        assert(__pyx_t_5);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_3, __pyx__function);
        __pyx_t_6 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1207, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __PYX_ERR(0, 1207, __pyx_L1_error)
    }

    /* "tmm4py/tmm4py_core.pyx":1208
 *           ierr = VecCreateFromLocalSize(self.lDim, &self.c)
 *           if ierr != 0: raise PETSc.Error(ierr)
 *           ierr = VecGetArray(self.c, &data_pointer)             # <<<<<<<<<<<<<<
 *           if ierr != 0: raise PETSc.Error(ierr)
 * #         Note: the memory is owned by self.c
*/
    __pyx_v_ierr = VecGetArray(__pyx_v_self->c, (&__pyx_v_data_pointer));

    /* "tmm4py/tmm4py_core.pyx":1209
 *           if ierr != 0: raise PETSc.Error(ierr)
 *           ierr = VecGetArray(self.c, &data_pointer)
 *           if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         Note: the memory is owned by self.c
 *         else:
*/
    __pyx_t_1 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_1)) {
      __pyx_t_3 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1209, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1209, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1209, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_6 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_5))) {
        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
        assert(__pyx_t_3);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
        __pyx_t_6 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1209, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __PYX_ERR(0, 1209, __pyx_L1_error)
    }

    /* "tmm4py/tmm4py_core.pyx":1204
 *           self.lDim = lBCSize
 * 
 *         if buf is None:             # <<<<<<<<<<<<<<
 *           self.frombuf = 0
 *           ierr = VecCreateFromLocalSize(self.lDim, &self.c)
*/
    goto __pyx_L7;
  }

  /* "tmm4py/tmm4py_core.pyx":1212
 * #         Note: the memory is owned by self.c
 *         else:
 *           if len(buf) != self.lDim:             # <<<<<<<<<<<<<<
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1
*/
  /*else*/ {
    __pyx_t_8 = PyObject_Length(((PyObject *)__pyx_v_buf)); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1212, __pyx_L1_error)
    __pyx_t_1 = (__pyx_t_8 != __pyx_v_self->lDim);
    if (unlikely(__pyx_t_1)) {

      /* "tmm4py/tmm4py_core.pyx":1213
 *         else:
 *           if len(buf) != self.lDim:
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")             # <<<<<<<<<<<<<<
 *           self.frombuf = 1
 *           data_pointer = &buf[0]
*/
      __pyx_t_5 = NULL;
      __Pyx_INCREF(__pyx_builtin_RuntimeError);
      __pyx_t_4 = __pyx_builtin_RuntimeError; 
      __pyx_t_3 = __Pyx_PyLong_From_PetscInt(__pyx_v_self->lDim); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1213, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_t_3, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1213, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_Provided_array_length_does_not_m, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1213, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_6 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_3};
        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1213, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __PYX_ERR(0, 1213, __pyx_L1_error)

      /* "tmm4py/tmm4py_core.pyx":1212
 * #         Note: the memory is owned by self.c
 *         else:
 *           if len(buf) != self.lDim:             # <<<<<<<<<<<<<<
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1
*/
    }

    /* "tmm4py/tmm4py_core.pyx":1214
 *           if len(buf) != self.lDim:
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1             # <<<<<<<<<<<<<<
 *           data_pointer = &buf[0]
 *           ierr = VecCreateWithArrayFromLocalSize(self.lDim, data_pointer, &self.c)
*/
    __pyx_v_self->frombuf = 1;

    /* "tmm4py/tmm4py_core.pyx":1215
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1
 *           data_pointer = &buf[0]             # <<<<<<<<<<<<<<
 *           ierr = VecCreateWithArrayFromLocalSize(self.lDim, data_pointer, &self.c)
 *           if ierr != 0: raise PETSc.Error(ierr)
*/
    __pyx_t_10 = 0;
    __pyx_t_11 = -1;
    if (__pyx_t_10 < 0) {
      __pyx_t_10 += __pyx_pybuffernd_buf.diminfo[0].shape;
      if (unlikely(__pyx_t_10 < 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 >= __pyx_pybuffernd_buf.diminfo[0].shape)) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      __Pyx_RaiseBufferIndexError(__pyx_t_11);
      __PYX_ERR(0, 1215, __pyx_L1_error)
    }
    __pyx_v_data_pointer = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_buf.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_buf.diminfo[0].strides)));

    /* "tmm4py/tmm4py_core.pyx":1216
 *           self.frombuf = 1
 *           data_pointer = &buf[0]
 *           ierr = VecCreateWithArrayFromLocalSize(self.lDim, data_pointer, &self.c)             # <<<<<<<<<<<<<<
 *           if ierr != 0: raise PETSc.Error(ierr)
 * #         Note: the memory is owned by the array buf (which may be owned by a vec)
*/
    __pyx_v_ierr = VecCreateWithArrayFromLocalSize(__pyx_v_self->lDim, __pyx_v_data_pointer, (&__pyx_v_self->c));

    /* "tmm4py/tmm4py_core.pyx":1217
 *           data_pointer = &buf[0]
 *           ierr = VecCreateWithArrayFromLocalSize(self.lDim, data_pointer, &self.c)
 *           if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #         Note: the memory is owned by the array buf (which may be owned by a vec)
 * 
*/
    __pyx_t_1 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_1)) {
      __pyx_t_4 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1217, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1217, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1217, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_6 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_5))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
        assert(__pyx_t_4);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
        __pyx_t_6 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_3};
        __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1217, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __PYX_ERR(0, 1217, __pyx_L1_error)
    }
  }
  __pyx_L7:;

  /* "tmm4py/tmm4py_core.pyx":1220
 * #         Note: the memory is owned by the array buf (which may be owned by a vec)
 * 
 *         self.arr = _ToNumpyRealArray(self.lDim, data_pointer, self.c, "")             # <<<<<<<<<<<<<<
 * 
 *         return self
*/
  __pyx_t_2 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArray(__pyx_v_self->lDim, __pyx_v_data_pointer, __pyx_v_self->c, __pyx_mstate_global->__pyx_kp_u_); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1220, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_GOTREF(__pyx_v_self->arr);
  __Pyx_DECREF(__pyx_v_self->arr);
  __pyx_v_self->arr = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":1222
 *         self.arr = _ToNumpyRealArray(self.lDim, data_pointer, self.c, "")
 * 
 *         return self             # <<<<<<<<<<<<<<
 * 
 *     def interp(self, tc, TimeDependentTimer timer, filename):
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1190
 *         pass
 * 
 *     def create(self, typ='tracer', np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscTimeDependentVec newvec
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_9);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_buf.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentVec.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_buf.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1224
 *         return self
 * 
 *     def interp(self, tc, TimeDependentTimer timer, filename):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscErrorCode ierr
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_7interp(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_16TimeDependentVec_7interp = {"interp", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_7interp, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_7interp(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_tc = 0;
  struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_timer = 0;
  PyObject *__pyx_v_filename = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("interp (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_timer,&__pyx_mstate_global->__pyx_n_u_filename,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1224, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1224, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1224, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1224, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "interp", 0) < 0) __PYX_ERR(0, 1224, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 3; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("interp", 1, 3, 3, i); __PYX_ERR(0, 1224, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1224, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1224, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1224, __pyx_L3_error)
    }
    __pyx_v_tc = values[0];
    __pyx_v_timer = ((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *)values[1]);
    __pyx_v_filename = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("interp", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 1224, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentVec.interp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_timer), __pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer, 1, "timer", 0))) __PYX_ERR(0, 1224, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_6interp(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)__pyx_v_self), __pyx_v_tc, __pyx_v_timer, __pyx_v_filename);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_6interp(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self, PyObject *__pyx_v_tc, struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_timer, PyObject *__pyx_v_filename) {
  PetscScalar __pyx_v_tcc;
  PetscErrorCode __pyx_v_ierr;
  char const *__pyx_v_c_filename;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscReal __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  size_t __pyx_t_4;
  char *__pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("interp", 0);

  /* "tmm4py/tmm4py_core.pyx":1225
 * 
 *     def interp(self, tc, TimeDependentTimer timer, filename):
 *         cdef PetscScalar tcc = asReal(tc)             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_filename
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asReal(__pyx_v_tc); if (unlikely(__pyx_t_1 == ((PetscReal)-1.0) && PyErr_Occurred())) __PYX_ERR(0, 1225, __pyx_L1_error)
  __pyx_v_tcc = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":1229
 *         cdef const char* c_filename
 * 
 *         c_filename = PyBytes_AsString(filename.encode())             # <<<<<<<<<<<<<<
 *         ierr = TimeDependentVecInterp(tcc, &self.c, timer.timer.numTimes, timer.timer.tdt, self.pvec, c_filename)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_t_3 = __pyx_v_filename;
  __Pyx_INCREF(__pyx_t_3);
  __pyx_t_4 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_2 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1229, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  }
  __pyx_t_5 = PyBytes_AsString(__pyx_t_2); if (unlikely(__pyx_t_5 == ((char *)0))) __PYX_ERR(0, 1229, __pyx_L1_error)
  __pyx_v_c_filename = __pyx_t_5;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":1230
 * 
 *         c_filename = PyBytes_AsString(filename.encode())
 *         ierr = TimeDependentVecInterp(tcc, &self.c, timer.timer.numTimes, timer.timer.tdt, self.pvec, c_filename)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_v_ierr = TimeDependentVecInterp(__pyx_v_tcc, (&__pyx_v_self->c), __pyx_v_timer->timer->numTimes, __pyx_v_timer->timer->tdt, __pyx_v_self->pvec, __pyx_v_c_filename);

  /* "tmm4py/tmm4py_core.pyx":1231
 *         c_filename = PyBytes_AsString(filename.encode())
 *         ierr = TimeDependentVecInterp(tcc, &self.c, timer.timer.numTimes, timer.timer.tdt, self.pvec, c_filename)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 *     def destroy(self):
*/
  __pyx_t_6 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_6)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1231, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1231, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1231, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_4 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_8);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_8);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_8, __pyx__function);
      __pyx_t_4 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_7};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1231, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1231, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1224
 *         return self
 * 
 *     def interp(self, tc, TimeDependentTimer timer, filename):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscErrorCode ierr
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentVec.interp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1233
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def destroy(self):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_9destroy(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_16TimeDependentVec_9destroy = {"destroy", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_9destroy, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_9destroy(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("destroy (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("destroy", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("destroy", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_8destroy(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_8destroy(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self) {
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("destroy", 0);

  /* "tmm4py/tmm4py_core.pyx":1236
 *         cdef PetscErrorCode ierr
 * 
 *         del self.arr # calls VecRestoreArray (??????)             # <<<<<<<<<<<<<<
 *         ierr = VecDestroy(&self.c)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  if (__Pyx_PyObject_DelAttrStr(((PyObject *)__pyx_v_self), __pyx_mstate_global->__pyx_n_u_arr) < 0) __PYX_ERR(0, 1236, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":1237
 * 
 *         del self.arr # calls VecRestoreArray (??????)
 *         ierr = VecDestroy(&self.c)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         ierr = TimeDependentVecDestroy(&self.pvec)
*/
  __pyx_v_ierr = VecDestroy((&__pyx_v_self->c));

  /* "tmm4py/tmm4py_core.pyx":1238
 *         del self.arr # calls VecRestoreArray (??????)
 *         ierr = VecDestroy(&self.c)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *         ierr = TimeDependentVecDestroy(&self.pvec)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_t_1 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_1)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1238, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1238, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1238, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1238, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1238, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1239
 *         ierr = VecDestroy(&self.c)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         ierr = TimeDependentVecDestroy(&self.pvec)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_v_ierr = TimeDependentVecDestroy((&__pyx_v_self->pvec));

  /* "tmm4py/tmm4py_core.pyx":1240
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         ierr = TimeDependentVecDestroy(&self.pvec)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 * cdef class PeriodicArray():
*/
  __pyx_t_1 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_1)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1240, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1240, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1240, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_3, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1240, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1240, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1233
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def destroy(self):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentVec.destroy", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":183
 *     cdef PetscInt frombuf
 *     cdef public:
 *       object arr             # <<<<<<<<<<<<<<
 * 
 * cdef class PeriodicArray:
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->arr);
  __pyx_r = __pyx_v_self->arr;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->arr);
  __Pyx_DECREF(__pyx_v_self->arr);
  __pyx_v_self->arr = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->arr);
  __Pyx_DECREF(__pyx_v_self->arr);
  __pyx_v_self->arr = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_11__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_16TimeDependentVec_11__reduce_cython__ = {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_11__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_11__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__reduce_cython__", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__reduce_cython__", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_10__reduce_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_10__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce_cython__", 0);

  /* "(tree fragment)":2
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 2, __pyx_L1_error)

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentVec.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_13__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_16TimeDependentVec_13__setstate_cython__ = {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_13__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_13__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v___pyx_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_pyx_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__setstate_cython__", 0) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, i); __PYX_ERR(1, 3, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
    }
    __pyx_v___pyx_state = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, __pyx_nargs); __PYX_ERR(1, 3, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentVec.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_12__setstate_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)__pyx_v_self), __pyx_v___pyx_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16TimeDependentVec_12__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setstate_cython__", 0);

  /* "(tree fragment)":4
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 4, __pyx_L1_error)

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentVec.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1244
 * cdef class PeriodicArray():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.parr = NULL
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__cinit__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray___cinit__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self) {
  int __pyx_r;

  /* "tmm4py/tmm4py_core.pyx":1245
 * 
 *     def __cinit__(self):
 *         self.parr = NULL             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self):
*/
  __pyx_v_self->parr = NULL;

  /* "tmm4py/tmm4py_core.pyx":1244
 * cdef class PeriodicArray():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.parr = NULL
 * 
*/

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1247
 *         self.parr = NULL
 * 
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         pass
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__init__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__init__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_2__init__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self) {
  int __pyx_r;

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1250
 *         pass
 * 
 *     def create(self, arrayLength, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscPeriodicArray newarr
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicArray_5create = {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_arrayLength = 0;
  PyArrayObject *__pyx_v_buf = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("create (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_arrayLength,&__pyx_mstate_global->__pyx_n_u_buf,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1250, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1250, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1250, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "create", 0) < 0) __PYX_ERR(0, 1250, __pyx_L3_error)
      if (!values[1]) values[1] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("create", 0, 1, 2, i); __PYX_ERR(0, 1250, __pyx_L3_error) }
      }
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1250, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1250, __pyx_L3_error)
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[1]) values[1] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
    }
    __pyx_v_arrayLength = values[0];
    __pyx_v_buf = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("create", 0, 1, 2, __pyx_nargs); __PYX_ERR(0, 1250, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicArray.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_buf), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 1, "buf", 0))) __PYX_ERR(0, 1250, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_4create(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)__pyx_v_self), __pyx_v_arrayLength, __pyx_v_buf);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self, PyObject *__pyx_v_arrayLength, PyArrayObject *__pyx_v_buf) {
  PetscErrorCode __pyx_v_ierr;
  PeriodicArray __pyx_v_newarr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_buf;
  __Pyx_Buffer __pyx_pybuffer_buf;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscInt __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  size_t __pyx_t_7;
  Py_ssize_t __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  Py_ssize_t __pyx_t_10;
  int __pyx_t_11;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("create", 0);
  __pyx_pybuffer_buf.pybuffer.buf = NULL;
  __pyx_pybuffer_buf.refcount = 0;
  __pyx_pybuffernd_buf.data = NULL;
  __pyx_pybuffernd_buf.rcbuffer = &__pyx_pybuffer_buf;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_buf.rcbuffer->pybuffer, (PyObject*)__pyx_v_buf, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1250, __pyx_L1_error)
  }
  __pyx_pybuffernd_buf.diminfo[0].strides = __pyx_pybuffernd_buf.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_buf.diminfo[0].shape = __pyx_pybuffernd_buf.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1255
 * #         cdef PetscScalar *data_pointer
 * 
 *         ierr = PeriodicArrayCreate(&newarr, arrayLength)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.parr=newarr
*/
  __pyx_t_1 = __Pyx_PyLong_As_PetscInt(__pyx_v_arrayLength); if (unlikely((__pyx_t_1 == ((PetscInt)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1255, __pyx_L1_error)
  __pyx_v_ierr = PeriodicArrayCreate((&__pyx_v_newarr), __pyx_t_1);

  /* "tmm4py/tmm4py_core.pyx":1256
 * 
 *         ierr = PeriodicArrayCreate(&newarr, arrayLength)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *         self.parr=newarr
 *         self.lDim = arrayLength
*/
  __pyx_t_2 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_2)) {
    __pyx_t_4 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1256, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1256, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1256, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
      assert(__pyx_t_4);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_6, __pyx__function);
      __pyx_t_7 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_5};
      __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1256, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_ERR(0, 1256, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1257
 *         ierr = PeriodicArrayCreate(&newarr, arrayLength)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.parr=newarr             # <<<<<<<<<<<<<<
 *         self.lDim = arrayLength
 * 
*/
  __pyx_v_self->parr = __pyx_v_newarr;

  /* "tmm4py/tmm4py_core.pyx":1258
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.parr=newarr
 *         self.lDim = arrayLength             # <<<<<<<<<<<<<<
 * 
 *         if buf is None:
*/
  __pyx_t_1 = __Pyx_PyLong_As_PetscInt(__pyx_v_arrayLength); if (unlikely((__pyx_t_1 == ((PetscInt)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1258, __pyx_L1_error)
  __pyx_v_self->lDim = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":1260
 *         self.lDim = arrayLength
 * 
 *         if buf is None:             # <<<<<<<<<<<<<<
 *           self.frombuf = 0
 *           self.data_pointer = <PetscScalar *> PyMem_Malloc(self.lDim*sizeof(PetscScalar))
*/
  __pyx_t_2 = (((PyObject *)__pyx_v_buf) == Py_None);
  if (__pyx_t_2) {

    /* "tmm4py/tmm4py_core.pyx":1261
 * 
 *         if buf is None:
 *           self.frombuf = 0             # <<<<<<<<<<<<<<
 *           self.data_pointer = <PetscScalar *> PyMem_Malloc(self.lDim*sizeof(PetscScalar))
 *           self.arr = _ToNumpyRealArrayWithDel(self.lDim, self.data_pointer, NULL, "")
*/
    __pyx_v_self->frombuf = 0;

    /* "tmm4py/tmm4py_core.pyx":1262
 *         if buf is None:
 *           self.frombuf = 0
 *           self.data_pointer = <PetscScalar *> PyMem_Malloc(self.lDim*sizeof(PetscScalar))             # <<<<<<<<<<<<<<
 *           self.arr = _ToNumpyRealArrayWithDel(self.lDim, self.data_pointer, NULL, "")
 * #         Note: the memory is owned by self.arr and will be freed when the destroy method is called
*/
    __pyx_v_self->data_pointer = ((PetscScalar *)PyMem_Malloc((__pyx_v_self->lDim * (sizeof(PetscScalar)))));

    /* "tmm4py/tmm4py_core.pyx":1263
 *           self.frombuf = 0
 *           self.data_pointer = <PetscScalar *> PyMem_Malloc(self.lDim*sizeof(PetscScalar))
 *           self.arr = _ToNumpyRealArrayWithDel(self.lDim, self.data_pointer, NULL, "")             # <<<<<<<<<<<<<<
 * #         Note: the memory is owned by self.arr and will be freed when the destroy method is called
 *         else:
*/
    __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArrayWithDel(__pyx_v_self->lDim, __pyx_v_self->data_pointer, NULL, __pyx_mstate_global->__pyx_kp_u_); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1263, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __Pyx_GOTREF(__pyx_v_self->arr);
    __Pyx_DECREF(__pyx_v_self->arr);
    __pyx_v_self->arr = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "tmm4py/tmm4py_core.pyx":1260
 *         self.lDim = arrayLength
 * 
 *         if buf is None:             # <<<<<<<<<<<<<<
 *           self.frombuf = 0
 *           self.data_pointer = <PetscScalar *> PyMem_Malloc(self.lDim*sizeof(PetscScalar))
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":1266
 * #         Note: the memory is owned by self.arr and will be freed when the destroy method is called
 *         else:
 *           if len(buf) != self.lDim:             # <<<<<<<<<<<<<<
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1
*/
  /*else*/ {
    __pyx_t_8 = PyObject_Length(((PyObject *)__pyx_v_buf)); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1266, __pyx_L1_error)
    __pyx_t_2 = (__pyx_t_8 != __pyx_v_self->lDim);
    if (unlikely(__pyx_t_2)) {

      /* "tmm4py/tmm4py_core.pyx":1267
 *         else:
 *           if len(buf) != self.lDim:
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")             # <<<<<<<<<<<<<<
 *           self.frombuf = 1
 *           self.data_pointer = &buf[0]
*/
      __pyx_t_6 = NULL;
      __Pyx_INCREF(__pyx_builtin_RuntimeError);
      __pyx_t_5 = __pyx_builtin_RuntimeError; 
      __pyx_t_4 = __Pyx_PyLong_From_PetscInt(__pyx_v_self->lDim); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1267, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1267, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_Provided_array_length_does_not_m, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1267, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_7 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_4};
        __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1267, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
      }
      __Pyx_Raise(__pyx_t_3, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __PYX_ERR(0, 1267, __pyx_L1_error)

      /* "tmm4py/tmm4py_core.pyx":1266
 * #         Note: the memory is owned by self.arr and will be freed when the destroy method is called
 *         else:
 *           if len(buf) != self.lDim:             # <<<<<<<<<<<<<<
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1
*/
    }

    /* "tmm4py/tmm4py_core.pyx":1268
 *           if len(buf) != self.lDim:
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1             # <<<<<<<<<<<<<<
 *           self.data_pointer = &buf[0]
 *           self.arr = _ToNumpyRealArray(self.lDim, self.data_pointer, NULL, "")
*/
    __pyx_v_self->frombuf = 1;

    /* "tmm4py/tmm4py_core.pyx":1269
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1
 *           self.data_pointer = &buf[0]             # <<<<<<<<<<<<<<
 *           self.arr = _ToNumpyRealArray(self.lDim, self.data_pointer, NULL, "")
 * #         Note: the memory is owned by the array buf
*/
    __pyx_t_10 = 0;
    __pyx_t_11 = -1;
    if (__pyx_t_10 < 0) {
      __pyx_t_10 += __pyx_pybuffernd_buf.diminfo[0].shape;
      if (unlikely(__pyx_t_10 < 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 >= __pyx_pybuffernd_buf.diminfo[0].shape)) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      __Pyx_RaiseBufferIndexError(__pyx_t_11);
      __PYX_ERR(0, 1269, __pyx_L1_error)
    }
    __pyx_v_self->data_pointer = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_buf.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_buf.diminfo[0].strides)));

    /* "tmm4py/tmm4py_core.pyx":1270
 *           self.frombuf = 1
 *           self.data_pointer = &buf[0]
 *           self.arr = _ToNumpyRealArray(self.lDim, self.data_pointer, NULL, "")             # <<<<<<<<<<<<<<
 * #         Note: the memory is owned by the array buf
 * 
*/
    __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArray(__pyx_v_self->lDim, __pyx_v_self->data_pointer, NULL, __pyx_mstate_global->__pyx_kp_u_); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1270, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __Pyx_GOTREF(__pyx_v_self->arr);
    __Pyx_DECREF(__pyx_v_self->arr);
    __pyx_v_self->arr = __pyx_t_3;
    __pyx_t_3 = 0;
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":1273
 * #         Note: the memory is owned by the array buf
 * 
 *         return self             # <<<<<<<<<<<<<<
 * 
 *     def interp(self, tc, PeriodicTimer timer, filename):
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1250
 *         pass
 * 
 *     def create(self, arrayLength, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscPeriodicArray newarr
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_9);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_buf.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicArray.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_buf.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1275
 *         return self
 * 
 *     def interp(self, tc, PeriodicTimer timer, filename):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscErrorCode ierr
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_7interp(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicArray_7interp = {"interp", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_7interp, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_7interp(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_tc = 0;
  struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_timer = 0;
  PyObject *__pyx_v_filename = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("interp (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_timer,&__pyx_mstate_global->__pyx_n_u_filename,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1275, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1275, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1275, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1275, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "interp", 0) < 0) __PYX_ERR(0, 1275, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 3; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("interp", 1, 3, 3, i); __PYX_ERR(0, 1275, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1275, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1275, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1275, __pyx_L3_error)
    }
    __pyx_v_tc = values[0];
    __pyx_v_timer = ((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *)values[1]);
    __pyx_v_filename = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("interp", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 1275, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicArray.interp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_timer), __pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer, 1, "timer", 0))) __PYX_ERR(0, 1275, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_6interp(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)__pyx_v_self), __pyx_v_tc, __pyx_v_timer, __pyx_v_filename);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_6interp(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self, PyObject *__pyx_v_tc, struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer *__pyx_v_timer, PyObject *__pyx_v_filename) {
  PetscScalar __pyx_v_tcc;
  PetscErrorCode __pyx_v_ierr;
  char const *__pyx_v_c_filename;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscReal __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  size_t __pyx_t_4;
  char *__pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("interp", 0);

  /* "tmm4py/tmm4py_core.pyx":1276
 * 
 *     def interp(self, tc, PeriodicTimer timer, filename):
 *         cdef PetscScalar tcc = asReal(tc)             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_filename
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asReal(__pyx_v_tc); if (unlikely(__pyx_t_1 == ((PetscReal)-1.0) && PyErr_Occurred())) __PYX_ERR(0, 1276, __pyx_L1_error)
  __pyx_v_tcc = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":1280
 *         cdef const char* c_filename
 * 
 *         c_filename = PyBytes_AsString(filename.encode())             # <<<<<<<<<<<<<<
 *         ierr = interpPeriodicProfileSurfaceScalarData(tcc, self.data_pointer, timer.timer.cyclePeriod, timer.timer.numPerPeriod, timer.timer.tdp, self.parr, c_filename)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_t_3 = __pyx_v_filename;
  __Pyx_INCREF(__pyx_t_3);
  __pyx_t_4 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_2 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1280, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  }
  __pyx_t_5 = PyBytes_AsString(__pyx_t_2); if (unlikely(__pyx_t_5 == ((char *)0))) __PYX_ERR(0, 1280, __pyx_L1_error)
  __pyx_v_c_filename = __pyx_t_5;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":1281
 * 
 *         c_filename = PyBytes_AsString(filename.encode())
 *         ierr = interpPeriodicProfileSurfaceScalarData(tcc, self.data_pointer, timer.timer.cyclePeriod, timer.timer.numPerPeriod, timer.timer.tdp, self.parr, c_filename)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_v_ierr = interpPeriodicProfileSurfaceScalarData(__pyx_v_tcc, __pyx_v_self->data_pointer, __pyx_v_timer->timer->cyclePeriod, __pyx_v_timer->timer->numPerPeriod, __pyx_v_timer->timer->tdp, __pyx_v_self->parr, __pyx_v_c_filename);

  /* "tmm4py/tmm4py_core.pyx":1282
 *         c_filename = PyBytes_AsString(filename.encode())
 *         ierr = interpPeriodicProfileSurfaceScalarData(tcc, self.data_pointer, timer.timer.cyclePeriod, timer.timer.numPerPeriod, timer.timer.tdp, self.parr, c_filename)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 *     def destroy(self):
*/
  __pyx_t_6 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_6)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1282, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1282, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1282, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_4 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_8);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_8);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_8, __pyx__function);
      __pyx_t_4 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_7};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1282, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1282, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1275
 *         return self
 * 
 *     def interp(self, tc, PeriodicTimer timer, filename):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscErrorCode ierr
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicArray.interp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1284
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def destroy(self):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_9destroy(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicArray_9destroy = {"destroy", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_9destroy, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_9destroy(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("destroy (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("destroy", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("destroy", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_8destroy(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_8destroy(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self) {
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("destroy", 0);

  /* "tmm4py/tmm4py_core.pyx":1287
 *         cdef PetscErrorCode ierr
 * 
 *         del self.arr             # <<<<<<<<<<<<<<
 *         ierr = PeriodicArrayDestroy(&self.parr)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  if (__Pyx_PyObject_DelAttrStr(((PyObject *)__pyx_v_self), __pyx_mstate_global->__pyx_n_u_arr) < 0) __PYX_ERR(0, 1287, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":1288
 * 
 *         del self.arr
 *         ierr = PeriodicArrayDestroy(&self.parr)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_v_ierr = PeriodicArrayDestroy((&__pyx_v_self->parr));

  /* "tmm4py/tmm4py_core.pyx":1289
 *         del self.arr
 *         ierr = PeriodicArrayDestroy(&self.parr)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 * cdef class TimeDependentArray():
*/
  __pyx_t_1 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_1)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1289, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1289, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1289, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1289, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1289, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1284
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def destroy(self):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicArray.destroy", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":191
 *     cdef PetscInt frombuf
 *     cdef public:
 *       object arr             # <<<<<<<<<<<<<<
 * 
 * cdef class TimeDependentArray:
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_3arr___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_3arr___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->arr);
  __pyx_r = __pyx_v_self->arr;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->arr);
  __Pyx_DECREF(__pyx_v_self->arr);
  __pyx_v_self->arr = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->arr);
  __Pyx_DECREF(__pyx_v_self->arr);
  __pyx_v_self->arr = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_11__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicArray_11__reduce_cython__ = {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_11__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_11__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__reduce_cython__", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__reduce_cython__", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_10__reduce_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_10__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce_cython__", 0);

  /* "(tree fragment)":2
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 2, __pyx_L1_error)

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicArray.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_13__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicArray_13__setstate_cython__ = {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_13__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_13__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v___pyx_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_pyx_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__setstate_cython__", 0) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, i); __PYX_ERR(1, 3, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
    }
    __pyx_v___pyx_state = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, __pyx_nargs); __PYX_ERR(1, 3, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicArray.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_12__setstate_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)__pyx_v_self), __pyx_v___pyx_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_13PeriodicArray_12__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setstate_cython__", 0);

  /* "(tree fragment)":4
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 4, __pyx_L1_error)

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.PeriodicArray.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1293
 * cdef class TimeDependentArray():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.parr = NULL
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__cinit__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__cinit__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray___cinit__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray___cinit__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self) {
  int __pyx_r;

  /* "tmm4py/tmm4py_core.pyx":1294
 * 
 *     def __cinit__(self):
 *         self.parr = NULL             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self):
*/
  __pyx_v_self->parr = NULL;

  /* "tmm4py/tmm4py_core.pyx":1293
 * cdef class TimeDependentArray():
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.parr = NULL
 * 
*/

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1296
 *         self.parr = NULL
 * 
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         pass
 * 
*/

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return -1;
  #endif
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__init__", 1, 0, 0, __pyx_nargs); return -1; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_VARARGS(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return -1;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__init__", __pyx_kwds); return -1;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_2__init__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_2__init__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self) {
  int __pyx_r;

  /* function exit code */
  __pyx_r = 0;
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1299
 *         pass
 * 
 *     def create(self, arrayLength, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscTimeDependentArray newarr
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentArray_5create = {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_5create(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_arrayLength = 0;
  PyArrayObject *__pyx_v_buf = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("create (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_arrayLength,&__pyx_mstate_global->__pyx_n_u_buf,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1299, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1299, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1299, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "create", 0) < 0) __PYX_ERR(0, 1299, __pyx_L3_error)
      if (!values[1]) values[1] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("create", 0, 1, 2, i); __PYX_ERR(0, 1299, __pyx_L3_error) }
      }
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1299, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1299, __pyx_L3_error)
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[1]) values[1] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
    }
    __pyx_v_arrayLength = values[0];
    __pyx_v_buf = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("create", 0, 1, 2, __pyx_nargs); __PYX_ERR(0, 1299, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentArray.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_buf), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 1, "buf", 0))) __PYX_ERR(0, 1299, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_4create(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)__pyx_v_self), __pyx_v_arrayLength, __pyx_v_buf);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_4create(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self, PyObject *__pyx_v_arrayLength, PyArrayObject *__pyx_v_buf) {
  PetscErrorCode __pyx_v_ierr;
  TimeDependentArray __pyx_v_newarr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_buf;
  __Pyx_Buffer __pyx_pybuffer_buf;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscInt __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  size_t __pyx_t_7;
  Py_ssize_t __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  Py_ssize_t __pyx_t_10;
  int __pyx_t_11;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("create", 0);
  __pyx_pybuffer_buf.pybuffer.buf = NULL;
  __pyx_pybuffer_buf.refcount = 0;
  __pyx_pybuffernd_buf.data = NULL;
  __pyx_pybuffernd_buf.rcbuffer = &__pyx_pybuffer_buf;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_buf.rcbuffer->pybuffer, (PyObject*)__pyx_v_buf, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1299, __pyx_L1_error)
  }
  __pyx_pybuffernd_buf.diminfo[0].strides = __pyx_pybuffernd_buf.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_buf.diminfo[0].shape = __pyx_pybuffernd_buf.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1304
 * #         cdef PetscScalar *data_pointer
 * 
 *         ierr = TimeDependentArrayCreate(&newarr, arrayLength)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.parr=newarr
*/
  __pyx_t_1 = __Pyx_PyLong_As_PetscInt(__pyx_v_arrayLength); if (unlikely((__pyx_t_1 == ((PetscInt)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1304, __pyx_L1_error)
  __pyx_v_ierr = TimeDependentArrayCreate((&__pyx_v_newarr), __pyx_t_1);

  /* "tmm4py/tmm4py_core.pyx":1305
 * 
 *         ierr = TimeDependentArrayCreate(&newarr, arrayLength)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *         self.parr=newarr
 *         self.lDim = arrayLength
*/
  __pyx_t_2 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_2)) {
    __pyx_t_4 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1305, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1305, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1305, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
      assert(__pyx_t_4);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_6, __pyx__function);
      __pyx_t_7 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_5};
      __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1305, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_ERR(0, 1305, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1306
 *         ierr = TimeDependentArrayCreate(&newarr, arrayLength)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.parr=newarr             # <<<<<<<<<<<<<<
 *         self.lDim = arrayLength
 * 
*/
  __pyx_v_self->parr = __pyx_v_newarr;

  /* "tmm4py/tmm4py_core.pyx":1307
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         self.parr=newarr
 *         self.lDim = arrayLength             # <<<<<<<<<<<<<<
 * 
 *         if buf is None:
*/
  __pyx_t_1 = __Pyx_PyLong_As_PetscInt(__pyx_v_arrayLength); if (unlikely((__pyx_t_1 == ((PetscInt)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1307, __pyx_L1_error)
  __pyx_v_self->lDim = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":1309
 *         self.lDim = arrayLength
 * 
 *         if buf is None:             # <<<<<<<<<<<<<<
 *           self.frombuf = 0
 *           self.data_pointer = <PetscScalar *> PyMem_Malloc(self.lDim*sizeof(PetscScalar))
*/
  __pyx_t_2 = (((PyObject *)__pyx_v_buf) == Py_None);
  if (__pyx_t_2) {

    /* "tmm4py/tmm4py_core.pyx":1310
 * 
 *         if buf is None:
 *           self.frombuf = 0             # <<<<<<<<<<<<<<
 *           self.data_pointer = <PetscScalar *> PyMem_Malloc(self.lDim*sizeof(PetscScalar))
 *           self.arr = _ToNumpyRealArrayWithDel(self.lDim, self.data_pointer, NULL, "")
*/
    __pyx_v_self->frombuf = 0;

    /* "tmm4py/tmm4py_core.pyx":1311
 *         if buf is None:
 *           self.frombuf = 0
 *           self.data_pointer = <PetscScalar *> PyMem_Malloc(self.lDim*sizeof(PetscScalar))             # <<<<<<<<<<<<<<
 *           self.arr = _ToNumpyRealArrayWithDel(self.lDim, self.data_pointer, NULL, "")
 * #         Note: the memory is owned by self.arr and will be freed when the destroy method is called
*/
    __pyx_v_self->data_pointer = ((PetscScalar *)PyMem_Malloc((__pyx_v_self->lDim * (sizeof(PetscScalar)))));

    /* "tmm4py/tmm4py_core.pyx":1312
 *           self.frombuf = 0
 *           self.data_pointer = <PetscScalar *> PyMem_Malloc(self.lDim*sizeof(PetscScalar))
 *           self.arr = _ToNumpyRealArrayWithDel(self.lDim, self.data_pointer, NULL, "")             # <<<<<<<<<<<<<<
 * #         Note: the memory is owned by self.arr and will be freed when the destroy method is called
 *         else:
*/
    __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArrayWithDel(__pyx_v_self->lDim, __pyx_v_self->data_pointer, NULL, __pyx_mstate_global->__pyx_kp_u_); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1312, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __Pyx_GOTREF(__pyx_v_self->arr);
    __Pyx_DECREF(__pyx_v_self->arr);
    __pyx_v_self->arr = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "tmm4py/tmm4py_core.pyx":1309
 *         self.lDim = arrayLength
 * 
 *         if buf is None:             # <<<<<<<<<<<<<<
 *           self.frombuf = 0
 *           self.data_pointer = <PetscScalar *> PyMem_Malloc(self.lDim*sizeof(PetscScalar))
*/
    goto __pyx_L4;
  }

  /* "tmm4py/tmm4py_core.pyx":1315
 * #         Note: the memory is owned by self.arr and will be freed when the destroy method is called
 *         else:
 *           if len(buf) != self.lDim:             # <<<<<<<<<<<<<<
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1
*/
  /*else*/ {
    __pyx_t_8 = PyObject_Length(((PyObject *)__pyx_v_buf)); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1315, __pyx_L1_error)
    __pyx_t_2 = (__pyx_t_8 != __pyx_v_self->lDim);
    if (unlikely(__pyx_t_2)) {

      /* "tmm4py/tmm4py_core.pyx":1316
 *         else:
 *           if len(buf) != self.lDim:
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")             # <<<<<<<<<<<<<<
 *           self.frombuf = 1
 *           self.data_pointer = &buf[0]
*/
      __pyx_t_6 = NULL;
      __Pyx_INCREF(__pyx_builtin_RuntimeError);
      __pyx_t_5 = __pyx_builtin_RuntimeError; 
      __pyx_t_4 = __Pyx_PyLong_From_PetscInt(__pyx_v_self->lDim); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1316, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1316, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_Provided_array_length_does_not_m, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1316, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_7 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_4};
        __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1316, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
      }
      __Pyx_Raise(__pyx_t_3, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __PYX_ERR(0, 1316, __pyx_L1_error)

      /* "tmm4py/tmm4py_core.pyx":1315
 * #         Note: the memory is owned by self.arr and will be freed when the destroy method is called
 *         else:
 *           if len(buf) != self.lDim:             # <<<<<<<<<<<<<<
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1
*/
    }

    /* "tmm4py/tmm4py_core.pyx":1317
 *           if len(buf) != self.lDim:
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1             # <<<<<<<<<<<<<<
 *           self.data_pointer = &buf[0]
 *           self.arr = _ToNumpyRealArray(self.lDim, self.data_pointer, NULL, "")
*/
    __pyx_v_self->frombuf = 1;

    /* "tmm4py/tmm4py_core.pyx":1318
 *             raise RuntimeError(f"Provided array length does not match expected length {self.lDim}")
 *           self.frombuf = 1
 *           self.data_pointer = &buf[0]             # <<<<<<<<<<<<<<
 *           self.arr = _ToNumpyRealArray(self.lDim, self.data_pointer, NULL, "")
 * #         Note: the memory is owned by the array buf
*/
    __pyx_t_10 = 0;
    __pyx_t_11 = -1;
    if (__pyx_t_10 < 0) {
      __pyx_t_10 += __pyx_pybuffernd_buf.diminfo[0].shape;
      if (unlikely(__pyx_t_10 < 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 >= __pyx_pybuffernd_buf.diminfo[0].shape)) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      __Pyx_RaiseBufferIndexError(__pyx_t_11);
      __PYX_ERR(0, 1318, __pyx_L1_error)
    }
    __pyx_v_self->data_pointer = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_buf.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_buf.diminfo[0].strides)));

    /* "tmm4py/tmm4py_core.pyx":1319
 *           self.frombuf = 1
 *           self.data_pointer = &buf[0]
 *           self.arr = _ToNumpyRealArray(self.lDim, self.data_pointer, NULL, "")             # <<<<<<<<<<<<<<
 * #         Note: the memory is owned by the array buf
 * 
*/
    __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArray(__pyx_v_self->lDim, __pyx_v_self->data_pointer, NULL, __pyx_mstate_global->__pyx_kp_u_); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1319, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __Pyx_GOTREF(__pyx_v_self->arr);
    __Pyx_DECREF(__pyx_v_self->arr);
    __pyx_v_self->arr = __pyx_t_3;
    __pyx_t_3 = 0;
  }
  __pyx_L4:;

  /* "tmm4py/tmm4py_core.pyx":1322
 * #         Note: the memory is owned by the array buf
 * 
 *         return self             # <<<<<<<<<<<<<<
 * 
 *     def interp(self, tc, TimeDependentTimer timer, filename):
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF((PyObject *)__pyx_v_self);
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1299
 *         pass
 * 
 *     def create(self, arrayLength, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscTimeDependentArray newarr
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_9);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_buf.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentArray.create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_buf.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1324
 *         return self
 * 
 *     def interp(self, tc, TimeDependentTimer timer, filename):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscErrorCode ierr
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_7interp(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentArray_7interp = {"interp", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_7interp, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_7interp(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_tc = 0;
  struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_timer = 0;
  PyObject *__pyx_v_filename = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("interp (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_tc,&__pyx_mstate_global->__pyx_n_u_timer,&__pyx_mstate_global->__pyx_n_u_filename,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1324, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1324, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1324, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1324, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "interp", 0) < 0) __PYX_ERR(0, 1324, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 3; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("interp", 1, 3, 3, i); __PYX_ERR(0, 1324, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1324, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1324, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1324, __pyx_L3_error)
    }
    __pyx_v_tc = values[0];
    __pyx_v_timer = ((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *)values[1]);
    __pyx_v_filename = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("interp", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 1324, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentArray.interp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_timer), __pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer, 1, "timer", 0))) __PYX_ERR(0, 1324, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_6interp(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)__pyx_v_self), __pyx_v_tc, __pyx_v_timer, __pyx_v_filename);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_6interp(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self, PyObject *__pyx_v_tc, struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer *__pyx_v_timer, PyObject *__pyx_v_filename) {
  PetscScalar __pyx_v_tcc;
  PetscErrorCode __pyx_v_ierr;
  char const *__pyx_v_c_filename;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscReal __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  size_t __pyx_t_4;
  char *__pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("interp", 0);

  /* "tmm4py/tmm4py_core.pyx":1325
 * 
 *     def interp(self, tc, TimeDependentTimer timer, filename):
 *         cdef PetscScalar tcc = asReal(tc)             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_filename
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asReal(__pyx_v_tc); if (unlikely(__pyx_t_1 == ((PetscReal)-1.0) && PyErr_Occurred())) __PYX_ERR(0, 1325, __pyx_L1_error)
  __pyx_v_tcc = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":1329
 *         cdef const char* c_filename
 * 
 *         c_filename = PyBytes_AsString(filename.encode())             # <<<<<<<<<<<<<<
 *         ierr = interpTimeDependentProfileSurfaceScalarData(tcc, self.data_pointer, timer.timer.numTimes, timer.timer.tdt, self.parr, c_filename)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_t_3 = __pyx_v_filename;
  __Pyx_INCREF(__pyx_t_3);
  __pyx_t_4 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_2 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1329, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  }
  __pyx_t_5 = PyBytes_AsString(__pyx_t_2); if (unlikely(__pyx_t_5 == ((char *)0))) __PYX_ERR(0, 1329, __pyx_L1_error)
  __pyx_v_c_filename = __pyx_t_5;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":1330
 * 
 *         c_filename = PyBytes_AsString(filename.encode())
 *         ierr = interpTimeDependentProfileSurfaceScalarData(tcc, self.data_pointer, timer.timer.numTimes, timer.timer.tdt, self.parr, c_filename)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_v_ierr = interpTimeDependentProfileSurfaceScalarData(__pyx_v_tcc, __pyx_v_self->data_pointer, __pyx_v_timer->timer->numTimes, __pyx_v_timer->timer->tdt, __pyx_v_self->parr, __pyx_v_c_filename);

  /* "tmm4py/tmm4py_core.pyx":1331
 *         c_filename = PyBytes_AsString(filename.encode())
 *         ierr = interpTimeDependentProfileSurfaceScalarData(tcc, self.data_pointer, timer.timer.numTimes, timer.timer.tdt, self.parr, c_filename)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 *     def destroy(self):
*/
  __pyx_t_6 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_6)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_4 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_8);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_8);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_8, __pyx__function);
      __pyx_t_4 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_7};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1331, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1331, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1324
 *         return self
 * 
 *     def interp(self, tc, TimeDependentTimer timer, filename):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscErrorCode ierr
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentArray.interp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1333
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def destroy(self):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_9destroy(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentArray_9destroy = {"destroy", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_9destroy, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_9destroy(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("destroy (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("destroy", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("destroy", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_8destroy(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_8destroy(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self) {
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("destroy", 0);

  /* "tmm4py/tmm4py_core.pyx":1336
 *         cdef PetscErrorCode ierr
 * 
 *         del self.arr             # <<<<<<<<<<<<<<
 *         ierr = TimeDependentArrayDestroy(&self.parr)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  if (__Pyx_PyObject_DelAttrStr(((PyObject *)__pyx_v_self), __pyx_mstate_global->__pyx_n_u_arr) < 0) __PYX_ERR(0, 1336, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":1337
 * 
 *         del self.arr
 *         ierr = TimeDependentArrayDestroy(&self.parr)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_v_ierr = TimeDependentArrayDestroy((&__pyx_v_self->parr));

  /* "tmm4py/tmm4py_core.pyx":1338
 *         del self.arr
 *         ierr = TimeDependentArrayDestroy(&self.parr)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 * 
*/
  __pyx_t_1 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_1)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1338, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1338, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1338, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1338, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1338, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1333
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def destroy(self):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentArray.destroy", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pxd":199
 *     cdef PetscInt frombuf
 *     cdef public:
 *       object arr             # <<<<<<<<<<<<<<
 * 
 * # This is taken from PETSc.pyx; there seems to be no way to import them directly
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_1__get__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr___get__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr___get__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__", 0);
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_self->arr);
  __pyx_r = __pyx_v_self->arr;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_2__set__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_2__set__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__", 0);
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(__pyx_v_self->arr);
  __Pyx_DECREF(__pyx_v_self->arr);
  __pyx_v_self->arr = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_5__del__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_4__del__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_4__del__(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__", 0);
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_self->arr);
  __Pyx_DECREF(__pyx_v_self->arr);
  __pyx_v_self->arr = Py_None;

  /* function exit code */
  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_11__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentArray_11__reduce_cython__ = {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_11__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_11__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__reduce_cython__", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__reduce_cython__", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_10__reduce_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_10__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce_cython__", 0);

  /* "(tree fragment)":2
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 2, __pyx_L1_error)

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentArray.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_13__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentArray_13__setstate_cython__ = {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_13__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_13__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v___pyx_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_pyx_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__setstate_cython__", 0) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, i); __PYX_ERR(1, 3, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
    }
    __pyx_v___pyx_state = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, __pyx_nargs); __PYX_ERR(1, 3, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentArray.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_12__setstate_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)__pyx_v_self), __pyx_v___pyx_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18TimeDependentArray_12__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setstate_cython__", 0);

  /* "(tree fragment)":4
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"             # <<<<<<<<<<<<<<
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_no_default___reduce___due_to_non, 0, 0);
  __PYX_ERR(1, 4, __pyx_L1_error)

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core.TimeDependentArray.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1341
 * 
 * 
 * def loadVecIntoArray(filename, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *data_pointer
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_17loadVecIntoArray(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_17loadVecIntoArray = {"loadVecIntoArray", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_17loadVecIntoArray, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_17loadVecIntoArray(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_filename = 0;
  PyArrayObject *__pyx_v_buf = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("loadVecIntoArray (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_filename,&__pyx_mstate_global->__pyx_n_u_buf,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1341, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1341, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1341, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "loadVecIntoArray", 0) < 0) __PYX_ERR(0, 1341, __pyx_L3_error)
      if (!values[1]) values[1] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("loadVecIntoArray", 0, 1, 2, i); __PYX_ERR(0, 1341, __pyx_L3_error) }
      }
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1341, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1341, __pyx_L3_error)
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[1]) values[1] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
    }
    __pyx_v_filename = values[0];
    __pyx_v_buf = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("loadVecIntoArray", 0, 1, 2, __pyx_nargs); __PYX_ERR(0, 1341, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.loadVecIntoArray", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_buf), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 1, "buf", 0))) __PYX_ERR(0, 1341, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16loadVecIntoArray(__pyx_self, __pyx_v_filename, __pyx_v_buf);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16loadVecIntoArray(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_filename, PyArrayObject *__pyx_v_buf) {
  PetscErrorCode __pyx_v_ierr;
  PetscScalar *__pyx_v_data_pointer;
  char const *__pyx_v_c_filename;
  PyObject *__pyx_v_nparr = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_buf;
  __Pyx_Buffer __pyx_pybuffer_buf;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  size_t __pyx_t_3;
  char *__pyx_t_4;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  Py_ssize_t __pyx_t_8;
  int __pyx_t_9;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("loadVecIntoArray", 0);
  __pyx_pybuffer_buf.pybuffer.buf = NULL;
  __pyx_pybuffer_buf.refcount = 0;
  __pyx_pybuffernd_buf.data = NULL;
  __pyx_pybuffernd_buf.rcbuffer = &__pyx_pybuffer_buf;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_buf.rcbuffer->pybuffer, (PyObject*)__pyx_v_buf, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1341, __pyx_L1_error)
  }
  __pyx_pybuffernd_buf.diminfo[0].strides = __pyx_pybuffernd_buf.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_buf.diminfo[0].shape = __pyx_pybuffernd_buf.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1348
 * #  https://cython.readthedocs.io/en/latest/src/tutorial/array.html#array-array
 * 
 *     c_filename = PyBytes_AsString(filename.encode())             # <<<<<<<<<<<<<<
 * 
 *     if buf is None:
*/
  __pyx_t_2 = __pyx_v_filename;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1348, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_t_4 = PyBytes_AsString(__pyx_t_1); if (unlikely(__pyx_t_4 == ((char *)0))) __PYX_ERR(0, 1348, __pyx_L1_error)
  __pyx_v_c_filename = __pyx_t_4;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1350
 *     c_filename = PyBytes_AsString(filename.encode())
 * 
 *     if buf is None:             # <<<<<<<<<<<<<<
 *         data_pointer = <PetscScalar *> PyMem_Malloc(lSize*sizeof(PetscScalar))
 *         ierr = VecLoadIntoArray(lSize, c_filename, data_pointer);
*/
  __pyx_t_5 = (((PyObject *)__pyx_v_buf) == Py_None);
  if (__pyx_t_5) {

    /* "tmm4py/tmm4py_core.pyx":1351
 * 
 *     if buf is None:
 *         data_pointer = <PetscScalar *> PyMem_Malloc(lSize*sizeof(PetscScalar))             # <<<<<<<<<<<<<<
 *         ierr = VecLoadIntoArray(lSize, c_filename, data_pointer);
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
    __pyx_v_data_pointer = ((PetscScalar *)PyMem_Malloc((lSize * (sizeof(PetscScalar)))));

    /* "tmm4py/tmm4py_core.pyx":1352
 *     if buf is None:
 *         data_pointer = <PetscScalar *> PyMem_Malloc(lSize*sizeof(PetscScalar))
 *         ierr = VecLoadIntoArray(lSize, c_filename, data_pointer);             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         nparr = _ToNumpyRealArrayWithDel(lSize, data_pointer, NULL, "")
*/
    __pyx_v_ierr = VecLoadIntoArray(lSize, __pyx_v_c_filename, __pyx_v_data_pointer);

    /* "tmm4py/tmm4py_core.pyx":1353
 *         data_pointer = <PetscScalar *> PyMem_Malloc(lSize*sizeof(PetscScalar))
 *         ierr = VecLoadIntoArray(lSize, c_filename, data_pointer);
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *         nparr = _ToNumpyRealArrayWithDel(lSize, data_pointer, NULL, "")
 * #       Note: the memory will be freed when nparr is deleted
*/
    __pyx_t_5 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_5)) {
      __pyx_t_2 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1353, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1353, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1353, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_3 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_7))) {
        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_7);
        assert(__pyx_t_2);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
        __pyx_t_3 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_6};
        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1353, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_Raise(__pyx_t_1, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __PYX_ERR(0, 1353, __pyx_L1_error)
    }

    /* "tmm4py/tmm4py_core.pyx":1354
 *         ierr = VecLoadIntoArray(lSize, c_filename, data_pointer);
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         nparr = _ToNumpyRealArrayWithDel(lSize, data_pointer, NULL, "")             # <<<<<<<<<<<<<<
 * #       Note: the memory will be freed when nparr is deleted
 *         return nparr
*/
    __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArrayWithDel(lSize, __pyx_v_data_pointer, NULL, __pyx_mstate_global->__pyx_kp_u_); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1354, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_nparr = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":1356
 *         nparr = _ToNumpyRealArrayWithDel(lSize, data_pointer, NULL, "")
 * #       Note: the memory will be freed when nparr is deleted
 *         return nparr             # <<<<<<<<<<<<<<
 *     else:
 *         data_pointer = &buf[0]
*/
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_nparr);
    __pyx_r = __pyx_v_nparr;
    goto __pyx_L0;

    /* "tmm4py/tmm4py_core.pyx":1350
 *     c_filename = PyBytes_AsString(filename.encode())
 * 
 *     if buf is None:             # <<<<<<<<<<<<<<
 *         data_pointer = <PetscScalar *> PyMem_Malloc(lSize*sizeof(PetscScalar))
 *         ierr = VecLoadIntoArray(lSize, c_filename, data_pointer);
*/
  }

  /* "tmm4py/tmm4py_core.pyx":1358
 *         return nparr
 *     else:
 *         data_pointer = &buf[0]             # <<<<<<<<<<<<<<
 *         ierr = VecLoadIntoArray(lSize, c_filename, data_pointer);
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  /*else*/ {
    __pyx_t_8 = 0;
    __pyx_t_9 = -1;
    if (__pyx_t_8 < 0) {
      __pyx_t_8 += __pyx_pybuffernd_buf.diminfo[0].shape;
      if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 0;
    } else if (unlikely(__pyx_t_8 >= __pyx_pybuffernd_buf.diminfo[0].shape)) __pyx_t_9 = 0;
    if (unlikely(__pyx_t_9 != -1)) {
      __Pyx_RaiseBufferIndexError(__pyx_t_9);
      __PYX_ERR(0, 1358, __pyx_L1_error)
    }
    __pyx_v_data_pointer = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_buf.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_buf.diminfo[0].strides)));

    /* "tmm4py/tmm4py_core.pyx":1359
 *     else:
 *         data_pointer = &buf[0]
 *         ierr = VecLoadIntoArray(lSize, c_filename, data_pointer);             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #       Note: the memory is owned by the array buf
*/
    __pyx_v_ierr = VecLoadIntoArray(lSize, __pyx_v_c_filename, __pyx_v_data_pointer);

    /* "tmm4py/tmm4py_core.pyx":1360
 *         data_pointer = &buf[0]
 *         ierr = VecLoadIntoArray(lSize, c_filename, data_pointer);
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #       Note: the memory is owned by the array buf
 * 
*/
    __pyx_t_5 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_5)) {
      __pyx_t_7 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1360, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1360, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1360, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_3 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
        assert(__pyx_t_7);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_2, __pyx__function);
        __pyx_t_3 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_6};
        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1360, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_Raise(__pyx_t_1, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __PYX_ERR(0, 1360, __pyx_L1_error)
    }
  }

  /* "tmm4py/tmm4py_core.pyx":1341
 * 
 * 
 * def loadVecIntoArray(filename, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *data_pointer
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_buf.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.loadVecIntoArray", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_buf.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF(__pyx_v_nparr);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1363
 * #       Note: the memory is owned by the array buf
 * 
 * def readProfileScalarData(filename, numValsPerProfile=1, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *data_pointer
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_19readProfileScalarData(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_19readProfileScalarData = {"readProfileScalarData", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_19readProfileScalarData, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_19readProfileScalarData(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_filename = 0;
  PyObject *__pyx_v_numValsPerProfile = 0;
  PyArrayObject *__pyx_v_buf = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("readProfileScalarData (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_filename,&__pyx_mstate_global->__pyx_n_u_numValsPerProfile,&__pyx_mstate_global->__pyx_n_u_buf,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1363, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1363, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1363, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1363, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "readProfileScalarData", 0) < 0) __PYX_ERR(0, 1363, __pyx_L3_error)
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)((PyObject*)__pyx_mstate_global->__pyx_int_1)));
      if (!values[2]) values[2] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("readProfileScalarData", 0, 1, 3, i); __PYX_ERR(0, 1363, __pyx_L3_error) }
      }
    } else {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1363, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1363, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1363, __pyx_L3_error)
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)((PyObject*)__pyx_mstate_global->__pyx_int_1)));
      if (!values[2]) values[2] = __Pyx_NewRef((PyObject *)((PyArrayObject *)Py_None));
    }
    __pyx_v_filename = values[0];
    __pyx_v_numValsPerProfile = values[1];
    __pyx_v_buf = ((PyArrayObject *)values[2]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("readProfileScalarData", 0, 1, 3, __pyx_nargs); __PYX_ERR(0, 1363, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.readProfileScalarData", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_buf), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 1, "buf", 0))) __PYX_ERR(0, 1363, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_18readProfileScalarData(__pyx_self, __pyx_v_filename, __pyx_v_numValsPerProfile, __pyx_v_buf);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_18readProfileScalarData(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_filename, PyObject *__pyx_v_numValsPerProfile, PyArrayObject *__pyx_v_buf) {
  PetscErrorCode __pyx_v_ierr;
  PetscScalar *__pyx_v_data_pointer;
  char const *__pyx_v_c_filename;
  PyObject *__pyx_v_lDim = NULL;
  PyObject *__pyx_v_nparr = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_buf;
  __Pyx_Buffer __pyx_pybuffer_buf;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  size_t __pyx_t_3;
  char *__pyx_t_4;
  int __pyx_t_5;
  PetscInt __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  Py_ssize_t __pyx_t_11;
  int __pyx_t_12;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("readProfileScalarData", 0);
  __pyx_pybuffer_buf.pybuffer.buf = NULL;
  __pyx_pybuffer_buf.refcount = 0;
  __pyx_pybuffernd_buf.data = NULL;
  __pyx_pybuffernd_buf.rcbuffer = &__pyx_pybuffer_buf;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_buf.rcbuffer->pybuffer, (PyObject*)__pyx_v_buf, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1363, __pyx_L1_error)
  }
  __pyx_pybuffernd_buf.diminfo[0].strides = __pyx_pybuffernd_buf.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_buf.diminfo[0].shape = __pyx_pybuffernd_buf.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1368
 *     cdef const char* c_filename
 * 
 *     c_filename = PyBytes_AsString(filename.encode())             # <<<<<<<<<<<<<<
 * 
 *     lDim = lNumProfiles*numValsPerProfile
*/
  __pyx_t_2 = __pyx_v_filename;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1368, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_t_4 = PyBytes_AsString(__pyx_t_1); if (unlikely(__pyx_t_4 == ((char *)0))) __PYX_ERR(0, 1368, __pyx_L1_error)
  __pyx_v_c_filename = __pyx_t_4;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1370
 *     c_filename = PyBytes_AsString(filename.encode())
 * 
 *     lDim = lNumProfiles*numValsPerProfile             # <<<<<<<<<<<<<<
 *     if buf is None:
 *         data_pointer = <PetscScalar *> PyMem_Malloc(lDim*sizeof(PetscScalar))
*/
  __pyx_t_1 = __Pyx_PyLong_From_PetscInt(lNumProfiles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1370, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_v_numValsPerProfile); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1370, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_lDim = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":1371
 * 
 *     lDim = lNumProfiles*numValsPerProfile
 *     if buf is None:             # <<<<<<<<<<<<<<
 *         data_pointer = <PetscScalar *> PyMem_Malloc(lDim*sizeof(PetscScalar))
 *         ierr = readProfileSurfaceScalarData(c_filename,data_pointer,numValsPerProfile);
*/
  __pyx_t_5 = (((PyObject *)__pyx_v_buf) == Py_None);
  if (__pyx_t_5) {

    /* "tmm4py/tmm4py_core.pyx":1372
 *     lDim = lNumProfiles*numValsPerProfile
 *     if buf is None:
 *         data_pointer = <PetscScalar *> PyMem_Malloc(lDim*sizeof(PetscScalar))             # <<<<<<<<<<<<<<
 *         ierr = readProfileSurfaceScalarData(c_filename,data_pointer,numValsPerProfile);
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
    __pyx_t_2 = __Pyx_PyLong_FromSize_t((sizeof(PetscScalar))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1372, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyNumber_Multiply(__pyx_v_lDim, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1372, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_3 = __Pyx_PyLong_As_size_t(__pyx_t_1); if (unlikely((__pyx_t_3 == (size_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1372, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_data_pointer = ((PetscScalar *)PyMem_Malloc(__pyx_t_3));

    /* "tmm4py/tmm4py_core.pyx":1373
 *     if buf is None:
 *         data_pointer = <PetscScalar *> PyMem_Malloc(lDim*sizeof(PetscScalar))
 *         ierr = readProfileSurfaceScalarData(c_filename,data_pointer,numValsPerProfile);             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         nparr = _ToNumpyRealArrayWithDel(lDim, data_pointer, NULL, "")
*/
    __pyx_t_6 = __Pyx_PyLong_As_PetscInt(__pyx_v_numValsPerProfile); if (unlikely((__pyx_t_6 == ((PetscInt)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1373, __pyx_L1_error)
    __pyx_v_ierr = readProfileSurfaceScalarData(__pyx_v_c_filename, __pyx_v_data_pointer, __pyx_t_6);

    /* "tmm4py/tmm4py_core.pyx":1374
 *         data_pointer = <PetscScalar *> PyMem_Malloc(lDim*sizeof(PetscScalar))
 *         ierr = readProfileSurfaceScalarData(c_filename,data_pointer,numValsPerProfile);
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *         nparr = _ToNumpyRealArrayWithDel(lDim, data_pointer, NULL, "")
 * #       Note: the memory will be freed when nparr is deleted
*/
    __pyx_t_5 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_5)) {
      __pyx_t_2 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1374, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1374, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1374, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_3 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_8))) {
        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_8);
        assert(__pyx_t_2);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_8);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_8, __pyx__function);
        __pyx_t_3 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_7};
        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1374, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_Raise(__pyx_t_1, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __PYX_ERR(0, 1374, __pyx_L1_error)
    }

    /* "tmm4py/tmm4py_core.pyx":1375
 *         ierr = readProfileSurfaceScalarData(c_filename,data_pointer,numValsPerProfile);
 *         if ierr != 0: raise PETSc.Error(ierr)
 *         nparr = _ToNumpyRealArrayWithDel(lDim, data_pointer, NULL, "")             # <<<<<<<<<<<<<<
 * #       Note: the memory will be freed when nparr is deleted
 *         return nparr
*/
    __pyx_t_6 = __Pyx_PyLong_As_PetscInt(__pyx_v_lDim); if (unlikely((__pyx_t_6 == ((PetscInt)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1375, __pyx_L1_error)
    __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArrayWithDel(__pyx_t_6, __pyx_v_data_pointer, NULL, __pyx_mstate_global->__pyx_kp_u_); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1375, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_nparr = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "tmm4py/tmm4py_core.pyx":1377
 *         nparr = _ToNumpyRealArrayWithDel(lDim, data_pointer, NULL, "")
 * #       Note: the memory will be freed when nparr is deleted
 *         return nparr             # <<<<<<<<<<<<<<
 *     else:
 *         if len(buf) != lDim:
*/
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_nparr);
    __pyx_r = __pyx_v_nparr;
    goto __pyx_L0;

    /* "tmm4py/tmm4py_core.pyx":1371
 * 
 *     lDim = lNumProfiles*numValsPerProfile
 *     if buf is None:             # <<<<<<<<<<<<<<
 *         data_pointer = <PetscScalar *> PyMem_Malloc(lDim*sizeof(PetscScalar))
 *         ierr = readProfileSurfaceScalarData(c_filename,data_pointer,numValsPerProfile);
*/
  }

  /* "tmm4py/tmm4py_core.pyx":1379
 *         return nparr
 *     else:
 *         if len(buf) != lDim:             # <<<<<<<<<<<<<<
 *           raise RuntimeError(f"Provided array length does not match expected length {lDim}")
 *         data_pointer = &buf[0]
*/
  /*else*/ {
    __pyx_t_9 = PyObject_Length(((PyObject *)__pyx_v_buf)); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1379, __pyx_L1_error)
    __pyx_t_1 = PyLong_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1379, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_8 = PyObject_RichCompare(__pyx_t_1, __pyx_v_lDim, Py_NE); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1379, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely((__pyx_t_5 < 0))) __PYX_ERR(0, 1379, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(__pyx_t_5)) {

      /* "tmm4py/tmm4py_core.pyx":1380
 *     else:
 *         if len(buf) != lDim:
 *           raise RuntimeError(f"Provided array length does not match expected length {lDim}")             # <<<<<<<<<<<<<<
 *         data_pointer = &buf[0]
 *         ierr = readProfileSurfaceScalarData(c_filename,data_pointer,numValsPerProfile);
*/
      __pyx_t_1 = NULL;
      __Pyx_INCREF(__pyx_builtin_RuntimeError);
      __pyx_t_7 = __pyx_builtin_RuntimeError; 
      __pyx_t_2 = __Pyx_PyObject_FormatSimple(__pyx_v_lDim, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1380, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_10 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_Provided_array_length_does_not_m, __pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1380, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_3 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_10};
        __pyx_t_8 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1380, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
      }
      __Pyx_Raise(__pyx_t_8, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __PYX_ERR(0, 1380, __pyx_L1_error)

      /* "tmm4py/tmm4py_core.pyx":1379
 *         return nparr
 *     else:
 *         if len(buf) != lDim:             # <<<<<<<<<<<<<<
 *           raise RuntimeError(f"Provided array length does not match expected length {lDim}")
 *         data_pointer = &buf[0]
*/
    }

    /* "tmm4py/tmm4py_core.pyx":1381
 *         if len(buf) != lDim:
 *           raise RuntimeError(f"Provided array length does not match expected length {lDim}")
 *         data_pointer = &buf[0]             # <<<<<<<<<<<<<<
 *         ierr = readProfileSurfaceScalarData(c_filename,data_pointer,numValsPerProfile);
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
    __pyx_t_11 = 0;
    __pyx_t_12 = -1;
    if (__pyx_t_11 < 0) {
      __pyx_t_11 += __pyx_pybuffernd_buf.diminfo[0].shape;
      if (unlikely(__pyx_t_11 < 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_11 >= __pyx_pybuffernd_buf.diminfo[0].shape)) __pyx_t_12 = 0;
    if (unlikely(__pyx_t_12 != -1)) {
      __Pyx_RaiseBufferIndexError(__pyx_t_12);
      __PYX_ERR(0, 1381, __pyx_L1_error)
    }
    __pyx_v_data_pointer = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_buf.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_buf.diminfo[0].strides)));

    /* "tmm4py/tmm4py_core.pyx":1382
 *           raise RuntimeError(f"Provided array length does not match expected length {lDim}")
 *         data_pointer = &buf[0]
 *         ierr = readProfileSurfaceScalarData(c_filename,data_pointer,numValsPerProfile);             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 * #       Note: the memory is owned by the array buf
*/
    __pyx_t_6 = __Pyx_PyLong_As_PetscInt(__pyx_v_numValsPerProfile); if (unlikely((__pyx_t_6 == ((PetscInt)-1)) && PyErr_Occurred())) __PYX_ERR(0, 1382, __pyx_L1_error)
    __pyx_v_ierr = readProfileSurfaceScalarData(__pyx_v_c_filename, __pyx_v_data_pointer, __pyx_t_6);

    /* "tmm4py/tmm4py_core.pyx":1383
 *         data_pointer = &buf[0]
 *         ierr = readProfileSurfaceScalarData(c_filename,data_pointer,numValsPerProfile);
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * #       Note: the memory is owned by the array buf
 * 
*/
    __pyx_t_5 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_5)) {
      __pyx_t_7 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1383, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1383, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1383, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __pyx_t_3 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_1))) {
        __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_1);
        assert(__pyx_t_7);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_1, __pyx__function);
        __pyx_t_3 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_10};
        __pyx_t_8 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1383, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
      }
      __Pyx_Raise(__pyx_t_8, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __PYX_ERR(0, 1383, __pyx_L1_error)
    }
  }

  /* "tmm4py/tmm4py_core.pyx":1363
 * #       Note: the memory is owned by the array buf
 * 
 * def readProfileScalarData(filename, numValsPerProfile=1, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *data_pointer
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_10);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_buf.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.readProfileScalarData", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_buf.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF(__pyx_v_lDim);
  __Pyx_XDECREF(__pyx_v_nparr);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1386
 * #       Note: the memory is owned by the array buf
 * 
 * def writeProfileScalarData(filename, np.ndarray[double, ndim=1, mode="c"] arr not None, numValsPerProfile=1, appendToFile=False):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *data_pointer
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_21writeProfileScalarData(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_21writeProfileScalarData = {"writeProfileScalarData", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_21writeProfileScalarData, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_21writeProfileScalarData(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_filename = 0;
  PyArrayObject *__pyx_v_arr = 0;
  PyObject *__pyx_v_numValsPerProfile = 0;
  PyObject *__pyx_v_appendToFile = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[4] = {0,0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("writeProfileScalarData (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_filename,&__pyx_mstate_global->__pyx_n_u_arr,&__pyx_mstate_global->__pyx_n_u_numValsPerProfile,&__pyx_mstate_global->__pyx_n_u_appendToFile,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1386, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 1386, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1386, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1386, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1386, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "writeProfileScalarData", 0) < 0) __PYX_ERR(0, 1386, __pyx_L3_error)
      if (!values[2]) values[2] = __Pyx_NewRef(((PyObject *)((PyObject*)__pyx_mstate_global->__pyx_int_1)));
      if (!values[3]) values[3] = __Pyx_NewRef(((PyObject *)((PyObject*)Py_False)));
      for (Py_ssize_t i = __pyx_nargs; i < 2; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("writeProfileScalarData", 0, 2, 4, i); __PYX_ERR(0, 1386, __pyx_L3_error) }
      }
    } else {
      switch (__pyx_nargs) {
        case  4:
        values[3] = __Pyx_ArgRef_FASTCALL(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[3])) __PYX_ERR(0, 1386, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1386, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1386, __pyx_L3_error)
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1386, __pyx_L3_error)
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[2]) values[2] = __Pyx_NewRef(((PyObject *)((PyObject*)__pyx_mstate_global->__pyx_int_1)));
      if (!values[3]) values[3] = __Pyx_NewRef(((PyObject *)((PyObject*)Py_False)));
    }
    __pyx_v_filename = values[0];
    __pyx_v_arr = ((PyArrayObject *)values[1]);
    __pyx_v_numValsPerProfile = values[2];
    __pyx_v_appendToFile = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("writeProfileScalarData", 0, 2, 4, __pyx_nargs); __PYX_ERR(0, 1386, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.writeProfileScalarData", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 0, "arr", 0))) __PYX_ERR(0, 1386, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_20writeProfileScalarData(__pyx_self, __pyx_v_filename, __pyx_v_arr, __pyx_v_numValsPerProfile, __pyx_v_appendToFile);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_20writeProfileScalarData(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_filename, PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_numValsPerProfile, PyObject *__pyx_v_appendToFile) {
  PetscErrorCode __pyx_v_ierr;
  PetscScalar *__pyx_v_data_pointer;
  char const *__pyx_v_c_filename;
  PyObject *__pyx_v_lDim = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_arr;
  __Pyx_Buffer __pyx_pybuffer_arr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  size_t __pyx_t_3;
  char *__pyx_t_4;
  Py_ssize_t __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  Py_ssize_t __pyx_t_10;
  int __pyx_t_11;
  PetscInt __pyx_t_12;
  PetscBool __pyx_t_13;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("writeProfileScalarData", 0);
  __pyx_pybuffer_arr.pybuffer.buf = NULL;
  __pyx_pybuffer_arr.refcount = 0;
  __pyx_pybuffernd_arr.data = NULL;
  __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1386, __pyx_L1_error)
  }
  __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1391
 *     cdef const char* c_filename
 * 
 *     c_filename = PyBytes_AsString(filename.encode())             # <<<<<<<<<<<<<<
 * 
 *     lDim = lNumProfiles*numValsPerProfile
*/
  __pyx_t_2 = __pyx_v_filename;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1391, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_t_4 = PyBytes_AsString(__pyx_t_1); if (unlikely(__pyx_t_4 == ((char *)0))) __PYX_ERR(0, 1391, __pyx_L1_error)
  __pyx_v_c_filename = __pyx_t_4;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1393
 *     c_filename = PyBytes_AsString(filename.encode())
 * 
 *     lDim = lNumProfiles*numValsPerProfile             # <<<<<<<<<<<<<<
 *     if len(arr) != lDim:
 *       raise RuntimeError(f"arr length does not match expected length {lDim}")
*/
  __pyx_t_1 = __Pyx_PyLong_From_PetscInt(lNumProfiles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1393, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyNumber_Multiply(__pyx_t_1, __pyx_v_numValsPerProfile); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1393, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_lDim = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":1394
 * 
 *     lDim = lNumProfiles*numValsPerProfile
 *     if len(arr) != lDim:             # <<<<<<<<<<<<<<
 *       raise RuntimeError(f"arr length does not match expected length {lDim}")
 *     data_pointer = &arr[0]
*/
  __pyx_t_5 = PyObject_Length(((PyObject *)__pyx_v_arr)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1394, __pyx_L1_error)
  __pyx_t_2 = PyLong_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_v_lDim, Py_NE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1394, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 1394, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(__pyx_t_6)) {

    /* "tmm4py/tmm4py_core.pyx":1395
 *     lDim = lNumProfiles*numValsPerProfile
 *     if len(arr) != lDim:
 *       raise RuntimeError(f"arr length does not match expected length {lDim}")             # <<<<<<<<<<<<<<
 *     data_pointer = &arr[0]
 *     ierr = writeProfileSurfaceScalarData(c_filename, data_pointer, asInt(numValsPerProfile), asBool(appendToFile))
*/
    __pyx_t_2 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_7 = __pyx_builtin_RuntimeError; 
    __pyx_t_8 = __Pyx_PyObject_FormatSimple(__pyx_v_lDim, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1395, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_9 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_arr_length_does_not_match_expect, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1395, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_3 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_9};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1395, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 1395, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":1394
 * 
 *     lDim = lNumProfiles*numValsPerProfile
 *     if len(arr) != lDim:             # <<<<<<<<<<<<<<
 *       raise RuntimeError(f"arr length does not match expected length {lDim}")
 *     data_pointer = &arr[0]
*/
  }

  /* "tmm4py/tmm4py_core.pyx":1396
 *     if len(arr) != lDim:
 *       raise RuntimeError(f"arr length does not match expected length {lDim}")
 *     data_pointer = &arr[0]             # <<<<<<<<<<<<<<
 *     ierr = writeProfileSurfaceScalarData(c_filename, data_pointer, asInt(numValsPerProfile), asBool(appendToFile))
 *     if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_t_10 = 0;
  __pyx_t_11 = -1;
  if (__pyx_t_10 < 0) {
    __pyx_t_10 += __pyx_pybuffernd_arr.diminfo[0].shape;
    if (unlikely(__pyx_t_10 < 0)) __pyx_t_11 = 0;
  } else if (unlikely(__pyx_t_10 >= __pyx_pybuffernd_arr.diminfo[0].shape)) __pyx_t_11 = 0;
  if (unlikely(__pyx_t_11 != -1)) {
    __Pyx_RaiseBufferIndexError(__pyx_t_11);
    __PYX_ERR(0, 1396, __pyx_L1_error)
  }
  __pyx_v_data_pointer = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_arr.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_arr.diminfo[0].strides)));

  /* "tmm4py/tmm4py_core.pyx":1397
 *       raise RuntimeError(f"arr length does not match expected length {lDim}")
 *     data_pointer = &arr[0]
 *     ierr = writeProfileSurfaceScalarData(c_filename, data_pointer, asInt(numValsPerProfile), asBool(appendToFile))             # <<<<<<<<<<<<<<
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_t_12 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_v_numValsPerProfile); if (unlikely(__pyx_t_12 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 1397, __pyx_L1_error)
  __pyx_t_13 = __pyx_f_6tmm4py_11tmm4py_core_asBool(__pyx_v_appendToFile); if (unlikely(__pyx_t_13 == ((PetscBool)((PetscBool)0)) && PyErr_Occurred())) __PYX_ERR(0, 1397, __pyx_L1_error)
  __pyx_v_ierr = writeProfileSurfaceScalarData(__pyx_v_c_filename, __pyx_v_data_pointer, __pyx_t_12, __pyx_t_13);

  /* "tmm4py/tmm4py_core.pyx":1398
 *     data_pointer = &arr[0]
 *     ierr = writeProfileSurfaceScalarData(c_filename, data_pointer, asInt(numValsPerProfile), asBool(appendToFile))
 *     if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 * def writeArrayToVec(filename, np.ndarray[double, ndim=1, mode="c"] arr not None, mode):
*/
  __pyx_t_6 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_6)) {
    __pyx_t_7 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1398, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1398, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1398, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_3 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
      assert(__pyx_t_7);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_2, __pyx__function);
      __pyx_t_3 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_9};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1398, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 1398, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1386
 * #       Note: the memory is owned by the array buf
 * 
 * def writeProfileScalarData(filename, np.ndarray[double, ndim=1, mode="c"] arr not None, numValsPerProfile=1, appendToFile=False):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *data_pointer
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_arr.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.writeProfileScalarData", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_arr.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF(__pyx_v_lDim);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1400
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
 * def writeArrayToVec(filename, np.ndarray[double, ndim=1, mode="c"] arr not None, mode):             # <<<<<<<<<<<<<<
 * #         if   mode == 'r'  : return PETSC_FILE_MODE_READ
 * #         elif mode == 'w'  : return PETSC_FILE_MODE_WRITE
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_23writeArrayToVec(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_23writeArrayToVec = {"writeArrayToVec", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_23writeArrayToVec, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_23writeArrayToVec(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_filename = 0;
  PyArrayObject *__pyx_v_arr = 0;
  PyObject *__pyx_v_mode = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("writeArrayToVec (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_filename,&__pyx_mstate_global->__pyx_n_u_arr,&__pyx_mstate_global->__pyx_n_u_mode,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1400, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1400, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1400, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1400, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "writeArrayToVec", 0) < 0) __PYX_ERR(0, 1400, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 3; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("writeArrayToVec", 1, 3, 3, i); __PYX_ERR(0, 1400, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1400, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1400, __pyx_L3_error)
      values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1400, __pyx_L3_error)
    }
    __pyx_v_filename = values[0];
    __pyx_v_arr = ((PyArrayObject *)values[1]);
    __pyx_v_mode = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("writeArrayToVec", 1, 3, 3, __pyx_nargs); __PYX_ERR(0, 1400, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.writeArrayToVec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 0, "arr", 0))) __PYX_ERR(0, 1400, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_22writeArrayToVec(__pyx_self, __pyx_v_filename, __pyx_v_arr, __pyx_v_mode);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_22writeArrayToVec(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_filename, PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_mode) {
  PyObject *__pyx_v_c = NULL;
  PyObject *__pyx_v_viewer = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_arr;
  __Pyx_Buffer __pyx_pybuffer_arr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  size_t __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("writeArrayToVec", 0);
  __pyx_pybuffer_arr.pybuffer.buf = NULL;
  __pyx_pybuffer_arr.refcount = 0;
  __pyx_pybuffernd_arr.data = NULL;
  __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1400, __pyx_L1_error)
  }
  __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1411
 * #         elif mode == 'ua' : return PETSC_FILE_MODE_APPEND_UPDATE
 * 
 *     c = petsc4py.PETSc.Vec() #.create(comm=petsc4py.PETSc.COMM_WORLD)             # <<<<<<<<<<<<<<
 *     c.createWithArray(arr,comm=petsc4py.PETSc.COMM_WORLD)
 * 
*/
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_petsc4py); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1411, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1411, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = __pyx_t_4;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_Vec, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1411, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_v_c = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1412
 * 
 *     c = petsc4py.PETSc.Vec() #.create(comm=petsc4py.PETSc.COMM_WORLD)
 *     c.createWithArray(arr,comm=petsc4py.PETSc.COMM_WORLD)             # <<<<<<<<<<<<<<
 * 
 * #     ierr = PetscViewerBinaryOpen(PETSC_COMM_WORLD,filename,mode,&fd);CHKERRQ(ierr);
*/
  __pyx_t_4 = __pyx_v_c;
  __Pyx_INCREF(__pyx_t_4);
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_petsc4py); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_COMM_WORLD); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_4, ((PyObject *)__pyx_v_arr)};
    __pyx_t_3 = __Pyx_MakeVectorcallBuilderKwds(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1412, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    if (__Pyx_VectorcallBuilder_AddArg(__pyx_mstate_global->__pyx_n_u_comm, __pyx_t_2, __pyx_t_3, __pyx_callargs+2, 0) < 0) __PYX_ERR(0, 1412, __pyx_L1_error)
    __pyx_t_1 = __Pyx_Object_VectorcallMethod_CallFromBuilder(__pyx_mstate_global->__pyx_n_u_createWithArray, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1412, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1415
 * 
 * #     ierr = PetscViewerBinaryOpen(PETSC_COMM_WORLD,filename,mode,&fd);CHKERRQ(ierr);
 *     viewer = PETSc.Viewer().createBinary(filename, mode=mode)             # <<<<<<<<<<<<<<
 *     c.view(viewer)
 *     viewer.destroy()
*/
  __pyx_t_4 = NULL;
  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1415, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_Viewer); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1415, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_7);
    assert(__pyx_t_4);
    PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_7);
    __Pyx_INCREF(__pyx_t_4);
    __Pyx_INCREF(__pyx__function);
    __Pyx_DECREF_SET(__pyx_t_7, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
    __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1415, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  }
  __pyx_t_3 = __pyx_t_2;
  __Pyx_INCREF(__pyx_t_3);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_3, __pyx_v_filename};
    __pyx_t_7 = __Pyx_MakeVectorcallBuilderKwds(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1415, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    if (__Pyx_VectorcallBuilder_AddArg(__pyx_mstate_global->__pyx_n_u_mode, __pyx_v_mode, __pyx_t_7, __pyx_callargs+2, 0) < 0) __PYX_ERR(0, 1415, __pyx_L1_error)
    __pyx_t_1 = __Pyx_Object_VectorcallMethod_CallFromBuilder(__pyx_mstate_global->__pyx_n_u_createBinary, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_7);
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1415, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_v_viewer = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1416
 * #     ierr = PetscViewerBinaryOpen(PETSC_COMM_WORLD,filename,mode,&fd);CHKERRQ(ierr);
 *     viewer = PETSc.Viewer().createBinary(filename, mode=mode)
 *     c.view(viewer)             # <<<<<<<<<<<<<<
 *     viewer.destroy()
 *     c.destroy()
*/
  __pyx_t_2 = __pyx_v_c;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_viewer};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_view, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1416, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1417
 *     viewer = PETSc.Viewer().createBinary(filename, mode=mode)
 *     c.view(viewer)
 *     viewer.destroy()             # <<<<<<<<<<<<<<
 *     c.destroy()
 * 
*/
  __pyx_t_2 = __pyx_v_viewer;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_destroy, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1417, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1418
 *     c.view(viewer)
 *     viewer.destroy()
 *     c.destroy()             # <<<<<<<<<<<<<<
 * 
 * def writeBinaryArray(filename, np.ndarray[double, ndim=1, mode="c"] arr not None, appendToFile=False):
*/
  __pyx_t_2 = __pyx_v_c;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_destroy, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1418, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1400
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
 * def writeArrayToVec(filename, np.ndarray[double, ndim=1, mode="c"] arr not None, mode):             # <<<<<<<<<<<<<<
 * #         if   mode == 'r'  : return PETSC_FILE_MODE_READ
 * #         elif mode == 'w'  : return PETSC_FILE_MODE_WRITE
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_arr.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.writeArrayToVec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_arr.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF(__pyx_v_c);
  __Pyx_XDECREF(__pyx_v_viewer);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1420
 *     c.destroy()
 * 
 * def writeBinaryArray(filename, np.ndarray[double, ndim=1, mode="c"] arr not None, appendToFile=False):             # <<<<<<<<<<<<<<
 * #   Note: writeBinaryScalarData only writes on rank 0. You can call this from all ranks
 *     cdef PetscErrorCode ierr
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_25writeBinaryArray(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_25writeBinaryArray = {"writeBinaryArray", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_25writeBinaryArray, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_25writeBinaryArray(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_filename = 0;
  PyArrayObject *__pyx_v_arr = 0;
  PyObject *__pyx_v_appendToFile = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[3] = {0,0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("writeBinaryArray (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_filename,&__pyx_mstate_global->__pyx_n_u_arr,&__pyx_mstate_global->__pyx_n_u_appendToFile,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1420, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1420, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1420, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1420, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "writeBinaryArray", 0) < 0) __PYX_ERR(0, 1420, __pyx_L3_error)
      if (!values[2]) values[2] = __Pyx_NewRef(((PyObject *)((PyObject*)Py_False)));
      for (Py_ssize_t i = __pyx_nargs; i < 2; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("writeBinaryArray", 0, 2, 3, i); __PYX_ERR(0, 1420, __pyx_L3_error) }
      }
    } else {
      switch (__pyx_nargs) {
        case  3:
        values[2] = __Pyx_ArgRef_FASTCALL(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[2])) __PYX_ERR(0, 1420, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1420, __pyx_L3_error)
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1420, __pyx_L3_error)
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[2]) values[2] = __Pyx_NewRef(((PyObject *)((PyObject*)Py_False)));
    }
    __pyx_v_filename = values[0];
    __pyx_v_arr = ((PyArrayObject *)values[1]);
    __pyx_v_appendToFile = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("writeBinaryArray", 0, 2, 3, __pyx_nargs); __PYX_ERR(0, 1420, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.writeBinaryArray", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 0, "arr", 0))) __PYX_ERR(0, 1420, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_24writeBinaryArray(__pyx_self, __pyx_v_filename, __pyx_v_arr, __pyx_v_appendToFile);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_24writeBinaryArray(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_filename, PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_appendToFile) {
  PetscErrorCode __pyx_v_ierr;
  PetscScalar *__pyx_v_data_pointer;
  char const *__pyx_v_c_filename;
  Py_ssize_t __pyx_v_N;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_arr;
  __Pyx_Buffer __pyx_pybuffer_arr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  size_t __pyx_t_3;
  char *__pyx_t_4;
  Py_ssize_t __pyx_t_5;
  Py_ssize_t __pyx_t_6;
  int __pyx_t_7;
  PetscBool __pyx_t_8;
  int __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("writeBinaryArray", 0);
  __pyx_pybuffer_arr.pybuffer.buf = NULL;
  __pyx_pybuffer_arr.refcount = 0;
  __pyx_pybuffernd_arr.data = NULL;
  __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1420, __pyx_L1_error)
  }
  __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1426
 *     cdef const char* c_filename
 * 
 *     c_filename = PyBytes_AsString(filename.encode())             # <<<<<<<<<<<<<<
 *     N=len(arr)
 *     data_pointer = &arr[0]
*/
  __pyx_t_2 = __pyx_v_filename;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_3 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_encode, __pyx_callargs+__pyx_t_3, (1-__pyx_t_3) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1426, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_t_4 = PyBytes_AsString(__pyx_t_1); if (unlikely(__pyx_t_4 == ((char *)0))) __PYX_ERR(0, 1426, __pyx_L1_error)
  __pyx_v_c_filename = __pyx_t_4;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1427
 * 
 *     c_filename = PyBytes_AsString(filename.encode())
 *     N=len(arr)             # <<<<<<<<<<<<<<
 *     data_pointer = &arr[0]
 *     ierr = writeBinaryScalarData(c_filename, data_pointer, N, asBool(appendToFile))
*/
  __pyx_t_5 = PyObject_Length(((PyObject *)__pyx_v_arr)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1427, __pyx_L1_error)
  __pyx_v_N = __pyx_t_5;

  /* "tmm4py/tmm4py_core.pyx":1428
 *     c_filename = PyBytes_AsString(filename.encode())
 *     N=len(arr)
 *     data_pointer = &arr[0]             # <<<<<<<<<<<<<<
 *     ierr = writeBinaryScalarData(c_filename, data_pointer, N, asBool(appendToFile))
 *     if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_t_6 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_6 < 0) {
    __pyx_t_6 += __pyx_pybuffernd_arr.diminfo[0].shape;
    if (unlikely(__pyx_t_6 < 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_6 >= __pyx_pybuffernd_arr.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    __Pyx_RaiseBufferIndexError(__pyx_t_7);
    __PYX_ERR(0, 1428, __pyx_L1_error)
  }
  __pyx_v_data_pointer = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_arr.rcbuffer->pybuffer.buf, __pyx_t_6, __pyx_pybuffernd_arr.diminfo[0].strides)));

  /* "tmm4py/tmm4py_core.pyx":1429
 *     N=len(arr)
 *     data_pointer = &arr[0]
 *     ierr = writeBinaryScalarData(c_filename, data_pointer, N, asBool(appendToFile))             # <<<<<<<<<<<<<<
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_t_8 = __pyx_f_6tmm4py_11tmm4py_core_asBool(__pyx_v_appendToFile); if (unlikely(__pyx_t_8 == ((PetscBool)((PetscBool)0)) && PyErr_Occurred())) __PYX_ERR(0, 1429, __pyx_L1_error)
  __pyx_v_ierr = writeBinaryScalarData(__pyx_v_c_filename, __pyx_v_data_pointer, __pyx_v_N, __pyx_t_8);

  /* "tmm4py/tmm4py_core.pyx":1430
 *     data_pointer = &arr[0]
 *     ierr = writeBinaryScalarData(c_filename, data_pointer, N, asBool(appendToFile))
 *     if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 * def barrier():
*/
  __pyx_t_9 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_9)) {
    __pyx_t_2 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1430, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1430, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1430, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_3 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_11))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_11);
      assert(__pyx_t_2);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_11);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_11, __pyx__function);
      __pyx_t_3 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_10};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_11, __pyx_callargs+__pyx_t_3, (2-__pyx_t_3) | (__pyx_t_3*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1430, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_ERR(0, 1430, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1420
 *     c.destroy()
 * 
 * def writeBinaryArray(filename, np.ndarray[double, ndim=1, mode="c"] arr not None, appendToFile=False):             # <<<<<<<<<<<<<<
 * #   Note: writeBinaryScalarData only writes on rank 0. You can call this from all ranks
 *     cdef PetscErrorCode ierr
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_arr.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.writeBinaryArray", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_arr.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1432
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
 * def barrier():             # <<<<<<<<<<<<<<
 * 
 *     cdef PetscErrorCode ierr
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_27barrier(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_27barrier = {"barrier", (PyCFunction)__pyx_pw_6tmm4py_11tmm4py_core_27barrier, METH_NOARGS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_27barrier(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("barrier (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_26barrier(__pyx_self);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_26barrier(CYTHON_UNUSED PyObject *__pyx_self) {
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  size_t __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("barrier", 0);

  /* "tmm4py/tmm4py_core.pyx":1435
 * 
 *     cdef PetscErrorCode ierr
 *     ierr = Barrier()             # <<<<<<<<<<<<<<
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_v_ierr = Barrier();

  /* "tmm4py/tmm4py_core.pyx":1436
 *     cdef PetscErrorCode ierr
 *     ierr = Barrier()
 *     if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 * def globalScalarSum(x):
*/
  __pyx_t_1 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_1)) {
    __pyx_t_3 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1436, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1436, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1436, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
      assert(__pyx_t_3);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
      __pyx_t_6 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_6, (2-__pyx_t_6) | (__pyx_t_6*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1436, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_ERR(0, 1436, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1432
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
 * def barrier():             # <<<<<<<<<<<<<<
 * 
 *     cdef PetscErrorCode ierr
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.barrier", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1438
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
 * def globalScalarSum(x):             # <<<<<<<<<<<<<<
 * 
 *     cdef PetscErrorCode ierr
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_29globalScalarSum(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_29globalScalarSum = {"globalScalarSum", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_29globalScalarSum, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_29globalScalarSum(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_x = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("globalScalarSum (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_x,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1438, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1438, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "globalScalarSum", 0) < 0) __PYX_ERR(0, 1438, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("globalScalarSum", 1, 1, 1, i); __PYX_ERR(0, 1438, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1438, __pyx_L3_error)
    }
    __pyx_v_x = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("globalScalarSum", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1438, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.globalScalarSum", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_28globalScalarSum(__pyx_self, __pyx_v_x);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_28globalScalarSum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PetscErrorCode __pyx_v_ierr;
  PetscScalar __pyx_v_xc;
  PetscScalar __pyx_v_tot;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscReal __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  size_t __pyx_t_7;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("globalScalarSum", 0);

  /* "tmm4py/tmm4py_core.pyx":1441
 * 
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar xc = asReal(x)             # <<<<<<<<<<<<<<
 *     cdef PetscScalar tot
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core_asReal(__pyx_v_x); if (unlikely(__pyx_t_1 == ((PetscReal)-1.0) && PyErr_Occurred())) __PYX_ERR(0, 1441, __pyx_L1_error)
  __pyx_v_xc = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":1444
 *     cdef PetscScalar tot
 * 
 *     ierr = sumScalar(xc, &tot)             # <<<<<<<<<<<<<<
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_v_ierr = sumScalar(__pyx_v_xc, (&__pyx_v_tot));

  /* "tmm4py/tmm4py_core.pyx":1445
 * 
 *     ierr = sumScalar(xc, &tot)
 *     if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 *     return toReal(tot)
*/
  __pyx_t_2 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_2)) {
    __pyx_t_4 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1445, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1445, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1445, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
      assert(__pyx_t_4);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_6, __pyx__function);
      __pyx_t_7 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_5};
      __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1445, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_ERR(0, 1445, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1447
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     return toReal(tot)             # <<<<<<<<<<<<<<
 * 
 * # This should be deprecated
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_tot); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1447, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1438
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
 * def globalScalarSum(x):             # <<<<<<<<<<<<<<
 * 
 *     cdef PetscErrorCode ierr
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.globalScalarSum", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1459
 * #     return tot
 * 
 * def globalSum(np.ndarray[double, ndim=1, mode="c"] xarr not None):             # <<<<<<<<<<<<<<
 * 
 *     cdef PetscErrorCode ierr
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_31globalSum(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_31globalSum = {"globalSum", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_31globalSum, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_31globalSum(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_xarr = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("globalSum (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_xarr,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1459, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1459, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "globalSum", 0) < 0) __PYX_ERR(0, 1459, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("globalSum", 1, 1, 1, i); __PYX_ERR(0, 1459, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1459, __pyx_L3_error)
    }
    __pyx_v_xarr = ((PyArrayObject *)values[0]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("globalSum", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1459, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.globalSum", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_xarr), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 0, "xarr", 0))) __PYX_ERR(0, 1459, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_30globalSum(__pyx_self, __pyx_v_xarr);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_30globalSum(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_xarr) {
  PetscErrorCode __pyx_v_ierr;
  PetscScalar *__pyx_v_xdata_pointer;
  PetscScalar __pyx_v_res;
  Py_ssize_t __pyx_v_nx;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_xarr;
  __Pyx_Buffer __pyx_pybuffer_xarr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  Py_ssize_t __pyx_t_1;
  Py_ssize_t __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PetscInt __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  size_t __pyx_t_10;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("globalSum", 0);
  __pyx_pybuffer_xarr.pybuffer.buf = NULL;
  __pyx_pybuffer_xarr.refcount = 0;
  __pyx_pybuffernd_xarr.data = NULL;
  __pyx_pybuffernd_xarr.rcbuffer = &__pyx_pybuffer_xarr;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_xarr.rcbuffer->pybuffer, (PyObject*)__pyx_v_xarr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1459, __pyx_L1_error)
  }
  __pyx_pybuffernd_xarr.diminfo[0].strides = __pyx_pybuffernd_xarr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_xarr.diminfo[0].shape = __pyx_pybuffernd_xarr.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1465
 *     cdef PetscScalar res
 * 
 *     nx = len(xarr)             # <<<<<<<<<<<<<<
 *     xdata_pointer = &xarr[0]
 * 
*/
  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_xarr)); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1465, __pyx_L1_error)
  __pyx_v_nx = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":1466
 * 
 *     nx = len(xarr)
 *     xdata_pointer = &xarr[0]             # <<<<<<<<<<<<<<
 * 
 *     ierr = sumArray(xdata_pointer, asInt(nx), &res)
*/
  __pyx_t_2 = 0;
  __pyx_t_3 = -1;
  if (__pyx_t_2 < 0) {
    __pyx_t_2 += __pyx_pybuffernd_xarr.diminfo[0].shape;
    if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
  } else if (unlikely(__pyx_t_2 >= __pyx_pybuffernd_xarr.diminfo[0].shape)) __pyx_t_3 = 0;
  if (unlikely(__pyx_t_3 != -1)) {
    __Pyx_RaiseBufferIndexError(__pyx_t_3);
    __PYX_ERR(0, 1466, __pyx_L1_error)
  }
  __pyx_v_xdata_pointer = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_xarr.rcbuffer->pybuffer.buf, __pyx_t_2, __pyx_pybuffernd_xarr.diminfo[0].strides)));

  /* "tmm4py/tmm4py_core.pyx":1468
 *     xdata_pointer = &xarr[0]
 * 
 *     ierr = sumArray(xdata_pointer, asInt(nx), &res)             # <<<<<<<<<<<<<<
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_t_4 = PyLong_FromSsize_t(__pyx_v_nx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1468, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_t_4); if (unlikely(__pyx_t_5 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 1468, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_ierr = sumArray(__pyx_v_xdata_pointer, __pyx_t_5, (&__pyx_v_res));

  /* "tmm4py/tmm4py_core.pyx":1469
 * 
 *     ierr = sumArray(xdata_pointer, asInt(nx), &res)
 *     if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 *     return toReal(res)
*/
  __pyx_t_6 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_6)) {
    __pyx_t_7 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1469, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1469, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1469, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_10 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_9))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_9);
      assert(__pyx_t_7);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_9);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_9, __pyx__function);
      __pyx_t_10 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_8};
      __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_9, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (__pyx_t_10*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1469, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_ERR(0, 1469, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1471
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     return toReal(res)             # <<<<<<<<<<<<<<
 * 
 * def dotProd(np.ndarray[double, ndim=1, mode="c"] xarr not None, np.ndarray[double, ndim=1, mode="c"] yarr not None):
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_4 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_res); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1471, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1459
 * #     return tot
 * 
 * def globalSum(np.ndarray[double, ndim=1, mode="c"] xarr not None):             # <<<<<<<<<<<<<<
 * 
 *     cdef PetscErrorCode ierr
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_xarr.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.globalSum", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_xarr.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1473
 *     return toReal(res)
 * 
 * def dotProd(np.ndarray[double, ndim=1, mode="c"] xarr not None, np.ndarray[double, ndim=1, mode="c"] yarr not None):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *xdata_pointer
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_33dotProd(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_33dotProd = {"dotProd", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_33dotProd, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_33dotProd(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_xarr = 0;
  PyArrayObject *__pyx_v_yarr = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dotProd (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_xarr,&__pyx_mstate_global->__pyx_n_u_yarr,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1473, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1473, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1473, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "dotProd", 0) < 0) __PYX_ERR(0, 1473, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 2; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("dotProd", 1, 2, 2, i); __PYX_ERR(0, 1473, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1473, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1473, __pyx_L3_error)
    }
    __pyx_v_xarr = ((PyArrayObject *)values[0]);
    __pyx_v_yarr = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("dotProd", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 1473, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.dotProd", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_xarr), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 0, "xarr", 0))) __PYX_ERR(0, 1473, __pyx_L1_error)
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_yarr), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 0, "yarr", 0))) __PYX_ERR(0, 1473, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_32dotProd(__pyx_self, __pyx_v_xarr, __pyx_v_yarr);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_32dotProd(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_xarr, PyArrayObject *__pyx_v_yarr) {
  PetscErrorCode __pyx_v_ierr;
  PetscScalar *__pyx_v_xdata_pointer;
  PetscScalar *__pyx_v_ydata_pointer;
  PetscScalar __pyx_v_res;
  Py_ssize_t __pyx_v_nx;
  Py_ssize_t __pyx_v_ny;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_xarr;
  __Pyx_Buffer __pyx_pybuffer_xarr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_yarr;
  __Pyx_Buffer __pyx_pybuffer_yarr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  Py_ssize_t __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8[4];
  PyObject *__pyx_t_9 = NULL;
  size_t __pyx_t_10;
  Py_ssize_t __pyx_t_11;
  int __pyx_t_12;
  PetscInt __pyx_t_13;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("dotProd", 0);
  __pyx_pybuffer_xarr.pybuffer.buf = NULL;
  __pyx_pybuffer_xarr.refcount = 0;
  __pyx_pybuffernd_xarr.data = NULL;
  __pyx_pybuffernd_xarr.rcbuffer = &__pyx_pybuffer_xarr;
  __pyx_pybuffer_yarr.pybuffer.buf = NULL;
  __pyx_pybuffer_yarr.refcount = 0;
  __pyx_pybuffernd_yarr.data = NULL;
  __pyx_pybuffernd_yarr.rcbuffer = &__pyx_pybuffer_yarr;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_xarr.rcbuffer->pybuffer, (PyObject*)__pyx_v_xarr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1473, __pyx_L1_error)
  }
  __pyx_pybuffernd_xarr.diminfo[0].strides = __pyx_pybuffernd_xarr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_xarr.diminfo[0].shape = __pyx_pybuffernd_xarr.rcbuffer->pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_yarr.rcbuffer->pybuffer, (PyObject*)__pyx_v_yarr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1473, __pyx_L1_error)
  }
  __pyx_pybuffernd_yarr.diminfo[0].strides = __pyx_pybuffernd_yarr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_yarr.diminfo[0].shape = __pyx_pybuffernd_yarr.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1479
 *     cdef PetscScalar res
 * 
 *     nx = len(xarr)             # <<<<<<<<<<<<<<
 *     ny = len(yarr)
 *     if nx != ny:
*/
  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_xarr)); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1479, __pyx_L1_error)
  __pyx_v_nx = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":1480
 * 
 *     nx = len(xarr)
 *     ny = len(yarr)             # <<<<<<<<<<<<<<
 *     if nx != ny:
 *       raise RuntimeError(f"xarr length {nx} does not equal yarr length {ny}")
*/
  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_yarr)); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1480, __pyx_L1_error)
  __pyx_v_ny = __pyx_t_1;

  /* "tmm4py/tmm4py_core.pyx":1481
 *     nx = len(xarr)
 *     ny = len(yarr)
 *     if nx != ny:             # <<<<<<<<<<<<<<
 *       raise RuntimeError(f"xarr length {nx} does not equal yarr length {ny}")
 * 
*/
  __pyx_t_2 = (__pyx_v_nx != __pyx_v_ny);
  if (unlikely(__pyx_t_2)) {

    /* "tmm4py/tmm4py_core.pyx":1482
 *     ny = len(yarr)
 *     if nx != ny:
 *       raise RuntimeError(f"xarr length {nx} does not equal yarr length {ny}")             # <<<<<<<<<<<<<<
 * 
 *     xdata_pointer = &xarr[0]
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_v_nx, 0, ' ', 'd'); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1482, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_v_ny, 0, ' ', 'd'); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1482, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8[0] = __pyx_mstate_global->__pyx_kp_u_xarr_length;
    __pyx_t_8[1] = __pyx_t_6;
    __pyx_t_8[2] = __pyx_mstate_global->__pyx_kp_u_does_not_equal_yarr_length;
    __pyx_t_8[3] = __pyx_t_7;
    __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_8, 4, 12 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_6) + 28 + __Pyx_PyUnicode_GET_LENGTH(__pyx_t_7), 127);
    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1482, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_10 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_9};
      __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (__pyx_t_10*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1482, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_ERR(0, 1482, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":1481
 *     nx = len(xarr)
 *     ny = len(yarr)
 *     if nx != ny:             # <<<<<<<<<<<<<<
 *       raise RuntimeError(f"xarr length {nx} does not equal yarr length {ny}")
 * 
*/
  }

  /* "tmm4py/tmm4py_core.pyx":1484
 *       raise RuntimeError(f"xarr length {nx} does not equal yarr length {ny}")
 * 
 *     xdata_pointer = &xarr[0]             # <<<<<<<<<<<<<<
 *     ydata_pointer = &yarr[0]
 * 
*/
  __pyx_t_11 = 0;
  __pyx_t_12 = -1;
  if (__pyx_t_11 < 0) {
    __pyx_t_11 += __pyx_pybuffernd_xarr.diminfo[0].shape;
    if (unlikely(__pyx_t_11 < 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_11 >= __pyx_pybuffernd_xarr.diminfo[0].shape)) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    __Pyx_RaiseBufferIndexError(__pyx_t_12);
    __PYX_ERR(0, 1484, __pyx_L1_error)
  }
  __pyx_v_xdata_pointer = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_xarr.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_xarr.diminfo[0].strides)));

  /* "tmm4py/tmm4py_core.pyx":1485
 * 
 *     xdata_pointer = &xarr[0]
 *     ydata_pointer = &yarr[0]             # <<<<<<<<<<<<<<
 * 
 *     ierr = dotProdArrays(xdata_pointer, ydata_pointer, asInt(nx), &res)
*/
  __pyx_t_11 = 0;
  __pyx_t_12 = -1;
  if (__pyx_t_11 < 0) {
    __pyx_t_11 += __pyx_pybuffernd_yarr.diminfo[0].shape;
    if (unlikely(__pyx_t_11 < 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_11 >= __pyx_pybuffernd_yarr.diminfo[0].shape)) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    __Pyx_RaiseBufferIndexError(__pyx_t_12);
    __PYX_ERR(0, 1485, __pyx_L1_error)
  }
  __pyx_v_ydata_pointer = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_yarr.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_yarr.diminfo[0].strides)));

  /* "tmm4py/tmm4py_core.pyx":1487
 *     ydata_pointer = &yarr[0]
 * 
 *     ierr = dotProdArrays(xdata_pointer, ydata_pointer, asInt(nx), &res)             # <<<<<<<<<<<<<<
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_t_3 = PyLong_FromSsize_t(__pyx_v_nx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1487, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_13 = __pyx_f_6tmm4py_11tmm4py_core_asInt(__pyx_t_3); if (unlikely(__pyx_t_13 == ((PetscInt)-1) && PyErr_Occurred())) __PYX_ERR(0, 1487, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_ierr = dotProdArrays(__pyx_v_xdata_pointer, __pyx_v_ydata_pointer, __pyx_t_13, (&__pyx_v_res));

  /* "tmm4py/tmm4py_core.pyx":1488
 * 
 *     ierr = dotProdArrays(xdata_pointer, ydata_pointer, asInt(nx), &res)
 *     if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 *     return toReal(res)
*/
  __pyx_t_2 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_2)) {
    __pyx_t_5 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1488, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1488, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1488, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_10 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
      assert(__pyx_t_5);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_4, __pyx__function);
      __pyx_t_10 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_9};
      __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (__pyx_t_10*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1488, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_ERR(0, 1488, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1490
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     return toReal(res)             # <<<<<<<<<<<<<<
 * 
 * # This should be deprecated
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_res); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1490, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1473
 *     return toReal(res)
 * 
 * def dotProd(np.ndarray[double, ndim=1, mode="c"] xarr not None, np.ndarray[double, ndim=1, mode="c"] yarr not None):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *xdata_pointer
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_9);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_xarr.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_yarr.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.dotProd", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_xarr.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_yarr.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1493
 * 
 * # This should be deprecated
 * def dotProdProfileScalarData(np.ndarray[double, ndim=1, mode="c"] xarr not None, np.ndarray[double, ndim=1, mode="c"] yarr not None):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *xdata_pointer
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_35dotProdProfileScalarData(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_35dotProdProfileScalarData = {"dotProdProfileScalarData", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_35dotProdProfileScalarData, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_35dotProdProfileScalarData(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_xarr = 0;
  PyArrayObject *__pyx_v_yarr = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dotProdProfileScalarData (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_xarr,&__pyx_mstate_global->__pyx_n_u_yarr,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1493, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1493, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1493, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "dotProdProfileScalarData", 0) < 0) __PYX_ERR(0, 1493, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 2; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("dotProdProfileScalarData", 1, 2, 2, i); __PYX_ERR(0, 1493, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1493, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1493, __pyx_L3_error)
    }
    __pyx_v_xarr = ((PyArrayObject *)values[0]);
    __pyx_v_yarr = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("dotProdProfileScalarData", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 1493, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.dotProdProfileScalarData", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_xarr), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 0, "xarr", 0))) __PYX_ERR(0, 1493, __pyx_L1_error)
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_yarr), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 0, "yarr", 0))) __PYX_ERR(0, 1493, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_34dotProdProfileScalarData(__pyx_self, __pyx_v_xarr, __pyx_v_yarr);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_34dotProdProfileScalarData(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_xarr, PyArrayObject *__pyx_v_yarr) {
  PetscErrorCode __pyx_v_ierr;
  PetscScalar *__pyx_v_xdata_pointer;
  PetscScalar *__pyx_v_ydata_pointer;
  PetscScalar __pyx_v_res;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_xarr;
  __Pyx_Buffer __pyx_pybuffer_xarr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_yarr;
  __Pyx_Buffer __pyx_pybuffer_yarr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  Py_ssize_t __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  size_t __pyx_t_8;
  Py_ssize_t __pyx_t_9;
  int __pyx_t_10;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("dotProdProfileScalarData", 0);
  __pyx_pybuffer_xarr.pybuffer.buf = NULL;
  __pyx_pybuffer_xarr.refcount = 0;
  __pyx_pybuffernd_xarr.data = NULL;
  __pyx_pybuffernd_xarr.rcbuffer = &__pyx_pybuffer_xarr;
  __pyx_pybuffer_yarr.pybuffer.buf = NULL;
  __pyx_pybuffer_yarr.refcount = 0;
  __pyx_pybuffernd_yarr.data = NULL;
  __pyx_pybuffernd_yarr.rcbuffer = &__pyx_pybuffer_yarr;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_xarr.rcbuffer->pybuffer, (PyObject*)__pyx_v_xarr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1493, __pyx_L1_error)
  }
  __pyx_pybuffernd_xarr.diminfo[0].strides = __pyx_pybuffernd_xarr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_xarr.diminfo[0].shape = __pyx_pybuffernd_xarr.rcbuffer->pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_yarr.rcbuffer->pybuffer, (PyObject*)__pyx_v_yarr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1493, __pyx_L1_error)
  }
  __pyx_pybuffernd_yarr.diminfo[0].strides = __pyx_pybuffernd_yarr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_yarr.diminfo[0].shape = __pyx_pybuffernd_yarr.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1499
 *     cdef PetscScalar res
 * 
 *     if (len(xarr) != lNumProfiles):             # <<<<<<<<<<<<<<
 *       raise RuntimeError(f"xarr length does not match expected length {lNumProfiles}")
 * 
*/
  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_xarr)); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1499, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != lNumProfiles);
  if (unlikely(__pyx_t_2)) {

    /* "tmm4py/tmm4py_core.pyx":1500
 * 
 *     if (len(xarr) != lNumProfiles):
 *       raise RuntimeError(f"xarr length does not match expected length {lNumProfiles}")             # <<<<<<<<<<<<<<
 * 
 *     if (len(yarr) != lNumProfiles):
*/
    __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_5 = __pyx_builtin_RuntimeError; 
    __pyx_t_6 = __Pyx_PyLong_From_PetscInt(lNumProfiles); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1500, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_t_6, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1500, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_xarr_length_does_not_match_expec, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1500, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_8 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_6};
      __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_8, (2-__pyx_t_8) | (__pyx_t_8*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_ERR(0, 1500, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":1499
 *     cdef PetscScalar res
 * 
 *     if (len(xarr) != lNumProfiles):             # <<<<<<<<<<<<<<
 *       raise RuntimeError(f"xarr length does not match expected length {lNumProfiles}")
 * 
*/
  }

  /* "tmm4py/tmm4py_core.pyx":1502
 *       raise RuntimeError(f"xarr length does not match expected length {lNumProfiles}")
 * 
 *     if (len(yarr) != lNumProfiles):             # <<<<<<<<<<<<<<
 *       raise RuntimeError(f"yarr length does not match expected length {lNumProfiles}")
 * 
*/
  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_yarr)); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1502, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != lNumProfiles);
  if (unlikely(__pyx_t_2)) {

    /* "tmm4py/tmm4py_core.pyx":1503
 * 
 *     if (len(yarr) != lNumProfiles):
 *       raise RuntimeError(f"yarr length does not match expected length {lNumProfiles}")             # <<<<<<<<<<<<<<
 * 
 *     xdata_pointer = &xarr[0]
*/
    __pyx_t_5 = NULL;
    __Pyx_INCREF(__pyx_builtin_RuntimeError);
    __pyx_t_6 = __pyx_builtin_RuntimeError; 
    __pyx_t_4 = __Pyx_PyLong_From_PetscInt(lNumProfiles); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1503, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_mstate_global->__pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1503, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_yarr_length_does_not_match_expec, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1503, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_8 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+__pyx_t_8, (2-__pyx_t_8) | (__pyx_t_8*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1503, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_ERR(0, 1503, __pyx_L1_error)

    /* "tmm4py/tmm4py_core.pyx":1502
 *       raise RuntimeError(f"xarr length does not match expected length {lNumProfiles}")
 * 
 *     if (len(yarr) != lNumProfiles):             # <<<<<<<<<<<<<<
 *       raise RuntimeError(f"yarr length does not match expected length {lNumProfiles}")
 * 
*/
  }

  /* "tmm4py/tmm4py_core.pyx":1505
 *       raise RuntimeError(f"yarr length does not match expected length {lNumProfiles}")
 * 
 *     xdata_pointer = &xarr[0]             # <<<<<<<<<<<<<<
 *     ydata_pointer = &yarr[0]
 * 
*/
  __pyx_t_9 = 0;
  __pyx_t_10 = -1;
  if (__pyx_t_9 < 0) {
    __pyx_t_9 += __pyx_pybuffernd_xarr.diminfo[0].shape;
    if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 0;
  } else if (unlikely(__pyx_t_9 >= __pyx_pybuffernd_xarr.diminfo[0].shape)) __pyx_t_10 = 0;
  if (unlikely(__pyx_t_10 != -1)) {
    __Pyx_RaiseBufferIndexError(__pyx_t_10);
    __PYX_ERR(0, 1505, __pyx_L1_error)
  }
  __pyx_v_xdata_pointer = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_xarr.rcbuffer->pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_xarr.diminfo[0].strides)));

  /* "tmm4py/tmm4py_core.pyx":1506
 * 
 *     xdata_pointer = &xarr[0]
 *     ydata_pointer = &yarr[0]             # <<<<<<<<<<<<<<
 * 
 *     ierr = dotProdProfileSurfaceScalarData(xdata_pointer, ydata_pointer, &res)
*/
  __pyx_t_9 = 0;
  __pyx_t_10 = -1;
  if (__pyx_t_9 < 0) {
    __pyx_t_9 += __pyx_pybuffernd_yarr.diminfo[0].shape;
    if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 0;
  } else if (unlikely(__pyx_t_9 >= __pyx_pybuffernd_yarr.diminfo[0].shape)) __pyx_t_10 = 0;
  if (unlikely(__pyx_t_10 != -1)) {
    __Pyx_RaiseBufferIndexError(__pyx_t_10);
    __PYX_ERR(0, 1506, __pyx_L1_error)
  }
  __pyx_v_ydata_pointer = (&(*__Pyx_BufPtrCContig1d(double *, __pyx_pybuffernd_yarr.rcbuffer->pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_yarr.diminfo[0].strides)));

  /* "tmm4py/tmm4py_core.pyx":1508
 *     ydata_pointer = &yarr[0]
 * 
 *     ierr = dotProdProfileSurfaceScalarData(xdata_pointer, ydata_pointer, &res)             # <<<<<<<<<<<<<<
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
*/
  __pyx_v_ierr = dotProdProfileSurfaceScalarData(__pyx_v_xdata_pointer, __pyx_v_ydata_pointer, (&__pyx_v_res));

  /* "tmm4py/tmm4py_core.pyx":1509
 * 
 *     ierr = dotProdProfileSurfaceScalarData(xdata_pointer, ydata_pointer, &res)
 *     if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * 
 *     return toReal(res)
*/
  __pyx_t_2 = (__pyx_v_ierr != 0);
  if (unlikely(__pyx_t_2)) {
    __pyx_t_6 = NULL;
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1509, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1509, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1509, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_8 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
      assert(__pyx_t_6);
      PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(__pyx__function);
      __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
      __pyx_t_8 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_4};
      __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+__pyx_t_8, (2-__pyx_t_8) | (__pyx_t_8*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1509, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_ERR(0, 1509, __pyx_L1_error)
  }

  /* "tmm4py/tmm4py_core.pyx":1511
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     return toReal(res)             # <<<<<<<<<<<<<<
 * 
 * # This should be deprecated
*/
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __pyx_f_6tmm4py_11tmm4py_core_toReal(__pyx_v_res); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1511, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1493
 * 
 * # This should be deprecated
 * def dotProdProfileScalarData(np.ndarray[double, ndim=1, mode="c"] xarr not None, np.ndarray[double, ndim=1, mode="c"] yarr not None):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *xdata_pointer
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_xarr.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_yarr.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.dotProdProfileScalarData", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_xarr.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_yarr.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1514
 * 
 * # This should be deprecated
 * def dotProdVecs(np.ndarray[double, ndim=1, mode="c"] xarr not None, np.ndarray[double, ndim=1, mode="c"] yarr not None):             # <<<<<<<<<<<<<<
 * 
 *     x = petsc4py.PETSc.Vec()
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_37dotProdVecs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_37dotProdVecs = {"dotProdVecs", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_37dotProdVecs, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_37dotProdVecs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_xarr = 0;
  PyArrayObject *__pyx_v_yarr = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dotProdVecs (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_xarr,&__pyx_mstate_global->__pyx_n_u_yarr,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1514, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1514, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1514, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "dotProdVecs", 0) < 0) __PYX_ERR(0, 1514, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 2; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("dotProdVecs", 1, 2, 2, i); __PYX_ERR(0, 1514, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1514, __pyx_L3_error)
      values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1514, __pyx_L3_error)
    }
    __pyx_v_xarr = ((PyArrayObject *)values[0]);
    __pyx_v_yarr = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("dotProdVecs", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 1514, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core.dotProdVecs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_xarr), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 0, "xarr", 0))) __PYX_ERR(0, 1514, __pyx_L1_error)
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_yarr), __pyx_mstate_global->__pyx_ptype_5numpy_ndarray, 0, "yarr", 0))) __PYX_ERR(0, 1514, __pyx_L1_error)
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_36dotProdVecs(__pyx_self, __pyx_v_xarr, __pyx_v_yarr);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_36dotProdVecs(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_xarr, PyArrayObject *__pyx_v_yarr) {
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_v_res = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_xarr;
  __Pyx_Buffer __pyx_pybuffer_xarr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_yarr;
  __Pyx_Buffer __pyx_pybuffer_yarr;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  size_t __pyx_t_5;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("dotProdVecs", 0);
  __pyx_pybuffer_xarr.pybuffer.buf = NULL;
  __pyx_pybuffer_xarr.refcount = 0;
  __pyx_pybuffernd_xarr.data = NULL;
  __pyx_pybuffernd_xarr.rcbuffer = &__pyx_pybuffer_xarr;
  __pyx_pybuffer_yarr.pybuffer.buf = NULL;
  __pyx_pybuffer_yarr.refcount = 0;
  __pyx_pybuffernd_yarr.data = NULL;
  __pyx_pybuffernd_yarr.rcbuffer = &__pyx_pybuffer_yarr;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_xarr.rcbuffer->pybuffer, (PyObject*)__pyx_v_xarr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1514, __pyx_L1_error)
  }
  __pyx_pybuffernd_xarr.diminfo[0].strides = __pyx_pybuffernd_xarr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_xarr.diminfo[0].shape = __pyx_pybuffernd_xarr.rcbuffer->pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_yarr.rcbuffer->pybuffer, (PyObject*)__pyx_v_yarr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1514, __pyx_L1_error)
  }
  __pyx_pybuffernd_yarr.diminfo[0].strides = __pyx_pybuffernd_yarr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_yarr.diminfo[0].shape = __pyx_pybuffernd_yarr.rcbuffer->pybuffer.shape[0];

  /* "tmm4py/tmm4py_core.pyx":1516
 * def dotProdVecs(np.ndarray[double, ndim=1, mode="c"] xarr not None, np.ndarray[double, ndim=1, mode="c"] yarr not None):
 * 
 *     x = petsc4py.PETSc.Vec()             # <<<<<<<<<<<<<<
 *     x.createWithArray(xarr,comm=petsc4py.PETSc.COMM_WORLD)
 *     y = petsc4py.PETSc.Vec()
*/
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_petsc4py); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1516, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1516, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = __pyx_t_4;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_Vec, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1516, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_v_x = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1517
 * 
 *     x = petsc4py.PETSc.Vec()
 *     x.createWithArray(xarr,comm=petsc4py.PETSc.COMM_WORLD)             # <<<<<<<<<<<<<<
 *     y = petsc4py.PETSc.Vec()
 *     y.createWithArray(yarr,comm=petsc4py.PETSc.COMM_WORLD)
*/
  __pyx_t_4 = __pyx_v_x;
  __Pyx_INCREF(__pyx_t_4);
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_petsc4py); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1517, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1517, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_COMM_WORLD); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1517, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_4, ((PyObject *)__pyx_v_xarr)};
    __pyx_t_3 = __Pyx_MakeVectorcallBuilderKwds(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1517, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    if (__Pyx_VectorcallBuilder_AddArg(__pyx_mstate_global->__pyx_n_u_comm, __pyx_t_2, __pyx_t_3, __pyx_callargs+2, 0) < 0) __PYX_ERR(0, 1517, __pyx_L1_error)
    __pyx_t_1 = __Pyx_Object_VectorcallMethod_CallFromBuilder(__pyx_mstate_global->__pyx_n_u_createWithArray, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1517, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1518
 *     x = petsc4py.PETSc.Vec()
 *     x.createWithArray(xarr,comm=petsc4py.PETSc.COMM_WORLD)
 *     y = petsc4py.PETSc.Vec()             # <<<<<<<<<<<<<<
 *     y.createWithArray(yarr,comm=petsc4py.PETSc.COMM_WORLD)
 * 
*/
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_petsc4py); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1518, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1518, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __pyx_t_4;
  __Pyx_INCREF(__pyx_t_3);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_Vec, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1518, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_v_y = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1519
 *     x.createWithArray(xarr,comm=petsc4py.PETSc.COMM_WORLD)
 *     y = petsc4py.PETSc.Vec()
 *     y.createWithArray(yarr,comm=petsc4py.PETSc.COMM_WORLD)             # <<<<<<<<<<<<<<
 * 
 *     res=x.dot(y)
*/
  __pyx_t_4 = __pyx_v_y;
  __Pyx_INCREF(__pyx_t_4);
  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_petsc4py); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1519, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1519, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_COMM_WORLD); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1519, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_4, ((PyObject *)__pyx_v_yarr)};
    __pyx_t_2 = __Pyx_MakeVectorcallBuilderKwds(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1519, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (__Pyx_VectorcallBuilder_AddArg(__pyx_mstate_global->__pyx_n_u_comm, __pyx_t_3, __pyx_t_2, __pyx_callargs+2, 0) < 0) __PYX_ERR(0, 1519, __pyx_L1_error)
    __pyx_t_1 = __Pyx_Object_VectorcallMethod_CallFromBuilder(__pyx_mstate_global->__pyx_n_u_createWithArray, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_2);
    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1519, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1521
 *     y.createWithArray(yarr,comm=petsc4py.PETSc.COMM_WORLD)
 * 
 *     res=x.dot(y)             # <<<<<<<<<<<<<<
 * 
 *     x.destroy()
*/
  __pyx_t_2 = __pyx_v_x;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_y};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_dot, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1521, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __pyx_v_res = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1523
 *     res=x.dot(y)
 * 
 *     x.destroy()             # <<<<<<<<<<<<<<
 *     y.destroy()
 * 
*/
  __pyx_t_2 = __pyx_v_x;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_destroy, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1523, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1524
 * 
 *     x.destroy()
 *     y.destroy()             # <<<<<<<<<<<<<<
 * 
 *     return res
*/
  __pyx_t_2 = __pyx_v_y;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCallMethod(__pyx_mstate_global->__pyx_n_u_destroy, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1524, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1526
 *     y.destroy()
 * 
 *     return res             # <<<<<<<<<<<<<<
 * 
 * # These are public functions for use from other extension modules via cimport. Note that
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_res);
  __pyx_r = __pyx_v_res;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1514
 * 
 * # This should be deprecated
 * def dotProdVecs(np.ndarray[double, ndim=1, mode="c"] xarr not None, np.ndarray[double, ndim=1, mode="c"] yarr not None):             # <<<<<<<<<<<<<<
 * 
 *     x = petsc4py.PETSc.Vec()
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_xarr.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_yarr.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("tmm4py.tmm4py_core.dotProdVecs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_xarr.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_yarr.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_y);
  __Pyx_XDECREF(__pyx_v_res);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1530
 * # These are public functions for use from other extension modules via cimport. Note that
 * # no error checking is done for the validity of the pointer/length passed in.
 * cdef getNumpyRealArrayFromPointer(PetscScalar *data_pointer, PetscInt n):             # <<<<<<<<<<<<<<
 *   c=_ToNumpyRealArray(n, data_pointer, NULL, "")
 *   return c
*/

static PyObject *__pyx_f_6tmm4py_11tmm4py_core_getNumpyRealArrayFromPointer(PetscScalar *__pyx_v_data_pointer, PetscInt __pyx_v_n) {
  PyObject *__pyx_v_c = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("getNumpyRealArrayFromPointer", 0);

  /* "tmm4py/tmm4py_core.pyx":1531
 * # no error checking is done for the validity of the pointer/length passed in.
 * cdef getNumpyRealArrayFromPointer(PetscScalar *data_pointer, PetscInt n):
 *   c=_ToNumpyRealArray(n, data_pointer, NULL, "")             # <<<<<<<<<<<<<<
 *   return c
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArray(__pyx_v_n, __pyx_v_data_pointer, NULL, __pyx_mstate_global->__pyx_kp_u_); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1531, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_c = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1532
 * cdef getNumpyRealArrayFromPointer(PetscScalar *data_pointer, PetscInt n):
 *   c=_ToNumpyRealArray(n, data_pointer, NULL, "")
 *   return c             # <<<<<<<<<<<<<<
 * 
 * cdef getNumpyIntArrayFromPointer(PetscInt *data_pointer, PetscInt n):
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_c);
  __pyx_r = __pyx_v_c;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1530
 * # These are public functions for use from other extension modules via cimport. Note that
 * # no error checking is done for the validity of the pointer/length passed in.
 * cdef getNumpyRealArrayFromPointer(PetscScalar *data_pointer, PetscInt n):             # <<<<<<<<<<<<<<
 *   c=_ToNumpyRealArray(n, data_pointer, NULL, "")
 *   return c
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.getNumpyRealArrayFromPointer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_c);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1534
 *   return c
 * 
 * cdef getNumpyIntArrayFromPointer(PetscInt *data_pointer, PetscInt n):             # <<<<<<<<<<<<<<
 *   c=_ToNumpyIntArray(n, data_pointer)
 *   return c
*/

static PyObject *__pyx_f_6tmm4py_11tmm4py_core_getNumpyIntArrayFromPointer(PetscInt *__pyx_v_data_pointer, PetscInt __pyx_v_n) {
  PyObject *__pyx_v_c = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("getNumpyIntArrayFromPointer", 0);

  /* "tmm4py/tmm4py_core.pyx":1535
 * 
 * cdef getNumpyIntArrayFromPointer(PetscInt *data_pointer, PetscInt n):
 *   c=_ToNumpyIntArray(n, data_pointer)             # <<<<<<<<<<<<<<
 *   return c
 * 
*/
  __pyx_t_1 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyIntArray(__pyx_v_n, __pyx_v_data_pointer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1535, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_c = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1536
 * cdef getNumpyIntArrayFromPointer(PetscInt *data_pointer, PetscInt n):
 *   c=_ToNumpyIntArray(n, data_pointer)
 *   return c             # <<<<<<<<<<<<<<
 * 
 * cdef copyNumpyRealArrayFromPointer(PetscScalar *data_pointer, PetscInt n):
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_c);
  __pyx_r = __pyx_v_c;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1534
 *   return c
 * 
 * cdef getNumpyIntArrayFromPointer(PetscInt *data_pointer, PetscInt n):             # <<<<<<<<<<<<<<
 *   c=_ToNumpyIntArray(n, data_pointer)
 *   return c
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.getNumpyIntArrayFromPointer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_c);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1538
 *   return c
 * 
 * cdef copyNumpyRealArrayFromPointer(PetscScalar *data_pointer, PetscInt n):             # <<<<<<<<<<<<<<
 *   cdef PetscScalar *arr_pointer
 *   cdef int i;
*/

static PyObject *__pyx_f_6tmm4py_11tmm4py_core_copyNumpyRealArrayFromPointer(PetscScalar *__pyx_v_data_pointer, PetscInt __pyx_v_n) {
  PetscScalar *__pyx_v_arr_pointer;
  int __pyx_v_i;
  PyObject *__pyx_v_arr = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscInt __pyx_t_1;
  PetscInt __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("copyNumpyRealArrayFromPointer", 0);

  /* "tmm4py/tmm4py_core.pyx":1541
 *   cdef PetscScalar *arr_pointer
 *   cdef int i;
 *   arr_pointer = <PetscScalar *> PyMem_Malloc(n*sizeof(PetscScalar))             # <<<<<<<<<<<<<<
 *   for i in range(n): arr_pointer[i]=data_pointer[i]
 *   arr = _ToNumpyRealArrayWithDel(n, arr_pointer, NULL, "")
*/
  __pyx_v_arr_pointer = ((PetscScalar *)PyMem_Malloc((__pyx_v_n * (sizeof(PetscScalar)))));

  /* "tmm4py/tmm4py_core.pyx":1542
 *   cdef int i;
 *   arr_pointer = <PetscScalar *> PyMem_Malloc(n*sizeof(PetscScalar))
 *   for i in range(n): arr_pointer[i]=data_pointer[i]             # <<<<<<<<<<<<<<
 *   arr = _ToNumpyRealArrayWithDel(n, arr_pointer, NULL, "")
 *   return arr
*/
  __pyx_t_1 = __pyx_v_n;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
    (__pyx_v_arr_pointer[__pyx_v_i]) = (__pyx_v_data_pointer[__pyx_v_i]);
  }

  /* "tmm4py/tmm4py_core.pyx":1543
 *   arr_pointer = <PetscScalar *> PyMem_Malloc(n*sizeof(PetscScalar))
 *   for i in range(n): arr_pointer[i]=data_pointer[i]
 *   arr = _ToNumpyRealArrayWithDel(n, arr_pointer, NULL, "")             # <<<<<<<<<<<<<<
 *   return arr
 * 
*/
  __pyx_t_4 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArrayWithDel(__pyx_v_n, __pyx_v_arr_pointer, NULL, __pyx_mstate_global->__pyx_kp_u_); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1543, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_v_arr = __pyx_t_4;
  __pyx_t_4 = 0;

  /* "tmm4py/tmm4py_core.pyx":1544
 *   for i in range(n): arr_pointer[i]=data_pointer[i]
 *   arr = _ToNumpyRealArrayWithDel(n, arr_pointer, NULL, "")
 *   return arr             # <<<<<<<<<<<<<<
 * 
 * cdef copyNumpyIntArrayFromPointer(PetscInt *data_pointer, PetscInt n):
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_arr);
  __pyx_r = __pyx_v_arr;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1538
 *   return c
 * 
 * cdef copyNumpyRealArrayFromPointer(PetscScalar *data_pointer, PetscInt n):             # <<<<<<<<<<<<<<
 *   cdef PetscScalar *arr_pointer
 *   cdef int i;
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.copyNumpyRealArrayFromPointer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_arr);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1546
 *   return arr
 * 
 * cdef copyNumpyIntArrayFromPointer(PetscInt *data_pointer, PetscInt n):             # <<<<<<<<<<<<<<
 *   cdef PetscInt *arr_pointer
 *   cdef int i;
*/

static PyObject *__pyx_f_6tmm4py_11tmm4py_core_copyNumpyIntArrayFromPointer(PetscInt *__pyx_v_data_pointer, PetscInt __pyx_v_n) {
  PetscInt *__pyx_v_arr_pointer;
  int __pyx_v_i;
  PyObject *__pyx_v_arr = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PetscInt __pyx_t_1;
  PetscInt __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("copyNumpyIntArrayFromPointer", 0);

  /* "tmm4py/tmm4py_core.pyx":1549
 *   cdef PetscInt *arr_pointer
 *   cdef int i;
 *   arr_pointer = <PetscInt *> PyMem_Malloc(n*sizeof(PetscInt))             # <<<<<<<<<<<<<<
 *   for i in range(n): arr_pointer[i]=data_pointer[i]
 *   arr = _ToNumpyIntArrayWithDel(n, arr_pointer)
*/
  __pyx_v_arr_pointer = ((PetscInt *)PyMem_Malloc((__pyx_v_n * (sizeof(PetscInt)))));

  /* "tmm4py/tmm4py_core.pyx":1550
 *   cdef int i;
 *   arr_pointer = <PetscInt *> PyMem_Malloc(n*sizeof(PetscInt))
 *   for i in range(n): arr_pointer[i]=data_pointer[i]             # <<<<<<<<<<<<<<
 *   arr = _ToNumpyIntArrayWithDel(n, arr_pointer)
 *   return arr
*/
  __pyx_t_1 = __pyx_v_n;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
    (__pyx_v_arr_pointer[__pyx_v_i]) = (__pyx_v_data_pointer[__pyx_v_i]);
  }

  /* "tmm4py/tmm4py_core.pyx":1551
 *   arr_pointer = <PetscInt *> PyMem_Malloc(n*sizeof(PetscInt))
 *   for i in range(n): arr_pointer[i]=data_pointer[i]
 *   arr = _ToNumpyIntArrayWithDel(n, arr_pointer)             # <<<<<<<<<<<<<<
 *   return arr
 * 
*/
  __pyx_t_4 = __pyx_f_6tmm4py_11tmm4py_core__ToNumpyIntArrayWithDel(__pyx_v_n, __pyx_v_arr_pointer); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1551, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_v_arr = __pyx_t_4;
  __pyx_t_4 = 0;

  /* "tmm4py/tmm4py_core.pyx":1552
 *   for i in range(n): arr_pointer[i]=data_pointer[i]
 *   arr = _ToNumpyIntArrayWithDel(n, arr_pointer)
 *   return arr             # <<<<<<<<<<<<<<
 * 
 * cdef class _RealArrayWrapper:
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_arr);
  __pyx_r = __pyx_v_arr;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1546
 *   return arr
 * 
 * cdef copyNumpyIntArrayFromPointer(PetscInt *data_pointer, PetscInt n):             # <<<<<<<<<<<<<<
 *   cdef PetscInt *arr_pointer
 *   cdef int i;
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("tmm4py.tmm4py_core.copyNumpyIntArrayFromPointer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_arr);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1559
 *     cdef PetscVec pv
 *     cdef str myId
 *     cdef set_data(self, PetscInt size, PetscScalar* data_ptr, PetscVec pv, str myId):             # <<<<<<<<<<<<<<
 *         # Note: pass NULL as the argument for pv if data_ptr doesn't point to a PETSc Vec
 *         self.data_ptr = data_ptr
*/

static PyObject *__pyx_f_6tmm4py_11tmm4py_core_17_RealArrayWrapper_set_data(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *__pyx_v_self, PetscInt __pyx_v_size, PetscScalar *__pyx_v_data_ptr, Vec __pyx_v_pv, PyObject *__pyx_v_myId) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("set_data", 0);

  /* "tmm4py/tmm4py_core.pyx":1561
 *     cdef set_data(self, PetscInt size, PetscScalar* data_ptr, PetscVec pv, str myId):
 *         # Note: pass NULL as the argument for pv if data_ptr doesn't point to a PETSc Vec
 *         self.data_ptr = data_ptr             # <<<<<<<<<<<<<<
 *         self.size = size
 *         self.pv = pv # we need to store a reference to this for the destructor
*/
  __pyx_v_self->data_ptr = __pyx_v_data_ptr;

  /* "tmm4py/tmm4py_core.pyx":1562
 *         # Note: pass NULL as the argument for pv if data_ptr doesn't point to a PETSc Vec
 *         self.data_ptr = data_ptr
 *         self.size = size             # <<<<<<<<<<<<<<
 *         self.pv = pv # we need to store a reference to this for the destructor
 *         self.myId = myId
*/
  __pyx_v_self->size = __pyx_v_size;

  /* "tmm4py/tmm4py_core.pyx":1563
 *         self.data_ptr = data_ptr
 *         self.size = size
 *         self.pv = pv # we need to store a reference to this for the destructor             # <<<<<<<<<<<<<<
 *         self.myId = myId
 * 
*/
  __pyx_v_self->pv = __pyx_v_pv;

  /* "tmm4py/tmm4py_core.pyx":1564
 *         self.size = size
 *         self.pv = pv # we need to store a reference to this for the destructor
 *         self.myId = myId             # <<<<<<<<<<<<<<
 * 
 *     def __array__(self, dtype=None, copy=None):
*/
  __Pyx_INCREF(__pyx_v_myId);
  __Pyx_GIVEREF(__pyx_v_myId);
  __Pyx_GOTREF(__pyx_v_self->myId);
  __Pyx_DECREF(__pyx_v_self->myId);
  __pyx_v_self->myId = __pyx_v_myId;

  /* "tmm4py/tmm4py_core.pyx":1559
 *     cdef PetscVec pv
 *     cdef str myId
 *     cdef set_data(self, PetscInt size, PetscScalar* data_ptr, PetscVec pv, str myId):             # <<<<<<<<<<<<<<
 *         # Note: pass NULL as the argument for pv if data_ptr doesn't point to a PETSc Vec
 *         self.data_ptr = data_ptr
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1566
 *         self.myId = myId
 * 
 *     def __array__(self, dtype=None, copy=None):             # <<<<<<<<<<<<<<
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_1__array__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_17_RealArrayWrapper_1__array__ = {"__array__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_1__array__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_1__array__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_dtype = 0;
  CYTHON_UNUSED PyObject *__pyx_v_copy = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__array__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_dtype,&__pyx_mstate_global->__pyx_n_u_copy,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1566, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1566, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1566, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__array__", 0) < 0) __PYX_ERR(0, 1566, __pyx_L3_error)
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)Py_None));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1566, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1566, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)Py_None));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
    }
    __pyx_v_dtype = values[0];
    __pyx_v_copy = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__array__", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1566, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core._RealArrayWrapper.__array__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_17_RealArrayWrapper___array__(((struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *)__pyx_v_self), __pyx_v_dtype, __pyx_v_copy);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_17_RealArrayWrapper___array__(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_dtype, CYTHON_UNUSED PyObject *__pyx_v_copy) {
  npy_intp __pyx_v_shape[1];
  PyObject *__pyx_v_ndarray = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__array__", 0);

  /* "tmm4py/tmm4py_core.pyx":1568
 *     def __array__(self, dtype=None, copy=None):
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size             # <<<<<<<<<<<<<<
 *         # Create a 1-d array of length size
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_DOUBLE, self.data_ptr)
*/
  (__pyx_v_shape[0]) = ((npy_intp)__pyx_v_self->size);

  /* "tmm4py/tmm4py_core.pyx":1570
 *         shape[0] = <np.npy_intp> self.size
 *         # Create a 1-d array of length size
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_DOUBLE, self.data_ptr)             # <<<<<<<<<<<<<<
 *         return ndarray
 * 
*/
  __pyx_t_1 = PyArray_SimpleNewFromData(1, __pyx_v_shape, NPY_DOUBLE, __pyx_v_self->data_ptr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1570, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_ndarray = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1571
 *         # Create a 1-d array of length size
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_DOUBLE, self.data_ptr)
 *         return ndarray             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_ndarray);
  __pyx_r = __pyx_v_ndarray;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1566
 *         self.myId = myId
 * 
 *     def __array__(self, dtype=None, copy=None):             # <<<<<<<<<<<<<<
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("tmm4py.tmm4py_core._RealArrayWrapper.__array__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ndarray);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1573
 *         return ndarray
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         # This is called by Python when the array goes out of scope or all the
 *         # references to it are gone which (I think) is what I want
*/

/* Python wrapper */
static void __pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_3__dealloc__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__dealloc__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_pf_6tmm4py_11tmm4py_core_17_RealArrayWrapper_2__dealloc__(((struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

static void __pyx_pf_6tmm4py_11tmm4py_core_17_RealArrayWrapper_2__dealloc__(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *__pyx_v_self) {
  PetscErrorCode __pyx_v_ierr;
  PyObject *__pyx_v_msg = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  size_t __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__dealloc__", 0);

  /* "tmm4py/tmm4py_core.pyx":1579
 *         cdef PetscErrorCode ierr
 * 
 *         msg = f"Before GC {self.myId}"             # <<<<<<<<<<<<<<
 *         if debug: print(msg)
 *         if self.pv:
*/
  __pyx_t_1 = __Pyx_PyUnicode_Unicode(__pyx_v_self->myId); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1579, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_Before_GC, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1579, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_msg = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":1580
 * 
 *         msg = f"Before GC {self.myId}"
 *         if debug: print(msg)             # <<<<<<<<<<<<<<
 *         if self.pv:
 *             msg = f"Doing GC {self.myId}"
*/
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_debug); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1580, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1580, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
    __pyx_t_1 = NULL;
    __Pyx_INCREF(__pyx_builtin_print);
    __pyx_t_4 = __pyx_builtin_print; 
    __pyx_t_5 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_msg};
      __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1580, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }

  /* "tmm4py/tmm4py_core.pyx":1581
 *         msg = f"Before GC {self.myId}"
 *         if debug: print(msg)
 *         if self.pv:             # <<<<<<<<<<<<<<
 *             msg = f"Doing GC {self.myId}"
 *             if debug: print(msg)
*/
  __pyx_t_3 = (__pyx_v_self->pv != 0);
  if (__pyx_t_3) {

    /* "tmm4py/tmm4py_core.pyx":1582
 *         if debug: print(msg)
 *         if self.pv:
 *             msg = f"Doing GC {self.myId}"             # <<<<<<<<<<<<<<
 *             if debug: print(msg)
 *             ierr = VecRestoreArray(self.pv,&self.data_ptr)
*/
    __pyx_t_2 = __Pyx_PyUnicode_Unicode(__pyx_v_self->myId); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1582, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_mstate_global->__pyx_kp_u_Doing_GC, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1582, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF_SET(__pyx_v_msg, ((PyObject*)__pyx_t_4));
    __pyx_t_4 = 0;

    /* "tmm4py/tmm4py_core.pyx":1583
 *         if self.pv:
 *             msg = f"Doing GC {self.myId}"
 *             if debug: print(msg)             # <<<<<<<<<<<<<<
 *             ierr = VecRestoreArray(self.pv,&self.data_ptr)
 *             if ierr != 0: raise PETSc.Error(ierr)
*/
    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_mstate_global->__pyx_n_u_debug); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1583, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1583, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_3) {
      __pyx_t_2 = NULL;
      __Pyx_INCREF(__pyx_builtin_print);
      __pyx_t_1 = __pyx_builtin_print; 
      __pyx_t_5 = 1;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_msg};
        __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1583, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }

    /* "tmm4py/tmm4py_core.pyx":1584
 *             msg = f"Doing GC {self.myId}"
 *             if debug: print(msg)
 *             ierr = VecRestoreArray(self.pv,&self.data_ptr)             # <<<<<<<<<<<<<<
 *             if ierr != 0: raise PETSc.Error(ierr)
 * # uncomment this for destructor but I don't think we want this as it will free the
*/
    __pyx_v_ierr = VecRestoreArray(__pyx_v_self->pv, (&__pyx_v_self->data_ptr));

    /* "tmm4py/tmm4py_core.pyx":1585
 *             if debug: print(msg)
 *             ierr = VecRestoreArray(self.pv,&self.data_ptr)
 *             if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 * # uncomment this for destructor but I don't think we want this as it will free the
 * # memory and we want PETSc to manage the memory
*/
    __pyx_t_3 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_3)) {
      __pyx_t_1 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1585, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1585, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1585, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_5 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_6))) {
        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
        assert(__pyx_t_1);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_6, __pyx__function);
        __pyx_t_5 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_2};
        __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1585, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
      }
      __Pyx_Raise(__pyx_t_4, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __PYX_ERR(0, 1585, __pyx_L1_error)
    }

    /* "tmm4py/tmm4py_core.pyx":1581
 *         msg = f"Before GC {self.myId}"
 *         if debug: print(msg)
 *         if self.pv:             # <<<<<<<<<<<<<<
 *             msg = f"Doing GC {self.myId}"
 *             if debug: print(msg)
*/
  }

  /* "tmm4py/tmm4py_core.pyx":1573
 *         return ndarray
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         # This is called by Python when the array goes out of scope or all the
 *         # references to it are gone which (I think) is what I want
*/

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core._RealArrayWrapper.__dealloc__", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_msg);
  __Pyx_RefNannyFinishContext();
}

/* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_5__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_17_RealArrayWrapper_5__reduce_cython__ = {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_5__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_5__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__reduce_cython__", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__reduce_cython__", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_17_RealArrayWrapper_4__reduce_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_17_RealArrayWrapper_4__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce_cython__", 0);

  /* "(tree fragment)":2
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"             # <<<<<<<<<<<<<<
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_self_data_ptr_self_pv_cannot_be, 0, 0);
  __PYX_ERR(1, 2, __pyx_L1_error)

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core._RealArrayWrapper.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_7__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_17_RealArrayWrapper_7__setstate_cython__ = {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_7__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_7__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v___pyx_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_pyx_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__setstate_cython__", 0) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, i); __PYX_ERR(1, 3, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
    }
    __pyx_v___pyx_state = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, __pyx_nargs); __PYX_ERR(1, 3, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core._RealArrayWrapper.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_17_RealArrayWrapper_6__setstate_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *)__pyx_v_self), __pyx_v___pyx_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_17_RealArrayWrapper_6__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setstate_cython__", 0);

  /* "(tree fragment)":4
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"             # <<<<<<<<<<<<<<
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_self_data_ptr_self_pv_cannot_be, 0, 0);
  __PYX_ERR(1, 4, __pyx_L1_error)

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core._RealArrayWrapper.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1598
 *     cdef PetscVec pv
 *     cdef str myId
 *     cdef set_data(self, PetscInt size, PetscScalar* data_ptr, PetscVec pv, str myId):             # <<<<<<<<<<<<<<
 *         # Note: pass NULL as the argument for pv if data_ptr doesn't point to a PETSc Vec
 *         self.data_ptr = data_ptr
*/

static PyObject *__pyx_f_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_set_data(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *__pyx_v_self, PetscInt __pyx_v_size, PetscScalar *__pyx_v_data_ptr, Vec __pyx_v_pv, PyObject *__pyx_v_myId) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("set_data", 0);

  /* "tmm4py/tmm4py_core.pyx":1600
 *     cdef set_data(self, PetscInt size, PetscScalar* data_ptr, PetscVec pv, str myId):
 *         # Note: pass NULL as the argument for pv if data_ptr doesn't point to a PETSc Vec
 *         self.data_ptr = data_ptr             # <<<<<<<<<<<<<<
 *         self.size = size
 *         self.pv = pv # we need to store a reference to this for the destructor
*/
  __pyx_v_self->data_ptr = __pyx_v_data_ptr;

  /* "tmm4py/tmm4py_core.pyx":1601
 *         # Note: pass NULL as the argument for pv if data_ptr doesn't point to a PETSc Vec
 *         self.data_ptr = data_ptr
 *         self.size = size             # <<<<<<<<<<<<<<
 *         self.pv = pv # we need to store a reference to this for the destructor
 *         self.myId = myId
*/
  __pyx_v_self->size = __pyx_v_size;

  /* "tmm4py/tmm4py_core.pyx":1602
 *         self.data_ptr = data_ptr
 *         self.size = size
 *         self.pv = pv # we need to store a reference to this for the destructor             # <<<<<<<<<<<<<<
 *         self.myId = myId
 * 
*/
  __pyx_v_self->pv = __pyx_v_pv;

  /* "tmm4py/tmm4py_core.pyx":1603
 *         self.size = size
 *         self.pv = pv # we need to store a reference to this for the destructor
 *         self.myId = myId             # <<<<<<<<<<<<<<
 * 
 *     def __array__(self, dtype=None, copy=None):
*/
  __Pyx_INCREF(__pyx_v_myId);
  __Pyx_GIVEREF(__pyx_v_myId);
  __Pyx_GOTREF(__pyx_v_self->myId);
  __Pyx_DECREF(__pyx_v_self->myId);
  __pyx_v_self->myId = __pyx_v_myId;

  /* "tmm4py/tmm4py_core.pyx":1598
 *     cdef PetscVec pv
 *     cdef str myId
 *     cdef set_data(self, PetscInt size, PetscScalar* data_ptr, PetscVec pv, str myId):             # <<<<<<<<<<<<<<
 *         # Note: pass NULL as the argument for pv if data_ptr doesn't point to a PETSc Vec
 *         self.data_ptr = data_ptr
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1605
 *         self.myId = myId
 * 
 *     def __array__(self, dtype=None, copy=None):             # <<<<<<<<<<<<<<
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_1__array__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_1__array__ = {"__array__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_1__array__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_1__array__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_dtype = 0;
  CYTHON_UNUSED PyObject *__pyx_v_copy = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__array__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_dtype,&__pyx_mstate_global->__pyx_n_u_copy,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1605, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1605, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1605, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__array__", 0) < 0) __PYX_ERR(0, 1605, __pyx_L3_error)
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)Py_None));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1605, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1605, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)Py_None));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
    }
    __pyx_v_dtype = values[0];
    __pyx_v_copy = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__array__", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1605, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core._RealArrayWrapperWithDel.__array__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel___array__(((struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *)__pyx_v_self), __pyx_v_dtype, __pyx_v_copy);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel___array__(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_dtype, CYTHON_UNUSED PyObject *__pyx_v_copy) {
  npy_intp __pyx_v_shape[1];
  PyObject *__pyx_v_ndarray = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__array__", 0);

  /* "tmm4py/tmm4py_core.pyx":1607
 *     def __array__(self, dtype=None, copy=None):
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size             # <<<<<<<<<<<<<<
 *         # Create a 1-d array of length 'size
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_DOUBLE, self.data_ptr)
*/
  (__pyx_v_shape[0]) = ((npy_intp)__pyx_v_self->size);

  /* "tmm4py/tmm4py_core.pyx":1609
 *         shape[0] = <np.npy_intp> self.size
 *         # Create a 1-d array of length 'size
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_DOUBLE, self.data_ptr)             # <<<<<<<<<<<<<<
 *         return ndarray
 *     def __dealloc__(self):
*/
  __pyx_t_1 = PyArray_SimpleNewFromData(1, __pyx_v_shape, NPY_DOUBLE, __pyx_v_self->data_ptr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1609, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_ndarray = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1610
 *         # Create a 1-d array of length 'size
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_DOUBLE, self.data_ptr)
 *         return ndarray             # <<<<<<<<<<<<<<
 *     def __dealloc__(self):
 *         # This is called by Python when the array goes out of scope or all the
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_ndarray);
  __pyx_r = __pyx_v_ndarray;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1605
 *         self.myId = myId
 * 
 *     def __array__(self, dtype=None, copy=None):             # <<<<<<<<<<<<<<
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("tmm4py.tmm4py_core._RealArrayWrapperWithDel.__array__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ndarray);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1611
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_DOUBLE, self.data_ptr)
 *         return ndarray
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         # This is called by Python when the array goes out of scope or all the
 *         # references to it are gone which (I think) is what I want
*/

/* Python wrapper */
static void __pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_3__dealloc__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__dealloc__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_pf_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_2__dealloc__(((struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

static void __pyx_pf_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_2__dealloc__(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  size_t __pyx_t_5;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__dealloc__", 0);

  /* "tmm4py/tmm4py_core.pyx":1614
 *         # This is called by Python when the array goes out of scope or all the
 *         # references to it are gone which (I think) is what I want
 *         if debug: print("freeing data")             # <<<<<<<<<<<<<<
 *         PyMem_Free(self.data_ptr)
 * 
*/
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_mstate_global->__pyx_n_u_debug); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1614, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1614, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
    __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_builtin_print);
    __pyx_t_4 = __pyx_builtin_print; 
    __pyx_t_5 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global->__pyx_kp_u_freeing_data};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1614, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "tmm4py/tmm4py_core.pyx":1615
 *         # references to it are gone which (I think) is what I want
 *         if debug: print("freeing data")
 *         PyMem_Free(self.data_ptr)             # <<<<<<<<<<<<<<
 * 
 * cdef class _IntArrayWrapper:
*/
  PyMem_Free(__pyx_v_self->data_ptr);

  /* "tmm4py/tmm4py_core.pyx":1611
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_DOUBLE, self.data_ptr)
 *         return ndarray
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         # This is called by Python when the array goes out of scope or all the
 *         # references to it are gone which (I think) is what I want
*/

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core._RealArrayWrapperWithDel.__dealloc__", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
}

/* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_5__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_5__reduce_cython__ = {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_5__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_5__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__reduce_cython__", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__reduce_cython__", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_4__reduce_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_4__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce_cython__", 0);

  /* "(tree fragment)":2
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"             # <<<<<<<<<<<<<<
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_self_data_ptr_self_pv_cannot_be, 0, 0);
  __PYX_ERR(1, 2, __pyx_L1_error)

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core._RealArrayWrapperWithDel.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_7__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_7__setstate_cython__ = {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_7__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_7__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v___pyx_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_pyx_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__setstate_cython__", 0) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, i); __PYX_ERR(1, 3, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
    }
    __pyx_v___pyx_state = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, __pyx_nargs); __PYX_ERR(1, 3, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core._RealArrayWrapperWithDel.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_6__setstate_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *)__pyx_v_self), __pyx_v___pyx_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_6__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setstate_cython__", 0);

  /* "(tree fragment)":4
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"             # <<<<<<<<<<<<<<
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_self_data_ptr_self_pv_cannot_be, 0, 0);
  __PYX_ERR(1, 4, __pyx_L1_error)

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core._RealArrayWrapperWithDel.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1620
 *     cdef PetscInt* data_ptr
 *     cdef int size
 *     cdef set_data(self, int size, PetscInt* data_ptr):             # <<<<<<<<<<<<<<
 *         self.data_ptr = data_ptr
 *         self.size = size # we need to store a reference to this for the destructor
*/

static PyObject *__pyx_f_6tmm4py_11tmm4py_core_16_IntArrayWrapper_set_data(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *__pyx_v_self, int __pyx_v_size, PetscInt *__pyx_v_data_ptr) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("set_data", 0);

  /* "tmm4py/tmm4py_core.pyx":1621
 *     cdef int size
 *     cdef set_data(self, int size, PetscInt* data_ptr):
 *         self.data_ptr = data_ptr             # <<<<<<<<<<<<<<
 *         self.size = size # we need to store a reference to this for the destructor
 * 
*/
  __pyx_v_self->data_ptr = __pyx_v_data_ptr;

  /* "tmm4py/tmm4py_core.pyx":1622
 *     cdef set_data(self, int size, PetscInt* data_ptr):
 *         self.data_ptr = data_ptr
 *         self.size = size # we need to store a reference to this for the destructor             # <<<<<<<<<<<<<<
 * 
 *     def __array__(self, dtype=None, copy=None):
*/
  __pyx_v_self->size = __pyx_v_size;

  /* "tmm4py/tmm4py_core.pyx":1620
 *     cdef PetscInt* data_ptr
 *     cdef int size
 *     cdef set_data(self, int size, PetscInt* data_ptr):             # <<<<<<<<<<<<<<
 *         self.data_ptr = data_ptr
 *         self.size = size # we need to store a reference to this for the destructor
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1624
 *         self.size = size # we need to store a reference to this for the destructor
 * 
 *     def __array__(self, dtype=None, copy=None):             # <<<<<<<<<<<<<<
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16_IntArrayWrapper_1__array__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_16_IntArrayWrapper_1__array__ = {"__array__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16_IntArrayWrapper_1__array__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16_IntArrayWrapper_1__array__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_dtype = 0;
  CYTHON_UNUSED PyObject *__pyx_v_copy = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__array__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_dtype,&__pyx_mstate_global->__pyx_n_u_copy,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1624, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1624, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1624, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__array__", 0) < 0) __PYX_ERR(0, 1624, __pyx_L3_error)
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)Py_None));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1624, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1624, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)Py_None));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
    }
    __pyx_v_dtype = values[0];
    __pyx_v_copy = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__array__", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1624, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core._IntArrayWrapper.__array__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16_IntArrayWrapper___array__(((struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *)__pyx_v_self), __pyx_v_dtype, __pyx_v_copy);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16_IntArrayWrapper___array__(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_dtype, CYTHON_UNUSED PyObject *__pyx_v_copy) {
  npy_intp __pyx_v_shape[1];
  PyObject *__pyx_v_ndarray = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__array__", 0);

  /* "tmm4py/tmm4py_core.pyx":1626
 *     def __array__(self, dtype=None, copy=None):
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size             # <<<<<<<<<<<<<<
 *         # Create a 1D array, of length 'size'
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_INT, self.data_ptr)
*/
  (__pyx_v_shape[0]) = ((npy_intp)__pyx_v_self->size);

  /* "tmm4py/tmm4py_core.pyx":1628
 *         shape[0] = <np.npy_intp> self.size
 *         # Create a 1D array, of length 'size'
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_INT, self.data_ptr)             # <<<<<<<<<<<<<<
 *         return ndarray
 * 
*/
  __pyx_t_1 = PyArray_SimpleNewFromData(1, __pyx_v_shape, NPY_INT, __pyx_v_self->data_ptr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1628, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_ndarray = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1629
 *         # Create a 1D array, of length 'size'
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_INT, self.data_ptr)
 *         return ndarray             # <<<<<<<<<<<<<<
 * 
 * cdef class _IntArrayWrapperWithDel:
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_ndarray);
  __pyx_r = __pyx_v_ndarray;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1624
 *         self.size = size # we need to store a reference to this for the destructor
 * 
 *     def __array__(self, dtype=None, copy=None):             # <<<<<<<<<<<<<<
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("tmm4py.tmm4py_core._IntArrayWrapper.__array__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ndarray);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16_IntArrayWrapper_3__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_16_IntArrayWrapper_3__reduce_cython__ = {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16_IntArrayWrapper_3__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16_IntArrayWrapper_3__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__reduce_cython__", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__reduce_cython__", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16_IntArrayWrapper_2__reduce_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16_IntArrayWrapper_2__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce_cython__", 0);

  /* "(tree fragment)":2
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"             # <<<<<<<<<<<<<<
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_self_data_ptr_cannot_be_converte, 0, 0);
  __PYX_ERR(1, 2, __pyx_L1_error)

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core._IntArrayWrapper.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16_IntArrayWrapper_5__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_16_IntArrayWrapper_5__setstate_cython__ = {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16_IntArrayWrapper_5__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_16_IntArrayWrapper_5__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v___pyx_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_pyx_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__setstate_cython__", 0) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, i); __PYX_ERR(1, 3, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
    }
    __pyx_v___pyx_state = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, __pyx_nargs); __PYX_ERR(1, 3, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core._IntArrayWrapper.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_16_IntArrayWrapper_4__setstate_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *)__pyx_v_self), __pyx_v___pyx_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_16_IntArrayWrapper_4__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setstate_cython__", 0);

  /* "(tree fragment)":4
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"             # <<<<<<<<<<<<<<
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_self_data_ptr_cannot_be_converte, 0, 0);
  __PYX_ERR(1, 4, __pyx_L1_error)

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core._IntArrayWrapper.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1634
 *     cdef PetscInt* data_ptr
 *     cdef int size
 *     cdef set_data(self, int size, PetscInt* data_ptr):             # <<<<<<<<<<<<<<
 *         self.data_ptr = data_ptr
 *         self.size = size # we need to store a reference to this for the destructor
*/

static PyObject *__pyx_f_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_set_data(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *__pyx_v_self, int __pyx_v_size, PetscInt *__pyx_v_data_ptr) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("set_data", 0);

  /* "tmm4py/tmm4py_core.pyx":1635
 *     cdef int size
 *     cdef set_data(self, int size, PetscInt* data_ptr):
 *         self.data_ptr = data_ptr             # <<<<<<<<<<<<<<
 *         self.size = size # we need to store a reference to this for the destructor
 * 
*/
  __pyx_v_self->data_ptr = __pyx_v_data_ptr;

  /* "tmm4py/tmm4py_core.pyx":1636
 *     cdef set_data(self, int size, PetscInt* data_ptr):
 *         self.data_ptr = data_ptr
 *         self.size = size # we need to store a reference to this for the destructor             # <<<<<<<<<<<<<<
 * 
 *     def __array__(self, dtype=None, copy=None):
*/
  __pyx_v_self->size = __pyx_v_size;

  /* "tmm4py/tmm4py_core.pyx":1634
 *     cdef PetscInt* data_ptr
 *     cdef int size
 *     cdef set_data(self, int size, PetscInt* data_ptr):             # <<<<<<<<<<<<<<
 *         self.data_ptr = data_ptr
 *         self.size = size # we need to store a reference to this for the destructor
*/

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1638
 *         self.size = size # we need to store a reference to this for the destructor
 * 
 *     def __array__(self, dtype=None, copy=None):             # <<<<<<<<<<<<<<
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_1__array__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_1__array__ = {"__array__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_1__array__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_1__array__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v_dtype = 0;
  CYTHON_UNUSED PyObject *__pyx_v_copy = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[2] = {0,0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__array__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_dtype,&__pyx_mstate_global->__pyx_n_u_copy,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(0, 1638, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1638, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1638, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__array__", 0) < 0) __PYX_ERR(0, 1638, __pyx_L3_error)
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)Py_None));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = __Pyx_ArgRef_FASTCALL(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[1])) __PYX_ERR(0, 1638, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(0, 1638, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[0]) values[0] = __Pyx_NewRef(((PyObject *)Py_None));
      if (!values[1]) values[1] = __Pyx_NewRef(((PyObject *)Py_None));
    }
    __pyx_v_dtype = values[0];
    __pyx_v_copy = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__array__", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1638, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core._IntArrayWrapperWithDel.__array__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel___array__(((struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *)__pyx_v_self), __pyx_v_dtype, __pyx_v_copy);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel___array__(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_dtype, CYTHON_UNUSED PyObject *__pyx_v_copy) {
  npy_intp __pyx_v_shape[1];
  PyObject *__pyx_v_ndarray = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__array__", 0);

  /* "tmm4py/tmm4py_core.pyx":1640
 *     def __array__(self, dtype=None, copy=None):
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size             # <<<<<<<<<<<<<<
 *         # Create a 1D array, of length 'size'
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_INT, self.data_ptr)
*/
  (__pyx_v_shape[0]) = ((npy_intp)__pyx_v_self->size);

  /* "tmm4py/tmm4py_core.pyx":1642
 *         shape[0] = <np.npy_intp> self.size
 *         # Create a 1D array, of length 'size'
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_INT, self.data_ptr)             # <<<<<<<<<<<<<<
 *         return ndarray
 *     def __dealloc__(self):
*/
  __pyx_t_1 = PyArray_SimpleNewFromData(1, __pyx_v_shape, NPY_INT, __pyx_v_self->data_ptr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1642, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_ndarray = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1643
 *         # Create a 1D array, of length 'size'
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_INT, self.data_ptr)
 *         return ndarray             # <<<<<<<<<<<<<<
 *     def __dealloc__(self):
 *         # This is called by Python when the array goes out of scope or all the
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_ndarray);
  __pyx_r = __pyx_v_ndarray;
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1638
 *         self.size = size # we need to store a reference to this for the destructor
 * 
 *     def __array__(self, dtype=None, copy=None):             # <<<<<<<<<<<<<<
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("tmm4py.tmm4py_core._IntArrayWrapperWithDel.__array__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ndarray);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1644
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_INT, self.data_ptr)
 *         return ndarray
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         # This is called by Python when the array goes out of scope or all the
 *         # references to it are gone which (I think) is what I want
*/

/* Python wrapper */
static void __pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_3__dealloc__(PyObject *__pyx_v_self) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__dealloc__ (wrapper)", 0);
  __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
  __pyx_pf_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_2__dealloc__(((struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

static void __pyx_pf_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_2__dealloc__(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  size_t __pyx_t_5;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__dealloc__", 0);

  /* "tmm4py/tmm4py_core.pyx":1647
 *         # This is called by Python when the array goes out of scope or all the
 *         # references to it are gone which (I think) is what I want
 *         if debug: print("freeing data")             # <<<<<<<<<<<<<<
 *         PyMem_Free(self.data_ptr)
 * 
*/
  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_mstate_global->__pyx_n_u_debug); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1647, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1647, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
    __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_builtin_print);
    __pyx_t_4 = __pyx_builtin_print; 
    __pyx_t_5 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global->__pyx_kp_u_freeing_data};
      __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1647, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "tmm4py/tmm4py_core.pyx":1648
 *         # references to it are gone which (I think) is what I want
 *         if debug: print("freeing data")
 *         PyMem_Free(self.data_ptr)             # <<<<<<<<<<<<<<
 * 
 * # uncomment this for destructor but I don't think we want this as it will free the
*/
  PyMem_Free(__pyx_v_self->data_ptr);

  /* "tmm4py/tmm4py_core.pyx":1644
 *         ndarray = np.PyArray_SimpleNewFromData(1, shape, np.NPY_INT, self.data_ptr)
 *         return ndarray
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         # This is called by Python when the array goes out of scope or all the
 *         # references to it are gone which (I think) is what I want
*/

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_WriteUnraisable("tmm4py.tmm4py_core._IntArrayWrapperWithDel.__dealloc__", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
}

/* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_5__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_5__reduce_cython__ = {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_5__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_5__reduce_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_nargs > 0)) { __Pyx_RaiseArgtupleInvalid("__reduce_cython__", 1, 0, 0, __pyx_nargs); return NULL; }
  const Py_ssize_t __pyx_kwds_len = unlikely(__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
  if (unlikely(__pyx_kwds_len < 0)) return NULL;
  if (unlikely(__pyx_kwds_len > 0)) {__Pyx_RejectKeywords("__reduce_cython__", __pyx_kwds); return NULL;}
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_4__reduce_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_4__reduce_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce_cython__", 0);

  /* "(tree fragment)":2
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"             # <<<<<<<<<<<<<<
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_self_data_ptr_cannot_be_converte, 0, 0);
  __PYX_ERR(1, 2, __pyx_L1_error)

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core._IntArrayWrapperWithDel.__reduce_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
*/

/* Python wrapper */
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_7__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_7__setstate_cython__ = {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_7__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_7__setstate_cython__(PyObject *__pyx_v_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  CYTHON_UNUSED PyObject *__pyx_v___pyx_state = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject* values[1] = {0};
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setstate_cython__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
  #else
  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&__pyx_mstate_global->__pyx_n_u_pyx_state,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? __Pyx_NumKwargs_FASTCALL(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
    if (__pyx_kwds_len > 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (__Pyx_ParseKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "__setstate_cython__", 0) < 0) __PYX_ERR(1, 3, __pyx_L3_error)
      for (Py_ssize_t i = __pyx_nargs; i < 1; i++) {
        if (unlikely(!values[i])) { __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, i); __PYX_ERR(1, 3, __pyx_L3_error) }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = __Pyx_ArgRef_FASTCALL(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS && unlikely(!values[0])) __PYX_ERR(1, 3, __pyx_L3_error)
    }
    __pyx_v___pyx_state = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__setstate_cython__", 1, 1, 1, __pyx_nargs); __PYX_ERR(1, 3, __pyx_L3_error)
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_AddTraceback("tmm4py.tmm4py_core._IntArrayWrapperWithDel.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_6__setstate_cython__(((struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *)__pyx_v_self), __pyx_v___pyx_state);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_6__setstate_cython__(CYTHON_UNUSED struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setstate_cython__", 0);

  /* "(tree fragment)":4
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"             # <<<<<<<<<<<<<<
*/
  __Pyx_Raise(__pyx_builtin_TypeError, __pyx_mstate_global->__pyx_kp_u_self_data_ptr_cannot_be_converte, 0, 0);
  __PYX_ERR(1, 4, __pyx_L1_error)

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("tmm4py.tmm4py_core._IntArrayWrapperWithDel.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1655
 * #         free(<void*>self.data_ptr)
 * 
 * cdef _ToNumpyRealArray(PetscInt size, PetscScalar *data_pointer, PetscVec pv, myId):             # <<<<<<<<<<<<<<
 * # Note: pass NULL as the argument for pv if data_pointer doesn't point to a PETSc Vec
 * #       pass "" for myId if not required
*/

static PyObject *__pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArray(PetscInt __pyx_v_size, PetscScalar *__pyx_v_data_pointer, Vec __pyx_v_pv, PyObject *__pyx_v_myId) {
  PetscErrorCode __pyx_v_ierr;
  PyArrayObject *__pyx_v_nparr = 0;
  struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *__pyx_v_varray = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  size_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  int __pyx_t_7;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_ToNumpyRealArray", 0);

  /* "tmm4py/tmm4py_core.pyx":1660
 *     cdef PetscErrorCode ierr
 *     cdef np.ndarray nparr
 *     varray = _RealArrayWrapper()             # <<<<<<<<<<<<<<
 *     varray.set_data(size, data_pointer,pv,myId)
 *     nparr = np.array(varray, copy=False)
*/
  __pyx_t_2 = NULL;
  __Pyx_INCREF((PyObject *)__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper);
  __pyx_t_3 = ((PyObject *)__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper); 
  __pyx_t_4 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1660, __pyx_L1_error)
    __Pyx_GOTREF((PyObject *)__pyx_t_1);
  }
  __pyx_v_varray = ((struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1661
 *     cdef np.ndarray nparr
 *     varray = _RealArrayWrapper()
 *     varray.set_data(size, data_pointer,pv,myId)             # <<<<<<<<<<<<<<
 *     nparr = np.array(varray, copy=False)
 *     np.PyArray_SetBaseObject(nparr,varray)
*/
  if (!(likely(PyUnicode_CheckExact(__pyx_v_myId))||((__pyx_v_myId) == Py_None) || __Pyx_RaiseUnexpectedTypeError("str", __pyx_v_myId))) __PYX_ERR(0, 1661, __pyx_L1_error)
  __pyx_t_1 = ((struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__RealArrayWrapper *)__pyx_v_varray->__pyx_vtab)->set_data(__pyx_v_varray, __pyx_v_size, __pyx_v_data_pointer, __pyx_v_pv, ((PyObject*)__pyx_v_myId)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1661, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1662
 *     varray = _RealArrayWrapper()
 *     varray.set_data(size, data_pointer,pv,myId)
 *     nparr = np.array(varray, copy=False)             # <<<<<<<<<<<<<<
 *     np.PyArray_SetBaseObject(nparr,varray)
 *     # Increment the reference count, as the above assignement was done in
*/
  __pyx_t_3 = NULL;
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1662, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1662, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
    assert(__pyx_t_3);
    PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
    __Pyx_INCREF(__pyx_t_3);
    __Pyx_INCREF(__pyx__function);
    __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
    __pyx_t_4 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_3, ((PyObject *)__pyx_v_varray)};
    __pyx_t_2 = __Pyx_MakeVectorcallBuilderKwds(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1662, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (__Pyx_VectorcallBuilder_AddArg(__pyx_mstate_global->__pyx_n_u_copy, Py_False, __pyx_t_2, __pyx_callargs+2, 0) < 0) __PYX_ERR(0, 1662, __pyx_L1_error)
    __pyx_t_1 = __Pyx_Object_Vectorcall_CallFromBuilder(__pyx_t_5, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1662, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_mstate_global->__pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1662, __pyx_L1_error)
  __pyx_v_nparr = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1663
 *     varray.set_data(size, data_pointer,pv,myId)
 *     nparr = np.array(varray, copy=False)
 *     np.PyArray_SetBaseObject(nparr,varray)             # <<<<<<<<<<<<<<
 *     # Increment the reference count, as the above assignement was done in
 *     # C, and Python does not know that there is this additional reference
*/
  __pyx_t_6 = PyArray_SetBaseObject(__pyx_v_nparr, ((PyObject *)__pyx_v_varray)); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 1663, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":1666
 *     # Increment the reference count, as the above assignement was done in
 *     # C, and Python does not know that there is this additional reference
 *     Py_INCREF(varray)             # <<<<<<<<<<<<<<
 * #   We restore data_pointer here because it was created with a VecGetArray in the calling
 * #   function in order to convert to a numpy array and is (should?) no longer needed in the
*/
  Py_INCREF(((PyObject *)__pyx_v_varray));

  /* "tmm4py/tmm4py_core.pyx":1670
 * #   function in order to convert to a numpy array and is (should?) no longer needed in the
 * #   calling function. Is that what I want?
 *     if pv:             # <<<<<<<<<<<<<<
 *         ierr = VecRestoreArray(pv, &data_pointer)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_t_7 = (__pyx_v_pv != 0);
  if (__pyx_t_7) {

    /* "tmm4py/tmm4py_core.pyx":1671
 * #   calling function. Is that what I want?
 *     if pv:
 *         ierr = VecRestoreArray(pv, &data_pointer)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *     return nparr
*/
    __pyx_v_ierr = VecRestoreArray(__pyx_v_pv, (&__pyx_v_data_pointer));

    /* "tmm4py/tmm4py_core.pyx":1672
 *     if pv:
 *         ierr = VecRestoreArray(pv, &data_pointer)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *     return nparr
 * 
*/
    __pyx_t_7 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_7)) {
      __pyx_t_5 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1672, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1672, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1672, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
        assert(__pyx_t_5);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_3, __pyx__function);
        __pyx_t_4 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_2};
        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1672, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_Raise(__pyx_t_1, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __PYX_ERR(0, 1672, __pyx_L1_error)
    }

    /* "tmm4py/tmm4py_core.pyx":1670
 * #   function in order to convert to a numpy array and is (should?) no longer needed in the
 * #   calling function. Is that what I want?
 *     if pv:             # <<<<<<<<<<<<<<
 *         ierr = VecRestoreArray(pv, &data_pointer)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  }

  /* "tmm4py/tmm4py_core.pyx":1673
 *         ierr = VecRestoreArray(pv, &data_pointer)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *     return nparr             # <<<<<<<<<<<<<<
 * 
 * cdef _ToNumpyIntArray(PetscInt size, PetscInt *data_pointer):
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF((PyObject *)__pyx_v_nparr);
  __pyx_r = ((PyObject *)__pyx_v_nparr);
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1655
 * #         free(<void*>self.data_ptr)
 * 
 * cdef _ToNumpyRealArray(PetscInt size, PetscScalar *data_pointer, PetscVec pv, myId):             # <<<<<<<<<<<<<<
 * # Note: pass NULL as the argument for pv if data_pointer doesn't point to a PETSc Vec
 * #       pass "" for myId if not required
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("tmm4py.tmm4py_core._ToNumpyRealArray", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_nparr);
  __Pyx_XDECREF((PyObject *)__pyx_v_varray);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1675
 *     return nparr
 * 
 * cdef _ToNumpyIntArray(PetscInt size, PetscInt *data_pointer):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef np.ndarray nparr
*/

static PyObject *__pyx_f_6tmm4py_11tmm4py_core__ToNumpyIntArray(PetscInt __pyx_v_size, PetscInt *__pyx_v_data_pointer) {
  PyArrayObject *__pyx_v_nparr = 0;
  struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *__pyx_v_varray = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  size_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_ToNumpyIntArray", 0);

  /* "tmm4py/tmm4py_core.pyx":1678
 *     cdef PetscErrorCode ierr
 *     cdef np.ndarray nparr
 *     varray = _IntArrayWrapper()             # <<<<<<<<<<<<<<
 *     varray.set_data(size, data_pointer)
 *     nparr = np.array(varray, copy=False)
*/
  __pyx_t_2 = NULL;
  __Pyx_INCREF((PyObject *)__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper);
  __pyx_t_3 = ((PyObject *)__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper); 
  __pyx_t_4 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1678, __pyx_L1_error)
    __Pyx_GOTREF((PyObject *)__pyx_t_1);
  }
  __pyx_v_varray = ((struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1679
 *     cdef np.ndarray nparr
 *     varray = _IntArrayWrapper()
 *     varray.set_data(size, data_pointer)             # <<<<<<<<<<<<<<
 *     nparr = np.array(varray, copy=False)
 *     np.PyArray_SetBaseObject(nparr,varray)
*/
  __pyx_t_1 = ((struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__IntArrayWrapper *)__pyx_v_varray->__pyx_vtab)->set_data(__pyx_v_varray, __pyx_v_size, __pyx_v_data_pointer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1679, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1680
 *     varray = _IntArrayWrapper()
 *     varray.set_data(size, data_pointer)
 *     nparr = np.array(varray, copy=False)             # <<<<<<<<<<<<<<
 *     np.PyArray_SetBaseObject(nparr,varray)
 *     # Increment the reference count, as the above assignement was done in
*/
  __pyx_t_3 = NULL;
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1680, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1680, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
    assert(__pyx_t_3);
    PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
    __Pyx_INCREF(__pyx_t_3);
    __Pyx_INCREF(__pyx__function);
    __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
    __pyx_t_4 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_3, ((PyObject *)__pyx_v_varray)};
    __pyx_t_2 = __Pyx_MakeVectorcallBuilderKwds(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1680, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (__Pyx_VectorcallBuilder_AddArg(__pyx_mstate_global->__pyx_n_u_copy, Py_False, __pyx_t_2, __pyx_callargs+2, 0) < 0) __PYX_ERR(0, 1680, __pyx_L1_error)
    __pyx_t_1 = __Pyx_Object_Vectorcall_CallFromBuilder(__pyx_t_5, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1680, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_mstate_global->__pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1680, __pyx_L1_error)
  __pyx_v_nparr = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1681
 *     varray.set_data(size, data_pointer)
 *     nparr = np.array(varray, copy=False)
 *     np.PyArray_SetBaseObject(nparr,varray)             # <<<<<<<<<<<<<<
 *     # Increment the reference count, as the above assignement was done in
 *     # C, and Python does not know that there is this additional reference
*/
  __pyx_t_6 = PyArray_SetBaseObject(__pyx_v_nparr, ((PyObject *)__pyx_v_varray)); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 1681, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":1684
 *     # Increment the reference count, as the above assignement was done in
 *     # C, and Python does not know that there is this additional reference
 *     Py_INCREF(varray)             # <<<<<<<<<<<<<<
 *     return nparr
 * 
*/
  Py_INCREF(((PyObject *)__pyx_v_varray));

  /* "tmm4py/tmm4py_core.pyx":1685
 *     # C, and Python does not know that there is this additional reference
 *     Py_INCREF(varray)
 *     return nparr             # <<<<<<<<<<<<<<
 * 
 * cdef _ToNumpyRealArrayWithDel(PetscInt size, PetscScalar *data_pointer, PetscVec pv, myId):
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF((PyObject *)__pyx_v_nparr);
  __pyx_r = ((PyObject *)__pyx_v_nparr);
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1675
 *     return nparr
 * 
 * cdef _ToNumpyIntArray(PetscInt size, PetscInt *data_pointer):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef np.ndarray nparr
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("tmm4py.tmm4py_core._ToNumpyIntArray", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_nparr);
  __Pyx_XDECREF((PyObject *)__pyx_v_varray);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1687
 *     return nparr
 * 
 * cdef _ToNumpyRealArrayWithDel(PetscInt size, PetscScalar *data_pointer, PetscVec pv, myId):             # <<<<<<<<<<<<<<
 * # Note: pass NULL as the argument for pv if data_pointer doesn't point to a vector
 *     cdef PetscErrorCode ierr
*/

static PyObject *__pyx_f_6tmm4py_11tmm4py_core__ToNumpyRealArrayWithDel(PetscInt __pyx_v_size, PetscScalar *__pyx_v_data_pointer, Vec __pyx_v_pv, PyObject *__pyx_v_myId) {
  PetscErrorCode __pyx_v_ierr;
  PyArrayObject *__pyx_v_nparr = 0;
  struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *__pyx_v_varray = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  size_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  int __pyx_t_7;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_ToNumpyRealArrayWithDel", 0);

  /* "tmm4py/tmm4py_core.pyx":1691
 *     cdef PetscErrorCode ierr
 *     cdef np.ndarray nparr
 *     varray = _RealArrayWrapperWithDel()             # <<<<<<<<<<<<<<
 *     varray.set_data(size, data_pointer,pv,myId)
 *     nparr = np.array(varray, copy=False)
*/
  __pyx_t_2 = NULL;
  __Pyx_INCREF((PyObject *)__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel);
  __pyx_t_3 = ((PyObject *)__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel); 
  __pyx_t_4 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1691, __pyx_L1_error)
    __Pyx_GOTREF((PyObject *)__pyx_t_1);
  }
  __pyx_v_varray = ((struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1692
 *     cdef np.ndarray nparr
 *     varray = _RealArrayWrapperWithDel()
 *     varray.set_data(size, data_pointer,pv,myId)             # <<<<<<<<<<<<<<
 *     nparr = np.array(varray, copy=False)
 *     np.PyArray_SetBaseObject(nparr,varray)
*/
  if (!(likely(PyUnicode_CheckExact(__pyx_v_myId))||((__pyx_v_myId) == Py_None) || __Pyx_RaiseUnexpectedTypeError("str", __pyx_v_myId))) __PYX_ERR(0, 1692, __pyx_L1_error)
  __pyx_t_1 = ((struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *)__pyx_v_varray->__pyx_vtab)->set_data(__pyx_v_varray, __pyx_v_size, __pyx_v_data_pointer, __pyx_v_pv, ((PyObject*)__pyx_v_myId)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1692, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1693
 *     varray = _RealArrayWrapperWithDel()
 *     varray.set_data(size, data_pointer,pv,myId)
 *     nparr = np.array(varray, copy=False)             # <<<<<<<<<<<<<<
 *     np.PyArray_SetBaseObject(nparr,varray)
 *     # Increment the reference count, as the above assignement was done in
*/
  __pyx_t_3 = NULL;
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1693, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1693, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
    assert(__pyx_t_3);
    PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
    __Pyx_INCREF(__pyx_t_3);
    __Pyx_INCREF(__pyx__function);
    __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
    __pyx_t_4 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_3, ((PyObject *)__pyx_v_varray)};
    __pyx_t_2 = __Pyx_MakeVectorcallBuilderKwds(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1693, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (__Pyx_VectorcallBuilder_AddArg(__pyx_mstate_global->__pyx_n_u_copy, Py_False, __pyx_t_2, __pyx_callargs+2, 0) < 0) __PYX_ERR(0, 1693, __pyx_L1_error)
    __pyx_t_1 = __Pyx_Object_Vectorcall_CallFromBuilder(__pyx_t_5, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1693, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_mstate_global->__pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1693, __pyx_L1_error)
  __pyx_v_nparr = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1694
 *     varray.set_data(size, data_pointer,pv,myId)
 *     nparr = np.array(varray, copy=False)
 *     np.PyArray_SetBaseObject(nparr,varray)             # <<<<<<<<<<<<<<
 *     # Increment the reference count, as the above assignement was done in
 *     # C, and Python does not know that there is this additional reference
*/
  __pyx_t_6 = PyArray_SetBaseObject(__pyx_v_nparr, ((PyObject *)__pyx_v_varray)); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 1694, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":1697
 *     # Increment the reference count, as the above assignement was done in
 *     # C, and Python does not know that there is this additional reference
 *     Py_INCREF(varray)             # <<<<<<<<<<<<<<
 *     if pv:
 *         ierr = VecRestoreArray(pv, &data_pointer)
*/
  Py_INCREF(((PyObject *)__pyx_v_varray));

  /* "tmm4py/tmm4py_core.pyx":1698
 *     # C, and Python does not know that there is this additional reference
 *     Py_INCREF(varray)
 *     if pv:             # <<<<<<<<<<<<<<
 *         ierr = VecRestoreArray(pv, &data_pointer)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  __pyx_t_7 = (__pyx_v_pv != 0);
  if (__pyx_t_7) {

    /* "tmm4py/tmm4py_core.pyx":1699
 *     Py_INCREF(varray)
 *     if pv:
 *         ierr = VecRestoreArray(pv, &data_pointer)             # <<<<<<<<<<<<<<
 *         if ierr != 0: raise PETSc.Error(ierr)
 *     return nparr
*/
    __pyx_v_ierr = VecRestoreArray(__pyx_v_pv, (&__pyx_v_data_pointer));

    /* "tmm4py/tmm4py_core.pyx":1700
 *     if pv:
 *         ierr = VecRestoreArray(pv, &data_pointer)
 *         if ierr != 0: raise PETSc.Error(ierr)             # <<<<<<<<<<<<<<
 *     return nparr
 * 
*/
    __pyx_t_7 = (__pyx_v_ierr != 0);
    if (unlikely(__pyx_t_7)) {
      __pyx_t_5 = NULL;
      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1700, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_Error); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1700, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyLong_From_PetscErrorCode(__pyx_v_ierr); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1700, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
        assert(__pyx_t_5);
        PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(__pyx__function);
        __Pyx_DECREF_SET(__pyx_t_3, __pyx__function);
        __pyx_t_4 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_2};
        __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1700, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_Raise(__pyx_t_1, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __PYX_ERR(0, 1700, __pyx_L1_error)
    }

    /* "tmm4py/tmm4py_core.pyx":1698
 *     # C, and Python does not know that there is this additional reference
 *     Py_INCREF(varray)
 *     if pv:             # <<<<<<<<<<<<<<
 *         ierr = VecRestoreArray(pv, &data_pointer)
 *         if ierr != 0: raise PETSc.Error(ierr)
*/
  }

  /* "tmm4py/tmm4py_core.pyx":1701
 *         ierr = VecRestoreArray(pv, &data_pointer)
 *         if ierr != 0: raise PETSc.Error(ierr)
 *     return nparr             # <<<<<<<<<<<<<<
 * 
 * cdef _ToNumpyIntArrayWithDel(PetscInt size, PetscInt *data_pointer):
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF((PyObject *)__pyx_v_nparr);
  __pyx_r = ((PyObject *)__pyx_v_nparr);
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1687
 *     return nparr
 * 
 * cdef _ToNumpyRealArrayWithDel(PetscInt size, PetscScalar *data_pointer, PetscVec pv, myId):             # <<<<<<<<<<<<<<
 * # Note: pass NULL as the argument for pv if data_pointer doesn't point to a vector
 *     cdef PetscErrorCode ierr
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("tmm4py.tmm4py_core._ToNumpyRealArrayWithDel", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_nparr);
  __Pyx_XDECREF((PyObject *)__pyx_v_varray);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "tmm4py/tmm4py_core.pyx":1703
 *     return nparr
 * 
 * cdef _ToNumpyIntArrayWithDel(PetscInt size, PetscInt *data_pointer):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef np.ndarray nparr
*/

static PyObject *__pyx_f_6tmm4py_11tmm4py_core__ToNumpyIntArrayWithDel(PetscInt __pyx_v_size, PetscInt *__pyx_v_data_pointer) {
  PyArrayObject *__pyx_v_nparr = 0;
  struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *__pyx_v_varray = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  size_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_ToNumpyIntArrayWithDel", 0);

  /* "tmm4py/tmm4py_core.pyx":1706
 *     cdef PetscErrorCode ierr
 *     cdef np.ndarray nparr
 *     varray = _IntArrayWrapperWithDel()             # <<<<<<<<<<<<<<
 *     varray.set_data(size, data_pointer)
 *     nparr = np.array(varray, copy=False)
*/
  __pyx_t_2 = NULL;
  __Pyx_INCREF((PyObject *)__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel);
  __pyx_t_3 = ((PyObject *)__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel); 
  __pyx_t_4 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1706, __pyx_L1_error)
    __Pyx_GOTREF((PyObject *)__pyx_t_1);
  }
  __pyx_v_varray = ((struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1707
 *     cdef np.ndarray nparr
 *     varray = _IntArrayWrapperWithDel()
 *     varray.set_data(size, data_pointer)             # <<<<<<<<<<<<<<
 *     nparr = np.array(varray, copy=False)
 *     np.PyArray_SetBaseObject(nparr,varray)
*/
  __pyx_t_1 = ((struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *)__pyx_v_varray->__pyx_vtab)->set_data(__pyx_v_varray, __pyx_v_size, __pyx_v_data_pointer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1707, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1708
 *     varray = _IntArrayWrapperWithDel()
 *     varray.set_data(size, data_pointer)
 *     nparr = np.array(varray, copy=False)             # <<<<<<<<<<<<<<
 *     np.PyArray_SetBaseObject(nparr,varray)
 *     # Increment the reference count, as the above assignement was done in
*/
  __pyx_t_3 = NULL;
  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1708, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1708, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
    assert(__pyx_t_3);
    PyObject* __pyx__function = PyMethod_GET_FUNCTION(__pyx_t_5);
    __Pyx_INCREF(__pyx_t_3);
    __Pyx_INCREF(__pyx__function);
    __Pyx_DECREF_SET(__pyx_t_5, __pyx__function);
    __pyx_t_4 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_3, ((PyObject *)__pyx_v_varray)};
    __pyx_t_2 = __Pyx_MakeVectorcallBuilderKwds(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1708, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (__Pyx_VectorcallBuilder_AddArg(__pyx_mstate_global->__pyx_n_u_copy, Py_False, __pyx_t_2, __pyx_callargs+2, 0) < 0) __PYX_ERR(0, 1708, __pyx_L1_error)
    __pyx_t_1 = __Pyx_Object_Vectorcall_CallFromBuilder(__pyx_t_5, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1708, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_mstate_global->__pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1708, __pyx_L1_error)
  __pyx_v_nparr = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "tmm4py/tmm4py_core.pyx":1709
 *     varray.set_data(size, data_pointer)
 *     nparr = np.array(varray, copy=False)
 *     np.PyArray_SetBaseObject(nparr,varray)             # <<<<<<<<<<<<<<
 *     # Increment the reference count, as the above assignement was done in
 *     # C, and Python does not know that there is this additional reference
*/
  __pyx_t_6 = PyArray_SetBaseObject(__pyx_v_nparr, ((PyObject *)__pyx_v_varray)); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 1709, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":1712
 *     # Increment the reference count, as the above assignement was done in
 *     # C, and Python does not know that there is this additional reference
 *     Py_INCREF(varray)             # <<<<<<<<<<<<<<
 *     return nparr
 * 
*/
  Py_INCREF(((PyObject *)__pyx_v_varray));

  /* "tmm4py/tmm4py_core.pyx":1713
 *     # C, and Python does not know that there is this additional reference
 *     Py_INCREF(varray)
 *     return nparr             # <<<<<<<<<<<<<<
 * 
 * #
*/
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF((PyObject *)__pyx_v_nparr);
  __pyx_r = ((PyObject *)__pyx_v_nparr);
  goto __pyx_L0;

  /* "tmm4py/tmm4py_core.pyx":1703
 *     return nparr
 * 
 * cdef _ToNumpyIntArrayWithDel(PetscInt size, PetscInt *data_pointer):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef np.ndarray nparr
*/

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("tmm4py.tmm4py_core._ToNumpyIntArrayWithDel", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_nparr);
  __Pyx_XDECREF((PyObject *)__pyx_v_varray);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
/* #### Code section: module_exttypes ### */

static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_TMMState(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *p;
  PyObject *o;
  #if CYTHON_COMPILING_IN_LIMITED_API
  allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
  o = alloc_func(t, 0);
  #else
  if (likely(!__Pyx_PyType_HasFeature(t, Py_TPFLAGS_IS_ABSTRACT))) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_mstate_global->__pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  #endif
  p = ((struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)o);
  p->finiex = Py_None; Py_INCREF(Py_None);
  p->fcalcex = Py_None; Py_INCREF(Py_None);
  p->fwriex = Py_None; Py_INCREF(Py_None);
  p->ffinex = Py_None; Py_INCREF(Py_None);
  p->freiex = Py_None; Py_INCREF(Py_None);
  p->finicbc = Py_None; Py_INCREF(Py_None);
  p->fcalccbc = Py_None; Py_INCREF(Py_None);
  p->fwricbc = Py_None; Py_INCREF(Py_None);
  p->ffincbc = Py_None; Py_INCREF(Py_None);
  p->freicbc = Py_None; Py_INCREF(Py_None);
  p->finimon = Py_None; Py_INCREF(Py_None);
  p->fcalcmon = Py_None; Py_INCREF(Py_None);
  p->fwrimon = Py_None; Py_INCREF(Py_None);
  p->ffinmon = Py_None; Py_INCREF(Py_None);
  p->finimis = Py_None; Py_INCREF(Py_None);
  p->fcalcmis = Py_None; Py_INCREF(Py_None);
  p->fwrimis = Py_None; Py_INCREF(Py_None);
  p->ffinmis = Py_None; Py_INCREF(Py_None);
  p->stateId = Py_None; Py_INCREF(Py_None);
  p->numTracers = Py_None; Py_INCREF(Py_None);
  p->config = Py_None; Py_INCREF(Py_None);
  p->tracerNames = Py_None; Py_INCREF(Py_None);
  p->c = Py_None; Py_INCREF(Py_None);
  p->qf = Py_None; Py_INCREF(Py_None);
  p->qef = Py_None; Py_INCREF(Py_None);
  p->qrel = Py_None; Py_INCREF(Py_None);
  p->cbc = Py_None; Py_INCREF(Py_None);
  p->cbf = Py_None; Py_INCREF(Py_None);
  if (unlikely(__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_1__cinit__(o, __pyx_mstate_global->__pyx_empty_tuple, NULL) < 0)) goto bad;
  return o;
  bad:
  Py_DECREF(o); o = 0;
  return NULL;
}

static void __pyx_tp_dealloc_6tmm4py_11tmm4py_core_TMMState(PyObject *o) {
  struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)o;
  #if CYTHON_USE_TP_FINALIZE
  if (unlikely((PY_VERSION_HEX >= 0x03080000 || __Pyx_PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE)) && __Pyx_PyObject_GetSlot(o, tp_finalize, destructor)) && !__Pyx_PyObject_GC_IsFinalized(o)) {
    if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_6tmm4py_11tmm4py_core_TMMState) {
      if (PyObject_CallFinalizerFromDealloc(o)) return;
    }
  }
  #endif
  PyObject_GC_UnTrack(o);
  Py_CLEAR(p->finiex);
  Py_CLEAR(p->fcalcex);
  Py_CLEAR(p->fwriex);
  Py_CLEAR(p->ffinex);
  Py_CLEAR(p->freiex);
  Py_CLEAR(p->finicbc);
  Py_CLEAR(p->fcalccbc);
  Py_CLEAR(p->fwricbc);
  Py_CLEAR(p->ffincbc);
  Py_CLEAR(p->freicbc);
  Py_CLEAR(p->finimon);
  Py_CLEAR(p->fcalcmon);
  Py_CLEAR(p->fwrimon);
  Py_CLEAR(p->ffinmon);
  Py_CLEAR(p->finimis);
  Py_CLEAR(p->fcalcmis);
  Py_CLEAR(p->fwrimis);
  Py_CLEAR(p->ffinmis);
  Py_CLEAR(p->stateId);
  Py_CLEAR(p->numTracers);
  Py_CLEAR(p->config);
  Py_CLEAR(p->tracerNames);
  Py_CLEAR(p->c);
  Py_CLEAR(p->qf);
  Py_CLEAR(p->qef);
  Py_CLEAR(p->qrel);
  Py_CLEAR(p->cbc);
  Py_CLEAR(p->cbf);
  #if CYTHON_USE_TYPE_SLOTS
  (*Py_TYPE(o)->tp_free)(o);
  #else
  {
    freefunc tp_free = (freefunc)PyType_GetSlot(Py_TYPE(o), Py_tp_free);
    if (tp_free) tp_free(o);
  }
  #endif
}

static int __pyx_tp_traverse_6tmm4py_11tmm4py_core_TMMState(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)o;
  {
    e = __Pyx_call_type_traverse(o, 1, v, a);
    if (e) return e;
  }
  if (p->finiex) {
    e = (*v)(p->finiex, a); if (e) return e;
  }
  if (p->fcalcex) {
    e = (*v)(p->fcalcex, a); if (e) return e;
  }
  if (p->fwriex) {
    e = (*v)(p->fwriex, a); if (e) return e;
  }
  if (p->ffinex) {
    e = (*v)(p->ffinex, a); if (e) return e;
  }
  if (p->freiex) {
    e = (*v)(p->freiex, a); if (e) return e;
  }
  if (p->finicbc) {
    e = (*v)(p->finicbc, a); if (e) return e;
  }
  if (p->fcalccbc) {
    e = (*v)(p->fcalccbc, a); if (e) return e;
  }
  if (p->fwricbc) {
    e = (*v)(p->fwricbc, a); if (e) return e;
  }
  if (p->ffincbc) {
    e = (*v)(p->ffincbc, a); if (e) return e;
  }
  if (p->freicbc) {
    e = (*v)(p->freicbc, a); if (e) return e;
  }
  if (p->finimon) {
    e = (*v)(p->finimon, a); if (e) return e;
  }
  if (p->fcalcmon) {
    e = (*v)(p->fcalcmon, a); if (e) return e;
  }
  if (p->fwrimon) {
    e = (*v)(p->fwrimon, a); if (e) return e;
  }
  if (p->ffinmon) {
    e = (*v)(p->ffinmon, a); if (e) return e;
  }
  if (p->finimis) {
    e = (*v)(p->finimis, a); if (e) return e;
  }
  if (p->fcalcmis) {
    e = (*v)(p->fcalcmis, a); if (e) return e;
  }
  if (p->fwrimis) {
    e = (*v)(p->fwrimis, a); if (e) return e;
  }
  if (p->ffinmis) {
    e = (*v)(p->ffinmis, a); if (e) return e;
  }
  if (p->stateId) {
    e = (*v)(p->stateId, a); if (e) return e;
  }
  if (p->numTracers) {
    e = (*v)(p->numTracers, a); if (e) return e;
  }
  if (p->config) {
    e = (*v)(p->config, a); if (e) return e;
  }
  if (p->tracerNames) {
    e = (*v)(p->tracerNames, a); if (e) return e;
  }
  if (p->c) {
    e = (*v)(p->c, a); if (e) return e;
  }
  if (p->qf) {
    e = (*v)(p->qf, a); if (e) return e;
  }
  if (p->qef) {
    e = (*v)(p->qef, a); if (e) return e;
  }
  if (p->qrel) {
    e = (*v)(p->qrel, a); if (e) return e;
  }
  if (p->cbc) {
    e = (*v)(p->cbc, a); if (e) return e;
  }
  if (p->cbf) {
    e = (*v)(p->cbf, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6tmm4py_11tmm4py_core_TMMState(PyObject *o) {
  PyObject* tmp;
  struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState *)o;
  tmp = ((PyObject*)p->finiex);
  p->finiex = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->fcalcex);
  p->fcalcex = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->fwriex);
  p->fwriex = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->ffinex);
  p->ffinex = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->freiex);
  p->freiex = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->finicbc);
  p->finicbc = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->fcalccbc);
  p->fcalccbc = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->fwricbc);
  p->fwricbc = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->ffincbc);
  p->ffincbc = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->freicbc);
  p->freicbc = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->finimon);
  p->finimon = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->fcalcmon);
  p->fcalcmon = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->fwrimon);
  p->fwrimon = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->ffinmon);
  p->ffinmon = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->finimis);
  p->finimis = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->fcalcmis);
  p->fcalcmis = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->fwrimis);
  p->fwrimis = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->ffinmis);
  p->ffinmis = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->stateId);
  p->stateId = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->numTracers);
  p->numTracers = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->config);
  p->config = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->tracerNames);
  p->tracerNames = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->c);
  p->c = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->qf);
  p->qf = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->qef);
  p->qef = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->qrel);
  p->qrel = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->cbc);
  p->cbc = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->cbf);
  p->cbf = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_finiex(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6finiex_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_finiex(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6finiex_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6finiex_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fcalcex(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fcalcex(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fcalcex_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fwriex(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6fwriex_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fwriex(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6fwriex_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6fwriex_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_ffinex(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6ffinex_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_ffinex(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6ffinex_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6ffinex_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_freiex(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6freiex_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_freiex(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6freiex_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6freiex_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_finicbc(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finicbc_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_finicbc(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finicbc_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finicbc_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fcalccbc(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fcalccbc(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalccbc_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fwricbc(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fwricbc(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwricbc_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_ffincbc(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_ffincbc(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffincbc_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_freicbc(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7freicbc_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_freicbc(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7freicbc_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7freicbc_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_finimon(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimon_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_finimon(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimon_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimon_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fcalcmon(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fcalcmon(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmon_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fwrimon(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fwrimon(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimon_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_ffinmon(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_ffinmon(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmon_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_finimis(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimis_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_finimis(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimis_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7finimis_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fcalcmis(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fcalcmis(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_8fcalcmis_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fwrimis(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fwrimis(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7fwrimis_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_ffinmis(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_ffinmis(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7ffinmis_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_stateId(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7stateId_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_stateId(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7stateId_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7stateId_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_numTracers(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_10numTracers_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_numTracers(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_10numTracers_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_10numTracers_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_config(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6config_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_config(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6config_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_6config_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_tracerNames(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_tracerNames(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_11tracerNames_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_c(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_1c_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_c(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_1c_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_1c_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_qf(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_2qf_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_qf(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_2qf_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_2qf_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_qef(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3qef_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_qef(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3qef_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3qef_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_qrel(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_4qrel_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_qrel(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_4qrel_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_4qrel_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_cbc(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbc_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_cbc(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbc_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbc_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_cbf(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbf_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_cbf(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbf_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3cbf_5__del__(o);
  }
}

static PyMethodDef __pyx_methods_6tmm4py_11tmm4py_core_TMMState[] = {
  {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setIniExternalForcingFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_7setIniExternalForcingFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setCalcExternalForcingFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_9setCalcExternalForcingFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setWriExternalForcingFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_11setWriExternalForcingFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setFinExternalForcingFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_13setFinExternalForcingFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setReiExternalForcingFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_15setReiExternalForcingFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setIniCalcBCFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_17setIniCalcBCFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setCalcCalcBCFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_19setCalcCalcBCFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setWriCalcBCFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_21setWriCalcBCFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setFinCalcBCFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_23setFinCalcBCFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setReiCalcBCFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_25setReiCalcBCFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setIniMonitorFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_27setIniMonitorFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setCalcMonitorFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_29setCalcMonitorFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setWriMonitorFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_31setWriMonitorFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setFinMonitorFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_33setFinMonitorFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setIniMisfitFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_35setIniMisfitFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setCalcMisfitFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_37setCalcMisfitFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setWriMisfitFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_39setWriMisfitFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setFinMisfitFunction", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_41setFinMisfitFunction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"getConfig", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_43getConfig, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"getNumTracers", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_45getNumTracers, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setFromOptions", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_47setFromOptions, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"forcingUpdate", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_49forcingUpdate, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"timeStep", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_51timeStep, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"timeStepPost", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_53timeStepPost, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"output", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_55output, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"pushConfigVar", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_57pushConfigVar, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"destroy", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_59destroy, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"setTracer", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_61setTracer, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"loadTracerFromFile", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_63loadTracerFromFile, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_65__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_67__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6tmm4py_11tmm4py_core_TMMState[] = {
  {"finiex", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_finiex, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_finiex, 0, 0},
  {"fcalcex", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fcalcex, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fcalcex, 0, 0},
  {"fwriex", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fwriex, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fwriex, 0, 0},
  {"ffinex", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_ffinex, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_ffinex, 0, 0},
  {"freiex", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_freiex, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_freiex, 0, 0},
  {"finicbc", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_finicbc, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_finicbc, 0, 0},
  {"fcalccbc", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fcalccbc, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fcalccbc, 0, 0},
  {"fwricbc", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fwricbc, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fwricbc, 0, 0},
  {"ffincbc", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_ffincbc, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_ffincbc, 0, 0},
  {"freicbc", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_freicbc, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_freicbc, 0, 0},
  {"finimon", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_finimon, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_finimon, 0, 0},
  {"fcalcmon", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fcalcmon, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fcalcmon, 0, 0},
  {"fwrimon", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fwrimon, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fwrimon, 0, 0},
  {"ffinmon", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_ffinmon, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_ffinmon, 0, 0},
  {"finimis", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_finimis, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_finimis, 0, 0},
  {"fcalcmis", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fcalcmis, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fcalcmis, 0, 0},
  {"fwrimis", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_fwrimis, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_fwrimis, 0, 0},
  {"ffinmis", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_ffinmis, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_ffinmis, 0, 0},
  {"stateId", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_stateId, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_stateId, 0, 0},
  {"numTracers", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_numTracers, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_numTracers, 0, 0},
  {"config", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_config, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_config, 0, 0},
  {"tracerNames", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_tracerNames, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_tracerNames, 0, 0},
  {"c", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_c, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_c, 0, 0},
  {"qf", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_qf, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_qf, 0, 0},
  {"qef", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_qef, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_qef, 0, 0},
  {"qrel", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_qrel, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_qrel, 0, 0},
  {"cbc", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_cbc, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_cbc, 0, 0},
  {"cbf", __pyx_getprop_6tmm4py_11tmm4py_core_8TMMState_cbf, __pyx_setprop_6tmm4py_11tmm4py_core_8TMMState_cbf, 0, 0},
  {0, 0, 0, 0, 0}
};
#if CYTHON_USE_TYPE_SPECS
static PyType_Slot __pyx_type_6tmm4py_11tmm4py_core_TMMState_slots[] = {
  {Py_tp_dealloc, (void *)__pyx_tp_dealloc_6tmm4py_11tmm4py_core_TMMState},
  {Py_tp_traverse, (void *)__pyx_tp_traverse_6tmm4py_11tmm4py_core_TMMState},
  {Py_tp_clear, (void *)__pyx_tp_clear_6tmm4py_11tmm4py_core_TMMState},
  {Py_tp_methods, (void *)__pyx_methods_6tmm4py_11tmm4py_core_TMMState},
  {Py_tp_getset, (void *)__pyx_getsets_6tmm4py_11tmm4py_core_TMMState},
  {Py_tp_init, (void *)__pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3__init__},
  {Py_tp_new, (void *)__pyx_tp_new_6tmm4py_11tmm4py_core_TMMState},
  {0, 0},
};
static PyType_Spec __pyx_type_6tmm4py_11tmm4py_core_TMMState_spec = {
  "tmm4py.tmm4py_core.TMMState",
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState),
  0,
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC,
  __pyx_type_6tmm4py_11tmm4py_core_TMMState_slots,
};
#else

static PyTypeObject __pyx_type_6tmm4py_11tmm4py_core_TMMState = {
  PyVarObject_HEAD_INIT(0, 0)
  "tmm4py.tmm4py_core.""TMMState", /*tp_name*/
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_TMMState), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6tmm4py_11tmm4py_core_TMMState, /*tp_dealloc*/
  #if PY_VERSION_HEX < 0x030800b4
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b4
  0, /*tp_vectorcall_offset*/
  #endif
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_as_async*/
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_6tmm4py_11tmm4py_core_TMMState, /*tp_traverse*/
  __pyx_tp_clear_6tmm4py_11tmm4py_core_TMMState, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6tmm4py_11tmm4py_core_TMMState, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6tmm4py_11tmm4py_core_TMMState, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  #if !CYTHON_USE_TYPE_SPECS
  0, /*tp_dictoffset*/
  #endif
  __pyx_pw_6tmm4py_11tmm4py_core_8TMMState_3__init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6tmm4py_11tmm4py_core_TMMState, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if CYTHON_USE_TP_FINALIZE
  0, /*tp_finalize*/
  #else
  NULL, /*tp_finalize*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
  0, /*tp_vectorcall*/
  #endif
  #if __PYX_NEED_TP_PRINT_SLOT == 1
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030C0000
  0, /*tp_watched*/
  #endif
  #if PY_VERSION_HEX >= 0x030d00A4
  0, /*tp_versions_used*/
  #endif
  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
  0, /*tp_pypy_flags*/
  #endif
};
#endif

static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_StepTimer(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *p;
  PyObject *o;
  #if CYTHON_COMPILING_IN_LIMITED_API
  allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
  o = alloc_func(t, 0);
  #else
  if (likely(!__Pyx_PyType_HasFeature(t, Py_TPFLAGS_IS_ABSTRACT))) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_mstate_global->__pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  #endif
  p = ((struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)o);
  p->count = Py_None; Py_INCREF(Py_None);
  p->startTimeStep = Py_None; Py_INCREF(Py_None);
  p->numTimeSteps = Py_None; Py_INCREF(Py_None);
  if (unlikely(__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_1__cinit__(o, __pyx_mstate_global->__pyx_empty_tuple, NULL) < 0)) goto bad;
  return o;
  bad:
  Py_DECREF(o); o = 0;
  return NULL;
}

static void __pyx_tp_dealloc_6tmm4py_11tmm4py_core_StepTimer(PyObject *o) {
  struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)o;
  #if CYTHON_USE_TP_FINALIZE
  if (unlikely((PY_VERSION_HEX >= 0x03080000 || __Pyx_PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE)) && __Pyx_PyObject_GetSlot(o, tp_finalize, destructor)) && !__Pyx_PyObject_GC_IsFinalized(o)) {
    if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_6tmm4py_11tmm4py_core_StepTimer) {
      if (PyObject_CallFinalizerFromDealloc(o)) return;
    }
  }
  #endif
  PyObject_GC_UnTrack(o);
  Py_CLEAR(p->count);
  Py_CLEAR(p->startTimeStep);
  Py_CLEAR(p->numTimeSteps);
  #if CYTHON_USE_TYPE_SLOTS
  (*Py_TYPE(o)->tp_free)(o);
  #else
  {
    freefunc tp_free = (freefunc)PyType_GetSlot(Py_TYPE(o), Py_tp_free);
    if (tp_free) tp_free(o);
  }
  #endif
}

static int __pyx_tp_traverse_6tmm4py_11tmm4py_core_StepTimer(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)o;
  {
    e = __Pyx_call_type_traverse(o, 1, v, a);
    if (e) return e;
  }
  if (p->count) {
    e = (*v)(p->count, a); if (e) return e;
  }
  if (p->startTimeStep) {
    e = (*v)(p->startTimeStep, a); if (e) return e;
  }
  if (p->numTimeSteps) {
    e = (*v)(p->numTimeSteps, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6tmm4py_11tmm4py_core_StepTimer(PyObject *o) {
  PyObject* tmp;
  struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer *)o;
  tmp = ((PyObject*)p->count);
  p->count = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->startTimeStep);
  p->startTimeStep = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->numTimeSteps);
  p->numTimeSteps = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_9StepTimer_count(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_5count_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_9StepTimer_count(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_5count_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_5count_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_9StepTimer_startTimeStep(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_9StepTimer_startTimeStep(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_13startTimeStep_5__del__(o);
  }
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_9StepTimer_numTimeSteps(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_9StepTimer_numTimeSteps(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_12numTimeSteps_5__del__(o);
  }
}

static PyMethodDef __pyx_methods_6tmm4py_11tmm4py_core_StepTimer[] = {
  {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"update", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_7update, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"incr", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_9incr, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_11__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_13__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6tmm4py_11tmm4py_core_StepTimer[] = {
  {"count", __pyx_getprop_6tmm4py_11tmm4py_core_9StepTimer_count, __pyx_setprop_6tmm4py_11tmm4py_core_9StepTimer_count, 0, 0},
  {"startTimeStep", __pyx_getprop_6tmm4py_11tmm4py_core_9StepTimer_startTimeStep, __pyx_setprop_6tmm4py_11tmm4py_core_9StepTimer_startTimeStep, 0, 0},
  {"numTimeSteps", __pyx_getprop_6tmm4py_11tmm4py_core_9StepTimer_numTimeSteps, __pyx_setprop_6tmm4py_11tmm4py_core_9StepTimer_numTimeSteps, 0, 0},
  {0, 0, 0, 0, 0}
};
#if CYTHON_USE_TYPE_SPECS
static PyType_Slot __pyx_type_6tmm4py_11tmm4py_core_StepTimer_slots[] = {
  {Py_tp_dealloc, (void *)__pyx_tp_dealloc_6tmm4py_11tmm4py_core_StepTimer},
  {Py_tp_traverse, (void *)__pyx_tp_traverse_6tmm4py_11tmm4py_core_StepTimer},
  {Py_tp_clear, (void *)__pyx_tp_clear_6tmm4py_11tmm4py_core_StepTimer},
  {Py_tp_methods, (void *)__pyx_methods_6tmm4py_11tmm4py_core_StepTimer},
  {Py_tp_getset, (void *)__pyx_getsets_6tmm4py_11tmm4py_core_StepTimer},
  {Py_tp_init, (void *)__pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_3__init__},
  {Py_tp_new, (void *)__pyx_tp_new_6tmm4py_11tmm4py_core_StepTimer},
  {0, 0},
};
static PyType_Spec __pyx_type_6tmm4py_11tmm4py_core_StepTimer_spec = {
  "tmm4py.tmm4py_core.StepTimer",
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer),
  0,
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC,
  __pyx_type_6tmm4py_11tmm4py_core_StepTimer_slots,
};
#else

static PyTypeObject __pyx_type_6tmm4py_11tmm4py_core_StepTimer = {
  PyVarObject_HEAD_INIT(0, 0)
  "tmm4py.tmm4py_core.""StepTimer", /*tp_name*/
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_StepTimer), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6tmm4py_11tmm4py_core_StepTimer, /*tp_dealloc*/
  #if PY_VERSION_HEX < 0x030800b4
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b4
  0, /*tp_vectorcall_offset*/
  #endif
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_as_async*/
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_6tmm4py_11tmm4py_core_StepTimer, /*tp_traverse*/
  __pyx_tp_clear_6tmm4py_11tmm4py_core_StepTimer, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6tmm4py_11tmm4py_core_StepTimer, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6tmm4py_11tmm4py_core_StepTimer, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  #if !CYTHON_USE_TYPE_SPECS
  0, /*tp_dictoffset*/
  #endif
  __pyx_pw_6tmm4py_11tmm4py_core_9StepTimer_3__init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6tmm4py_11tmm4py_core_StepTimer, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if CYTHON_USE_TP_FINALIZE
  0, /*tp_finalize*/
  #else
  NULL, /*tp_finalize*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
  0, /*tp_vectorcall*/
  #endif
  #if __PYX_NEED_TP_PRINT_SLOT == 1
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030C0000
  0, /*tp_watched*/
  #endif
  #if PY_VERSION_HEX >= 0x030d00A4
  0, /*tp_versions_used*/
  #endif
  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
  0, /*tp_pypy_flags*/
  #endif
};
#endif

static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_PeriodicTimer(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  PyObject *o;
  #if CYTHON_COMPILING_IN_LIMITED_API
  allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
  o = alloc_func(t, 0);
  #else
  if (likely(!__Pyx_PyType_HasFeature(t, Py_TPFLAGS_IS_ABSTRACT))) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_mstate_global->__pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  #endif
  if (unlikely(__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_1__cinit__(o, __pyx_mstate_global->__pyx_empty_tuple, NULL) < 0)) goto bad;
  return o;
  bad:
  Py_DECREF(o); o = 0;
  return NULL;
}

static void __pyx_tp_dealloc_6tmm4py_11tmm4py_core_PeriodicTimer(PyObject *o) {
  #if CYTHON_USE_TP_FINALIZE
  if (unlikely((PY_VERSION_HEX >= 0x03080000 || __Pyx_PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE)) && __Pyx_PyObject_GetSlot(o, tp_finalize, destructor)) && (!PyType_IS_GC(Py_TYPE(o)) || !__Pyx_PyObject_GC_IsFinalized(o))) {
    if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_6tmm4py_11tmm4py_core_PeriodicTimer) {
      if (PyObject_CallFinalizerFromDealloc(o)) return;
    }
  }
  #endif
  #if CYTHON_USE_TYPE_SLOTS
  (*Py_TYPE(o)->tp_free)(o);
  #else
  {
    freefunc tp_free = (freefunc)PyType_GetSlot(Py_TYPE(o), Py_tp_free);
    if (tp_free) tp_free(o);
  }
  #endif
}

static PyMethodDef __pyx_methods_6tmm4py_11tmm4py_core_PeriodicTimer[] = {
  {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_7__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_9__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};
#if CYTHON_USE_TYPE_SPECS
static PyType_Slot __pyx_type_6tmm4py_11tmm4py_core_PeriodicTimer_slots[] = {
  {Py_tp_dealloc, (void *)__pyx_tp_dealloc_6tmm4py_11tmm4py_core_PeriodicTimer},
  {Py_tp_methods, (void *)__pyx_methods_6tmm4py_11tmm4py_core_PeriodicTimer},
  {Py_tp_init, (void *)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_3__init__},
  {Py_tp_new, (void *)__pyx_tp_new_6tmm4py_11tmm4py_core_PeriodicTimer},
  {0, 0},
};
static PyType_Spec __pyx_type_6tmm4py_11tmm4py_core_PeriodicTimer_spec = {
  "tmm4py.tmm4py_core.PeriodicTimer",
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer),
  0,
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE,
  __pyx_type_6tmm4py_11tmm4py_core_PeriodicTimer_slots,
};
#else

static PyTypeObject __pyx_type_6tmm4py_11tmm4py_core_PeriodicTimer = {
  PyVarObject_HEAD_INIT(0, 0)
  "tmm4py.tmm4py_core.""PeriodicTimer", /*tp_name*/
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicTimer), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6tmm4py_11tmm4py_core_PeriodicTimer, /*tp_dealloc*/
  #if PY_VERSION_HEX < 0x030800b4
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b4
  0, /*tp_vectorcall_offset*/
  #endif
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_as_async*/
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6tmm4py_11tmm4py_core_PeriodicTimer, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  #if !CYTHON_USE_TYPE_SPECS
  0, /*tp_dictoffset*/
  #endif
  __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicTimer_3__init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6tmm4py_11tmm4py_core_PeriodicTimer, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if CYTHON_USE_TP_FINALIZE
  0, /*tp_finalize*/
  #else
  NULL, /*tp_finalize*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
  0, /*tp_vectorcall*/
  #endif
  #if __PYX_NEED_TP_PRINT_SLOT == 1
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030C0000
  0, /*tp_watched*/
  #endif
  #if PY_VERSION_HEX >= 0x030d00A4
  0, /*tp_versions_used*/
  #endif
  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
  0, /*tp_pypy_flags*/
  #endif
};
#endif

static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_TimeDependentTimer(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  PyObject *o;
  #if CYTHON_COMPILING_IN_LIMITED_API
  allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
  o = alloc_func(t, 0);
  #else
  if (likely(!__Pyx_PyType_HasFeature(t, Py_TPFLAGS_IS_ABSTRACT))) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_mstate_global->__pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  #endif
  if (unlikely(__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_1__cinit__(o, __pyx_mstate_global->__pyx_empty_tuple, NULL) < 0)) goto bad;
  return o;
  bad:
  Py_DECREF(o); o = 0;
  return NULL;
}

static void __pyx_tp_dealloc_6tmm4py_11tmm4py_core_TimeDependentTimer(PyObject *o) {
  #if CYTHON_USE_TP_FINALIZE
  if (unlikely((PY_VERSION_HEX >= 0x03080000 || __Pyx_PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE)) && __Pyx_PyObject_GetSlot(o, tp_finalize, destructor)) && (!PyType_IS_GC(Py_TYPE(o)) || !__Pyx_PyObject_GC_IsFinalized(o))) {
    if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_6tmm4py_11tmm4py_core_TimeDependentTimer) {
      if (PyObject_CallFinalizerFromDealloc(o)) return;
    }
  }
  #endif
  #if CYTHON_USE_TYPE_SLOTS
  (*Py_TYPE(o)->tp_free)(o);
  #else
  {
    freefunc tp_free = (freefunc)PyType_GetSlot(Py_TYPE(o), Py_tp_free);
    if (tp_free) tp_free(o);
  }
  #endif
}

static PyMethodDef __pyx_methods_6tmm4py_11tmm4py_core_TimeDependentTimer[] = {
  {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_7__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_9__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};
#if CYTHON_USE_TYPE_SPECS
static PyType_Slot __pyx_type_6tmm4py_11tmm4py_core_TimeDependentTimer_slots[] = {
  {Py_tp_dealloc, (void *)__pyx_tp_dealloc_6tmm4py_11tmm4py_core_TimeDependentTimer},
  {Py_tp_methods, (void *)__pyx_methods_6tmm4py_11tmm4py_core_TimeDependentTimer},
  {Py_tp_init, (void *)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_3__init__},
  {Py_tp_new, (void *)__pyx_tp_new_6tmm4py_11tmm4py_core_TimeDependentTimer},
  {0, 0},
};
static PyType_Spec __pyx_type_6tmm4py_11tmm4py_core_TimeDependentTimer_spec = {
  "tmm4py.tmm4py_core.TimeDependentTimer",
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer),
  0,
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE,
  __pyx_type_6tmm4py_11tmm4py_core_TimeDependentTimer_slots,
};
#else

static PyTypeObject __pyx_type_6tmm4py_11tmm4py_core_TimeDependentTimer = {
  PyVarObject_HEAD_INIT(0, 0)
  "tmm4py.tmm4py_core.""TimeDependentTimer", /*tp_name*/
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentTimer), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6tmm4py_11tmm4py_core_TimeDependentTimer, /*tp_dealloc*/
  #if PY_VERSION_HEX < 0x030800b4
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b4
  0, /*tp_vectorcall_offset*/
  #endif
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_as_async*/
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6tmm4py_11tmm4py_core_TimeDependentTimer, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  #if !CYTHON_USE_TYPE_SPECS
  0, /*tp_dictoffset*/
  #endif
  __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentTimer_3__init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6tmm4py_11tmm4py_core_TimeDependentTimer, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if CYTHON_USE_TP_FINALIZE
  0, /*tp_finalize*/
  #else
  NULL, /*tp_finalize*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
  0, /*tp_vectorcall*/
  #endif
  #if __PYX_NEED_TP_PRINT_SLOT == 1
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030C0000
  0, /*tp_watched*/
  #endif
  #if PY_VERSION_HEX >= 0x030d00A4
  0, /*tp_versions_used*/
  #endif
  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
  0, /*tp_pypy_flags*/
  #endif
};
#endif

static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_PeriodicVec(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *p;
  PyObject *o;
  #if CYTHON_COMPILING_IN_LIMITED_API
  allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
  o = alloc_func(t, 0);
  #else
  if (likely(!__Pyx_PyType_HasFeature(t, Py_TPFLAGS_IS_ABSTRACT))) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_mstate_global->__pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  #endif
  p = ((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)o);
  p->arr = Py_None; Py_INCREF(Py_None);
  if (unlikely(__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_1__cinit__(o, __pyx_mstate_global->__pyx_empty_tuple, NULL) < 0)) goto bad;
  return o;
  bad:
  Py_DECREF(o); o = 0;
  return NULL;
}

static void __pyx_tp_dealloc_6tmm4py_11tmm4py_core_PeriodicVec(PyObject *o) {
  struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)o;
  #if CYTHON_USE_TP_FINALIZE
  if (unlikely((PY_VERSION_HEX >= 0x03080000 || __Pyx_PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE)) && __Pyx_PyObject_GetSlot(o, tp_finalize, destructor)) && !__Pyx_PyObject_GC_IsFinalized(o)) {
    if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_6tmm4py_11tmm4py_core_PeriodicVec) {
      if (PyObject_CallFinalizerFromDealloc(o)) return;
    }
  }
  #endif
  PyObject_GC_UnTrack(o);
  Py_CLEAR(p->arr);
  #if CYTHON_USE_TYPE_SLOTS
  (*Py_TYPE(o)->tp_free)(o);
  #else
  {
    freefunc tp_free = (freefunc)PyType_GetSlot(Py_TYPE(o), Py_tp_free);
    if (tp_free) tp_free(o);
  }
  #endif
}

static int __pyx_tp_traverse_6tmm4py_11tmm4py_core_PeriodicVec(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)o;
  {
    e = __Pyx_call_type_traverse(o, 1, v, a);
    if (e) return e;
  }
  if (p->arr) {
    e = (*v)(p->arr, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6tmm4py_11tmm4py_core_PeriodicVec(PyObject *o) {
  PyObject* tmp;
  struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec *)o;
  tmp = ((PyObject*)p->arr);
  p->arr = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_11PeriodicVec_arr(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_11PeriodicVec_arr(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_3arr_5__del__(o);
  }
}

static PyMethodDef __pyx_methods_6tmm4py_11tmm4py_core_PeriodicVec[] = {
  {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"interp", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_7interp, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"destroy", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_9destroy, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_11__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_13__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6tmm4py_11tmm4py_core_PeriodicVec[] = {
  {"arr", __pyx_getprop_6tmm4py_11tmm4py_core_11PeriodicVec_arr, __pyx_setprop_6tmm4py_11tmm4py_core_11PeriodicVec_arr, 0, 0},
  {0, 0, 0, 0, 0}
};
#if CYTHON_USE_TYPE_SPECS
static PyType_Slot __pyx_type_6tmm4py_11tmm4py_core_PeriodicVec_slots[] = {
  {Py_tp_dealloc, (void *)__pyx_tp_dealloc_6tmm4py_11tmm4py_core_PeriodicVec},
  {Py_tp_traverse, (void *)__pyx_tp_traverse_6tmm4py_11tmm4py_core_PeriodicVec},
  {Py_tp_clear, (void *)__pyx_tp_clear_6tmm4py_11tmm4py_core_PeriodicVec},
  {Py_tp_methods, (void *)__pyx_methods_6tmm4py_11tmm4py_core_PeriodicVec},
  {Py_tp_getset, (void *)__pyx_getsets_6tmm4py_11tmm4py_core_PeriodicVec},
  {Py_tp_init, (void *)__pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_3__init__},
  {Py_tp_new, (void *)__pyx_tp_new_6tmm4py_11tmm4py_core_PeriodicVec},
  {0, 0},
};
static PyType_Spec __pyx_type_6tmm4py_11tmm4py_core_PeriodicVec_spec = {
  "tmm4py.tmm4py_core.PeriodicVec",
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec),
  0,
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC,
  __pyx_type_6tmm4py_11tmm4py_core_PeriodicVec_slots,
};
#else

static PyTypeObject __pyx_type_6tmm4py_11tmm4py_core_PeriodicVec = {
  PyVarObject_HEAD_INIT(0, 0)
  "tmm4py.tmm4py_core.""PeriodicVec", /*tp_name*/
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicVec), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6tmm4py_11tmm4py_core_PeriodicVec, /*tp_dealloc*/
  #if PY_VERSION_HEX < 0x030800b4
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b4
  0, /*tp_vectorcall_offset*/
  #endif
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_as_async*/
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_6tmm4py_11tmm4py_core_PeriodicVec, /*tp_traverse*/
  __pyx_tp_clear_6tmm4py_11tmm4py_core_PeriodicVec, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6tmm4py_11tmm4py_core_PeriodicVec, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6tmm4py_11tmm4py_core_PeriodicVec, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  #if !CYTHON_USE_TYPE_SPECS
  0, /*tp_dictoffset*/
  #endif
  __pyx_pw_6tmm4py_11tmm4py_core_11PeriodicVec_3__init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6tmm4py_11tmm4py_core_PeriodicVec, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if CYTHON_USE_TP_FINALIZE
  0, /*tp_finalize*/
  #else
  NULL, /*tp_finalize*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
  0, /*tp_vectorcall*/
  #endif
  #if __PYX_NEED_TP_PRINT_SLOT == 1
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030C0000
  0, /*tp_watched*/
  #endif
  #if PY_VERSION_HEX >= 0x030d00A4
  0, /*tp_versions_used*/
  #endif
  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
  0, /*tp_pypy_flags*/
  #endif
};
#endif

static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_TimeDependentVec(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *p;
  PyObject *o;
  #if CYTHON_COMPILING_IN_LIMITED_API
  allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
  o = alloc_func(t, 0);
  #else
  if (likely(!__Pyx_PyType_HasFeature(t, Py_TPFLAGS_IS_ABSTRACT))) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_mstate_global->__pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  #endif
  p = ((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)o);
  p->arr = Py_None; Py_INCREF(Py_None);
  if (unlikely(__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_1__cinit__(o, __pyx_mstate_global->__pyx_empty_tuple, NULL) < 0)) goto bad;
  return o;
  bad:
  Py_DECREF(o); o = 0;
  return NULL;
}

static void __pyx_tp_dealloc_6tmm4py_11tmm4py_core_TimeDependentVec(PyObject *o) {
  struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)o;
  #if CYTHON_USE_TP_FINALIZE
  if (unlikely((PY_VERSION_HEX >= 0x03080000 || __Pyx_PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE)) && __Pyx_PyObject_GetSlot(o, tp_finalize, destructor)) && !__Pyx_PyObject_GC_IsFinalized(o)) {
    if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_6tmm4py_11tmm4py_core_TimeDependentVec) {
      if (PyObject_CallFinalizerFromDealloc(o)) return;
    }
  }
  #endif
  PyObject_GC_UnTrack(o);
  Py_CLEAR(p->arr);
  #if CYTHON_USE_TYPE_SLOTS
  (*Py_TYPE(o)->tp_free)(o);
  #else
  {
    freefunc tp_free = (freefunc)PyType_GetSlot(Py_TYPE(o), Py_tp_free);
    if (tp_free) tp_free(o);
  }
  #endif
}

static int __pyx_tp_traverse_6tmm4py_11tmm4py_core_TimeDependentVec(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)o;
  {
    e = __Pyx_call_type_traverse(o, 1, v, a);
    if (e) return e;
  }
  if (p->arr) {
    e = (*v)(p->arr, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6tmm4py_11tmm4py_core_TimeDependentVec(PyObject *o) {
  PyObject* tmp;
  struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec *)o;
  tmp = ((PyObject*)p->arr);
  p->arr = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_16TimeDependentVec_arr(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_16TimeDependentVec_arr(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_3arr_5__del__(o);
  }
}

static PyMethodDef __pyx_methods_6tmm4py_11tmm4py_core_TimeDependentVec[] = {
  {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"interp", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_7interp, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"destroy", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_9destroy, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_11__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_13__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6tmm4py_11tmm4py_core_TimeDependentVec[] = {
  {"arr", __pyx_getprop_6tmm4py_11tmm4py_core_16TimeDependentVec_arr, __pyx_setprop_6tmm4py_11tmm4py_core_16TimeDependentVec_arr, 0, 0},
  {0, 0, 0, 0, 0}
};
#if CYTHON_USE_TYPE_SPECS
static PyType_Slot __pyx_type_6tmm4py_11tmm4py_core_TimeDependentVec_slots[] = {
  {Py_tp_dealloc, (void *)__pyx_tp_dealloc_6tmm4py_11tmm4py_core_TimeDependentVec},
  {Py_tp_traverse, (void *)__pyx_tp_traverse_6tmm4py_11tmm4py_core_TimeDependentVec},
  {Py_tp_clear, (void *)__pyx_tp_clear_6tmm4py_11tmm4py_core_TimeDependentVec},
  {Py_tp_methods, (void *)__pyx_methods_6tmm4py_11tmm4py_core_TimeDependentVec},
  {Py_tp_getset, (void *)__pyx_getsets_6tmm4py_11tmm4py_core_TimeDependentVec},
  {Py_tp_init, (void *)__pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_3__init__},
  {Py_tp_new, (void *)__pyx_tp_new_6tmm4py_11tmm4py_core_TimeDependentVec},
  {0, 0},
};
static PyType_Spec __pyx_type_6tmm4py_11tmm4py_core_TimeDependentVec_spec = {
  "tmm4py.tmm4py_core.TimeDependentVec",
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec),
  0,
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC,
  __pyx_type_6tmm4py_11tmm4py_core_TimeDependentVec_slots,
};
#else

static PyTypeObject __pyx_type_6tmm4py_11tmm4py_core_TimeDependentVec = {
  PyVarObject_HEAD_INIT(0, 0)
  "tmm4py.tmm4py_core.""TimeDependentVec", /*tp_name*/
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentVec), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6tmm4py_11tmm4py_core_TimeDependentVec, /*tp_dealloc*/
  #if PY_VERSION_HEX < 0x030800b4
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b4
  0, /*tp_vectorcall_offset*/
  #endif
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_as_async*/
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_6tmm4py_11tmm4py_core_TimeDependentVec, /*tp_traverse*/
  __pyx_tp_clear_6tmm4py_11tmm4py_core_TimeDependentVec, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6tmm4py_11tmm4py_core_TimeDependentVec, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6tmm4py_11tmm4py_core_TimeDependentVec, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  #if !CYTHON_USE_TYPE_SPECS
  0, /*tp_dictoffset*/
  #endif
  __pyx_pw_6tmm4py_11tmm4py_core_16TimeDependentVec_3__init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6tmm4py_11tmm4py_core_TimeDependentVec, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if CYTHON_USE_TP_FINALIZE
  0, /*tp_finalize*/
  #else
  NULL, /*tp_finalize*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
  0, /*tp_vectorcall*/
  #endif
  #if __PYX_NEED_TP_PRINT_SLOT == 1
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030C0000
  0, /*tp_watched*/
  #endif
  #if PY_VERSION_HEX >= 0x030d00A4
  0, /*tp_versions_used*/
  #endif
  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
  0, /*tp_pypy_flags*/
  #endif
};
#endif

static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_PeriodicArray(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *p;
  PyObject *o;
  #if CYTHON_COMPILING_IN_LIMITED_API
  allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
  o = alloc_func(t, 0);
  #else
  if (likely(!__Pyx_PyType_HasFeature(t, Py_TPFLAGS_IS_ABSTRACT))) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_mstate_global->__pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  #endif
  p = ((struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)o);
  p->arr = Py_None; Py_INCREF(Py_None);
  if (unlikely(__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_1__cinit__(o, __pyx_mstate_global->__pyx_empty_tuple, NULL) < 0)) goto bad;
  return o;
  bad:
  Py_DECREF(o); o = 0;
  return NULL;
}

static void __pyx_tp_dealloc_6tmm4py_11tmm4py_core_PeriodicArray(PyObject *o) {
  struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)o;
  #if CYTHON_USE_TP_FINALIZE
  if (unlikely((PY_VERSION_HEX >= 0x03080000 || __Pyx_PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE)) && __Pyx_PyObject_GetSlot(o, tp_finalize, destructor)) && !__Pyx_PyObject_GC_IsFinalized(o)) {
    if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_6tmm4py_11tmm4py_core_PeriodicArray) {
      if (PyObject_CallFinalizerFromDealloc(o)) return;
    }
  }
  #endif
  PyObject_GC_UnTrack(o);
  Py_CLEAR(p->arr);
  #if CYTHON_USE_TYPE_SLOTS
  (*Py_TYPE(o)->tp_free)(o);
  #else
  {
    freefunc tp_free = (freefunc)PyType_GetSlot(Py_TYPE(o), Py_tp_free);
    if (tp_free) tp_free(o);
  }
  #endif
}

static int __pyx_tp_traverse_6tmm4py_11tmm4py_core_PeriodicArray(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)o;
  {
    e = __Pyx_call_type_traverse(o, 1, v, a);
    if (e) return e;
  }
  if (p->arr) {
    e = (*v)(p->arr, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6tmm4py_11tmm4py_core_PeriodicArray(PyObject *o) {
  PyObject* tmp;
  struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray *)o;
  tmp = ((PyObject*)p->arr);
  p->arr = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_13PeriodicArray_arr(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_13PeriodicArray_arr(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_3arr_5__del__(o);
  }
}

static PyMethodDef __pyx_methods_6tmm4py_11tmm4py_core_PeriodicArray[] = {
  {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"interp", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_7interp, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"destroy", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_9destroy, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_11__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_13__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6tmm4py_11tmm4py_core_PeriodicArray[] = {
  {"arr", __pyx_getprop_6tmm4py_11tmm4py_core_13PeriodicArray_arr, __pyx_setprop_6tmm4py_11tmm4py_core_13PeriodicArray_arr, 0, 0},
  {0, 0, 0, 0, 0}
};
#if CYTHON_USE_TYPE_SPECS
static PyType_Slot __pyx_type_6tmm4py_11tmm4py_core_PeriodicArray_slots[] = {
  {Py_tp_dealloc, (void *)__pyx_tp_dealloc_6tmm4py_11tmm4py_core_PeriodicArray},
  {Py_tp_traverse, (void *)__pyx_tp_traverse_6tmm4py_11tmm4py_core_PeriodicArray},
  {Py_tp_clear, (void *)__pyx_tp_clear_6tmm4py_11tmm4py_core_PeriodicArray},
  {Py_tp_methods, (void *)__pyx_methods_6tmm4py_11tmm4py_core_PeriodicArray},
  {Py_tp_getset, (void *)__pyx_getsets_6tmm4py_11tmm4py_core_PeriodicArray},
  {Py_tp_init, (void *)__pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_3__init__},
  {Py_tp_new, (void *)__pyx_tp_new_6tmm4py_11tmm4py_core_PeriodicArray},
  {0, 0},
};
static PyType_Spec __pyx_type_6tmm4py_11tmm4py_core_PeriodicArray_spec = {
  "tmm4py.tmm4py_core.PeriodicArray",
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray),
  0,
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC,
  __pyx_type_6tmm4py_11tmm4py_core_PeriodicArray_slots,
};
#else

static PyTypeObject __pyx_type_6tmm4py_11tmm4py_core_PeriodicArray = {
  PyVarObject_HEAD_INIT(0, 0)
  "tmm4py.tmm4py_core.""PeriodicArray", /*tp_name*/
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_PeriodicArray), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6tmm4py_11tmm4py_core_PeriodicArray, /*tp_dealloc*/
  #if PY_VERSION_HEX < 0x030800b4
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b4
  0, /*tp_vectorcall_offset*/
  #endif
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_as_async*/
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_6tmm4py_11tmm4py_core_PeriodicArray, /*tp_traverse*/
  __pyx_tp_clear_6tmm4py_11tmm4py_core_PeriodicArray, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6tmm4py_11tmm4py_core_PeriodicArray, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6tmm4py_11tmm4py_core_PeriodicArray, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  #if !CYTHON_USE_TYPE_SPECS
  0, /*tp_dictoffset*/
  #endif
  __pyx_pw_6tmm4py_11tmm4py_core_13PeriodicArray_3__init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6tmm4py_11tmm4py_core_PeriodicArray, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if CYTHON_USE_TP_FINALIZE
  0, /*tp_finalize*/
  #else
  NULL, /*tp_finalize*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
  0, /*tp_vectorcall*/
  #endif
  #if __PYX_NEED_TP_PRINT_SLOT == 1
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030C0000
  0, /*tp_watched*/
  #endif
  #if PY_VERSION_HEX >= 0x030d00A4
  0, /*tp_versions_used*/
  #endif
  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
  0, /*tp_pypy_flags*/
  #endif
};
#endif

static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core_TimeDependentArray(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *p;
  PyObject *o;
  #if CYTHON_COMPILING_IN_LIMITED_API
  allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
  o = alloc_func(t, 0);
  #else
  if (likely(!__Pyx_PyType_HasFeature(t, Py_TPFLAGS_IS_ABSTRACT))) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_mstate_global->__pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  #endif
  p = ((struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)o);
  p->arr = Py_None; Py_INCREF(Py_None);
  if (unlikely(__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_1__cinit__(o, __pyx_mstate_global->__pyx_empty_tuple, NULL) < 0)) goto bad;
  return o;
  bad:
  Py_DECREF(o); o = 0;
  return NULL;
}

static void __pyx_tp_dealloc_6tmm4py_11tmm4py_core_TimeDependentArray(PyObject *o) {
  struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)o;
  #if CYTHON_USE_TP_FINALIZE
  if (unlikely((PY_VERSION_HEX >= 0x03080000 || __Pyx_PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE)) && __Pyx_PyObject_GetSlot(o, tp_finalize, destructor)) && !__Pyx_PyObject_GC_IsFinalized(o)) {
    if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_6tmm4py_11tmm4py_core_TimeDependentArray) {
      if (PyObject_CallFinalizerFromDealloc(o)) return;
    }
  }
  #endif
  PyObject_GC_UnTrack(o);
  Py_CLEAR(p->arr);
  #if CYTHON_USE_TYPE_SLOTS
  (*Py_TYPE(o)->tp_free)(o);
  #else
  {
    freefunc tp_free = (freefunc)PyType_GetSlot(Py_TYPE(o), Py_tp_free);
    if (tp_free) tp_free(o);
  }
  #endif
}

static int __pyx_tp_traverse_6tmm4py_11tmm4py_core_TimeDependentArray(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)o;
  {
    e = __Pyx_call_type_traverse(o, 1, v, a);
    if (e) return e;
  }
  if (p->arr) {
    e = (*v)(p->arr, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6tmm4py_11tmm4py_core_TimeDependentArray(PyObject *o) {
  PyObject* tmp;
  struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *p = (struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray *)o;
  tmp = ((PyObject*)p->arr);
  p->arr = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyObject *__pyx_getprop_6tmm4py_11tmm4py_core_18TimeDependentArray_arr(PyObject *o, CYTHON_UNUSED void *x) {
  return __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_1__get__(o);
}

static int __pyx_setprop_6tmm4py_11tmm4py_core_18TimeDependentArray_arr(PyObject *o, PyObject *v, CYTHON_UNUSED void *x) {
  if (v) {
    return __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_3__set__(o, v);
  }
  else {
    return __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_3arr_5__del__(o);
  }
}

static PyMethodDef __pyx_methods_6tmm4py_11tmm4py_core_TimeDependentArray[] = {
  {"create", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_5create, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"interp", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_7interp, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"destroy", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_9destroy, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_11__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_13__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6tmm4py_11tmm4py_core_TimeDependentArray[] = {
  {"arr", __pyx_getprop_6tmm4py_11tmm4py_core_18TimeDependentArray_arr, __pyx_setprop_6tmm4py_11tmm4py_core_18TimeDependentArray_arr, 0, 0},
  {0, 0, 0, 0, 0}
};
#if CYTHON_USE_TYPE_SPECS
static PyType_Slot __pyx_type_6tmm4py_11tmm4py_core_TimeDependentArray_slots[] = {
  {Py_tp_dealloc, (void *)__pyx_tp_dealloc_6tmm4py_11tmm4py_core_TimeDependentArray},
  {Py_tp_traverse, (void *)__pyx_tp_traverse_6tmm4py_11tmm4py_core_TimeDependentArray},
  {Py_tp_clear, (void *)__pyx_tp_clear_6tmm4py_11tmm4py_core_TimeDependentArray},
  {Py_tp_methods, (void *)__pyx_methods_6tmm4py_11tmm4py_core_TimeDependentArray},
  {Py_tp_getset, (void *)__pyx_getsets_6tmm4py_11tmm4py_core_TimeDependentArray},
  {Py_tp_init, (void *)__pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_3__init__},
  {Py_tp_new, (void *)__pyx_tp_new_6tmm4py_11tmm4py_core_TimeDependentArray},
  {0, 0},
};
static PyType_Spec __pyx_type_6tmm4py_11tmm4py_core_TimeDependentArray_spec = {
  "tmm4py.tmm4py_core.TimeDependentArray",
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray),
  0,
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC,
  __pyx_type_6tmm4py_11tmm4py_core_TimeDependentArray_slots,
};
#else

static PyTypeObject __pyx_type_6tmm4py_11tmm4py_core_TimeDependentArray = {
  PyVarObject_HEAD_INIT(0, 0)
  "tmm4py.tmm4py_core.""TimeDependentArray", /*tp_name*/
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core_TimeDependentArray), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6tmm4py_11tmm4py_core_TimeDependentArray, /*tp_dealloc*/
  #if PY_VERSION_HEX < 0x030800b4
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b4
  0, /*tp_vectorcall_offset*/
  #endif
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_as_async*/
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_6tmm4py_11tmm4py_core_TimeDependentArray, /*tp_traverse*/
  __pyx_tp_clear_6tmm4py_11tmm4py_core_TimeDependentArray, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6tmm4py_11tmm4py_core_TimeDependentArray, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6tmm4py_11tmm4py_core_TimeDependentArray, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  #if !CYTHON_USE_TYPE_SPECS
  0, /*tp_dictoffset*/
  #endif
  __pyx_pw_6tmm4py_11tmm4py_core_18TimeDependentArray_3__init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6tmm4py_11tmm4py_core_TimeDependentArray, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if CYTHON_USE_TP_FINALIZE
  0, /*tp_finalize*/
  #else
  NULL, /*tp_finalize*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
  0, /*tp_vectorcall*/
  #endif
  #if __PYX_NEED_TP_PRINT_SLOT == 1
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030C0000
  0, /*tp_watched*/
  #endif
  #if PY_VERSION_HEX >= 0x030d00A4
  0, /*tp_versions_used*/
  #endif
  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
  0, /*tp_pypy_flags*/
  #endif
};
#endif
static struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__RealArrayWrapper __pyx_vtable_6tmm4py_11tmm4py_core__RealArrayWrapper;

static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core__RealArrayWrapper(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *p;
  PyObject *o;
  #if CYTHON_COMPILING_IN_LIMITED_API
  allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
  o = alloc_func(t, 0);
  #else
  if (likely(!__Pyx_PyType_HasFeature(t, Py_TPFLAGS_IS_ABSTRACT))) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_mstate_global->__pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  #endif
  p = ((struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *)o);
  p->__pyx_vtab = __pyx_vtabptr_6tmm4py_11tmm4py_core__RealArrayWrapper;
  p->myId = ((PyObject*)Py_None); Py_INCREF(Py_None);
  return o;
}

static void __pyx_tp_dealloc_6tmm4py_11tmm4py_core__RealArrayWrapper(PyObject *o) {
  struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *p = (struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *)o;
  #if CYTHON_USE_TP_FINALIZE
  if (unlikely((PY_VERSION_HEX >= 0x03080000 || __Pyx_PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE)) && __Pyx_PyObject_GetSlot(o, tp_finalize, destructor)) && (!PyType_IS_GC(Py_TYPE(o)) || !__Pyx_PyObject_GC_IsFinalized(o))) {
    if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_6tmm4py_11tmm4py_core__RealArrayWrapper) {
      if (PyObject_CallFinalizerFromDealloc(o)) return;
    }
  }
  #endif
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    __Pyx_SET_REFCNT(o, Py_REFCNT(o) + 1);
    __pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_3__dealloc__(o);
    __Pyx_SET_REFCNT(o, Py_REFCNT(o) - 1);
    PyErr_Restore(etype, eval, etb);
  }
  Py_CLEAR(p->myId);
  #if CYTHON_USE_TYPE_SLOTS
  (*Py_TYPE(o)->tp_free)(o);
  #else
  {
    freefunc tp_free = (freefunc)PyType_GetSlot(Py_TYPE(o), Py_tp_free);
    if (tp_free) tp_free(o);
  }
  #endif
}

static PyMethodDef __pyx_methods_6tmm4py_11tmm4py_core__RealArrayWrapper[] = {
  {"__array__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_1__array__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_5__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_17_RealArrayWrapper_7__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};
#if CYTHON_USE_TYPE_SPECS
static PyType_Slot __pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapper_slots[] = {
  {Py_tp_dealloc, (void *)__pyx_tp_dealloc_6tmm4py_11tmm4py_core__RealArrayWrapper},
  {Py_tp_methods, (void *)__pyx_methods_6tmm4py_11tmm4py_core__RealArrayWrapper},
  {Py_tp_new, (void *)__pyx_tp_new_6tmm4py_11tmm4py_core__RealArrayWrapper},
  {0, 0},
};
static PyType_Spec __pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapper_spec = {
  "tmm4py.tmm4py_core._RealArrayWrapper",
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper),
  0,
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE,
  __pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapper_slots,
};
#else

static PyTypeObject __pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapper = {
  PyVarObject_HEAD_INIT(0, 0)
  "tmm4py.tmm4py_core.""_RealArrayWrapper", /*tp_name*/
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6tmm4py_11tmm4py_core__RealArrayWrapper, /*tp_dealloc*/
  #if PY_VERSION_HEX < 0x030800b4
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b4
  0, /*tp_vectorcall_offset*/
  #endif
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_as_async*/
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6tmm4py_11tmm4py_core__RealArrayWrapper, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  #if !CYTHON_USE_TYPE_SPECS
  0, /*tp_dictoffset*/
  #endif
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6tmm4py_11tmm4py_core__RealArrayWrapper, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if CYTHON_USE_TP_FINALIZE
  0, /*tp_finalize*/
  #else
  NULL, /*tp_finalize*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
  0, /*tp_vectorcall*/
  #endif
  #if __PYX_NEED_TP_PRINT_SLOT == 1
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030C0000
  0, /*tp_watched*/
  #endif
  #if PY_VERSION_HEX >= 0x030d00A4
  0, /*tp_versions_used*/
  #endif
  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
  0, /*tp_pypy_flags*/
  #endif
};
#endif
static struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel __pyx_vtable_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel;

static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *p;
  PyObject *o;
  #if CYTHON_COMPILING_IN_LIMITED_API
  allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
  o = alloc_func(t, 0);
  #else
  if (likely(!__Pyx_PyType_HasFeature(t, Py_TPFLAGS_IS_ABSTRACT))) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_mstate_global->__pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  #endif
  p = ((struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *)o);
  p->__pyx_vtab = __pyx_vtabptr_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel;
  p->myId = ((PyObject*)Py_None); Py_INCREF(Py_None);
  return o;
}

static void __pyx_tp_dealloc_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel(PyObject *o) {
  struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *p = (struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *)o;
  #if CYTHON_USE_TP_FINALIZE
  if (unlikely((PY_VERSION_HEX >= 0x03080000 || __Pyx_PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE)) && __Pyx_PyObject_GetSlot(o, tp_finalize, destructor)) && (!PyType_IS_GC(Py_TYPE(o)) || !__Pyx_PyObject_GC_IsFinalized(o))) {
    if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel) {
      if (PyObject_CallFinalizerFromDealloc(o)) return;
    }
  }
  #endif
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    __Pyx_SET_REFCNT(o, Py_REFCNT(o) + 1);
    __pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_3__dealloc__(o);
    __Pyx_SET_REFCNT(o, Py_REFCNT(o) - 1);
    PyErr_Restore(etype, eval, etb);
  }
  Py_CLEAR(p->myId);
  #if CYTHON_USE_TYPE_SLOTS
  (*Py_TYPE(o)->tp_free)(o);
  #else
  {
    freefunc tp_free = (freefunc)PyType_GetSlot(Py_TYPE(o), Py_tp_free);
    if (tp_free) tp_free(o);
  }
  #endif
}

static PyMethodDef __pyx_methods_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel[] = {
  {"__array__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_1__array__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_5__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_7__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};
#if CYTHON_USE_TYPE_SPECS
static PyType_Slot __pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel_slots[] = {
  {Py_tp_dealloc, (void *)__pyx_tp_dealloc_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel},
  {Py_tp_methods, (void *)__pyx_methods_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel},
  {Py_tp_new, (void *)__pyx_tp_new_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel},
  {0, 0},
};
static PyType_Spec __pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel_spec = {
  "tmm4py.tmm4py_core._RealArrayWrapperWithDel",
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel),
  0,
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE,
  __pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel_slots,
};
#else

static PyTypeObject __pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel = {
  PyVarObject_HEAD_INIT(0, 0)
  "tmm4py.tmm4py_core.""_RealArrayWrapperWithDel", /*tp_name*/
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel, /*tp_dealloc*/
  #if PY_VERSION_HEX < 0x030800b4
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b4
  0, /*tp_vectorcall_offset*/
  #endif
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_as_async*/
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  #if !CYTHON_USE_TYPE_SPECS
  0, /*tp_dictoffset*/
  #endif
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if CYTHON_USE_TP_FINALIZE
  0, /*tp_finalize*/
  #else
  NULL, /*tp_finalize*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
  0, /*tp_vectorcall*/
  #endif
  #if __PYX_NEED_TP_PRINT_SLOT == 1
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030C0000
  0, /*tp_watched*/
  #endif
  #if PY_VERSION_HEX >= 0x030d00A4
  0, /*tp_versions_used*/
  #endif
  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
  0, /*tp_pypy_flags*/
  #endif
};
#endif
static struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__IntArrayWrapper __pyx_vtable_6tmm4py_11tmm4py_core__IntArrayWrapper;

static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core__IntArrayWrapper(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *p;
  PyObject *o;
  #if CYTHON_COMPILING_IN_LIMITED_API
  allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
  o = alloc_func(t, 0);
  #else
  if (likely(!__Pyx_PyType_HasFeature(t, Py_TPFLAGS_IS_ABSTRACT))) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_mstate_global->__pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  #endif
  p = ((struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *)o);
  p->__pyx_vtab = __pyx_vtabptr_6tmm4py_11tmm4py_core__IntArrayWrapper;
  return o;
}

static void __pyx_tp_dealloc_6tmm4py_11tmm4py_core__IntArrayWrapper(PyObject *o) {
  #if CYTHON_USE_TP_FINALIZE
  if (unlikely((PY_VERSION_HEX >= 0x03080000 || __Pyx_PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE)) && __Pyx_PyObject_GetSlot(o, tp_finalize, destructor)) && (!PyType_IS_GC(Py_TYPE(o)) || !__Pyx_PyObject_GC_IsFinalized(o))) {
    if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_6tmm4py_11tmm4py_core__IntArrayWrapper) {
      if (PyObject_CallFinalizerFromDealloc(o)) return;
    }
  }
  #endif
  #if CYTHON_USE_TYPE_SLOTS
  (*Py_TYPE(o)->tp_free)(o);
  #else
  {
    freefunc tp_free = (freefunc)PyType_GetSlot(Py_TYPE(o), Py_tp_free);
    if (tp_free) tp_free(o);
  }
  #endif
}

static PyMethodDef __pyx_methods_6tmm4py_11tmm4py_core__IntArrayWrapper[] = {
  {"__array__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16_IntArrayWrapper_1__array__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16_IntArrayWrapper_3__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_16_IntArrayWrapper_5__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};
#if CYTHON_USE_TYPE_SPECS
static PyType_Slot __pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapper_slots[] = {
  {Py_tp_dealloc, (void *)__pyx_tp_dealloc_6tmm4py_11tmm4py_core__IntArrayWrapper},
  {Py_tp_methods, (void *)__pyx_methods_6tmm4py_11tmm4py_core__IntArrayWrapper},
  {Py_tp_new, (void *)__pyx_tp_new_6tmm4py_11tmm4py_core__IntArrayWrapper},
  {0, 0},
};
static PyType_Spec __pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapper_spec = {
  "tmm4py.tmm4py_core._IntArrayWrapper",
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper),
  0,
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE,
  __pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapper_slots,
};
#else

static PyTypeObject __pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapper = {
  PyVarObject_HEAD_INIT(0, 0)
  "tmm4py.tmm4py_core.""_IntArrayWrapper", /*tp_name*/
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6tmm4py_11tmm4py_core__IntArrayWrapper, /*tp_dealloc*/
  #if PY_VERSION_HEX < 0x030800b4
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b4
  0, /*tp_vectorcall_offset*/
  #endif
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_as_async*/
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6tmm4py_11tmm4py_core__IntArrayWrapper, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  #if !CYTHON_USE_TYPE_SPECS
  0, /*tp_dictoffset*/
  #endif
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6tmm4py_11tmm4py_core__IntArrayWrapper, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if CYTHON_USE_TP_FINALIZE
  0, /*tp_finalize*/
  #else
  NULL, /*tp_finalize*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
  0, /*tp_vectorcall*/
  #endif
  #if __PYX_NEED_TP_PRINT_SLOT == 1
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030C0000
  0, /*tp_watched*/
  #endif
  #if PY_VERSION_HEX >= 0x030d00A4
  0, /*tp_versions_used*/
  #endif
  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
  0, /*tp_pypy_flags*/
  #endif
};
#endif
static struct __pyx_vtabstruct_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel __pyx_vtable_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel;

static PyObject *__pyx_tp_new_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *p;
  PyObject *o;
  #if CYTHON_COMPILING_IN_LIMITED_API
  allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
  o = alloc_func(t, 0);
  #else
  if (likely(!__Pyx_PyType_HasFeature(t, Py_TPFLAGS_IS_ABSTRACT))) {
    o = (*t->tp_alloc)(t, 0);
  } else {
    o = (PyObject *) PyBaseObject_Type.tp_new(t, __pyx_mstate_global->__pyx_empty_tuple, 0);
  }
  if (unlikely(!o)) return 0;
  #endif
  p = ((struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *)o);
  p->__pyx_vtab = __pyx_vtabptr_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel;
  return o;
}

static void __pyx_tp_dealloc_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel(PyObject *o) {
  #if CYTHON_USE_TP_FINALIZE
  if (unlikely((PY_VERSION_HEX >= 0x03080000 || __Pyx_PyType_HasFeature(Py_TYPE(o), Py_TPFLAGS_HAVE_FINALIZE)) && __Pyx_PyObject_GetSlot(o, tp_finalize, destructor)) && (!PyType_IS_GC(Py_TYPE(o)) || !__Pyx_PyObject_GC_IsFinalized(o))) {
    if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel) {
      if (PyObject_CallFinalizerFromDealloc(o)) return;
    }
  }
  #endif
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    __Pyx_SET_REFCNT(o, Py_REFCNT(o) + 1);
    __pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_3__dealloc__(o);
    __Pyx_SET_REFCNT(o, Py_REFCNT(o) - 1);
    PyErr_Restore(etype, eval, etb);
  }
  #if CYTHON_USE_TYPE_SLOTS
  (*Py_TYPE(o)->tp_free)(o);
  #else
  {
    freefunc tp_free = (freefunc)PyType_GetSlot(Py_TYPE(o), Py_tp_free);
    if (tp_free) tp_free(o);
  }
  #endif
}

static PyMethodDef __pyx_methods_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel[] = {
  {"__array__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_1__array__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__reduce_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_5__reduce_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {"__setstate_cython__", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_7__setstate_cython__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};
#if CYTHON_USE_TYPE_SPECS
static PyType_Slot __pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel_slots[] = {
  {Py_tp_dealloc, (void *)__pyx_tp_dealloc_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel},
  {Py_tp_methods, (void *)__pyx_methods_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel},
  {Py_tp_new, (void *)__pyx_tp_new_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel},
  {0, 0},
};
static PyType_Spec __pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel_spec = {
  "tmm4py.tmm4py_core._IntArrayWrapperWithDel",
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel),
  0,
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE,
  __pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel_slots,
};
#else

static PyTypeObject __pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel = {
  PyVarObject_HEAD_INIT(0, 0)
  "tmm4py.tmm4py_core.""_IntArrayWrapperWithDel", /*tp_name*/
  sizeof(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel, /*tp_dealloc*/
  #if PY_VERSION_HEX < 0x030800b4
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b4
  0, /*tp_vectorcall_offset*/
  #endif
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_as_async*/
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  #if !CYTHON_USE_TYPE_SPECS
  0, /*tp_dictoffset*/
  #endif
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if CYTHON_USE_TP_FINALIZE
  0, /*tp_finalize*/
  #else
  NULL, /*tp_finalize*/
  #endif
  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
  0, /*tp_vectorcall*/
  #endif
  #if __PYX_NEED_TP_PRINT_SLOT == 1
  0, /*tp_print*/
  #endif
  #if PY_VERSION_HEX >= 0x030C0000
  0, /*tp_watched*/
  #endif
  #if PY_VERSION_HEX >= 0x030d00A4
  0, /*tp_versions_used*/
  #endif
  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
  0, /*tp_pypy_flags*/
  #endif
};
#endif

static PyMethodDef __pyx_methods[] = {
  {0, 0, 0, 0}
};
/* #### Code section: initfunc_declarations ### */
static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(__pyx_mstatetype *__pyx_mstate); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(__pyx_mstatetype *__pyx_mstate); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_InitGlobals(void); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_InitConstants(__pyx_mstatetype *__pyx_mstate); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_modinit_global_init_code(__pyx_mstatetype *__pyx_mstate); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_modinit_variable_export_code(__pyx_mstatetype *__pyx_mstate); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_modinit_function_export_code(__pyx_mstatetype *__pyx_mstate); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_modinit_type_init_code(__pyx_mstatetype *__pyx_mstate); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_modinit_type_import_code(__pyx_mstatetype *__pyx_mstate); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_modinit_variable_import_code(__pyx_mstatetype *__pyx_mstate); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_modinit_function_import_code(__pyx_mstatetype *__pyx_mstate); /*proto*/
static CYTHON_SMALL_CODE int __Pyx_CreateCodeObjects(__pyx_mstatetype *__pyx_mstate); /*proto*/
/* #### Code section: init_module ### */

static int __Pyx_modinit_global_init_code(__pyx_mstatetype *__pyx_mstate) {
  __Pyx_RefNannyDeclarations
  CYTHON_UNUSED_VAR(__pyx_mstate);
  __Pyx_RefNannySetupContext("__Pyx_modinit_global_init_code", 0);
  /*--- Global init code ---*/
  __Pyx_RefNannyFinishContext();
  return 0;
}

static int __Pyx_modinit_variable_export_code(__pyx_mstatetype *__pyx_mstate) {
  __Pyx_RefNannyDeclarations
  CYTHON_UNUSED_VAR(__pyx_mstate);
  __Pyx_RefNannySetupContext("__Pyx_modinit_variable_export_code", 0);
  /*--- Variable export code ---*/
  __Pyx_RefNannyFinishContext();
  return 0;
}

static int __Pyx_modinit_function_export_code(__pyx_mstatetype *__pyx_mstate) {
  __Pyx_RefNannyDeclarations
  CYTHON_UNUSED_VAR(__pyx_mstate);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__Pyx_modinit_function_export_code", 0);
  /*--- Function export code ---*/
  if (__Pyx_ExportFunction("getNumpyRealArrayFromPointer", (void (*)(void))__pyx_f_6tmm4py_11tmm4py_core_getNumpyRealArrayFromPointer, "PyObject *(PetscScalar *, PetscInt)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  if (__Pyx_ExportFunction("getNumpyIntArrayFromPointer", (void (*)(void))__pyx_f_6tmm4py_11tmm4py_core_getNumpyIntArrayFromPointer, "PyObject *(PetscInt *, PetscInt)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  if (__Pyx_ExportFunction("copyNumpyRealArrayFromPointer", (void (*)(void))__pyx_f_6tmm4py_11tmm4py_core_copyNumpyRealArrayFromPointer, "PyObject *(PetscScalar *, PetscInt)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  if (__Pyx_ExportFunction("copyNumpyIntArrayFromPointer", (void (*)(void))__pyx_f_6tmm4py_11tmm4py_core_copyNumpyIntArrayFromPointer, "PyObject *(PetscInt *, PetscInt)") < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  __Pyx_RefNannyFinishContext();
  return 0;
  __pyx_L1_error:;
  __Pyx_RefNannyFinishContext();
  return -1;
}

static int __Pyx_modinit_type_init_code(__pyx_mstatetype *__pyx_mstate) {
  __Pyx_RefNannyDeclarations
  CYTHON_UNUSED_VAR(__pyx_mstate);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
  /*--- Type init code ---*/
  #if CYTHON_USE_TYPE_SPECS
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_6tmm4py_11tmm4py_core_TMMState_spec, NULL); if (unlikely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState)) __PYX_ERR(0, 352, __pyx_L1_error)
  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_6tmm4py_11tmm4py_core_TMMState_spec, __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState) < 0) __PYX_ERR(0, 352, __pyx_L1_error)
  #else
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState = &__pyx_type_6tmm4py_11tmm4py_core_TMMState;
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  #endif
  #if !CYTHON_USE_TYPE_SPECS
  if (__Pyx_PyType_Ready(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState) < 0) __PYX_ERR(0, 352, __pyx_L1_error)
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState->tp_dictoffset && __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState->tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState->tp_getattro = PyObject_GenericGetAttr;
  }
  #endif
  if (PyObject_SetAttr(__pyx_m, __pyx_mstate_global->__pyx_n_u_TMMState, (PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState) < 0) __PYX_ERR(0, 352, __pyx_L1_error)
  if (__Pyx_setup_reduce((PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState) < 0) __PYX_ERR(0, 352, __pyx_L1_error)
  #if CYTHON_USE_TYPE_SPECS
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_6tmm4py_11tmm4py_core_StepTimer_spec, NULL); if (unlikely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer)) __PYX_ERR(0, 976, __pyx_L1_error)
  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_6tmm4py_11tmm4py_core_StepTimer_spec, __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer) < 0) __PYX_ERR(0, 976, __pyx_L1_error)
  #else
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer = &__pyx_type_6tmm4py_11tmm4py_core_StepTimer;
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  #endif
  #if !CYTHON_USE_TYPE_SPECS
  if (__Pyx_PyType_Ready(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer) < 0) __PYX_ERR(0, 976, __pyx_L1_error)
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer->tp_dictoffset && __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer->tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer->tp_getattro = PyObject_GenericGetAttr;
  }
  #endif
  if (PyObject_SetAttr(__pyx_m, __pyx_mstate_global->__pyx_n_u_StepTimer, (PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer) < 0) __PYX_ERR(0, 976, __pyx_L1_error)
  if (__Pyx_setup_reduce((PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer) < 0) __PYX_ERR(0, 976, __pyx_L1_error)
  #if CYTHON_USE_TYPE_SPECS
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_6tmm4py_11tmm4py_core_PeriodicTimer_spec, NULL); if (unlikely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer)) __PYX_ERR(0, 1018, __pyx_L1_error)
  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_6tmm4py_11tmm4py_core_PeriodicTimer_spec, __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer) < 0) __PYX_ERR(0, 1018, __pyx_L1_error)
  #else
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer = &__pyx_type_6tmm4py_11tmm4py_core_PeriodicTimer;
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  #endif
  #if !CYTHON_USE_TYPE_SPECS
  if (__Pyx_PyType_Ready(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer) < 0) __PYX_ERR(0, 1018, __pyx_L1_error)
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer->tp_dictoffset && __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer->tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer->tp_getattro = PyObject_GenericGetAttr;
  }
  #endif
  if (PyObject_SetAttr(__pyx_m, __pyx_mstate_global->__pyx_n_u_PeriodicTimer, (PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer) < 0) __PYX_ERR(0, 1018, __pyx_L1_error)
  if (__Pyx_setup_reduce((PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer) < 0) __PYX_ERR(0, 1018, __pyx_L1_error)
  #if CYTHON_USE_TYPE_SPECS
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_6tmm4py_11tmm4py_core_TimeDependentTimer_spec, NULL); if (unlikely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer)) __PYX_ERR(0, 1072, __pyx_L1_error)
  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_6tmm4py_11tmm4py_core_TimeDependentTimer_spec, __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer) < 0) __PYX_ERR(0, 1072, __pyx_L1_error)
  #else
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer = &__pyx_type_6tmm4py_11tmm4py_core_TimeDependentTimer;
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  #endif
  #if !CYTHON_USE_TYPE_SPECS
  if (__Pyx_PyType_Ready(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer) < 0) __PYX_ERR(0, 1072, __pyx_L1_error)
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer->tp_dictoffset && __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer->tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer->tp_getattro = PyObject_GenericGetAttr;
  }
  #endif
  if (PyObject_SetAttr(__pyx_m, __pyx_mstate_global->__pyx_n_u_TimeDependentTimer, (PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer) < 0) __PYX_ERR(0, 1072, __pyx_L1_error)
  if (__Pyx_setup_reduce((PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer) < 0) __PYX_ERR(0, 1072, __pyx_L1_error)
  #if CYTHON_USE_TYPE_SPECS
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_6tmm4py_11tmm4py_core_PeriodicVec_spec, NULL); if (unlikely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec)) __PYX_ERR(0, 1122, __pyx_L1_error)
  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_6tmm4py_11tmm4py_core_PeriodicVec_spec, __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
  #else
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec = &__pyx_type_6tmm4py_11tmm4py_core_PeriodicVec;
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  #endif
  #if !CYTHON_USE_TYPE_SPECS
  if (__Pyx_PyType_Ready(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec->tp_dictoffset && __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec->tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec->tp_getattro = PyObject_GenericGetAttr;
  }
  #endif
  if (PyObject_SetAttr(__pyx_m, __pyx_mstate_global->__pyx_n_u_PeriodicVec, (PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
  if (__Pyx_setup_reduce((PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
  #if CYTHON_USE_TYPE_SPECS
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_6tmm4py_11tmm4py_core_TimeDependentVec_spec, NULL); if (unlikely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec)) __PYX_ERR(0, 1182, __pyx_L1_error)
  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_6tmm4py_11tmm4py_core_TimeDependentVec_spec, __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec) < 0) __PYX_ERR(0, 1182, __pyx_L1_error)
  #else
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec = &__pyx_type_6tmm4py_11tmm4py_core_TimeDependentVec;
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  #endif
  #if !CYTHON_USE_TYPE_SPECS
  if (__Pyx_PyType_Ready(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec) < 0) __PYX_ERR(0, 1182, __pyx_L1_error)
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec->tp_dictoffset && __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec->tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec->tp_getattro = PyObject_GenericGetAttr;
  }
  #endif
  if (PyObject_SetAttr(__pyx_m, __pyx_mstate_global->__pyx_n_u_TimeDependentVec, (PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec) < 0) __PYX_ERR(0, 1182, __pyx_L1_error)
  if (__Pyx_setup_reduce((PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec) < 0) __PYX_ERR(0, 1182, __pyx_L1_error)
  #if CYTHON_USE_TYPE_SPECS
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_6tmm4py_11tmm4py_core_PeriodicArray_spec, NULL); if (unlikely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray)) __PYX_ERR(0, 1242, __pyx_L1_error)
  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_6tmm4py_11tmm4py_core_PeriodicArray_spec, __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray) < 0) __PYX_ERR(0, 1242, __pyx_L1_error)
  #else
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray = &__pyx_type_6tmm4py_11tmm4py_core_PeriodicArray;
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  #endif
  #if !CYTHON_USE_TYPE_SPECS
  if (__Pyx_PyType_Ready(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray) < 0) __PYX_ERR(0, 1242, __pyx_L1_error)
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray->tp_dictoffset && __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray->tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray->tp_getattro = PyObject_GenericGetAttr;
  }
  #endif
  if (PyObject_SetAttr(__pyx_m, __pyx_mstate_global->__pyx_n_u_PeriodicArray, (PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray) < 0) __PYX_ERR(0, 1242, __pyx_L1_error)
  if (__Pyx_setup_reduce((PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray) < 0) __PYX_ERR(0, 1242, __pyx_L1_error)
  #if CYTHON_USE_TYPE_SPECS
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_6tmm4py_11tmm4py_core_TimeDependentArray_spec, NULL); if (unlikely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray)) __PYX_ERR(0, 1291, __pyx_L1_error)
  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_6tmm4py_11tmm4py_core_TimeDependentArray_spec, __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray) < 0) __PYX_ERR(0, 1291, __pyx_L1_error)
  #else
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray = &__pyx_type_6tmm4py_11tmm4py_core_TimeDependentArray;
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  #endif
  #if !CYTHON_USE_TYPE_SPECS
  if (__Pyx_PyType_Ready(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray) < 0) __PYX_ERR(0, 1291, __pyx_L1_error)
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray->tp_dictoffset && __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray->tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray->tp_getattro = PyObject_GenericGetAttr;
  }
  #endif
  if (PyObject_SetAttr(__pyx_m, __pyx_mstate_global->__pyx_n_u_TimeDependentArray, (PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray) < 0) __PYX_ERR(0, 1291, __pyx_L1_error)
  if (__Pyx_setup_reduce((PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray) < 0) __PYX_ERR(0, 1291, __pyx_L1_error)
  __pyx_vtabptr_6tmm4py_11tmm4py_core__RealArrayWrapper = &__pyx_vtable_6tmm4py_11tmm4py_core__RealArrayWrapper;
  __pyx_vtable_6tmm4py_11tmm4py_core__RealArrayWrapper.set_data = (PyObject *(*)(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapper *, PetscInt, PetscScalar *, Vec, PyObject *))__pyx_f_6tmm4py_11tmm4py_core_17_RealArrayWrapper_set_data;
  #if CYTHON_USE_TYPE_SPECS
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapper_spec, NULL); if (unlikely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper)) __PYX_ERR(0, 1554, __pyx_L1_error)
  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapper_spec, __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper) < 0) __PYX_ERR(0, 1554, __pyx_L1_error)
  #else
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper = &__pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapper;
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  #endif
  #if !CYTHON_USE_TYPE_SPECS
  if (__Pyx_PyType_Ready(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper) < 0) __PYX_ERR(0, 1554, __pyx_L1_error)
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper->tp_dictoffset && __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper->tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper->tp_getattro = PyObject_GenericGetAttr;
  }
  #endif
  if (__Pyx_SetVtable(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper, __pyx_vtabptr_6tmm4py_11tmm4py_core__RealArrayWrapper) < 0) __PYX_ERR(0, 1554, __pyx_L1_error)
  if (__Pyx_MergeVtables(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper) < 0) __PYX_ERR(0, 1554, __pyx_L1_error)
  if (PyObject_SetAttr(__pyx_m, __pyx_mstate_global->__pyx_n_u_RealArrayWrapper, (PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper) < 0) __PYX_ERR(0, 1554, __pyx_L1_error)
  if (__Pyx_setup_reduce((PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper) < 0) __PYX_ERR(0, 1554, __pyx_L1_error)
  __pyx_vtabptr_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel = &__pyx_vtable_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel;
  __pyx_vtable_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel.set_data = (PyObject *(*)(struct __pyx_obj_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel *, PetscInt, PetscScalar *, Vec, PyObject *))__pyx_f_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_set_data;
  #if CYTHON_USE_TYPE_SPECS
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel_spec, NULL); if (unlikely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel)) __PYX_ERR(0, 1593, __pyx_L1_error)
  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel_spec, __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel) < 0) __PYX_ERR(0, 1593, __pyx_L1_error)
  #else
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel = &__pyx_type_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel;
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  #endif
  #if !CYTHON_USE_TYPE_SPECS
  if (__Pyx_PyType_Ready(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel) < 0) __PYX_ERR(0, 1593, __pyx_L1_error)
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel->tp_dictoffset && __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel->tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel->tp_getattro = PyObject_GenericGetAttr;
  }
  #endif
  if (__Pyx_SetVtable(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel, __pyx_vtabptr_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel) < 0) __PYX_ERR(0, 1593, __pyx_L1_error)
  if (__Pyx_MergeVtables(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel) < 0) __PYX_ERR(0, 1593, __pyx_L1_error)
  if (PyObject_SetAttr(__pyx_m, __pyx_mstate_global->__pyx_n_u_RealArrayWrapperWithDel, (PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel) < 0) __PYX_ERR(0, 1593, __pyx_L1_error)
  if (__Pyx_setup_reduce((PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel) < 0) __PYX_ERR(0, 1593, __pyx_L1_error)
  __pyx_vtabptr_6tmm4py_11tmm4py_core__IntArrayWrapper = &__pyx_vtable_6tmm4py_11tmm4py_core__IntArrayWrapper;
  __pyx_vtable_6tmm4py_11tmm4py_core__IntArrayWrapper.set_data = (PyObject *(*)(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapper *, int, PetscInt *))__pyx_f_6tmm4py_11tmm4py_core_16_IntArrayWrapper_set_data;
  #if CYTHON_USE_TYPE_SPECS
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapper_spec, NULL); if (unlikely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper)) __PYX_ERR(0, 1617, __pyx_L1_error)
  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapper_spec, __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper) < 0) __PYX_ERR(0, 1617, __pyx_L1_error)
  #else
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper = &__pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapper;
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  #endif
  #if !CYTHON_USE_TYPE_SPECS
  if (__Pyx_PyType_Ready(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper) < 0) __PYX_ERR(0, 1617, __pyx_L1_error)
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper->tp_dictoffset && __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper->tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper->tp_getattro = PyObject_GenericGetAttr;
  }
  #endif
  if (__Pyx_SetVtable(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper, __pyx_vtabptr_6tmm4py_11tmm4py_core__IntArrayWrapper) < 0) __PYX_ERR(0, 1617, __pyx_L1_error)
  if (__Pyx_MergeVtables(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper) < 0) __PYX_ERR(0, 1617, __pyx_L1_error)
  if (PyObject_SetAttr(__pyx_m, __pyx_mstate_global->__pyx_n_u_IntArrayWrapper, (PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper) < 0) __PYX_ERR(0, 1617, __pyx_L1_error)
  if (__Pyx_setup_reduce((PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper) < 0) __PYX_ERR(0, 1617, __pyx_L1_error)
  __pyx_vtabptr_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel = &__pyx_vtable_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel;
  __pyx_vtable_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel.set_data = (PyObject *(*)(struct __pyx_obj_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel *, int, PetscInt *))__pyx_f_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_set_data;
  #if CYTHON_USE_TYPE_SPECS
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel_spec, NULL); if (unlikely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel)) __PYX_ERR(0, 1631, __pyx_L1_error)
  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel_spec, __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel) < 0) __PYX_ERR(0, 1631, __pyx_L1_error)
  #else
  __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel = &__pyx_type_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel;
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  #endif
  #if !CYTHON_USE_TYPE_SPECS
  if (__Pyx_PyType_Ready(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel) < 0) __PYX_ERR(0, 1631, __pyx_L1_error)
  #endif
  #if !CYTHON_COMPILING_IN_LIMITED_API
  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel->tp_dictoffset && __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel->tp_getattro == PyObject_GenericGetAttr)) {
    __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel->tp_getattro = PyObject_GenericGetAttr;
  }
  #endif
  if (__Pyx_SetVtable(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel, __pyx_vtabptr_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel) < 0) __PYX_ERR(0, 1631, __pyx_L1_error)
  if (__Pyx_MergeVtables(__pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel) < 0) __PYX_ERR(0, 1631, __pyx_L1_error)
  if (PyObject_SetAttr(__pyx_m, __pyx_mstate_global->__pyx_n_u_IntArrayWrapperWithDel, (PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel) < 0) __PYX_ERR(0, 1631, __pyx_L1_error)
  if (__Pyx_setup_reduce((PyObject *) __pyx_mstate->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel) < 0) __PYX_ERR(0, 1631, __pyx_L1_error)
  __Pyx_RefNannyFinishContext();
  return 0;
  __pyx_L1_error:;
  __Pyx_RefNannyFinishContext();
  return -1;
}

static int __Pyx_modinit_type_import_code(__pyx_mstatetype *__pyx_mstate) {
  __Pyx_RefNannyDeclarations
  CYTHON_UNUSED_VAR(__pyx_mstate);
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
  /*--- Type import code ---*/
  __pyx_t_1 = PyImport_ImportModule("petsc4py.PETSc"); if (unlikely(!__pyx_t_1)) __PYX_ERR(5, 115, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Comm = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "Comm",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscCommObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscCommObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscCommObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscCommObject),
  #else
  sizeof(struct PyPetscCommObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscCommObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Comm) __PYX_ERR(5, 115, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Object = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "Object",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscObjectObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscObjectObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscObjectObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscObjectObject),
  #else
  sizeof(struct PyPetscObjectObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscObjectObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Object) __PYX_ERR(5, 123, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_Object = (struct __pyx_vtabstruct_8petsc4py_5PETSc_Object*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Object); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_Object)) __PYX_ERR(5, 123, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Viewer = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "Viewer",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscViewerObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscViewerObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscViewerObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscViewerObject),
  #else
  sizeof(struct PyPetscViewerObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscViewerObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Viewer) __PYX_ERR(5, 135, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_Viewer = (struct __pyx_vtabstruct_8petsc4py_5PETSc_Viewer*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Viewer); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_Viewer)) __PYX_ERR(5, 135, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Random = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "Random",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscRandomObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscRandomObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscRandomObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscRandomObject),
  #else
  sizeof(struct PyPetscRandomObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscRandomObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Random) __PYX_ERR(5, 141, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_Random = (struct __pyx_vtabstruct_8petsc4py_5PETSc_Random*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Random); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_Random)) __PYX_ERR(5, 141, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Device = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "Device",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscDeviceObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDeviceObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscDeviceObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDeviceObject),
  #else
  sizeof(struct PyPetscDeviceObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDeviceObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Device) __PYX_ERR(5, 147, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DeviceContext = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "DeviceContext",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscDeviceContextObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDeviceContextObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscDeviceContextObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDeviceContextObject),
  #else
  sizeof(struct PyPetscDeviceContextObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDeviceContextObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DeviceContext) __PYX_ERR(5, 154, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_DeviceContext = (struct __pyx_vtabstruct_8petsc4py_5PETSc_DeviceContext*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DeviceContext); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_DeviceContext)) __PYX_ERR(5, 154, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_IS = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "IS",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscISObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscISObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscISObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscISObject),
  #else
  sizeof(struct PyPetscISObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscISObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_IS) __PYX_ERR(5, 160, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_IS = (struct __pyx_vtabstruct_8petsc4py_5PETSc_IS*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_IS); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_IS)) __PYX_ERR(5, 160, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_LGMap = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "LGMap",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscLGMapObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscLGMapObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscLGMapObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscLGMapObject),
  #else
  sizeof(struct PyPetscLGMapObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscLGMapObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_LGMap) __PYX_ERR(5, 166, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_LGMap = (struct __pyx_vtabstruct_8petsc4py_5PETSc_LGMap*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_LGMap); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_LGMap)) __PYX_ERR(5, 166, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_SF = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "SF",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscSFObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSFObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscSFObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSFObject),
  #else
  sizeof(struct PyPetscSFObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSFObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_SF) __PYX_ERR(5, 172, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_SF = (struct __pyx_vtabstruct_8petsc4py_5PETSc_SF*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_SF); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_SF)) __PYX_ERR(5, 172, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Vec = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "Vec",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscVecObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscVecObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscVecObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscVecObject),
  #else
  sizeof(struct PyPetscVecObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscVecObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Vec) __PYX_ERR(5, 178, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_Vec = (struct __pyx_vtabstruct_8petsc4py_5PETSc_Vec*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Vec); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_Vec)) __PYX_ERR(5, 178, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Space = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "Space",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscSpaceObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSpaceObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscSpaceObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSpaceObject),
  #else
  sizeof(struct PyPetscSpaceObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSpaceObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Space) __PYX_ERR(5, 184, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_Space = (struct __pyx_vtabstruct_8petsc4py_5PETSc_Space*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Space); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_Space)) __PYX_ERR(5, 184, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DualSpace = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "DualSpace",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscDualSpaceObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDualSpaceObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscDualSpaceObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDualSpaceObject),
  #else
  sizeof(struct PyPetscDualSpaceObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDualSpaceObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DualSpace) __PYX_ERR(5, 190, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_DualSpace = (struct __pyx_vtabstruct_8petsc4py_5PETSc_DualSpace*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DualSpace); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_DualSpace)) __PYX_ERR(5, 190, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_FE = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "FE",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscFEObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscFEObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscFEObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscFEObject),
  #else
  sizeof(struct PyPetscFEObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscFEObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_FE) __PYX_ERR(5, 196, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_FE = (struct __pyx_vtabstruct_8petsc4py_5PETSc_FE*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_FE); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_FE)) __PYX_ERR(5, 196, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Quad = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "Quad",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscQuadObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscQuadObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscQuadObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscQuadObject),
  #else
  sizeof(struct PyPetscQuadObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscQuadObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Quad) __PYX_ERR(5, 202, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_Quad = (struct __pyx_vtabstruct_8petsc4py_5PETSc_Quad*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Quad); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_Quad)) __PYX_ERR(5, 202, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Scatter = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "Scatter",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscScatterObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscScatterObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscScatterObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscScatterObject),
  #else
  sizeof(struct PyPetscScatterObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscScatterObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Scatter) __PYX_ERR(5, 208, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_Scatter = (struct __pyx_vtabstruct_8petsc4py_5PETSc_Scatter*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Scatter); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_Scatter)) __PYX_ERR(5, 208, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Section = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "Section",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscSectionObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSectionObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscSectionObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSectionObject),
  #else
  sizeof(struct PyPetscSectionObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSectionObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Section) __PYX_ERR(5, 214, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_Section = (struct __pyx_vtabstruct_8petsc4py_5PETSc_Section*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Section); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_Section)) __PYX_ERR(5, 214, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Mat = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "Mat",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscMatObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscMatObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscMatObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscMatObject),
  #else
  sizeof(struct PyPetscMatObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscMatObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Mat) __PYX_ERR(5, 220, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_Mat = (struct __pyx_vtabstruct_8petsc4py_5PETSc_Mat*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Mat); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_Mat)) __PYX_ERR(5, 220, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_MatPartitioning = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "MatPartitioning",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscMatPartitioningObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscMatPartitioningObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscMatPartitioningObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscMatPartitioningObject),
  #else
  sizeof(struct PyPetscMatPartitioningObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscMatPartitioningObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_MatPartitioning) __PYX_ERR(5, 226, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_MatPartitioning = (struct __pyx_vtabstruct_8petsc4py_5PETSc_MatPartitioning*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_MatPartitioning); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_MatPartitioning)) __PYX_ERR(5, 226, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_NullSpace = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "NullSpace",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscNullSpaceObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscNullSpaceObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscNullSpaceObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscNullSpaceObject),
  #else
  sizeof(struct PyPetscNullSpaceObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscNullSpaceObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_NullSpace) __PYX_ERR(5, 232, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_NullSpace = (struct __pyx_vtabstruct_8petsc4py_5PETSc_NullSpace*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_NullSpace); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_NullSpace)) __PYX_ERR(5, 232, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_PC = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "PC",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscPCObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscPCObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscPCObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscPCObject),
  #else
  sizeof(struct PyPetscPCObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscPCObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_PC) __PYX_ERR(5, 238, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_PC = (struct __pyx_vtabstruct_8petsc4py_5PETSc_PC*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_PC); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_PC)) __PYX_ERR(5, 238, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_KSP = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "KSP",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscKSPObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscKSPObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscKSPObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscKSPObject),
  #else
  sizeof(struct PyPetscKSPObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscKSPObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_KSP) __PYX_ERR(5, 244, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_KSP = (struct __pyx_vtabstruct_8petsc4py_5PETSc_KSP*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_KSP); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_KSP)) __PYX_ERR(5, 244, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_SNES = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "SNES",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscSNESObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSNESObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscSNESObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSNESObject),
  #else
  sizeof(struct PyPetscSNESObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSNESObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_SNES) __PYX_ERR(5, 250, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_SNES = (struct __pyx_vtabstruct_8petsc4py_5PETSc_SNES*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_SNES); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_SNES)) __PYX_ERR(5, 250, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_SNESLineSearch = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "SNESLineSearch",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscSNESLineSearchObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSNESLineSearchObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscSNESLineSearchObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSNESLineSearchObject),
  #else
  sizeof(struct PyPetscSNESLineSearchObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscSNESLineSearchObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_SNESLineSearch) __PYX_ERR(5, 256, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_SNESLineSearch = (struct __pyx_vtabstruct_8petsc4py_5PETSc_SNESLineSearch*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_SNESLineSearch); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_SNESLineSearch)) __PYX_ERR(5, 256, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_TS = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "TS",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscTSObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscTSObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscTSObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscTSObject),
  #else
  sizeof(struct PyPetscTSObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscTSObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_TS) __PYX_ERR(5, 262, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_TS = (struct __pyx_vtabstruct_8petsc4py_5PETSc_TS*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_TS); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_TS)) __PYX_ERR(5, 262, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_TAO = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "TAO",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscTAOObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscTAOObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscTAOObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscTAOObject),
  #else
  sizeof(struct PyPetscTAOObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscTAOObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_TAO) __PYX_ERR(5, 268, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_TAO = (struct __pyx_vtabstruct_8petsc4py_5PETSc_TAO*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_TAO); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_TAO)) __PYX_ERR(5, 268, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_TAOLineSearch = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "TAOLineSearch",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscTAOLineSearchObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscTAOLineSearchObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscTAOLineSearchObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscTAOLineSearchObject),
  #else
  sizeof(struct PyPetscTAOLineSearchObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscTAOLineSearchObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_TAOLineSearch) __PYX_ERR(5, 274, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_TAOLineSearch = (struct __pyx_vtabstruct_8petsc4py_5PETSc_TAOLineSearch*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_TAOLineSearch); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_TAOLineSearch)) __PYX_ERR(5, 274, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_AO = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "AO",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscAOObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscAOObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscAOObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscAOObject),
  #else
  sizeof(struct PyPetscAOObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscAOObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_AO) __PYX_ERR(5, 281, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_AO = (struct __pyx_vtabstruct_8petsc4py_5PETSc_AO*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_AO); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_AO)) __PYX_ERR(5, 281, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DM = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "DM",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscDMObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDMObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscDMObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDMObject),
  #else
  sizeof(struct PyPetscDMObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDMObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DM) __PYX_ERR(5, 287, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_DM = (struct __pyx_vtabstruct_8petsc4py_5PETSc_DM*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DM); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_DM)) __PYX_ERR(5, 287, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DMPlexTransform = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "DMPlexTransform",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscDMPlexTransformObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDMPlexTransformObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscDMPlexTransformObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDMPlexTransformObject),
  #else
  sizeof(struct PyPetscDMPlexTransformObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDMPlexTransformObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DMPlexTransform) __PYX_ERR(5, 293, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_DMPlexTransform = (struct __pyx_vtabstruct_8petsc4py_5PETSc_DMPlexTransform*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DMPlexTransform); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_DMPlexTransform)) __PYX_ERR(5, 293, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_CellDM = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "CellDM",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscDMSwarmCellDMObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDMSwarmCellDMObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscDMSwarmCellDMObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDMSwarmCellDMObject),
  #else
  sizeof(struct PyPetscDMSwarmCellDMObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDMSwarmCellDMObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_CellDM) __PYX_ERR(5, 299, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_CellDM = (struct __pyx_vtabstruct_8petsc4py_5PETSc_CellDM*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_CellDM); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_CellDM)) __PYX_ERR(5, 299, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DS = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "DS",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscDSObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDSObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscDSObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDSObject),
  #else
  sizeof(struct PyPetscDSObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDSObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DS) __PYX_ERR(5, 305, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_DS = (struct __pyx_vtabstruct_8petsc4py_5PETSc_DS*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DS); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_DS)) __PYX_ERR(5, 305, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Partitioner = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "Partitioner",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscPartitionerObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscPartitionerObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscPartitionerObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscPartitionerObject),
  #else
  sizeof(struct PyPetscPartitionerObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscPartitionerObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Partitioner) __PYX_ERR(5, 311, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_Partitioner = (struct __pyx_vtabstruct_8petsc4py_5PETSc_Partitioner*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_Partitioner); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_Partitioner)) __PYX_ERR(5, 311, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DMLabel = __Pyx_ImportType_3_1_3(__pyx_t_1, "petsc4py.PETSc", "DMLabel",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(struct PyPetscDMLabelObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDMLabelObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(struct PyPetscDMLabelObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDMLabelObject),
  #else
  sizeof(struct PyPetscDMLabelObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(struct PyPetscDMLabelObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DMLabel) __PYX_ERR(5, 317, __pyx_L1_error)
  __pyx_vtabptr_8petsc4py_5PETSc_DMLabel = (struct __pyx_vtabstruct_8petsc4py_5PETSc_DMLabel*)__Pyx_GetVtable(__pyx_mstate->__pyx_ptype_8petsc4py_5PETSc_DMLabel); if (unlikely(!__pyx_vtabptr_8petsc4py_5PETSc_DMLabel)) __PYX_ERR(5, 317, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(6, 9, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_mstate->__pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_1_3(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyTypeObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  0, 0,
  #else
  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyHeapTypeObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_7cpython_4type_type) __PYX_ERR(6, 9, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(7, 8, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_mstate->__pyx_ptype_7cpython_4bool_bool = __Pyx_ImportType_3_1_3(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "bool",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyLongObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyLongObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  0, 0,
  #else
  sizeof(PyLongObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyLongObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_7cpython_4bool_bool) __PYX_ERR(7, 8, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(8, 16, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_mstate->__pyx_ptype_7cpython_7complex_complex = __Pyx_ImportType_3_1_3(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "complex",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyComplexObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyComplexObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  0, 0,
  #else
  sizeof(PyComplexObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyComplexObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_7cpython_7complex_complex) __PYX_ERR(8, 16, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 271, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_mstate->__pyx_ptype_5numpy_dtype = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "dtype",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyArray_Descr),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyArray_Descr),
  #else
  sizeof(PyArray_Descr), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyArray_Descr),
  #endif
  __Pyx_ImportType_CheckSize_Ignore_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_dtype) __PYX_ERR(3, 271, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_flatiter = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "flatiter",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyArrayIterObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyArrayIterObject),
  #else
  sizeof(PyArrayIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyArrayIterObject),
  #endif
  __Pyx_ImportType_CheckSize_Ignore_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_flatiter) __PYX_ERR(3, 316, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_broadcast = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "broadcast",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyArrayMultiIterObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyArrayMultiIterObject),
  #else
  sizeof(PyArrayMultiIterObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyArrayMultiIterObject),
  #endif
  __Pyx_ImportType_CheckSize_Ignore_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_broadcast) __PYX_ERR(3, 320, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_ndarray = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "ndarray",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyArrayObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyArrayObject),
  #else
  sizeof(PyArrayObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyArrayObject),
  #endif
  __Pyx_ImportType_CheckSize_Ignore_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_ndarray) __PYX_ERR(3, 359, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_generic = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "generic",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #else
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_generic) __PYX_ERR(3, 848, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_number = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "number",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #else
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_number) __PYX_ERR(3, 850, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_integer = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "integer",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #else
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_integer) __PYX_ERR(3, 852, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_signedinteger = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "signedinteger",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #else
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_signedinteger) __PYX_ERR(3, 854, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "unsignedinteger",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #else
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(3, 856, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_inexact = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "inexact",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #else
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_inexact) __PYX_ERR(3, 858, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_floating = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "floating",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #else
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_floating) __PYX_ERR(3, 860, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_complexfloating = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "complexfloating",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #else
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_complexfloating) __PYX_ERR(3, 862, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_flexible = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "flexible",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #else
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_flexible) __PYX_ERR(3, 864, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_character = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "character",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #else
  sizeof(PyObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyObject),
  #endif
  __Pyx_ImportType_CheckSize_Warn_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_character) __PYX_ERR(3, 866, __pyx_L1_error)
  __pyx_mstate->__pyx_ptype_5numpy_ufunc = __Pyx_ImportType_3_1_3(__pyx_t_1, "numpy", "ufunc",
  #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
  sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyUFuncObject),
  #elif CYTHON_COMPILING_IN_LIMITED_API
  sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyUFuncObject),
  #else
  sizeof(PyUFuncObject), __PYX_GET_STRUCT_ALIGNMENT_3_1_3(PyUFuncObject),
  #endif
  __Pyx_ImportType_CheckSize_Ignore_3_1_3); if (!__pyx_mstate->__pyx_ptype_5numpy_ufunc) __PYX_ERR(3, 930, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_RefNannyFinishContext();
  return 0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_RefNannyFinishContext();
  return -1;
}

static int __Pyx_modinit_variable_import_code(__pyx_mstatetype *__pyx_mstate) {
  __Pyx_RefNannyDeclarations
  CYTHON_UNUSED_VAR(__pyx_mstate);
  __Pyx_RefNannySetupContext("__Pyx_modinit_variable_import_code", 0);
  /*--- Variable import code ---*/
  __Pyx_RefNannyFinishContext();
  return 0;
}

static int __Pyx_modinit_function_import_code(__pyx_mstatetype *__pyx_mstate) {
  __Pyx_RefNannyDeclarations
  CYTHON_UNUSED_VAR(__pyx_mstate);
  __Pyx_RefNannySetupContext("__Pyx_modinit_function_import_code", 0);
  /*--- Function import code ---*/
  __Pyx_RefNannyFinishContext();
  return 0;
}

#if CYTHON_PEP489_MULTI_PHASE_INIT
static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
static int __pyx_pymod_exec_tmm4py_core(PyObject* module); /*proto*/
static PyModuleDef_Slot __pyx_moduledef_slots[] = {
  {Py_mod_create, (void*)__pyx_pymod_create},
  {Py_mod_exec, (void*)__pyx_pymod_exec_tmm4py_core},
  #if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
  {Py_mod_gil, Py_MOD_GIL_USED},
  #endif
  #if PY_VERSION_HEX >= 0x030C0000 && CYTHON_USE_MODULE_STATE
  {Py_mod_multiple_interpreters, Py_MOD_MULTIPLE_INTERPRETERS_NOT_SUPPORTED},
  #endif
  {0, NULL}
};
#endif

#ifdef __cplusplus
namespace {
  struct PyModuleDef __pyx_moduledef =
  #else
  static struct PyModuleDef __pyx_moduledef =
  #endif
  {
      PyModuleDef_HEAD_INIT,
      "tmm4py_core",
      0, /* m_doc */
    #if CYTHON_USE_MODULE_STATE
      sizeof(__pyx_mstatetype), /* m_size */
    #else
      (CYTHON_PEP489_MULTI_PHASE_INIT) ? 0 : -1, /* m_size */
    #endif
      __pyx_methods /* m_methods */,
    #if CYTHON_PEP489_MULTI_PHASE_INIT
      __pyx_moduledef_slots, /* m_slots */
    #else
      NULL, /* m_reload */
    #endif
    #if CYTHON_USE_MODULE_STATE
      __pyx_m_traverse, /* m_traverse */
      __pyx_m_clear, /* m_clear */
      NULL /* m_free */
    #else
      NULL, /* m_traverse */
      NULL, /* m_clear */
      NULL /* m_free */
    #endif
  };
  #ifdef __cplusplus
} /* anonymous namespace */
#endif

/* PyModInitFuncType */
#ifndef CYTHON_NO_PYINIT_EXPORT
  #define __Pyx_PyMODINIT_FUNC PyMODINIT_FUNC
#else
  #ifdef __cplusplus
  #define __Pyx_PyMODINIT_FUNC extern "C" PyObject *
  #else
  #define __Pyx_PyMODINIT_FUNC PyObject *
  #endif
#endif

__Pyx_PyMODINIT_FUNC PyInit_tmm4py_core(void) CYTHON_SMALL_CODE; /*proto*/
__Pyx_PyMODINIT_FUNC PyInit_tmm4py_core(void)
#if CYTHON_PEP489_MULTI_PHASE_INIT
{
  return PyModuleDef_Init(&__pyx_moduledef);
}
/* ModuleCreationPEP489 */
#if CYTHON_COMPILING_IN_LIMITED_API && __PYX_LIMITED_VERSION_HEX < 0x03090000
static PY_INT64_T __Pyx_GetCurrentInterpreterId(void) {
    {
        PyObject *module = PyImport_ImportModule("_interpreters"); // 3.13+ I think
        if (!module) {
            PyErr_Clear(); // just try the 3.8-3.12 version
            module = PyImport_ImportModule("_xxsubinterpreters");
            if (!module) goto bad;
        }
        PyObject *current = PyObject_CallMethod(module, "get_current", NULL);
        Py_DECREF(module);
        if (!current) goto bad;
        if (PyTuple_Check(current)) {
            PyObject *new_current = PySequence_GetItem(current, 0);
            Py_DECREF(current);
            current = new_current;
            if (!new_current) goto bad;
        }
        long long as_c_int = PyLong_AsLongLong(current);
        Py_DECREF(current);
        return as_c_int;
    }
  bad:
    PySys_WriteStderr("__Pyx_GetCurrentInterpreterId failed. Try setting the C define CYTHON_PEP489_MULTI_PHASE_INIT=0\n");
    return -1;
}
#endif
#if !CYTHON_USE_MODULE_STATE
static CYTHON_SMALL_CODE int __Pyx_check_single_interpreter(void) {
    static PY_INT64_T main_interpreter_id = -1;
#if CYTHON_COMPILING_IN_GRAAL
    PY_INT64_T current_id = PyInterpreterState_GetIDFromThreadState(PyThreadState_Get());
#elif CYTHON_COMPILING_IN_LIMITED_API && __PYX_LIMITED_VERSION_HEX >= 0x03090000
    PY_INT64_T current_id = PyInterpreterState_GetID(PyInterpreterState_Get());
#elif CYTHON_COMPILING_IN_LIMITED_API
    PY_INT64_T current_id = __Pyx_GetCurrentInterpreterId();
#else
    PY_INT64_T current_id = PyInterpreterState_GetID(PyThreadState_Get()->interp);
#endif
    if (unlikely(current_id == -1)) {
        return -1;
    }
    if (main_interpreter_id == -1) {
        main_interpreter_id = current_id;
        return 0;
    } else if (unlikely(main_interpreter_id != current_id)) {
        PyErr_SetString(
            PyExc_ImportError,
            "Interpreter change detected - this module can only be loaded into one interpreter per process.");
        return -1;
    }
    return 0;
}
#endif
static CYTHON_SMALL_CODE int __Pyx_copy_spec_to_module(PyObject *spec, PyObject *moddict, const char* from_name, const char* to_name, int allow_none)
{
    PyObject *value = PyObject_GetAttrString(spec, from_name);
    int result = 0;
    if (likely(value)) {
        if (allow_none || value != Py_None) {
            result = PyDict_SetItemString(moddict, to_name, value);
        }
        Py_DECREF(value);
    } else if (PyErr_ExceptionMatches(PyExc_AttributeError)) {
        PyErr_Clear();
    } else {
        result = -1;
    }
    return result;
}
static CYTHON_SMALL_CODE PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def) {
    PyObject *module = NULL, *moddict, *modname;
    CYTHON_UNUSED_VAR(def);
    #if !CYTHON_USE_MODULE_STATE
    if (__Pyx_check_single_interpreter())
        return NULL;
    #endif
    if (__pyx_m)
        return __Pyx_NewRef(__pyx_m);
    modname = PyObject_GetAttrString(spec, "name");
    if (unlikely(!modname)) goto bad;
    module = PyModule_NewObject(modname);
    Py_DECREF(modname);
    if (unlikely(!module)) goto bad;
    moddict = PyModule_GetDict(module);
    if (unlikely(!moddict)) goto bad;
    if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "loader", "__loader__", 1) < 0)) goto bad;
    if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "origin", "__file__", 1) < 0)) goto bad;
    if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "parent", "__package__", 1) < 0)) goto bad;
    if (unlikely(__Pyx_copy_spec_to_module(spec, moddict, "submodule_search_locations", "__path__", 0) < 0)) goto bad;
    return module;
bad:
    Py_XDECREF(module);
    return NULL;
}


static CYTHON_SMALL_CODE int __pyx_pymod_exec_tmm4py_core(PyObject *__pyx_pyinit_module)
#endif
{
  int stringtab_initialized = 0;
  #if CYTHON_USE_MODULE_STATE
  int pystate_addmodule_run = 0;
  #endif
  __pyx_mstatetype *__pyx_mstate = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  size_t __pyx_t_9;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannyDeclarations
  #if CYTHON_PEP489_MULTI_PHASE_INIT
  if (__pyx_m) {
    if (__pyx_m == __pyx_pyinit_module) return 0;
    PyErr_SetString(PyExc_RuntimeError, "Module 'tmm4py_core' has already been imported. Re-initialisation is not supported.");
    return -1;
  }
  #else
  if (__pyx_m) return __Pyx_NewRef(__pyx_m);
  #endif
  /*--- Module creation code ---*/
  #if CYTHON_PEP489_MULTI_PHASE_INIT
  __pyx_t_1 = __pyx_pyinit_module;
  Py_INCREF(__pyx_t_1);
  #else
  __pyx_t_1 = PyModule_Create(&__pyx_moduledef); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #if CYTHON_USE_MODULE_STATE
  {
    int add_module_result = __Pyx_State_AddModule(__pyx_t_1, &__pyx_moduledef);
    __pyx_t_1 = 0; /* transfer ownership from __pyx_t_1 to "tmm4py_core" pseudovariable */
    if (unlikely((add_module_result < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
    pystate_addmodule_run = 1;
  }
  #else
  __pyx_m = __pyx_t_1;
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
  PyUnstable_Module_SetGIL(__pyx_m, Py_MOD_GIL_USED);
  #endif
  __pyx_mstate = __pyx_mstate_global;
  CYTHON_UNUSED_VAR(__pyx_t_1);
  __pyx_mstate->__pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_mstate->__pyx_d)) __PYX_ERR(0, 1, __pyx_L1_error)
  Py_INCREF(__pyx_mstate->__pyx_d);
  __pyx_mstate->__pyx_b = __Pyx_PyImport_AddModuleRef(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_mstate->__pyx_b)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_mstate->__pyx_cython_runtime = __Pyx_PyImport_AddModuleRef("cython_runtime"); if (unlikely(!__pyx_mstate->__pyx_cython_runtime)) __PYX_ERR(0, 1, __pyx_L1_error)
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_mstate->__pyx_b) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  /* ImportRefnannyAPI */
  #if CYTHON_REFNANNY
__Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
if (!__Pyx_RefNanny) {
  PyErr_Clear();
  __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
  if (!__Pyx_RefNanny)
      Py_FatalError("failed to import 'refnanny' module");
}
#endif

__Pyx_RefNannySetupContext("PyInit_tmm4py_core", 0);
  if (__Pyx_check_binary_version(__PYX_LIMITED_VERSION_HEX, __Pyx_get_runtime_version(), CYTHON_COMPILING_IN_LIMITED_API) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #ifdef __Pxy_PyFrame_Initialize_Offsets
  __Pxy_PyFrame_Initialize_Offsets();
  #endif
  __pyx_mstate->__pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_mstate->__pyx_empty_tuple)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_mstate->__pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_mstate->__pyx_empty_bytes)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_mstate->__pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_mstate->__pyx_empty_unicode)) __PYX_ERR(0, 1, __pyx_L1_error)
  /*--- Initialize various global constants etc. ---*/
  if (__Pyx_InitConstants(__pyx_mstate) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  stringtab_initialized = 1;
  if (__Pyx_InitGlobals() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #if 0 || defined(__Pyx_CyFunction_USED) || defined(__Pyx_FusedFunction_USED) || defined(__Pyx_Coroutine_USED) || defined(__Pyx_Generator_USED) || defined(__Pyx_AsyncGen_USED)
  if (__pyx_CommonTypesMetaclass_init(__pyx_m) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_CyFunction_USED
  if (__pyx_CyFunction_init(__pyx_m) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_FusedFunction_USED
  if (__pyx_FusedFunction_init(__pyx_m) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_Coroutine_USED
  if (__pyx_Coroutine_init(__pyx_m) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_Generator_USED
  if (__pyx_Generator_init(__pyx_m) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_AsyncGen_USED
  if (__pyx_AsyncGen_init(__pyx_m) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  /*--- Library function declarations ---*/
  if (__pyx_module_is_main_tmm4py__tmm4py_core) {
    if (PyObject_SetAttr(__pyx_m, __pyx_mstate_global->__pyx_n_u_name, __pyx_mstate_global->__pyx_n_u_main) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  }
  {
    PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(0, 1, __pyx_L1_error)
    if (!PyDict_GetItemString(modules, "tmm4py.tmm4py_core")) {
      if (unlikely((PyDict_SetItemString(modules, "tmm4py.tmm4py_core", __pyx_m) < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
    }
  }
  /*--- Builtin init code ---*/
  if (__Pyx_InitCachedBuiltins(__pyx_mstate) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  /*--- Constants init code ---*/
  if (__Pyx_InitCachedConstants(__pyx_mstate) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  if (__Pyx_CreateCodeObjects(__pyx_mstate) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  /*--- Global type/function init code ---*/
  (void)__Pyx_modinit_global_init_code(__pyx_mstate);
  (void)__Pyx_modinit_variable_export_code(__pyx_mstate);
  if (unlikely((__Pyx_modinit_function_export_code(__pyx_mstate) < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
  if (unlikely((__Pyx_modinit_type_init_code(__pyx_mstate) < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
  if (unlikely((__Pyx_modinit_type_import_code(__pyx_mstate) < 0))) __PYX_ERR(0, 1, __pyx_L1_error)
  (void)__Pyx_modinit_variable_import_code(__pyx_mstate);
  (void)__Pyx_modinit_function_import_code(__pyx_mstate);
  /*--- Execution code ---*/

  /* "tmm4py/tmm4py_core.pyx":4
 * cimport cython
 * 
 * import petsc4py             # <<<<<<<<<<<<<<
 * import sys
 * import warnings
*/
  __pyx_t_2 = __Pyx_ImportDottedModule(__pyx_mstate_global->__pyx_n_u_petsc4py, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_petsc4py, __pyx_t_2) < 0) __PYX_ERR(0, 4, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":5
 * 
 * import petsc4py
 * import sys             # <<<<<<<<<<<<<<
 * import warnings
 * import atexit
*/
  __pyx_t_2 = __Pyx_ImportDottedModule(__pyx_mstate_global->__pyx_n_u_sys, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_sys, __pyx_t_2) < 0) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":6
 * import petsc4py
 * import sys
 * import warnings             # <<<<<<<<<<<<<<
 * import atexit
 * 
*/
  __pyx_t_2 = __Pyx_ImportDottedModule(__pyx_mstate_global->__pyx_n_u_warnings, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 6, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_warnings, __pyx_t_2) < 0) __PYX_ERR(0, 6, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":7
 * import sys
 * import warnings
 * import atexit             # <<<<<<<<<<<<<<
 * 
 * try:
*/
  __pyx_t_2 = __Pyx_ImportDottedModule(__pyx_mstate_global->__pyx_n_u_atexit, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 7, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_atexit, __pyx_t_2) < 0) __PYX_ERR(0, 7, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":9
 * import atexit
 * 
 * try:             # <<<<<<<<<<<<<<
 *   from mpi4py import MPI
 * except:
*/
  {
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_3, &__pyx_t_4);
    __Pyx_XGOTREF(__pyx_t_1);
    __Pyx_XGOTREF(__pyx_t_3);
    __Pyx_XGOTREF(__pyx_t_4);
    /*try:*/ {

      /* "tmm4py/tmm4py_core.pyx":10
 * 
 * try:
 *   from mpi4py import MPI             # <<<<<<<<<<<<<<
 * except:
 *   MPI=None
*/
      __pyx_t_2 = __Pyx_PyList_Pack(1, __pyx_mstate_global->__pyx_n_u_MPI); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L2_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_5 = __Pyx_Import(__pyx_mstate_global->__pyx_n_u_mpi4py, __pyx_t_2, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 10, __pyx_L2_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_MPI); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L2_error)
      __Pyx_GOTREF(__pyx_t_2);
      if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_MPI, __pyx_t_2) < 0) __PYX_ERR(0, 10, __pyx_L2_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

      /* "tmm4py/tmm4py_core.pyx":9
 * import atexit
 * 
 * try:             # <<<<<<<<<<<<<<
 *   from mpi4py import MPI
 * except:
*/
    }
    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L7_try_end;
    __pyx_L2_error:;
    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;

    /* "tmm4py/tmm4py_core.pyx":11
 * try:
 *   from mpi4py import MPI
 * except:             # <<<<<<<<<<<<<<
 *   MPI=None
 * 
*/
    /*except:*/ {
      __Pyx_AddTraceback("tmm4py.tmm4py_core", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_2, &__pyx_t_6) < 0) __PYX_ERR(0, 11, __pyx_L4_except_error)
      __Pyx_XGOTREF(__pyx_t_5);
      __Pyx_XGOTREF(__pyx_t_2);
      __Pyx_XGOTREF(__pyx_t_6);

      /* "tmm4py/tmm4py_core.pyx":12
 *   from mpi4py import MPI
 * except:
 *   MPI=None             # <<<<<<<<<<<<<<
 * 
 * # This doesn't give an error on compiling but it fails as runtime
*/
      if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_MPI, Py_None) < 0) __PYX_ERR(0, 12, __pyx_L4_except_error)
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L3_exception_handled;
    }

    /* "tmm4py/tmm4py_core.pyx":9
 * import atexit
 * 
 * try:             # <<<<<<<<<<<<<<
 *   from mpi4py import MPI
 * except:
*/
    __pyx_L4_except_error:;
    __Pyx_XGIVEREF(__pyx_t_1);
    __Pyx_XGIVEREF(__pyx_t_3);
    __Pyx_XGIVEREF(__pyx_t_4);
    __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_3, __pyx_t_4);
    goto __pyx_L1_error;
    __pyx_L3_exception_handled:;
    __Pyx_XGIVEREF(__pyx_t_1);
    __Pyx_XGIVEREF(__pyx_t_3);
    __Pyx_XGIVEREF(__pyx_t_4);
    __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_3, __pyx_t_4);
    __pyx_L7_try_end:;
  }

  /* "tmm4py/tmm4py_core.pyx":17
 * # from petsc4py import asBool, asInt, asReal, asScalar, toBool, toInt, toReal
 * 
 * from petsc4py import PETSc             # <<<<<<<<<<<<<<
 * 
 * cimport numpy as np
*/
  __pyx_t_6 = __Pyx_PyList_Pack(1, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 17, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_2 = __Pyx_Import(__pyx_mstate_global->__pyx_n_u_petsc4py, __pyx_t_6, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 17, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_ImportFrom(__pyx_t_2, __pyx_mstate_global->__pyx_n_u_PETSc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 17, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_PETSc, __pyx_t_6) < 0) __PYX_ERR(0, 17, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":20
 * 
 * cimport numpy as np
 * import numpy as np             # <<<<<<<<<<<<<<
 * from libc.stdlib cimport malloc, free
 * from cpython cimport PyObject, Py_INCREF
*/
  __pyx_t_2 = __Pyx_ImportDottedModule(__pyx_mstate_global->__pyx_n_u_numpy, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_np, __pyx_t_2) < 0) __PYX_ERR(0, 20, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":25
 * from cpython.mem cimport PyMem_Malloc, PyMem_Free
 * 
 * np.import_array()             # <<<<<<<<<<<<<<
 * 
 * from cpython.bytes cimport PyBytes_AsString
*/
  __pyx_t_7 = __pyx_f_5numpy_import_array(); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 25, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":34
 * # warnings.showwarning=mywarnings
 * 
 * debug=False             # <<<<<<<<<<<<<<
 * 
 * # we use this to keep track of all created states so that we can call their destroy method
*/
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_debug, Py_False) < 0) __PYX_ERR(0, 34, __pyx_L1_error)

  /* "tmm4py/tmm4py_core.pyx":37
 * 
 * # we use this to keep track of all created states so that we can call their destroy method
 * _statescreated=[]             # <<<<<<<<<<<<<<
 * 
 * cdef extern from "tmm_share.h":
*/
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 37, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_statescreated, __pyx_t_2) < 0) __PYX_ERR(0, 37, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":53
 *     PetscBool useProfiles
 * 
 * configVars = ["useExternalForcing",             # <<<<<<<<<<<<<<
 *               "useForcingFromFile",
 *               "usePrescribedBC",
*/
  __pyx_t_2 = __Pyx_PyList_Pack(29, __pyx_mstate_global->__pyx_n_u_useExternalForcing, __pyx_mstate_global->__pyx_n_u_useForcingFromFile, __pyx_mstate_global->__pyx_n_u_usePrescribedBC, __pyx_mstate_global->__pyx_n_u_applyExternalForcing, __pyx_mstate_global->__pyx_n_u_applyForcingFromFile, __pyx_mstate_global->__pyx_n_u_applyBC, __pyx_mstate_global->__pyx_n_u_periodicForcing, __pyx_mstate_global->__pyx_n_u_timeDependentForcing, __pyx_mstate_global->__pyx_n_u_constantForcing, __pyx_mstate_global->__pyx_n_u_periodicBC, __pyx_mstate_global->__pyx_n_u_timeDependentBC, __pyx_mstate_global->__pyx_n_u_constantBC, __pyx_mstate_global->__pyx_n_u_doCalcBC, __pyx_mstate_global->__pyx_n_u_useMonitor, __pyx_mstate_global->__pyx_n_u_doMisfit, __pyx_mstate_global->__pyx_n_u_relaxTracer, __pyx_mstate_global->__pyx_n_u_isInitializedExternalForcing, __pyx_mstate_global->__pyx_n_u_isInitializedCalcBC, __pyx_mstate_global->__pyx_n_u_doOutput, __pyx_mstate_global->__pyx_n_u_appendOutput, __pyx_mstate_global->__pyx_n_u_writePickup, __pyx_mstate_global->__pyx_n_u_doWriteBC, __pyx_mstate_global->__pyx_n_u_doWriteQF, __pyx_mstate_global->__pyx_n_u_doWriteQEF, __pyx_mstate_global->__pyx_n_u_pickupFromFile, __pyx_mstate_global->__pyx_n_u_doTimeAverage, __pyx_mstate_global->__pyx_n_u_avgAppendOutput, __pyx_mstate_global->__pyx_n_u_doExtraWrite, __pyx_mstate_global->__pyx_n_u_numTracers); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 53, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_configVars, __pyx_t_2) < 0) __PYX_ERR(0, 53, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":83
 *               "numTracers"]
 * 
 * profileVars = ["useProfiles",             # <<<<<<<<<<<<<<
 *                "lSize",
 *                "lNumProfiles",
*/
  __pyx_t_2 = __Pyx_PyList_Pack(7, __pyx_mstate_global->__pyx_n_u_useProfiles, __pyx_mstate_global->__pyx_n_u_lSize, __pyx_mstate_global->__pyx_n_u_lNumProfiles, __pyx_mstate_global->__pyx_n_u_totalNumProfiles, __pyx_mstate_global->__pyx_n_u_lProfileLength, __pyx_mstate_global->__pyx_n_u_lStartIndices, __pyx_mstate_global->__pyx_n_u_lEndIndices); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 83, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_profileVars, __pyx_t_2) < 0) __PYX_ERR(0, 83, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":303
 * # You can still modify the numpy arrays in that list but not replace them
 * # with something else, or append or insert something in the list.
 * class _ImmutableList(list):             # <<<<<<<<<<<<<<
 *   def __setitem__(self, index, item):
 *     raise RuntimeError("List is not mutable")
*/
  __pyx_t_2 = PyTuple_Pack(1, ((PyObject *)(&PyList_Type))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = __Pyx_PEP560_update_bases(__pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_CalculateMetaclass(NULL, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_8 = __Pyx_Py3MetaclassPrepare(__pyx_t_5, __pyx_t_6, __pyx_mstate_global->__pyx_n_u_ImmutableList, __pyx_mstate_global->__pyx_n_u_ImmutableList, (PyObject *) NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, (PyObject *) NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  if (__pyx_t_6 != __pyx_t_2) {
    if (unlikely((PyDict_SetItemString(__pyx_t_8, "__orig_bases__", __pyx_t_2) < 0))) __PYX_ERR(0, 303, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":304
 * # with something else, or append or insert something in the list.
 * class _ImmutableList(list):
 *   def __setitem__(self, index, item):             # <<<<<<<<<<<<<<
 *     raise RuntimeError("List is not mutable")
 *   def insert(self, index, item):
*/
  __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_14_ImmutableList_1__setitem__, 0, __pyx_mstate_global->__pyx_n_u_ImmutableList___setitem, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[0])); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 304, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (__Pyx_SetNameInClass(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_setitem, __pyx_t_2) < 0) __PYX_ERR(0, 304, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":306
 *   def __setitem__(self, index, item):
 *     raise RuntimeError("List is not mutable")
 *   def insert(self, index, item):             # <<<<<<<<<<<<<<
 *     raise RuntimeError("List is not insertable")
 *   def append(self, item):
*/
  __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_14_ImmutableList_3insert, 0, __pyx_mstate_global->__pyx_n_u_ImmutableList_insert, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[1])); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (__Pyx_SetNameInClass(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_insert, __pyx_t_2) < 0) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":308
 *   def insert(self, index, item):
 *     raise RuntimeError("List is not insertable")
 *   def append(self, item):             # <<<<<<<<<<<<<<
 *    raise RuntimeError("List is not appendable")
 * 
*/
  __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_14_ImmutableList_5append, 0, __pyx_mstate_global->__pyx_n_u_ImmutableList_append, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[2])); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (__Pyx_SetNameInClass(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_append, __pyx_t_2) < 0) __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "tmm4py/tmm4py_core.pyx":303
 * # You can still modify the numpy arrays in that list but not replace them
 * # with something else, or append or insert something in the list.
 * class _ImmutableList(list):             # <<<<<<<<<<<<<<
 *   def __setitem__(self, index, item):
 *     raise RuntimeError("List is not mutable")
*/
  __pyx_t_2 = __Pyx_Py3ClassCreate(__pyx_t_5, __pyx_mstate_global->__pyx_n_u_ImmutableList, __pyx_t_6, __pyx_t_8, NULL, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_ImmutableList, __pyx_t_2) < 0) __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":311
 *    raise RuntimeError("List is not appendable")
 * 
 * class Stub:             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self, Id, prefix):
*/
  __pyx_t_6 = __Pyx_Py3MetaclassPrepare((PyObject *) NULL, __pyx_mstate_global->__pyx_empty_tuple, __pyx_mstate_global->__pyx_n_u_Stub, __pyx_mstate_global->__pyx_n_u_Stub, (PyObject *) NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, (PyObject *) NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);

  /* "tmm4py/tmm4py_core.pyx":313
 * class Stub:
 * 
 *     def __init__(self, Id, prefix):             # <<<<<<<<<<<<<<
 *       self.Id = Id
 *     def iniExternalForcingFn(self, tc, Iter, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_1__init__, 0, __pyx_mstate_global->__pyx_n_u_Stub___init, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[3])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 313, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_init, __pyx_t_5) < 0) __PYX_ERR(0, 313, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":315
 *     def __init__(self, Id, prefix):
 *       self.Id = Id
 *     def iniExternalForcingFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def calcExternalForcingFn(self, tc, Iter, iLoop, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_3iniExternalForcingFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_iniExternalForcingFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[4])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 315, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_iniExternalForcingFn, __pyx_t_5) < 0) __PYX_ERR(0, 315, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":317
 *     def iniExternalForcingFn(self, tc, Iter, state):
 *       pass
 *     def calcExternalForcingFn(self, tc, Iter, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def writeExternalForcingFn(self, tc, Iter, iLoop, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_5calcExternalForcingFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_calcExternalForcingFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[5])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 317, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_calcExternalForcingFn, __pyx_t_5) < 0) __PYX_ERR(0, 317, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":319
 *     def calcExternalForcingFn(self, tc, Iter, iLoop, state):
 *       pass
 *     def writeExternalForcingFn(self, tc, Iter, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def finalizeExternalForcingFn(self, tc, Iter, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_7writeExternalForcingFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_writeExternalForcingFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[6])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 319, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_writeExternalForcingFn, __pyx_t_5) < 0) __PYX_ERR(0, 319, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":321
 *     def writeExternalForcingFn(self, tc, Iter, iLoop, state):
 *       pass
 *     def finalizeExternalForcingFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def reInitializeExternalForcingFn(self, tc, Iter, iLoop, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_9finalizeExternalForcingFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_finalizeExternalForcingFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[7])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 321, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_finalizeExternalForcingFn, __pyx_t_5) < 0) __PYX_ERR(0, 321, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":323
 *     def finalizeExternalForcingFn(self, tc, Iter, state):
 *       pass
 *     def reInitializeExternalForcingFn(self, tc, Iter, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def iniCalcBCFn(self, tc, Iterc, tf, Iterf, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_11reInitializeExternalForcingFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_reInitializeExternalForcing, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[8])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 323, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_reInitializeExternalForcingFn, __pyx_t_5) < 0) __PYX_ERR(0, 323, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":325
 *     def reInitializeExternalForcingFn(self, tc, Iter, iLoop, state):
 *       pass
 *     def iniCalcBCFn(self, tc, Iterc, tf, Iterf, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def calcCalcBCFn(self, tc, Iterc, tf, Iterf, iLoop, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_13iniCalcBCFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_iniCalcBCFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[9])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 325, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_iniCalcBCFn, __pyx_t_5) < 0) __PYX_ERR(0, 325, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":327
 *     def iniCalcBCFn(self, tc, Iterc, tf, Iterf, state):
 *       pass
 *     def calcCalcBCFn(self, tc, Iterc, tf, Iterf, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def writeCalcBCFn(self, tc, Iter, iLoop, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_15calcCalcBCFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_calcCalcBCFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[10])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 327, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_calcCalcBCFn, __pyx_t_5) < 0) __PYX_ERR(0, 327, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":329
 *     def calcCalcBCFn(self, tc, Iterc, tf, Iterf, iLoop, state):
 *       pass
 *     def writeCalcBCFn(self, tc, Iter, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def finalizeCalcBCFn(self, tc, Iter, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_17writeCalcBCFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_writeCalcBCFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[11])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 329, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_writeCalcBCFn, __pyx_t_5) < 0) __PYX_ERR(0, 329, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":331
 *     def writeCalcBCFn(self, tc, Iter, iLoop, state):
 *       pass
 *     def finalizeCalcBCFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *        pass
 *     def reInitializeCalcBCFn(self, tc, Iter, iLoop, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_19finalizeCalcBCFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_finalizeCalcBCFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[12])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 331, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_finalizeCalcBCFn, __pyx_t_5) < 0) __PYX_ERR(0, 331, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":333
 *     def finalizeCalcBCFn(self, tc, Iter, state):
 *        pass
 *     def reInitializeCalcBCFn(self, tc, Iter, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def iniMonitorFn(self, tc, Iter, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_21reInitializeCalcBCFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_reInitializeCalcBCFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[13])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 333, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_reInitializeCalcBCFn, __pyx_t_5) < 0) __PYX_ERR(0, 333, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":335
 *     def reInitializeCalcBCFn(self, tc, Iter, iLoop, state):
 *       pass
 *     def iniMonitorFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def calcMonitorFn(self, tc, iLoop, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_23iniMonitorFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_iniMonitorFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[14])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 335, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_iniMonitorFn, __pyx_t_5) < 0) __PYX_ERR(0, 335, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":337
 *     def iniMonitorFn(self, tc, Iter, state):
 *       pass
 *     def calcMonitorFn(self, tc, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def writeMonitorFn(self, tc, iLoop, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_25calcMonitorFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_calcMonitorFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[15])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 337, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_calcMonitorFn, __pyx_t_5) < 0) __PYX_ERR(0, 337, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":339
 *     def calcMonitorFn(self, tc, iLoop, state):
 *       pass
 *     def writeMonitorFn(self, tc, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def finalizeMonitorFn(self, tc, Iter, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_27writeMonitorFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_writeMonitorFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[16])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 339, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_writeMonitorFn, __pyx_t_5) < 0) __PYX_ERR(0, 339, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":341
 *     def writeMonitorFn(self, tc, iLoop, state):
 *       pass
 *     def finalizeMonitorFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def iniMisfitFn(self, tc, Iter, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_29finalizeMonitorFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_finalizeMonitorFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[17])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 341, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_finalizeMonitorFn, __pyx_t_5) < 0) __PYX_ERR(0, 341, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":343
 *     def finalizeMonitorFn(self, tc, Iter, state):
 *       pass
 *     def iniMisfitFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def calcMisfitFn(self, tc, iLoop, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_31iniMisfitFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_iniMisfitFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[18])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 343, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_iniMisfitFn, __pyx_t_5) < 0) __PYX_ERR(0, 343, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":345
 *     def iniMisfitFn(self, tc, Iter, state):
 *       pass
 *     def calcMisfitFn(self, tc, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def writeMisfitFn(self, tc, iLoop, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_33calcMisfitFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_calcMisfitFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[19])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 345, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_calcMisfitFn, __pyx_t_5) < 0) __PYX_ERR(0, 345, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":347
 *     def calcMisfitFn(self, tc, iLoop, state):
 *       pass
 *     def writeMisfitFn(self, tc, iLoop, state):             # <<<<<<<<<<<<<<
 *       pass
 *     def finalizeMisfitFn(self, tc, Iter, state):
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_35writeMisfitFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_writeMisfitFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[20])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 347, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_writeMisfitFn, __pyx_t_5) < 0) __PYX_ERR(0, 347, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":349
 *     def writeMisfitFn(self, tc, iLoop, state):
 *       pass
 *     def finalizeMisfitFn(self, tc, Iter, state):             # <<<<<<<<<<<<<<
 *       pass
 * 
*/
  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_4Stub_37finalizeMisfitFn, 0, __pyx_mstate_global->__pyx_n_u_Stub_finalizeMisfitFn, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[21])); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 349, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_SetNameInClass(__pyx_t_6, __pyx_mstate_global->__pyx_n_u_finalizeMisfitFn, __pyx_t_5) < 0) __PYX_ERR(0, 349, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "tmm4py/tmm4py_core.pyx":311
 *    raise RuntimeError("List is not appendable")
 * 
 * class Stub:             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self, Id, prefix):
*/
  __pyx_t_5 = __Pyx_Py3ClassCreate(((PyObject*)&PyType_Type), __pyx_mstate_global->__pyx_n_u_Stub, __pyx_mstate_global->__pyx_empty_tuple, __pyx_t_6, NULL, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_Stub, __pyx_t_5) < 0) __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":389
 *         _statescreated.append(self)
 * 
 *     def create(self):             # <<<<<<<<<<<<<<
 * 
 *         cdef PetscErrorCode ierr
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_5create, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_create, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[22])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 389, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_create, __pyx_t_6) < 0) __PYX_ERR(0, 389, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":412
 * #   arguments and the python state object.
 * 
 *     def setIniExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setIniExternalForcingFunction failed: -external_forcing not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_7setIniExternalForcingFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setIniExternalForcingFu, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[23])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setIniExternalForcingFunction, __pyx_t_6) < 0) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":427
 * #             raise RuntimeError(f"TMMSetIniExtForcFunction failed with error code {ierr}")
 * 
 *     def setCalcExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setCalcExternalForcingFunction failed: -external_forcing not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_9setCalcExternalForcingFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setCalcExternalForcingF, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[24])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 427, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setCalcExternalForcingFunction, __pyx_t_6) < 0) __PYX_ERR(0, 427, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":440
 * #             raise RuntimeError(f"TMMSetCalcExtForcFunction failed with error code {ierr}")
 * 
 *     def setWriExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setWriExternalForcingFunction failed: -external_forcing not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_11setWriExternalForcingFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setWriExternalForcingFu, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[25])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 440, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setWriExternalForcingFunction, __pyx_t_6) < 0) __PYX_ERR(0, 440, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":453
 * #             raise RuntimeError(f"TMMSetWriExtForcFunction failed with error code {ierr}")
 * 
 *     def setFinExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setFinExternalForcingFunction failed: -external_forcing not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_13setFinExternalForcingFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setFinExternalForcingFu, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[26])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 453, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setFinExternalForcingFunction, __pyx_t_6) < 0) __PYX_ERR(0, 453, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":466
 * #             raise RuntimeError(f"TMMSetFinExtForcFunction failed with error code {ierr}")
 * 
 *     def setReiExternalForcingFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useExternalForcing']:
 *             raise RuntimeError("setReiExternalForcingFunction failed: -external_forcing not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_15setReiExternalForcingFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setReiExternalForcingFu, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[27])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 466, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setReiExternalForcingFunction, __pyx_t_6) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":479
 * #             raise RuntimeError(f"TMMSetReiExtForcFunction failed with error code {ierr}")
 * 
 *     def setIniCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setIniCalcBCFunction failed: -calc_bc not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_17setIniCalcBCFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setIniCalcBCFunction, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[28])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 479, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setIniCalcBCFunction, __pyx_t_6) < 0) __PYX_ERR(0, 479, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":492
 * #             raise RuntimeError(f"TMMSetIniCalcBCFunction failed with error code {ierr}")
 * 
 *     def setCalcCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setCalcCalcBCFunction failed: -calc_bc not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_19setCalcCalcBCFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setCalcCalcBCFunction, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[29])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 492, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setCalcCalcBCFunction, __pyx_t_6) < 0) __PYX_ERR(0, 492, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":505
 * #             raise RuntimeError(f"TMMSetCalcCalcBCFunction failed with error code {ierr}")
 * 
 *     def setWriCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setWriCalcBCFunction failed: -calc_bc not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_21setWriCalcBCFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setWriCalcBCFunction, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[30])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 505, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setWriCalcBCFunction, __pyx_t_6) < 0) __PYX_ERR(0, 505, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":518
 * #             raise RuntimeError(f"TMMSetWriCalcBCFunction failed with error code {ierr}")
 * 
 *     def setFinCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setFinCalcBCFunction failed: -calc_bc not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_23setFinCalcBCFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setFinCalcBCFunction, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[31])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 518, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setFinCalcBCFunction, __pyx_t_6) < 0) __PYX_ERR(0, 518, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":531
 * #             raise RuntimeError(f"TMMSetFinCalcBCFunction failed with error code {ierr}")
 * 
 *     def setReiCalcBCFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doCalcBC']:
 *             raise RuntimeError("setReiCalcBCFunction failed: -calc_bc not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_25setReiCalcBCFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setReiCalcBCFunction, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[32])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 531, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setReiCalcBCFunction, __pyx_t_6) < 0) __PYX_ERR(0, 531, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":544
 * #             raise RuntimeError(f"TMMSetReiCalcBCFunction failed with error code {ierr}")
 * 
 *     def setIniMonitorFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setIniMonitorFunction failed: -use_monitor not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_27setIniMonitorFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setIniMonitorFunction, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[33])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 544, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setIniMonitorFunction, __pyx_t_6) < 0) __PYX_ERR(0, 544, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":558
 * #             raise RuntimeError(f"TMMSetIniMonitorFunction failed with error code {ierr}")
 * 
 *     def setCalcMonitorFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setCalcMonitorFunction failed: -use_monitor not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_29setCalcMonitorFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setCalcMonitorFunction, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[34])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 558, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setCalcMonitorFunction, __pyx_t_6) < 0) __PYX_ERR(0, 558, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":571
 * #             raise RuntimeError(f"TMMSetCalcMonitorFunction failed with error code {ierr}")
 * 
 *     def setWriMonitorFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setWriMonitorFunction failed: -use_monitor not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_31setWriMonitorFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setWriMonitorFunction, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[35])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 571, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setWriMonitorFunction, __pyx_t_6) < 0) __PYX_ERR(0, 571, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":584
 * #             raise RuntimeError(f"TMMSetWriMonitorFunction failed with error code {ierr}")
 * 
 *     def setFinMonitorFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['useMonitor']:
 *             raise RuntimeError("setFinMonitorFunction failed: -use_monitor not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_33setFinMonitorFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setFinMonitorFunction, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[36])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 584, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setFinMonitorFunction, __pyx_t_6) < 0) __PYX_ERR(0, 584, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":597
 * #             raise RuntimeError(f"TMMSetFinMonitorFunction failed with error code {ierr}")
 * 
 *     def setIniMisfitFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setIniMisfitFunction failed: -calc_misfit not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_35setIniMisfitFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setIniMisfitFunction, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[37])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 597, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setIniMisfitFunction, __pyx_t_6) < 0) __PYX_ERR(0, 597, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":610
 * #             raise RuntimeError(f"TMMSetIniMisfitFunction failed with error code {ierr}")
 * 
 *     def setCalcMisfitFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setCalcMisfitFunction failed: -calc_misfit not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_37setCalcMisfitFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setCalcMisfitFunction, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[38])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 610, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setCalcMisfitFunction, __pyx_t_6) < 0) __PYX_ERR(0, 610, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":623
 * #             raise RuntimeError(f"TMMSetCalcMisfitFunction failed with error code {ierr}")
 * 
 *     def setWriMisfitFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setWriMisfitFunction failed: -calc_misfit not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_39setWriMisfitFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setWriMisfitFunction, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[39])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setWriMisfitFunction, __pyx_t_6) < 0) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":636
 * #             raise RuntimeError(f"TMMSetWriMisfitFunction failed with error code {ierr}")
 * 
 *     def setFinMisfitFunction(self, func, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         if not self.config['doMisfit']:
 *             raise RuntimeError("setFinMisfitFunction failed: -calc_misfit not specified")
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_41setFinMisfitFunction, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setFinMisfitFunction, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[40])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 636, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setFinMisfitFunction, __pyx_t_6) < 0) __PYX_ERR(0, 636, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":649
 * #             raise RuntimeError(f"TMMSetFinMisfitFunction failed with error code {ierr}")
 * 
 *     def getConfig(self):             # <<<<<<<<<<<<<<
 *         if True: #toBool(self.state.isInitialized):
 *           config = _getStateConfig(self.state)
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_43getConfig, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_getConfig, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[41])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 649, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_getConfig, __pyx_t_6) < 0) __PYX_ERR(0, 649, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":656
 *           raise RuntimeError("getConfig failed because state is uninitialized!")
 * 
 *     def getNumTracers(self):             # <<<<<<<<<<<<<<
 *         return toInt(self.state.numTracers)
 * 
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_45getNumTracers, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_getNumTracers, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[42])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 656, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_getNumTracers, __pyx_t_6) < 0) __PYX_ERR(0, 656, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":659
 *         return toInt(self.state.numTracers)
 * 
 *     def setFromOptions(self, prefix="", doOutput=True):             # <<<<<<<<<<<<<<
 *         cdef const char* pre
 *         cdef PetscScalar *data_pointer
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_47setFromOptions, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setFromOptions, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[43])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 659, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[0]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setFromOptions, __pyx_t_6) < 0) __PYX_ERR(0, 659, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":746
 *             del cbf
 * 
 *     def forcingUpdate(self, tc, Iterc, iLoop):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_49forcingUpdate, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_forcingUpdate, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[44])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 746, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_forcingUpdate, __pyx_t_6) < 0) __PYX_ERR(0, 746, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":756
 * #             raise RuntimeError(f"TMMForcingUpdate failed with error code {ierr}")
 * 
 *     def timeStep(self, tc, Iterc, iLoop):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_51timeStep, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_timeStep, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[45])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 756, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_timeStep, __pyx_t_6) < 0) __PYX_ERR(0, 756, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":766
 * #             raise RuntimeError(f"TMMTimeStep failed with error code {ierr}")
 * 
 *     def timeStepPost(self, tc, Iterc, iLoop):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_53timeStepPost, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_timeStepPost, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[46])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 766, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_timeStepPost, __pyx_t_6) < 0) __PYX_ERR(0, 766, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":777
 * #             raise RuntimeError(f"TMMTimeStepPost failed with error code {ierr}")
 * 
 *     def output(self, tc, Iterc, iLoop):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscInt Itercc = asInt(Iterc)
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_55output, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_output, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[47])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_output, __pyx_t_6) < 0) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":788
 * #             raise RuntimeError(f"TMMOutput failed with error code {ierr}")
 * 
 *     def pushConfigVar(self,**kwargs):             # <<<<<<<<<<<<<<
 *         for key in kwargs:
 *           if key=='isInitializedExternalForcing':
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_57pushConfigVar, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_pushConfigVar, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[48])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_pushConfigVar, __pyx_t_6) < 0) __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":803
 *         self.config=_getStateConfig(self.state)
 * 
 *     def destroy(self, tc):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_59destroy, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_destroy, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[49])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 803, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_destroy, __pyx_t_6) < 0) __PYX_ERR(0, 803, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":831
 * #             raise RuntimeError(f"TMMDestroy failed with error code {ierr}")
 * 
 *     def setTracer(self, alpha, itr=0):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar sval = asReal(alpha)
 *         cdef PetscErrorCode ierr
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_61setTracer, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_setTracer, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[50])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 831, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[1]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_setTracer, __pyx_t_6) < 0) __PYX_ERR(0, 831, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":837
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def loadTracerFromFile(self, typ, filename, itr, iRec=0):             # <<<<<<<<<<<<<<
 * #     Note: iRec is 0-based while VecLoadIntoVectorRandomAccessFromFile is 1-based
 *       cdef PetscErrorCode ierr
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_63loadTracerFromFile, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState_loadTracerFromFile, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[51])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 837, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[1]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TMMState, __pyx_mstate_global->__pyx_n_u_loadTracerFromFile, __pyx_t_6) < 0) __PYX_ERR(0, 837, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_65__reduce_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState___reduce_cython, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[52])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_reduce_cython, __pyx_t_6) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_8TMMState_67__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TMMState___setstate_cython, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[53])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_setstate_cython, __pyx_t_6) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":859
 *         raise RuntimeError(f"Unknown type of vector {typ} when loading")
 * 
 * def _cleanUp():             # <<<<<<<<<<<<<<
 *     tconfig=getTimeConfig()
 *     tc = tconfig['time0'] + tconfig['deltaTClock']*tconfig['maxSteps']
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_1_cleanUp, 0, __pyx_mstate_global->__pyx_n_u_cleanUp, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[54])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 859, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_cleanUp, __pyx_t_6) < 0) __PYX_ERR(0, 859, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":869
 *     finalize(tc)
 * 
 * atexit.register(_cleanUp)             # <<<<<<<<<<<<<<
 * 
 * def initialize():
*/
  __pyx_t_5 = NULL;
  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_atexit); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 869, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_register); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 869, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_mstate_global->__pyx_n_u_cleanUp); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 869, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __pyx_t_9 = 1;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_8};
    __pyx_t_6 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+__pyx_t_9, (2-__pyx_t_9) | (__pyx_t_9*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 869, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":871
 * atexit.register(_cleanUp)
 * 
 * def initialize():             # <<<<<<<<<<<<<<
 * 
 *     cdef PetscInt Iter0ret
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_3initialize, 0, __pyx_mstate_global->__pyx_n_u_initialize, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[55])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 871, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_initialize, __pyx_t_6) < 0) __PYX_ERR(0, 871, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":888
 *     return toInt(Iter0ret), toInt(maxStepsret), toReal(time0ret), toReal(deltaTClockret)
 * 
 * def updateTMs(tc):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar tcc = asReal(tc)
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_5updateTMs, 0, __pyx_mstate_global->__pyx_n_u_updateTMs, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[56])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 888, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_updateTMs, __pyx_t_6) < 0) __PYX_ERR(0, 888, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":896
 * #         raise RuntimeError(f"TMMUpdateTMs failed with error code {ierr}")
 * 
 * def finalize(tc):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar tcc = asReal(tc)
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_7finalize, 0, __pyx_mstate_global->__pyx_n_u_finalize, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[57])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 896, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_finalize, __pyx_t_6) < 0) __PYX_ERR(0, 896, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":904
 * #         raise RuntimeError(f"TMMFinalize failed with error code {ierr}")
 * 
 * def getProfileConfig():             # <<<<<<<<<<<<<<
 *     config = {key: False for key in profileVars}
 *     if toBool(useProfiles):
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_9getProfileConfig, 0, __pyx_mstate_global->__pyx_n_u_getProfileConfig, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[58])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 904, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_getProfileConfig, __pyx_t_6) < 0) __PYX_ERR(0, 904, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":926
 *     return config
 * 
 * def getTimeConfig():             # <<<<<<<<<<<<<<
 *     config = {'Iter0': toInt(Iter0), 'time0': toReal(time0), 'maxSteps': toInt(maxSteps), 'deltaTClock': toReal(deltaTClock)}
 *     return config
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_11getTimeConfig, 0, __pyx_mstate_global->__pyx_n_u_getTimeConfig, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[59])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 926, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_getTimeConfig, __pyx_t_6) < 0) __PYX_ERR(0, 926, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":930
 *     return config
 * 
 * def getSizes():             # <<<<<<<<<<<<<<
 *     return toInt(nb), toInt(lSize)
 * 
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_13getSizes, 0, __pyx_mstate_global->__pyx_n_u_getSizes, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[60])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 930, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_getSizes, __pyx_t_6) < 0) __PYX_ERR(0, 930, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":933
 *     return toInt(nb), toInt(lSize)
 * 
 * def getBCSizes():             # <<<<<<<<<<<<<<
 *     if toBool(prescribedBCInUse):
 *       return toInt(gBCSize), toInt(lBCSize)
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_15getBCSizes, 0, __pyx_mstate_global->__pyx_n_u_getBCSizes, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[61])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_getBCSizes, __pyx_t_6) < 0) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":984
 *         pass
 * 
 *     def create(self, prefix="", prefix2prefix=None, PetscInt startTimeStep=0):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_pre
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_9StepTimer_5create, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_StepTimer_create, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[62])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 984, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[2]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer, __pyx_mstate_global->__pyx_n_u_create, __pyx_t_6) < 0) __PYX_ERR(0, 984, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1006
 *         return self
 * 
 *     def update(self, PetscInt Iter):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         ierr = StepTimerUpdate(Iter, self.timer)
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_9StepTimer_7update, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_StepTimer_update, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[63])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1006, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer, __pyx_mstate_global->__pyx_n_u_update, __pyx_t_6) < 0) __PYX_ERR(0, 1006, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1014
 *         self.numTimeSteps = self.timer.numTimeSteps
 * 
 *     def incr(self):             # <<<<<<<<<<<<<<
 *         self.timer.count = self.timer.count + 1
 *         self.count = self.timer.count
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_9StepTimer_9incr, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_StepTimer_incr, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[64])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1014, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_StepTimer, __pyx_mstate_global->__pyx_n_u_incr, __pyx_t_6) < 0) __PYX_ERR(0, 1014, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_9StepTimer_11__reduce_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_StepTimer___reduce_cython, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[65])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_reduce_cython, __pyx_t_6) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_9StepTimer_13__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_StepTimer___setstate_cython, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[66])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_setstate_cython, __pyx_t_6) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1026
 *         pass
 * 
 *     def create(self, prefix="", prefix2prefix=None, np.ndarray[double, ndim=1, mode="c"] tdp=None, cyclePeriod=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_pre
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicTimer_5create, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_PeriodicTimer_create, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[67])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1026, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[3]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicTimer, __pyx_mstate_global->__pyx_n_u_create, __pyx_t_6) < 0) __PYX_ERR(0, 1026, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicTimer_7__reduce_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_PeriodicTimer___reduce_cython, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[68])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_reduce_cython, __pyx_t_6) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicTimer_9__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_PeriodicTimer___setstate_cython, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[69])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_setstate_cython, __pyx_t_6) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1080
 *         pass
 * 
 *     def create(self, prefix="", prefix2prefix=None, np.ndarray[double, ndim=1, mode="c"] tdt=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_pre
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentTimer_5create, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TimeDependentTimer_create, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[70])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1080, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[4]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentTimer, __pyx_mstate_global->__pyx_n_u_create, __pyx_t_6) < 0) __PYX_ERR(0, 1080, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentTimer_7__reduce_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TimeDependentTimer___reduce_cyth, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[71])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_reduce_cython, __pyx_t_6) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentTimer_9__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TimeDependentTimer___setstate_cy, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[72])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_setstate_cython, __pyx_t_6) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1130
 *         pass
 * 
 *     def create(self, typ='tracer', np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscPeriodicVec newvec
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_11PeriodicVec_5create, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_PeriodicVec_create, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[73])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1130, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[5]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec, __pyx_mstate_global->__pyx_n_u_create, __pyx_t_6) < 0) __PYX_ERR(0, 1130, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1164
 *         return self
 * 
 *     def interp(self, tc, PeriodicTimer timer, filename):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscErrorCode ierr
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_11PeriodicVec_7interp, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_PeriodicVec_interp, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[74])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1164, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec, __pyx_mstate_global->__pyx_n_u_interp, __pyx_t_6) < 0) __PYX_ERR(0, 1164, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1173
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def destroy(self):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_11PeriodicVec_9destroy, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_PeriodicVec_destroy, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[75])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1173, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicVec, __pyx_mstate_global->__pyx_n_u_destroy, __pyx_t_6) < 0) __PYX_ERR(0, 1173, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_11PeriodicVec_11__reduce_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_PeriodicVec___reduce_cython, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[76])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_reduce_cython, __pyx_t_6) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_11PeriodicVec_13__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_PeriodicVec___setstate_cython, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[77])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_setstate_cython, __pyx_t_6) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1190
 *         pass
 * 
 *     def create(self, typ='tracer', np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscTimeDependentVec newvec
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_16TimeDependentVec_5create, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TimeDependentVec_create, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[78])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1190, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[5]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec, __pyx_mstate_global->__pyx_n_u_create, __pyx_t_6) < 0) __PYX_ERR(0, 1190, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1224
 *         return self
 * 
 *     def interp(self, tc, TimeDependentTimer timer, filename):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscErrorCode ierr
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_16TimeDependentVec_7interp, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TimeDependentVec_interp, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[79])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1224, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec, __pyx_mstate_global->__pyx_n_u_interp, __pyx_t_6) < 0) __PYX_ERR(0, 1224, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1233
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def destroy(self):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_16TimeDependentVec_9destroy, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TimeDependentVec_destroy, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[80])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1233, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentVec, __pyx_mstate_global->__pyx_n_u_destroy, __pyx_t_6) < 0) __PYX_ERR(0, 1233, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_16TimeDependentVec_11__reduce_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TimeDependentVec___reduce_cython, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[81])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_reduce_cython, __pyx_t_6) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_16TimeDependentVec_13__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TimeDependentVec___setstate_cyth, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[82])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_setstate_cython, __pyx_t_6) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1250
 *         pass
 * 
 *     def create(self, arrayLength, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscPeriodicArray newarr
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicArray_5create, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_PeriodicArray_create, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[83])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1250, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[6]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray, __pyx_mstate_global->__pyx_n_u_create, __pyx_t_6) < 0) __PYX_ERR(0, 1250, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1275
 *         return self
 * 
 *     def interp(self, tc, PeriodicTimer timer, filename):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscErrorCode ierr
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicArray_7interp, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_PeriodicArray_interp, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[84])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1275, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray, __pyx_mstate_global->__pyx_n_u_interp, __pyx_t_6) < 0) __PYX_ERR(0, 1275, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1284
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def destroy(self):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicArray_9destroy, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_PeriodicArray_destroy, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[85])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1284, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_PeriodicArray, __pyx_mstate_global->__pyx_n_u_destroy, __pyx_t_6) < 0) __PYX_ERR(0, 1284, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicArray_11__reduce_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_PeriodicArray___reduce_cython, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[86])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_reduce_cython, __pyx_t_6) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_13PeriodicArray_13__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_PeriodicArray___setstate_cython, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[87])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_setstate_cython, __pyx_t_6) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1299
 *         pass
 * 
 *     def create(self, arrayLength, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscTimeDependentArray newarr
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentArray_5create, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TimeDependentArray_create, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[88])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1299, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[6]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray, __pyx_mstate_global->__pyx_n_u_create, __pyx_t_6) < 0) __PYX_ERR(0, 1299, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1324
 *         return self
 * 
 *     def interp(self, tc, TimeDependentTimer timer, filename):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar tcc = asReal(tc)
 *         cdef PetscErrorCode ierr
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentArray_7interp, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TimeDependentArray_interp, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[89])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1324, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray, __pyx_mstate_global->__pyx_n_u_interp, __pyx_t_6) < 0) __PYX_ERR(0, 1324, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1333
 *         if ierr != 0: raise PETSc.Error(ierr)
 * 
 *     def destroy(self):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 * 
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentArray_9destroy, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TimeDependentArray_destroy, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[90])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1333, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core_TimeDependentArray, __pyx_mstate_global->__pyx_n_u_destroy, __pyx_t_6) < 0) __PYX_ERR(0, 1333, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentArray_11__reduce_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TimeDependentArray___reduce_cyth, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[91])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_reduce_cython, __pyx_t_6) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "no default __reduce__ due to non-trivial __cinit__"
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_18TimeDependentArray_13__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_TimeDependentArray___setstate_cy, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[92])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_setstate_cython, __pyx_t_6) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1341
 * 
 * 
 * def loadVecIntoArray(filename, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *data_pointer
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_17loadVecIntoArray, 0, __pyx_mstate_global->__pyx_n_u_loadVecIntoArray, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[93])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1341, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[6]);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_loadVecIntoArray, __pyx_t_6) < 0) __PYX_ERR(0, 1341, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1363
 * #       Note: the memory is owned by the array buf
 * 
 * def readProfileScalarData(filename, numValsPerProfile=1, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *data_pointer
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_19readProfileScalarData, 0, __pyx_mstate_global->__pyx_n_u_readProfileScalarData, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[94])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1363, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[7]);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_readProfileScalarData, __pyx_t_6) < 0) __PYX_ERR(0, 1363, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1386
 * #       Note: the memory is owned by the array buf
 * 
 * def writeProfileScalarData(filename, np.ndarray[double, ndim=1, mode="c"] arr not None, numValsPerProfile=1, appendToFile=False):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *data_pointer
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_21writeProfileScalarData, 0, __pyx_mstate_global->__pyx_n_u_writeProfileScalarData, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[95])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1386, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[8]);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_writeProfileScalarData, __pyx_t_6) < 0) __PYX_ERR(0, 1386, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1400
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
 * def writeArrayToVec(filename, np.ndarray[double, ndim=1, mode="c"] arr not None, mode):             # <<<<<<<<<<<<<<
 * #         if   mode == 'r'  : return PETSC_FILE_MODE_READ
 * #         elif mode == 'w'  : return PETSC_FILE_MODE_WRITE
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_23writeArrayToVec, 0, __pyx_mstate_global->__pyx_n_u_writeArrayToVec, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[96])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1400, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_writeArrayToVec, __pyx_t_6) < 0) __PYX_ERR(0, 1400, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1420
 *     c.destroy()
 * 
 * def writeBinaryArray(filename, np.ndarray[double, ndim=1, mode="c"] arr not None, appendToFile=False):             # <<<<<<<<<<<<<<
 * #   Note: writeBinaryScalarData only writes on rank 0. You can call this from all ranks
 *     cdef PetscErrorCode ierr
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_25writeBinaryArray, 0, __pyx_mstate_global->__pyx_n_u_writeBinaryArray, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[97])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1420, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[9]);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_writeBinaryArray, __pyx_t_6) < 0) __PYX_ERR(0, 1420, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1432
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
 * def barrier():             # <<<<<<<<<<<<<<
 * 
 *     cdef PetscErrorCode ierr
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_27barrier, 0, __pyx_mstate_global->__pyx_n_u_barrier, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[98])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1432, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_barrier, __pyx_t_6) < 0) __PYX_ERR(0, 1432, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1438
 *     if ierr != 0: raise PETSc.Error(ierr)
 * 
 * def globalScalarSum(x):             # <<<<<<<<<<<<<<
 * 
 *     cdef PetscErrorCode ierr
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_29globalScalarSum, 0, __pyx_mstate_global->__pyx_n_u_globalScalarSum, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[99])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1438, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_globalScalarSum, __pyx_t_6) < 0) __PYX_ERR(0, 1438, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1459
 * #     return tot
 * 
 * def globalSum(np.ndarray[double, ndim=1, mode="c"] xarr not None):             # <<<<<<<<<<<<<<
 * 
 *     cdef PetscErrorCode ierr
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_31globalSum, 0, __pyx_mstate_global->__pyx_n_u_globalSum, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[100])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1459, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_globalSum, __pyx_t_6) < 0) __PYX_ERR(0, 1459, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1473
 *     return toReal(res)
 * 
 * def dotProd(np.ndarray[double, ndim=1, mode="c"] xarr not None, np.ndarray[double, ndim=1, mode="c"] yarr not None):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *xdata_pointer
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_33dotProd, 0, __pyx_mstate_global->__pyx_n_u_dotProd, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[101])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1473, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_dotProd, __pyx_t_6) < 0) __PYX_ERR(0, 1473, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1493
 * 
 * # This should be deprecated
 * def dotProdProfileScalarData(np.ndarray[double, ndim=1, mode="c"] xarr not None, np.ndarray[double, ndim=1, mode="c"] yarr not None):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *xdata_pointer
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_35dotProdProfileScalarData, 0, __pyx_mstate_global->__pyx_n_u_dotProdProfileScalarData, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[102])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1493, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_dotProdProfileScalarData, __pyx_t_6) < 0) __PYX_ERR(0, 1493, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1514
 * 
 * # This should be deprecated
 * def dotProdVecs(np.ndarray[double, ndim=1, mode="c"] xarr not None, np.ndarray[double, ndim=1, mode="c"] yarr not None):             # <<<<<<<<<<<<<<
 * 
 *     x = petsc4py.PETSc.Vec()
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_37dotProdVecs, 0, __pyx_mstate_global->__pyx_n_u_dotProdVecs, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[103])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1514, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_dotProdVecs, __pyx_t_6) < 0) __PYX_ERR(0, 1514, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1566
 *         self.myId = myId
 * 
 *     def __array__(self, dtype=None, copy=None):             # <<<<<<<<<<<<<<
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_17_RealArrayWrapper_1__array__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_RealArrayWrapper___array, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[104])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[10]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapper, __pyx_mstate_global->__pyx_n_u_array_2, __pyx_t_6) < 0) __PYX_ERR(0, 1566, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_17_RealArrayWrapper_5__reduce_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_RealArrayWrapper___reduce_cytho, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[105])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_reduce_cython, __pyx_t_6) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_17_RealArrayWrapper_7__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_RealArrayWrapper___setstate_cyt, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[106])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_setstate_cython, __pyx_t_6) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1605
 *         self.myId = myId
 * 
 *     def __array__(self, dtype=None, copy=None):             # <<<<<<<<<<<<<<
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_1__array__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_RealArrayWrapperWithDel___array, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[107])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1605, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[10]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core__RealArrayWrapperWithDel, __pyx_mstate_global->__pyx_n_u_array_2, __pyx_t_6) < 0) __PYX_ERR(0, 1605, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_5__reduce_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_RealArrayWrapperWithDel___reduc, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[108])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_reduce_cython, __pyx_t_6) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr,self.pv cannot be converted to a Python object for pickling"
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_24_RealArrayWrapperWithDel_7__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_RealArrayWrapperWithDel___setst, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[109])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_setstate_cython, __pyx_t_6) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1624
 *         self.size = size # we need to store a reference to this for the destructor
 * 
 *     def __array__(self, dtype=None, copy=None):             # <<<<<<<<<<<<<<
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_16_IntArrayWrapper_1__array__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_IntArrayWrapper___array, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[110])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1624, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[10]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapper, __pyx_mstate_global->__pyx_n_u_array_2, __pyx_t_6) < 0) __PYX_ERR(0, 1624, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_16_IntArrayWrapper_3__reduce_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_IntArrayWrapper___reduce_cython, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[111])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_reduce_cython, __pyx_t_6) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_16_IntArrayWrapper_5__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_IntArrayWrapper___setstate_cyth, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[112])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_setstate_cython, __pyx_t_6) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1638
 *         self.size = size # we need to store a reference to this for the destructor
 * 
 *     def __array__(self, dtype=None, copy=None):             # <<<<<<<<<<<<<<
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_1__array__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_IntArrayWrapperWithDel___array, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[113])); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1638, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_6, __pyx_mstate_global->__pyx_tuple[10]);
  if (__Pyx_SetItemOnTypeDict(__pyx_mstate_global->__pyx_ptype_6tmm4py_11tmm4py_core__IntArrayWrapperWithDel, __pyx_mstate_global->__pyx_n_u_array_2, __pyx_t_6) < 0) __PYX_ERR(0, 1638, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":1
 * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_5__reduce_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_IntArrayWrapperWithDel___reduce, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[114])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_reduce_cython, __pyx_t_6) < 0) __PYX_ERR(1, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "(tree fragment)":3
 * def __reduce_cython__(self):
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
 * def __setstate_cython__(self, __pyx_state):             # <<<<<<<<<<<<<<
 *     raise TypeError, "self.data_ptr cannot be converted to a Python object for pickling"
*/
  __pyx_t_6 = __Pyx_CyFunction_New(&__pyx_mdef_6tmm4py_11tmm4py_core_23_IntArrayWrapperWithDel_7__setstate_cython__, __Pyx_CYFUNCTION_CCLASS, __pyx_mstate_global->__pyx_n_u_IntArrayWrapperWithDel___setsta, NULL, __pyx_mstate_global->__pyx_n_u_tmm4py_tmm4py_core, __pyx_mstate_global->__pyx_d, ((PyObject *)__pyx_mstate_global->__pyx_codeobj_tab[115])); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_setstate_cython, __pyx_t_6) < 0) __PYX_ERR(1, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "tmm4py/tmm4py_core.pyx":1
 * # from __future__ import absolute_import             # <<<<<<<<<<<<<<
 * cimport cython
 * 
*/
  __pyx_t_6 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_mstate_global->__pyx_d, __pyx_mstate_global->__pyx_n_u_test, __pyx_t_6) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /*--- Wrapped vars code ---*/

  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  if (__pyx_m) {
    if (__pyx_mstate->__pyx_d && stringtab_initialized) {
      __Pyx_AddTraceback("init tmm4py.tmm4py_core", __pyx_clineno, __pyx_lineno, __pyx_filename);
    }
    #if !CYTHON_USE_MODULE_STATE
    Py_CLEAR(__pyx_m);
    #else
    Py_DECREF(__pyx_m);
    if (pystate_addmodule_run) {
      PyObject *tp, *value, *tb;
      PyErr_Fetch(&tp, &value, &tb);
      PyState_RemoveModule(&__pyx_moduledef);
      PyErr_Restore(tp, value, tb);
    }
    #endif
  } else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_ImportError, "init tmm4py.tmm4py_core");
  }
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  #if CYTHON_PEP489_MULTI_PHASE_INIT
  return (__pyx_m != NULL) ? 0 : -1;
  #else
  return __pyx_m;
  #endif
}
/* #### Code section: pystring_table ### */

typedef struct {
    const char *s;
#if 179 <= 65535
    const unsigned short n;
#elif 179 / 2 < INT_MAX
    const unsigned int n;
#elif 179 / 2 < LONG_MAX
    const unsigned long n;
#else
    const Py_ssize_t n;
#endif
#if 1 <= 31
    const unsigned int encoding : 5;
#elif 1 <= 255
    const unsigned char encoding;
#elif 1 <= 65535
    const unsigned short encoding;
#else
    const Py_ssize_t encoding;
#endif
    const unsigned int is_unicode : 1;
    const unsigned int intern : 1;
} __Pyx_StringTabEntry;
static const char * const __pyx_string_tab_encodings[] = { 0 };
static const __Pyx_StringTabEntry __pyx_string_tab[] = {
  {__pyx_k_, sizeof(__pyx_k_), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_ */
  {__pyx_k_Before_GC, sizeof(__pyx_k_Before_GC), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Before_GC */
  {__pyx_k_COMM_WORLD, sizeof(__pyx_k_COMM_WORLD), 0, 1, 1}, /* PyObject cname: __pyx_n_u_COMM_WORLD */
  {__pyx_k_Calling_destroy_at_time, sizeof(__pyx_k_Calling_destroy_at_time), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Calling_destroy_at_time */
  {__pyx_k_Calling_finalize_at_time, sizeof(__pyx_k_Calling_finalize_at_time), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Calling_finalize_at_time */
  {__pyx_k_Doing_GC, sizeof(__pyx_k_Doing_GC), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Doing_GC */
  {__pyx_k_Error, sizeof(__pyx_k_Error), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Error */
  {__pyx_k_Id, sizeof(__pyx_k_Id), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Id */
  {__pyx_k_Id_2, sizeof(__pyx_k_Id_2), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Id_2 */
  {__pyx_k_ImmutableList, sizeof(__pyx_k_ImmutableList), 0, 1, 1}, /* PyObject cname: __pyx_n_u_ImmutableList */
  {__pyx_k_ImmutableList___setitem, sizeof(__pyx_k_ImmutableList___setitem), 0, 1, 1}, /* PyObject cname: __pyx_n_u_ImmutableList___setitem */
  {__pyx_k_ImmutableList_append, sizeof(__pyx_k_ImmutableList_append), 0, 1, 1}, /* PyObject cname: __pyx_n_u_ImmutableList_append */
  {__pyx_k_ImmutableList_insert, sizeof(__pyx_k_ImmutableList_insert), 0, 1, 1}, /* PyObject cname: __pyx_n_u_ImmutableList_insert */
  {__pyx_k_ImportError, sizeof(__pyx_k_ImportError), 0, 1, 1}, /* PyObject cname: __pyx_n_u_ImportError */
  {__pyx_k_Incorrect_type_for, sizeof(__pyx_k_Incorrect_type_for), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Incorrect_type_for */
  {__pyx_k_Ini_exf_forcing_func_is, sizeof(__pyx_k_Ini_exf_forcing_func_is), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Ini_exf_forcing_func_is */
  {__pyx_k_Ini_monitor_func_is, sizeof(__pyx_k_Ini_monitor_func_is), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Ini_monitor_func_is */
  {__pyx_k_IntArrayWrapper, sizeof(__pyx_k_IntArrayWrapper), 0, 1, 1}, /* PyObject cname: __pyx_n_u_IntArrayWrapper */
  {__pyx_k_IntArrayWrapperWithDel, sizeof(__pyx_k_IntArrayWrapperWithDel), 0, 1, 1}, /* PyObject cname: __pyx_n_u_IntArrayWrapperWithDel */
  {__pyx_k_IntArrayWrapperWithDel___array, sizeof(__pyx_k_IntArrayWrapperWithDel___array), 0, 1, 1}, /* PyObject cname: __pyx_n_u_IntArrayWrapperWithDel___array */
  {__pyx_k_IntArrayWrapperWithDel___reduce, sizeof(__pyx_k_IntArrayWrapperWithDel___reduce), 0, 1, 1}, /* PyObject cname: __pyx_n_u_IntArrayWrapperWithDel___reduce */
  {__pyx_k_IntArrayWrapperWithDel___setsta, sizeof(__pyx_k_IntArrayWrapperWithDel___setsta), 0, 1, 1}, /* PyObject cname: __pyx_n_u_IntArrayWrapperWithDel___setsta */
  {__pyx_k_IntArrayWrapper___array, sizeof(__pyx_k_IntArrayWrapper___array), 0, 1, 1}, /* PyObject cname: __pyx_n_u_IntArrayWrapper___array */
  {__pyx_k_IntArrayWrapper___reduce_cython, sizeof(__pyx_k_IntArrayWrapper___reduce_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_IntArrayWrapper___reduce_cython */
  {__pyx_k_IntArrayWrapper___setstate_cyth, sizeof(__pyx_k_IntArrayWrapper___setstate_cyth), 0, 1, 1}, /* PyObject cname: __pyx_n_u_IntArrayWrapper___setstate_cyth */
  {__pyx_k_Iter, sizeof(__pyx_k_Iter), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Iter */
  {__pyx_k_Iter0, sizeof(__pyx_k_Iter0), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Iter0 */
  {__pyx_k_Iter0ret, sizeof(__pyx_k_Iter0ret), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Iter0ret */
  {__pyx_k_Iterc, sizeof(__pyx_k_Iterc), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Iterc */
  {__pyx_k_Itercc, sizeof(__pyx_k_Itercc), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Itercc */
  {__pyx_k_Iterf, sizeof(__pyx_k_Iterf), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Iterf */
  {__pyx_k_KeyError, sizeof(__pyx_k_KeyError), 0, 1, 1}, /* PyObject cname: __pyx_n_u_KeyError */
  {__pyx_k_Length_of_tdp_array, sizeof(__pyx_k_Length_of_tdp_array), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Length_of_tdp_array */
  {__pyx_k_Length_of_tdt_array, sizeof(__pyx_k_Length_of_tdt_array), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Length_of_tdt_array */
  {__pyx_k_List_is_not_appendable, sizeof(__pyx_k_List_is_not_appendable), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_List_is_not_appendable */
  {__pyx_k_List_is_not_insertable, sizeof(__pyx_k_List_is_not_insertable), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_List_is_not_insertable */
  {__pyx_k_List_is_not_mutable, sizeof(__pyx_k_List_is_not_mutable), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_List_is_not_mutable */
  {__pyx_k_MPI, sizeof(__pyx_k_MPI), 0, 1, 1}, /* PyObject cname: __pyx_n_u_MPI */
  {__pyx_k_Must_be_a_bool, sizeof(__pyx_k_Must_be_a_bool), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Must_be_a_bool */
  {__pyx_k_N, sizeof(__pyx_k_N), 0, 1, 1}, /* PyObject cname: __pyx_n_u_N */
  {__pyx_k_None, sizeof(__pyx_k_None), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_None */
  {__pyx_k_Note_that_Cython_is_deliberately, sizeof(__pyx_k_Note_that_Cython_is_deliberately), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Note_that_Cython_is_deliberately */
  {__pyx_k_OptDB, sizeof(__pyx_k_OptDB), 0, 1, 1}, /* PyObject cname: __pyx_n_u_OptDB */
  {__pyx_k_OptDBState, sizeof(__pyx_k_OptDBState), 0, 1, 1}, /* PyObject cname: __pyx_n_u_OptDBState */
  {__pyx_k_Options, sizeof(__pyx_k_Options), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Options */
  {__pyx_k_PETSc, sizeof(__pyx_k_PETSc), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PETSc */
  {__pyx_k_PeriodicArray, sizeof(__pyx_k_PeriodicArray), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicArray */
  {__pyx_k_PeriodicArray___reduce_cython, sizeof(__pyx_k_PeriodicArray___reduce_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicArray___reduce_cython */
  {__pyx_k_PeriodicArray___setstate_cython, sizeof(__pyx_k_PeriodicArray___setstate_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicArray___setstate_cython */
  {__pyx_k_PeriodicArray_create, sizeof(__pyx_k_PeriodicArray_create), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicArray_create */
  {__pyx_k_PeriodicArray_destroy, sizeof(__pyx_k_PeriodicArray_destroy), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicArray_destroy */
  {__pyx_k_PeriodicArray_interp, sizeof(__pyx_k_PeriodicArray_interp), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicArray_interp */
  {__pyx_k_PeriodicTimer, sizeof(__pyx_k_PeriodicTimer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicTimer */
  {__pyx_k_PeriodicTimer___reduce_cython, sizeof(__pyx_k_PeriodicTimer___reduce_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicTimer___reduce_cython */
  {__pyx_k_PeriodicTimer___setstate_cython, sizeof(__pyx_k_PeriodicTimer___setstate_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicTimer___setstate_cython */
  {__pyx_k_PeriodicTimer_create, sizeof(__pyx_k_PeriodicTimer_create), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicTimer_create */
  {__pyx_k_PeriodicVec, sizeof(__pyx_k_PeriodicVec), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicVec */
  {__pyx_k_PeriodicVec___reduce_cython, sizeof(__pyx_k_PeriodicVec___reduce_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicVec___reduce_cython */
  {__pyx_k_PeriodicVec___setstate_cython, sizeof(__pyx_k_PeriodicVec___setstate_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicVec___setstate_cython */
  {__pyx_k_PeriodicVec_create, sizeof(__pyx_k_PeriodicVec_create), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicVec_create */
  {__pyx_k_PeriodicVec_destroy, sizeof(__pyx_k_PeriodicVec_destroy), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicVec_destroy */
  {__pyx_k_PeriodicVec_interp, sizeof(__pyx_k_PeriodicVec_interp), 0, 1, 1}, /* PyObject cname: __pyx_n_u_PeriodicVec_interp */
  {__pyx_k_Provided_array_length_does_not_m, sizeof(__pyx_k_Provided_array_length_does_not_m), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Provided_array_length_does_not_m */
  {__pyx_k_RealArrayWrapper, sizeof(__pyx_k_RealArrayWrapper), 0, 1, 1}, /* PyObject cname: __pyx_n_u_RealArrayWrapper */
  {__pyx_k_RealArrayWrapperWithDel, sizeof(__pyx_k_RealArrayWrapperWithDel), 0, 1, 1}, /* PyObject cname: __pyx_n_u_RealArrayWrapperWithDel */
  {__pyx_k_RealArrayWrapperWithDel___array, sizeof(__pyx_k_RealArrayWrapperWithDel___array), 0, 1, 1}, /* PyObject cname: __pyx_n_u_RealArrayWrapperWithDel___array */
  {__pyx_k_RealArrayWrapperWithDel___reduc, sizeof(__pyx_k_RealArrayWrapperWithDel___reduc), 0, 1, 1}, /* PyObject cname: __pyx_n_u_RealArrayWrapperWithDel___reduc */
  {__pyx_k_RealArrayWrapperWithDel___setst, sizeof(__pyx_k_RealArrayWrapperWithDel___setst), 0, 1, 1}, /* PyObject cname: __pyx_n_u_RealArrayWrapperWithDel___setst */
  {__pyx_k_RealArrayWrapper___array, sizeof(__pyx_k_RealArrayWrapper___array), 0, 1, 1}, /* PyObject cname: __pyx_n_u_RealArrayWrapper___array */
  {__pyx_k_RealArrayWrapper___reduce_cytho, sizeof(__pyx_k_RealArrayWrapper___reduce_cytho), 0, 1, 1}, /* PyObject cname: __pyx_n_u_RealArrayWrapper___reduce_cytho */
  {__pyx_k_RealArrayWrapper___setstate_cyt, sizeof(__pyx_k_RealArrayWrapper___setstate_cyt), 0, 1, 1}, /* PyObject cname: __pyx_n_u_RealArrayWrapper___setstate_cyt */
  {__pyx_k_RuntimeError, sizeof(__pyx_k_RuntimeError), 0, 1, 1}, /* PyObject cname: __pyx_n_u_RuntimeError */
  {__pyx_k_Setting_options_database, sizeof(__pyx_k_Setting_options_database), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Setting_options_database */
  {__pyx_k_Setting_options_database_for, sizeof(__pyx_k_Setting_options_database_for), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Setting_options_database_for */
  {__pyx_k_StepTimer, sizeof(__pyx_k_StepTimer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_StepTimer */
  {__pyx_k_StepTimer___reduce_cython, sizeof(__pyx_k_StepTimer___reduce_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_StepTimer___reduce_cython */
  {__pyx_k_StepTimer___setstate_cython, sizeof(__pyx_k_StepTimer___setstate_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_StepTimer___setstate_cython */
  {__pyx_k_StepTimer_create, sizeof(__pyx_k_StepTimer_create), 0, 1, 1}, /* PyObject cname: __pyx_n_u_StepTimer_create */
  {__pyx_k_StepTimer_incr, sizeof(__pyx_k_StepTimer_incr), 0, 1, 1}, /* PyObject cname: __pyx_n_u_StepTimer_incr */
  {__pyx_k_StepTimer_update, sizeof(__pyx_k_StepTimer_update), 0, 1, 1}, /* PyObject cname: __pyx_n_u_StepTimer_update */
  {__pyx_k_Stub, sizeof(__pyx_k_Stub), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub */
  {__pyx_k_Stub___init, sizeof(__pyx_k_Stub___init), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub___init */
  {__pyx_k_Stub_calcCalcBCFn, sizeof(__pyx_k_Stub_calcCalcBCFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_calcCalcBCFn */
  {__pyx_k_Stub_calcExternalForcingFn, sizeof(__pyx_k_Stub_calcExternalForcingFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_calcExternalForcingFn */
  {__pyx_k_Stub_calcMisfitFn, sizeof(__pyx_k_Stub_calcMisfitFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_calcMisfitFn */
  {__pyx_k_Stub_calcMonitorFn, sizeof(__pyx_k_Stub_calcMonitorFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_calcMonitorFn */
  {__pyx_k_Stub_finalizeCalcBCFn, sizeof(__pyx_k_Stub_finalizeCalcBCFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_finalizeCalcBCFn */
  {__pyx_k_Stub_finalizeExternalForcingFn, sizeof(__pyx_k_Stub_finalizeExternalForcingFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_finalizeExternalForcingFn */
  {__pyx_k_Stub_finalizeMisfitFn, sizeof(__pyx_k_Stub_finalizeMisfitFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_finalizeMisfitFn */
  {__pyx_k_Stub_finalizeMonitorFn, sizeof(__pyx_k_Stub_finalizeMonitorFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_finalizeMonitorFn */
  {__pyx_k_Stub_iniCalcBCFn, sizeof(__pyx_k_Stub_iniCalcBCFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_iniCalcBCFn */
  {__pyx_k_Stub_iniExternalForcingFn, sizeof(__pyx_k_Stub_iniExternalForcingFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_iniExternalForcingFn */
  {__pyx_k_Stub_iniMisfitFn, sizeof(__pyx_k_Stub_iniMisfitFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_iniMisfitFn */
  {__pyx_k_Stub_iniMonitorFn, sizeof(__pyx_k_Stub_iniMonitorFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_iniMonitorFn */
  {__pyx_k_Stub_reInitializeCalcBCFn, sizeof(__pyx_k_Stub_reInitializeCalcBCFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_reInitializeCalcBCFn */
  {__pyx_k_Stub_reInitializeExternalForcing, sizeof(__pyx_k_Stub_reInitializeExternalForcing), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_reInitializeExternalForcing */
  {__pyx_k_Stub_writeCalcBCFn, sizeof(__pyx_k_Stub_writeCalcBCFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_writeCalcBCFn */
  {__pyx_k_Stub_writeExternalForcingFn, sizeof(__pyx_k_Stub_writeExternalForcingFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_writeExternalForcingFn */
  {__pyx_k_Stub_writeMisfitFn, sizeof(__pyx_k_Stub_writeMisfitFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_writeMisfitFn */
  {__pyx_k_Stub_writeMonitorFn, sizeof(__pyx_k_Stub_writeMonitorFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Stub_writeMonitorFn */
  {__pyx_k_TMMState, sizeof(__pyx_k_TMMState), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState */
  {__pyx_k_TMMState___reduce_cython, sizeof(__pyx_k_TMMState___reduce_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState___reduce_cython */
  {__pyx_k_TMMState___setstate_cython, sizeof(__pyx_k_TMMState___setstate_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState___setstate_cython */
  {__pyx_k_TMMState_create, sizeof(__pyx_k_TMMState_create), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_create */
  {__pyx_k_TMMState_destroy, sizeof(__pyx_k_TMMState_destroy), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_destroy */
  {__pyx_k_TMMState_forcingUpdate, sizeof(__pyx_k_TMMState_forcingUpdate), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_forcingUpdate */
  {__pyx_k_TMMState_getConfig, sizeof(__pyx_k_TMMState_getConfig), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_getConfig */
  {__pyx_k_TMMState_getNumTracers, sizeof(__pyx_k_TMMState_getNumTracers), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_getNumTracers */
  {__pyx_k_TMMState_loadTracerFromFile, sizeof(__pyx_k_TMMState_loadTracerFromFile), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_loadTracerFromFile */
  {__pyx_k_TMMState_output, sizeof(__pyx_k_TMMState_output), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_output */
  {__pyx_k_TMMState_pushConfigVar, sizeof(__pyx_k_TMMState_pushConfigVar), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_pushConfigVar */
  {__pyx_k_TMMState_setCalcCalcBCFunction, sizeof(__pyx_k_TMMState_setCalcCalcBCFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setCalcCalcBCFunction */
  {__pyx_k_TMMState_setCalcExternalForcingF, sizeof(__pyx_k_TMMState_setCalcExternalForcingF), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setCalcExternalForcingF */
  {__pyx_k_TMMState_setCalcMisfitFunction, sizeof(__pyx_k_TMMState_setCalcMisfitFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setCalcMisfitFunction */
  {__pyx_k_TMMState_setCalcMonitorFunction, sizeof(__pyx_k_TMMState_setCalcMonitorFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setCalcMonitorFunction */
  {__pyx_k_TMMState_setFinCalcBCFunction, sizeof(__pyx_k_TMMState_setFinCalcBCFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setFinCalcBCFunction */
  {__pyx_k_TMMState_setFinExternalForcingFu, sizeof(__pyx_k_TMMState_setFinExternalForcingFu), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setFinExternalForcingFu */
  {__pyx_k_TMMState_setFinMisfitFunction, sizeof(__pyx_k_TMMState_setFinMisfitFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setFinMisfitFunction */
  {__pyx_k_TMMState_setFinMonitorFunction, sizeof(__pyx_k_TMMState_setFinMonitorFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setFinMonitorFunction */
  {__pyx_k_TMMState_setFromOptions, sizeof(__pyx_k_TMMState_setFromOptions), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setFromOptions */
  {__pyx_k_TMMState_setIniCalcBCFunction, sizeof(__pyx_k_TMMState_setIniCalcBCFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setIniCalcBCFunction */
  {__pyx_k_TMMState_setIniExternalForcingFu, sizeof(__pyx_k_TMMState_setIniExternalForcingFu), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setIniExternalForcingFu */
  {__pyx_k_TMMState_setIniMisfitFunction, sizeof(__pyx_k_TMMState_setIniMisfitFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setIniMisfitFunction */
  {__pyx_k_TMMState_setIniMonitorFunction, sizeof(__pyx_k_TMMState_setIniMonitorFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setIniMonitorFunction */
  {__pyx_k_TMMState_setReiCalcBCFunction, sizeof(__pyx_k_TMMState_setReiCalcBCFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setReiCalcBCFunction */
  {__pyx_k_TMMState_setReiExternalForcingFu, sizeof(__pyx_k_TMMState_setReiExternalForcingFu), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setReiExternalForcingFu */
  {__pyx_k_TMMState_setTracer, sizeof(__pyx_k_TMMState_setTracer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setTracer */
  {__pyx_k_TMMState_setWriCalcBCFunction, sizeof(__pyx_k_TMMState_setWriCalcBCFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setWriCalcBCFunction */
  {__pyx_k_TMMState_setWriExternalForcingFu, sizeof(__pyx_k_TMMState_setWriExternalForcingFu), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setWriExternalForcingFu */
  {__pyx_k_TMMState_setWriMisfitFunction, sizeof(__pyx_k_TMMState_setWriMisfitFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setWriMisfitFunction */
  {__pyx_k_TMMState_setWriMonitorFunction, sizeof(__pyx_k_TMMState_setWriMonitorFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_setWriMonitorFunction */
  {__pyx_k_TMMState_timeStep, sizeof(__pyx_k_TMMState_timeStep), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_timeStep */
  {__pyx_k_TMMState_timeStepPost, sizeof(__pyx_k_TMMState_timeStepPost), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TMMState_timeStepPost */
  {__pyx_k_This_will_override_any_previous, sizeof(__pyx_k_This_will_override_any_previous), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_This_will_override_any_previous */
  {__pyx_k_TimeDependentArray, sizeof(__pyx_k_TimeDependentArray), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentArray */
  {__pyx_k_TimeDependentArray___reduce_cyth, sizeof(__pyx_k_TimeDependentArray___reduce_cyth), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentArray___reduce_cyth */
  {__pyx_k_TimeDependentArray___setstate_cy, sizeof(__pyx_k_TimeDependentArray___setstate_cy), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentArray___setstate_cy */
  {__pyx_k_TimeDependentArray_create, sizeof(__pyx_k_TimeDependentArray_create), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentArray_create */
  {__pyx_k_TimeDependentArray_destroy, sizeof(__pyx_k_TimeDependentArray_destroy), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentArray_destroy */
  {__pyx_k_TimeDependentArray_interp, sizeof(__pyx_k_TimeDependentArray_interp), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentArray_interp */
  {__pyx_k_TimeDependentTimer, sizeof(__pyx_k_TimeDependentTimer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentTimer */
  {__pyx_k_TimeDependentTimer___reduce_cyth, sizeof(__pyx_k_TimeDependentTimer___reduce_cyth), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentTimer___reduce_cyth */
  {__pyx_k_TimeDependentTimer___setstate_cy, sizeof(__pyx_k_TimeDependentTimer___setstate_cy), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentTimer___setstate_cy */
  {__pyx_k_TimeDependentTimer_create, sizeof(__pyx_k_TimeDependentTimer_create), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentTimer_create */
  {__pyx_k_TimeDependentVec, sizeof(__pyx_k_TimeDependentVec), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentVec */
  {__pyx_k_TimeDependentVec___reduce_cython, sizeof(__pyx_k_TimeDependentVec___reduce_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentVec___reduce_cython */
  {__pyx_k_TimeDependentVec___setstate_cyth, sizeof(__pyx_k_TimeDependentVec___setstate_cyth), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentVec___setstate_cyth */
  {__pyx_k_TimeDependentVec_create, sizeof(__pyx_k_TimeDependentVec_create), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentVec_create */
  {__pyx_k_TimeDependentVec_destroy, sizeof(__pyx_k_TimeDependentVec_destroy), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentVec_destroy */
  {__pyx_k_TimeDependentVec_interp, sizeof(__pyx_k_TimeDependentVec_interp), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TimeDependentVec_interp */
  {__pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 1, 1}, /* PyObject cname: __pyx_n_u_TypeError */
  {__pyx_k_Unknown_type_of_vector, sizeof(__pyx_k_Unknown_type_of_vector), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Unknown_type_of_vector */
  {__pyx_k_Vec, sizeof(__pyx_k_Vec), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Vec */
  {__pyx_k_Viewer, sizeof(__pyx_k_Viewer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_Viewer */
  {__pyx_k_Warning_no_options_database_valu, sizeof(__pyx_k_Warning_no_options_database_valu), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Warning_no_options_database_valu */
  {__pyx_k_Within_destroy_at_time, sizeof(__pyx_k_Within_destroy_at_time), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_Within_destroy_at_time */
  {__pyx_k__2, sizeof(__pyx_k__2), 0, 1, 0}, /* PyObject cname: __pyx_kp_u__2 */
  {__pyx_k__3, sizeof(__pyx_k__3), 0, 1, 0}, /* PyObject cname: __pyx_kp_u__3 */
  {__pyx_k__4, sizeof(__pyx_k__4), 0, 1, 0}, /* PyObject cname: __pyx_kp_u__4 */
  {__pyx_k__5, sizeof(__pyx_k__5), 0, 1, 0}, /* PyObject cname: __pyx_kp_u__5 */
  {__pyx_k_add_note, sizeof(__pyx_k_add_note), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_add_note */
  {__pyx_k_alpha, sizeof(__pyx_k_alpha), 0, 1, 1}, /* PyObject cname: __pyx_n_u_alpha */
  {__pyx_k_append, sizeof(__pyx_k_append), 0, 1, 1}, /* PyObject cname: __pyx_n_u_append */
  {__pyx_k_appendOutput, sizeof(__pyx_k_appendOutput), 0, 1, 1}, /* PyObject cname: __pyx_n_u_appendOutput */
  {__pyx_k_appendToFile, sizeof(__pyx_k_appendToFile), 0, 1, 1}, /* PyObject cname: __pyx_n_u_appendToFile */
  {__pyx_k_applyBC, sizeof(__pyx_k_applyBC), 0, 1, 1}, /* PyObject cname: __pyx_n_u_applyBC */
  {__pyx_k_applyExternalForcing, sizeof(__pyx_k_applyExternalForcing), 0, 1, 1}, /* PyObject cname: __pyx_n_u_applyExternalForcing */
  {__pyx_k_applyForcingFromFile, sizeof(__pyx_k_applyForcingFromFile), 0, 1, 1}, /* PyObject cname: __pyx_n_u_applyForcingFromFile */
  {__pyx_k_args, sizeof(__pyx_k_args), 0, 1, 1}, /* PyObject cname: __pyx_n_u_args */
  {__pyx_k_arr, sizeof(__pyx_k_arr), 0, 1, 1}, /* PyObject cname: __pyx_n_u_arr */
  {__pyx_k_arr_length_does_not_match_expect, sizeof(__pyx_k_arr_length_does_not_match_expect), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_arr_length_does_not_match_expect */
  {__pyx_k_array, sizeof(__pyx_k_array), 0, 1, 1}, /* PyObject cname: __pyx_n_u_array */
  {__pyx_k_arrayLength, sizeof(__pyx_k_arrayLength), 0, 1, 1}, /* PyObject cname: __pyx_n_u_arrayLength */
  {__pyx_k_array_2, sizeof(__pyx_k_array_2), 0, 1, 1}, /* PyObject cname: __pyx_n_u_array_2 */
  {__pyx_k_asyncio_coroutines, sizeof(__pyx_k_asyncio_coroutines), 0, 1, 1}, /* PyObject cname: __pyx_n_u_asyncio_coroutines */
  {__pyx_k_atexit, sizeof(__pyx_k_atexit), 0, 1, 1}, /* PyObject cname: __pyx_n_u_atexit */
  {__pyx_k_avgAppendOutput, sizeof(__pyx_k_avgAppendOutput), 0, 1, 1}, /* PyObject cname: __pyx_n_u_avgAppendOutput */
  {__pyx_k_barrier, sizeof(__pyx_k_barrier), 0, 1, 1}, /* PyObject cname: __pyx_n_u_barrier */
  {__pyx_k_buf, sizeof(__pyx_k_buf), 0, 1, 1}, /* PyObject cname: __pyx_n_u_buf */
  {__pyx_k_c, sizeof(__pyx_k_c), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_c */
  {__pyx_k_c_2, sizeof(__pyx_k_c_2), 0, 1, 1}, /* PyObject cname: __pyx_n_u_c_2 */
  {__pyx_k_c_filename, sizeof(__pyx_k_c_filename), 0, 1, 1}, /* PyObject cname: __pyx_n_u_c_filename */
  {__pyx_k_c_pre, sizeof(__pyx_k_c_pre), 0, 1, 1}, /* PyObject cname: __pyx_n_u_c_pre */
  {__pyx_k_c_pre2pre, sizeof(__pyx_k_c_pre2pre), 0, 1, 1}, /* PyObject cname: __pyx_n_u_c_pre2pre */
  {__pyx_k_c_tdp, sizeof(__pyx_k_c_tdp), 0, 1, 1}, /* PyObject cname: __pyx_n_u_c_tdp */
  {__pyx_k_c_tdt, sizeof(__pyx_k_c_tdt), 0, 1, 1}, /* PyObject cname: __pyx_n_u_c_tdt */
  {__pyx_k_calcCalcBCFn, sizeof(__pyx_k_calcCalcBCFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_calcCalcBCFn */
  {__pyx_k_calcExternalForcingFn, sizeof(__pyx_k_calcExternalForcingFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_calcExternalForcingFn */
  {__pyx_k_calcMisfitFn, sizeof(__pyx_k_calcMisfitFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_calcMisfitFn */
  {__pyx_k_calcMonitorFn, sizeof(__pyx_k_calcMonitorFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_calcMonitorFn */
  {__pyx_k_cbc, sizeof(__pyx_k_cbc), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_cbc */
  {__pyx_k_cbc_2, sizeof(__pyx_k_cbc_2), 0, 1, 1}, /* PyObject cname: __pyx_n_u_cbc_2 */
  {__pyx_k_cbf, sizeof(__pyx_k_cbf), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_cbf */
  {__pyx_k_cbf_2, sizeof(__pyx_k_cbf_2), 0, 1, 1}, /* PyObject cname: __pyx_n_u_cbf_2 */
  {__pyx_k_cleanUp, sizeof(__pyx_k_cleanUp), 0, 1, 1}, /* PyObject cname: __pyx_n_u_cleanUp */
  {__pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 1, 1}, /* PyObject cname: __pyx_n_u_cline_in_traceback */
  {__pyx_k_comm, sizeof(__pyx_k_comm), 0, 1, 1}, /* PyObject cname: __pyx_n_u_comm */
  {__pyx_k_config, sizeof(__pyx_k_config), 0, 1, 1}, /* PyObject cname: __pyx_n_u_config */
  {__pyx_k_configVars, sizeof(__pyx_k_configVars), 0, 1, 1}, /* PyObject cname: __pyx_n_u_configVars */
  {__pyx_k_constantBC, sizeof(__pyx_k_constantBC), 0, 1, 1}, /* PyObject cname: __pyx_n_u_constantBC */
  {__pyx_k_constantForcing, sizeof(__pyx_k_constantForcing), 0, 1, 1}, /* PyObject cname: __pyx_n_u_constantForcing */
  {__pyx_k_context, sizeof(__pyx_k_context), 0, 1, 1}, /* PyObject cname: __pyx_n_u_context */
  {__pyx_k_copy, sizeof(__pyx_k_copy), 0, 1, 1}, /* PyObject cname: __pyx_n_u_copy */
  {__pyx_k_create, sizeof(__pyx_k_create), 0, 1, 1}, /* PyObject cname: __pyx_n_u_create */
  {__pyx_k_createBinary, sizeof(__pyx_k_createBinary), 0, 1, 1}, /* PyObject cname: __pyx_n_u_createBinary */
  {__pyx_k_createWithArray, sizeof(__pyx_k_createWithArray), 0, 1, 1}, /* PyObject cname: __pyx_n_u_createWithArray */
  {__pyx_k_cyclePeriod, sizeof(__pyx_k_cyclePeriod), 0, 1, 1}, /* PyObject cname: __pyx_n_u_cyclePeriod */
  {__pyx_k_cycle_period, sizeof(__pyx_k_cycle_period), 0, 1, 1}, /* PyObject cname: __pyx_n_u_cycle_period */
  {__pyx_k_data_pointer, sizeof(__pyx_k_data_pointer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_data_pointer */
  {__pyx_k_debug, sizeof(__pyx_k_debug), 0, 1, 1}, /* PyObject cname: __pyx_n_u_debug */
  {__pyx_k_deltaTClock, sizeof(__pyx_k_deltaTClock), 0, 1, 1}, /* PyObject cname: __pyx_n_u_deltaTClock */
  {__pyx_k_deltaTClockret, sizeof(__pyx_k_deltaTClockret), 0, 1, 1}, /* PyObject cname: __pyx_n_u_deltaTClockret */
  {__pyx_k_destroy, sizeof(__pyx_k_destroy), 0, 1, 1}, /* PyObject cname: __pyx_n_u_destroy */
  {__pyx_k_disable, sizeof(__pyx_k_disable), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_disable */
  {__pyx_k_doCalcBC, sizeof(__pyx_k_doCalcBC), 0, 1, 1}, /* PyObject cname: __pyx_n_u_doCalcBC */
  {__pyx_k_doExtraWrite, sizeof(__pyx_k_doExtraWrite), 0, 1, 1}, /* PyObject cname: __pyx_n_u_doExtraWrite */
  {__pyx_k_doMisfit, sizeof(__pyx_k_doMisfit), 0, 1, 1}, /* PyObject cname: __pyx_n_u_doMisfit */
  {__pyx_k_doOutput, sizeof(__pyx_k_doOutput), 0, 1, 1}, /* PyObject cname: __pyx_n_u_doOutput */
  {__pyx_k_doTimeAverage, sizeof(__pyx_k_doTimeAverage), 0, 1, 1}, /* PyObject cname: __pyx_n_u_doTimeAverage */
  {__pyx_k_doWriteBC, sizeof(__pyx_k_doWriteBC), 0, 1, 1}, /* PyObject cname: __pyx_n_u_doWriteBC */
  {__pyx_k_doWriteQEF, sizeof(__pyx_k_doWriteQEF), 0, 1, 1}, /* PyObject cname: __pyx_n_u_doWriteQEF */
  {__pyx_k_doWriteQF, sizeof(__pyx_k_doWriteQF), 0, 1, 1}, /* PyObject cname: __pyx_n_u_doWriteQF */
  {__pyx_k_doc, sizeof(__pyx_k_doc), 0, 1, 1}, /* PyObject cname: __pyx_n_u_doc */
  {__pyx_k_does_not_equal_yarr_length, sizeof(__pyx_k_does_not_equal_yarr_length), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_does_not_equal_yarr_length */
  {__pyx_k_does_not_match_size_specified_i, sizeof(__pyx_k_does_not_match_size_specified_i), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_does_not_match_size_specified_i */
  {__pyx_k_dot, sizeof(__pyx_k_dot), 0, 1, 1}, /* PyObject cname: __pyx_n_u_dot */
  {__pyx_k_dotProd, sizeof(__pyx_k_dotProd), 0, 1, 1}, /* PyObject cname: __pyx_n_u_dotProd */
  {__pyx_k_dotProdProfileScalarData, sizeof(__pyx_k_dotProdProfileScalarData), 0, 1, 1}, /* PyObject cname: __pyx_n_u_dotProdProfileScalarData */
  {__pyx_k_dotProdVecs, sizeof(__pyx_k_dotProdVecs), 0, 1, 1}, /* PyObject cname: __pyx_n_u_dotProdVecs */
  {__pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 1, 1}, /* PyObject cname: __pyx_n_u_dtype */
  {__pyx_k_enable, sizeof(__pyx_k_enable), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_enable */
  {__pyx_k_encode, sizeof(__pyx_k_encode), 0, 1, 1}, /* PyObject cname: __pyx_n_u_encode */
  {__pyx_k_filename, sizeof(__pyx_k_filename), 0, 1, 1}, /* PyObject cname: __pyx_n_u_filename */
  {__pyx_k_finalize, sizeof(__pyx_k_finalize), 0, 1, 1}, /* PyObject cname: __pyx_n_u_finalize */
  {__pyx_k_finalizeCalcBCFn, sizeof(__pyx_k_finalizeCalcBCFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_finalizeCalcBCFn */
  {__pyx_k_finalizeExternalForcingFn, sizeof(__pyx_k_finalizeExternalForcingFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_finalizeExternalForcingFn */
  {__pyx_k_finalizeMisfitFn, sizeof(__pyx_k_finalizeMisfitFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_finalizeMisfitFn */
  {__pyx_k_finalizeMonitorFn, sizeof(__pyx_k_finalizeMonitorFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_finalizeMonitorFn */
  {__pyx_k_for, sizeof(__pyx_k_for), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_for */
  {__pyx_k_forcingUpdate, sizeof(__pyx_k_forcingUpdate), 0, 1, 1}, /* PyObject cname: __pyx_n_u_forcingUpdate */
  {__pyx_k_freeing_data, sizeof(__pyx_k_freeing_data), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_freeing_data */
  {__pyx_k_func, sizeof(__pyx_k_func), 0, 1, 1}, /* PyObject cname: __pyx_n_u_func */
  {__pyx_k_func_2, sizeof(__pyx_k_func_2), 0, 1, 1}, /* PyObject cname: __pyx_n_u_func_2 */
  {__pyx_k_gc, sizeof(__pyx_k_gc), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_gc */
  {__pyx_k_getBCSizes, sizeof(__pyx_k_getBCSizes), 0, 1, 1}, /* PyObject cname: __pyx_n_u_getBCSizes */
  {__pyx_k_getBCSizes_failed_because_no_pre, sizeof(__pyx_k_getBCSizes_failed_because_no_pre), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_getBCSizes_failed_because_no_pre */
  {__pyx_k_getConfig, sizeof(__pyx_k_getConfig), 0, 1, 1}, /* PyObject cname: __pyx_n_u_getConfig */
  {__pyx_k_getInt, sizeof(__pyx_k_getInt), 0, 1, 1}, /* PyObject cname: __pyx_n_u_getInt */
  {__pyx_k_getNumTracers, sizeof(__pyx_k_getNumTracers), 0, 1, 1}, /* PyObject cname: __pyx_n_u_getNumTracers */
  {__pyx_k_getProfileConfig, sizeof(__pyx_k_getProfileConfig), 0, 1, 1}, /* PyObject cname: __pyx_n_u_getProfileConfig */
  {__pyx_k_getRank, sizeof(__pyx_k_getRank), 0, 1, 1}, /* PyObject cname: __pyx_n_u_getRank */
  {__pyx_k_getSizes, sizeof(__pyx_k_getSizes), 0, 1, 1}, /* PyObject cname: __pyx_n_u_getSizes */
  {__pyx_k_getString, sizeof(__pyx_k_getString), 0, 1, 1}, /* PyObject cname: __pyx_n_u_getString */
  {__pyx_k_getTimeConfig, sizeof(__pyx_k_getTimeConfig), 0, 1, 1}, /* PyObject cname: __pyx_n_u_getTimeConfig */
  {__pyx_k_getstate, sizeof(__pyx_k_getstate), 0, 1, 1}, /* PyObject cname: __pyx_n_u_getstate */
  {__pyx_k_globalScalarSum, sizeof(__pyx_k_globalScalarSum), 0, 1, 1}, /* PyObject cname: __pyx_n_u_globalScalarSum */
  {__pyx_k_globalSum, sizeof(__pyx_k_globalSum), 0, 1, 1}, /* PyObject cname: __pyx_n_u_globalSum */
  {__pyx_k_hasName, sizeof(__pyx_k_hasName), 0, 1, 1}, /* PyObject cname: __pyx_n_u_hasName */
  {__pyx_k_iLoop, sizeof(__pyx_k_iLoop), 0, 1, 1}, /* PyObject cname: __pyx_n_u_iLoop */
  {__pyx_k_iLoopc, sizeof(__pyx_k_iLoopc), 0, 1, 1}, /* PyObject cname: __pyx_n_u_iLoopc */
  {__pyx_k_iRec, sizeof(__pyx_k_iRec), 0, 1, 1}, /* PyObject cname: __pyx_n_u_iRec */
  {__pyx_k_iRecc, sizeof(__pyx_k_iRecc), 0, 1, 1}, /* PyObject cname: __pyx_n_u_iRecc */
  {__pyx_k_ierr, sizeof(__pyx_k_ierr), 0, 1, 1}, /* PyObject cname: __pyx_n_u_ierr */
  {__pyx_k_incr, sizeof(__pyx_k_incr), 0, 1, 1}, /* PyObject cname: __pyx_n_u_incr */
  {__pyx_k_index, sizeof(__pyx_k_index), 0, 1, 1}, /* PyObject cname: __pyx_n_u_index */
  {__pyx_k_iniCalcBCFn, sizeof(__pyx_k_iniCalcBCFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_iniCalcBCFn */
  {__pyx_k_iniExternalForcingFn, sizeof(__pyx_k_iniExternalForcingFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_iniExternalForcingFn */
  {__pyx_k_iniMisfitFn, sizeof(__pyx_k_iniMisfitFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_iniMisfitFn */
  {__pyx_k_iniMonitorFn, sizeof(__pyx_k_iniMonitorFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_iniMonitorFn */
  {__pyx_k_init, sizeof(__pyx_k_init), 0, 1, 1}, /* PyObject cname: __pyx_n_u_init */
  {__pyx_k_initialize, sizeof(__pyx_k_initialize), 0, 1, 1}, /* PyObject cname: __pyx_n_u_initialize */
  {__pyx_k_initializing, sizeof(__pyx_k_initializing), 0, 1, 1}, /* PyObject cname: __pyx_n_u_initializing */
  {__pyx_k_insert, sizeof(__pyx_k_insert), 0, 1, 1}, /* PyObject cname: __pyx_n_u_insert */
  {__pyx_k_interp, sizeof(__pyx_k_interp), 0, 1, 1}, /* PyObject cname: __pyx_n_u_interp */
  {__pyx_k_isInitializedCalcBC, sizeof(__pyx_k_isInitializedCalcBC), 0, 1, 1}, /* PyObject cname: __pyx_n_u_isInitializedCalcBC */
  {__pyx_k_isInitializedExternalForcing, sizeof(__pyx_k_isInitializedExternalForcing), 0, 1, 1}, /* PyObject cname: __pyx_n_u_isInitializedExternalForcing */
  {__pyx_k_is_coroutine, sizeof(__pyx_k_is_coroutine), 0, 1, 1}, /* PyObject cname: __pyx_n_u_is_coroutine */
  {__pyx_k_isenabled, sizeof(__pyx_k_isenabled), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_isenabled */
  {__pyx_k_item, sizeof(__pyx_k_item), 0, 1, 1}, /* PyObject cname: __pyx_n_u_item */
  {__pyx_k_itr, sizeof(__pyx_k_itr), 0, 1, 1}, /* PyObject cname: __pyx_n_u_itr */
  {__pyx_k_k, sizeof(__pyx_k_k), 0, 1, 1}, /* PyObject cname: __pyx_n_u_k */
  {__pyx_k_key, sizeof(__pyx_k_key), 0, 1, 1}, /* PyObject cname: __pyx_n_u_key */
  {__pyx_k_keys, sizeof(__pyx_k_keys), 0, 1, 1}, /* PyObject cname: __pyx_n_u_keys */
  {__pyx_k_kwargs, sizeof(__pyx_k_kwargs), 0, 1, 1}, /* PyObject cname: __pyx_n_u_kwargs */
  {__pyx_k_lDim, sizeof(__pyx_k_lDim), 0, 1, 1}, /* PyObject cname: __pyx_n_u_lDim */
  {__pyx_k_lEndIndices, sizeof(__pyx_k_lEndIndices), 0, 1, 1}, /* PyObject cname: __pyx_n_u_lEndIndices */
  {__pyx_k_lNumProfiles, sizeof(__pyx_k_lNumProfiles), 0, 1, 1}, /* PyObject cname: __pyx_n_u_lNumProfiles */
  {__pyx_k_lProfileLength, sizeof(__pyx_k_lProfileLength), 0, 1, 1}, /* PyObject cname: __pyx_n_u_lProfileLength */
  {__pyx_k_lSize, sizeof(__pyx_k_lSize), 0, 1, 1}, /* PyObject cname: __pyx_n_u_lSize */
  {__pyx_k_lStartIndices, sizeof(__pyx_k_lStartIndices), 0, 1, 1}, /* PyObject cname: __pyx_n_u_lStartIndices */
  {__pyx_k_loadTracerFromFile, sizeof(__pyx_k_loadTracerFromFile), 0, 1, 1}, /* PyObject cname: __pyx_n_u_loadTracerFromFile */
  {__pyx_k_loadVecIntoArray, sizeof(__pyx_k_loadVecIntoArray), 0, 1, 1}, /* PyObject cname: __pyx_n_u_loadVecIntoArray */
  {__pyx_k_main, sizeof(__pyx_k_main), 0, 1, 1}, /* PyObject cname: __pyx_n_u_main */
  {__pyx_k_maxSteps, sizeof(__pyx_k_maxSteps), 0, 1, 1}, /* PyObject cname: __pyx_n_u_maxSteps */
  {__pyx_k_maxStepsret, sizeof(__pyx_k_maxStepsret), 0, 1, 1}, /* PyObject cname: __pyx_n_u_maxStepsret */
  {__pyx_k_metaclass, sizeof(__pyx_k_metaclass), 0, 1, 1}, /* PyObject cname: __pyx_n_u_metaclass */
  {__pyx_k_mode, sizeof(__pyx_k_mode), 0, 1, 1}, /* PyObject cname: __pyx_n_u_mode */
  {__pyx_k_module, sizeof(__pyx_k_module), 0, 1, 1}, /* PyObject cname: __pyx_n_u_module */
  {__pyx_k_mpi4py, sizeof(__pyx_k_mpi4py), 0, 1, 1}, /* PyObject cname: __pyx_n_u_mpi4py */
  {__pyx_k_mro_entries, sizeof(__pyx_k_mro_entries), 0, 1, 1}, /* PyObject cname: __pyx_n_u_mro_entries */
  {__pyx_k_myId, sizeof(__pyx_k_myId), 0, 1, 1}, /* PyObject cname: __pyx_n_u_myId */
  {__pyx_k_n, sizeof(__pyx_k_n), 0, 1, 1}, /* PyObject cname: __pyx_n_u_n */
  {__pyx_k_name, sizeof(__pyx_k_name), 0, 1, 1}, /* PyObject cname: __pyx_n_u_name */
  {__pyx_k_ndarray, sizeof(__pyx_k_ndarray), 0, 1, 1}, /* PyObject cname: __pyx_n_u_ndarray */
  {__pyx_k_newarr, sizeof(__pyx_k_newarr), 0, 1, 1}, /* PyObject cname: __pyx_n_u_newarr */
  {__pyx_k_newstate, sizeof(__pyx_k_newstate), 0, 1, 1}, /* PyObject cname: __pyx_n_u_newstate */
  {__pyx_k_newtimer, sizeof(__pyx_k_newtimer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_newtimer */
  {__pyx_k_newvec, sizeof(__pyx_k_newvec), 0, 1, 1}, /* PyObject cname: __pyx_n_u_newvec */
  {__pyx_k_nl, sizeof(__pyx_k_nl), 0, 1, 1}, /* PyObject cname: __pyx_n_u_nl */
  {__pyx_k_no_default___reduce___due_to_non, sizeof(__pyx_k_no_default___reduce___due_to_non), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_no_default___reduce___due_to_non */
  {__pyx_k_np, sizeof(__pyx_k_np), 0, 1, 1}, /* PyObject cname: __pyx_n_u_np */
  {__pyx_k_nparr, sizeof(__pyx_k_nparr), 0, 1, 1}, /* PyObject cname: __pyx_n_u_nparr */
  {__pyx_k_numTracers, sizeof(__pyx_k_numTracers), 0, 1, 1}, /* PyObject cname: __pyx_n_u_numTracers */
  {__pyx_k_numValsPerProfile, sizeof(__pyx_k_numValsPerProfile), 0, 1, 1}, /* PyObject cname: __pyx_n_u_numValsPerProfile */
  {__pyx_k_num_per_period, sizeof(__pyx_k_num_per_period), 0, 1, 1}, /* PyObject cname: __pyx_n_u_num_per_period */
  {__pyx_k_num_times, sizeof(__pyx_k_num_times), 0, 1, 1}, /* PyObject cname: __pyx_n_u_num_times */
  {__pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 1, 1}, /* PyObject cname: __pyx_n_u_numpy */
  {__pyx_k_numpy__core_multiarray_failed_to, sizeof(__pyx_k_numpy__core_multiarray_failed_to), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_numpy__core_multiarray_failed_to */
  {__pyx_k_numpy__core_umath_failed_to_impo, sizeof(__pyx_k_numpy__core_umath_failed_to_impo), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_numpy__core_umath_failed_to_impo */
  {__pyx_k_nx, sizeof(__pyx_k_nx), 0, 1, 1}, /* PyObject cname: __pyx_n_u_nx */
  {__pyx_k_ny, sizeof(__pyx_k_ny), 0, 1, 1}, /* PyObject cname: __pyx_n_u_ny */
  {__pyx_k_output, sizeof(__pyx_k_output), 0, 1, 1}, /* PyObject cname: __pyx_n_u_output */
  {__pyx_k_periodicBC, sizeof(__pyx_k_periodicBC), 0, 1, 1}, /* PyObject cname: __pyx_n_u_periodicBC */
  {__pyx_k_periodicForcing, sizeof(__pyx_k_periodicForcing), 0, 1, 1}, /* PyObject cname: __pyx_n_u_periodicForcing */
  {__pyx_k_petsc4py, sizeof(__pyx_k_petsc4py), 0, 1, 1}, /* PyObject cname: __pyx_n_u_petsc4py */
  {__pyx_k_pickupFromFile, sizeof(__pyx_k_pickupFromFile), 0, 1, 1}, /* PyObject cname: __pyx_n_u_pickupFromFile */
  {__pyx_k_pop, sizeof(__pyx_k_pop), 0, 1, 1}, /* PyObject cname: __pyx_n_u_pop */
  {__pyx_k_pre, sizeof(__pyx_k_pre), 0, 1, 1}, /* PyObject cname: __pyx_n_u_pre */
  {__pyx_k_prefix, sizeof(__pyx_k_prefix), 0, 1, 1}, /* PyObject cname: __pyx_n_u_prefix */
  {__pyx_k_prefix2prefix, sizeof(__pyx_k_prefix2prefix), 0, 1, 1}, /* PyObject cname: __pyx_n_u_prefix2prefix */
  {__pyx_k_prepare, sizeof(__pyx_k_prepare), 0, 1, 1}, /* PyObject cname: __pyx_n_u_prepare */
  {__pyx_k_print, sizeof(__pyx_k_print), 0, 1, 1}, /* PyObject cname: __pyx_n_u_print */
  {__pyx_k_profileVars, sizeof(__pyx_k_profileVars), 0, 1, 1}, /* PyObject cname: __pyx_n_u_profileVars */
  {__pyx_k_pushConfigVar, sizeof(__pyx_k_pushConfigVar), 0, 1, 1}, /* PyObject cname: __pyx_n_u_pushConfigVar */
  {__pyx_k_pyx_state, sizeof(__pyx_k_pyx_state), 0, 1, 1}, /* PyObject cname: __pyx_n_u_pyx_state */
  {__pyx_k_pyx_vtable, sizeof(__pyx_k_pyx_vtable), 0, 1, 1}, /* PyObject cname: __pyx_n_u_pyx_vtable */
  {__pyx_k_qef, sizeof(__pyx_k_qef), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_qef */
  {__pyx_k_qef_2, sizeof(__pyx_k_qef_2), 0, 1, 1}, /* PyObject cname: __pyx_n_u_qef_2 */
  {__pyx_k_qf, sizeof(__pyx_k_qf), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_qf */
  {__pyx_k_qf_2, sizeof(__pyx_k_qf_2), 0, 1, 1}, /* PyObject cname: __pyx_n_u_qf_2 */
  {__pyx_k_qrel, sizeof(__pyx_k_qrel), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_qrel */
  {__pyx_k_qrel_2, sizeof(__pyx_k_qrel_2), 0, 1, 1}, /* PyObject cname: __pyx_n_u_qrel_2 */
  {__pyx_k_qualname, sizeof(__pyx_k_qualname), 0, 1, 1}, /* PyObject cname: __pyx_n_u_qualname */
  {__pyx_k_r, sizeof(__pyx_k_r), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_r */
  {__pyx_k_range, sizeof(__pyx_k_range), 0, 1, 1}, /* PyObject cname: __pyx_n_u_range */
  {__pyx_k_rank, sizeof(__pyx_k_rank), 0, 1, 1}, /* PyObject cname: __pyx_n_u_rank */
  {__pyx_k_reInitializeCalcBCFn, sizeof(__pyx_k_reInitializeCalcBCFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_reInitializeCalcBCFn */
  {__pyx_k_reInitializeExternalForcingFn, sizeof(__pyx_k_reInitializeExternalForcingFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_reInitializeExternalForcingFn */
  {__pyx_k_readProfileScalarData, sizeof(__pyx_k_readProfileScalarData), 0, 1, 1}, /* PyObject cname: __pyx_n_u_readProfileScalarData */
  {__pyx_k_reduce, sizeof(__pyx_k_reduce), 0, 1, 1}, /* PyObject cname: __pyx_n_u_reduce */
  {__pyx_k_reduce_cython, sizeof(__pyx_k_reduce_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_reduce_cython */
  {__pyx_k_reduce_ex, sizeof(__pyx_k_reduce_ex), 0, 1, 1}, /* PyObject cname: __pyx_n_u_reduce_ex */
  {__pyx_k_register, sizeof(__pyx_k_register), 0, 1, 1}, /* PyObject cname: __pyx_n_u_register */
  {__pyx_k_relaxTracer, sizeof(__pyx_k_relaxTracer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_relaxTracer */
  {__pyx_k_res, sizeof(__pyx_k_res), 0, 1, 1}, /* PyObject cname: __pyx_n_u_res */
  {__pyx_k_s, sizeof(__pyx_k_s), 0, 1, 1}, /* PyObject cname: __pyx_n_u_s */
  {__pyx_k_self, sizeof(__pyx_k_self), 0, 1, 1}, /* PyObject cname: __pyx_n_u_self */
  {__pyx_k_self_data_ptr_cannot_be_converte, sizeof(__pyx_k_self_data_ptr_cannot_be_converte), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_self_data_ptr_cannot_be_converte */
  {__pyx_k_self_data_ptr_self_pv_cannot_be, sizeof(__pyx_k_self_data_ptr_self_pv_cannot_be), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_self_data_ptr_self_pv_cannot_be */
  {__pyx_k_setCalcCalcBCFunction, sizeof(__pyx_k_setCalcCalcBCFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setCalcCalcBCFunction */
  {__pyx_k_setCalcCalcBCFunction_failed_cal, sizeof(__pyx_k_setCalcCalcBCFunction_failed_cal), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setCalcCalcBCFunction_failed_cal */
  {__pyx_k_setCalcExternalForcingFunction, sizeof(__pyx_k_setCalcExternalForcingFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setCalcExternalForcingFunction */
  {__pyx_k_setCalcExternalForcingFunction_f, sizeof(__pyx_k_setCalcExternalForcingFunction_f), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setCalcExternalForcingFunction_f */
  {__pyx_k_setCalcMisfitFunction, sizeof(__pyx_k_setCalcMisfitFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setCalcMisfitFunction */
  {__pyx_k_setCalcMisfitFunction_failed_cal, sizeof(__pyx_k_setCalcMisfitFunction_failed_cal), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setCalcMisfitFunction_failed_cal */
  {__pyx_k_setCalcMonitorFunction, sizeof(__pyx_k_setCalcMonitorFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setCalcMonitorFunction */
  {__pyx_k_setCalcMonitorFunction_failed_us, sizeof(__pyx_k_setCalcMonitorFunction_failed_us), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setCalcMonitorFunction_failed_us */
  {__pyx_k_setFinCalcBCFunction, sizeof(__pyx_k_setFinCalcBCFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setFinCalcBCFunction */
  {__pyx_k_setFinCalcBCFunction_failed_calc, sizeof(__pyx_k_setFinCalcBCFunction_failed_calc), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setFinCalcBCFunction_failed_calc */
  {__pyx_k_setFinExternalForcingFunction, sizeof(__pyx_k_setFinExternalForcingFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setFinExternalForcingFunction */
  {__pyx_k_setFinExternalForcingFunction_fa, sizeof(__pyx_k_setFinExternalForcingFunction_fa), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setFinExternalForcingFunction_fa */
  {__pyx_k_setFinMisfitFunction, sizeof(__pyx_k_setFinMisfitFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setFinMisfitFunction */
  {__pyx_k_setFinMisfitFunction_failed_calc, sizeof(__pyx_k_setFinMisfitFunction_failed_calc), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setFinMisfitFunction_failed_calc */
  {__pyx_k_setFinMonitorFunction, sizeof(__pyx_k_setFinMonitorFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setFinMonitorFunction */
  {__pyx_k_setFinMonitorFunction_failed_use, sizeof(__pyx_k_setFinMonitorFunction_failed_use), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setFinMonitorFunction_failed_use */
  {__pyx_k_setFromOptions, sizeof(__pyx_k_setFromOptions), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setFromOptions */
  {__pyx_k_setIniCalcBCFunction, sizeof(__pyx_k_setIniCalcBCFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setIniCalcBCFunction */
  {__pyx_k_setIniCalcBCFunction_failed_calc, sizeof(__pyx_k_setIniCalcBCFunction_failed_calc), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setIniCalcBCFunction_failed_calc */
  {__pyx_k_setIniExternalForcingFunction, sizeof(__pyx_k_setIniExternalForcingFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setIniExternalForcingFunction */
  {__pyx_k_setIniExternalForcingFunction_fa, sizeof(__pyx_k_setIniExternalForcingFunction_fa), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setIniExternalForcingFunction_fa */
  {__pyx_k_setIniMisfitFunction, sizeof(__pyx_k_setIniMisfitFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setIniMisfitFunction */
  {__pyx_k_setIniMisfitFunction_failed_calc, sizeof(__pyx_k_setIniMisfitFunction_failed_calc), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setIniMisfitFunction_failed_calc */
  {__pyx_k_setIniMonitorFunction, sizeof(__pyx_k_setIniMonitorFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setIniMonitorFunction */
  {__pyx_k_setIniMonitorFunction_failed_use, sizeof(__pyx_k_setIniMonitorFunction_failed_use), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setIniMonitorFunction_failed_use */
  {__pyx_k_setReiCalcBCFunction, sizeof(__pyx_k_setReiCalcBCFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setReiCalcBCFunction */
  {__pyx_k_setReiCalcBCFunction_failed_calc, sizeof(__pyx_k_setReiCalcBCFunction_failed_calc), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setReiCalcBCFunction_failed_calc */
  {__pyx_k_setReiExternalForcingFunction, sizeof(__pyx_k_setReiExternalForcingFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setReiExternalForcingFunction */
  {__pyx_k_setReiExternalForcingFunction_fa, sizeof(__pyx_k_setReiExternalForcingFunction_fa), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setReiExternalForcingFunction_fa */
  {__pyx_k_setTracer, sizeof(__pyx_k_setTracer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setTracer */
  {__pyx_k_setValue, sizeof(__pyx_k_setValue), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setValue */
  {__pyx_k_setWriCalcBCFunction, sizeof(__pyx_k_setWriCalcBCFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setWriCalcBCFunction */
  {__pyx_k_setWriCalcBCFunction_failed_calc, sizeof(__pyx_k_setWriCalcBCFunction_failed_calc), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setWriCalcBCFunction_failed_calc */
  {__pyx_k_setWriExternalForcingFunction, sizeof(__pyx_k_setWriExternalForcingFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setWriExternalForcingFunction */
  {__pyx_k_setWriExternalForcingFunction_fa, sizeof(__pyx_k_setWriExternalForcingFunction_fa), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setWriExternalForcingFunction_fa */
  {__pyx_k_setWriMisfitFunction, sizeof(__pyx_k_setWriMisfitFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setWriMisfitFunction */
  {__pyx_k_setWriMisfitFunction_failed_calc, sizeof(__pyx_k_setWriMisfitFunction_failed_calc), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setWriMisfitFunction_failed_calc */
  {__pyx_k_setWriMonitorFunction, sizeof(__pyx_k_setWriMonitorFunction), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setWriMonitorFunction */
  {__pyx_k_setWriMonitorFunction_failed_use, sizeof(__pyx_k_setWriMonitorFunction_failed_use), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_setWriMonitorFunction_failed_use */
  {__pyx_k_set_name, sizeof(__pyx_k_set_name), 0, 1, 1}, /* PyObject cname: __pyx_n_u_set_name */
  {__pyx_k_setitem, sizeof(__pyx_k_setitem), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setitem */
  {__pyx_k_setstate, sizeof(__pyx_k_setstate), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setstate */
  {__pyx_k_setstate_cython, sizeof(__pyx_k_setstate_cython), 0, 1, 1}, /* PyObject cname: __pyx_n_u_setstate_cython */
  {__pyx_k_shape, sizeof(__pyx_k_shape), 0, 1, 1}, /* PyObject cname: __pyx_n_u_shape */
  {__pyx_k_spec, sizeof(__pyx_k_spec), 0, 1, 1}, /* PyObject cname: __pyx_n_u_spec */
  {__pyx_k_split, sizeof(__pyx_k_split), 0, 1, 1}, /* PyObject cname: __pyx_n_u_split */
  {__pyx_k_startTimeStep, sizeof(__pyx_k_startTimeStep), 0, 1, 1}, /* PyObject cname: __pyx_n_u_startTimeStep */
  {__pyx_k_state, sizeof(__pyx_k_state), 0, 1, 1}, /* PyObject cname: __pyx_n_u_state */
  {__pyx_k_statescreated, sizeof(__pyx_k_statescreated), 0, 1, 1}, /* PyObject cname: __pyx_n_u_statescreated */
  {__pyx_k_stringsource, sizeof(__pyx_k_stringsource), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_stringsource */
  {__pyx_k_sval, sizeof(__pyx_k_sval), 0, 1, 1}, /* PyObject cname: __pyx_n_u_sval */
  {__pyx_k_sys, sizeof(__pyx_k_sys), 0, 1, 1}, /* PyObject cname: __pyx_n_u_sys */
  {__pyx_k_tc, sizeof(__pyx_k_tc), 0, 1, 1}, /* PyObject cname: __pyx_n_u_tc */
  {__pyx_k_tcc, sizeof(__pyx_k_tcc), 0, 1, 1}, /* PyObject cname: __pyx_n_u_tcc */
  {__pyx_k_tconfig, sizeof(__pyx_k_tconfig), 0, 1, 1}, /* PyObject cname: __pyx_n_u_tconfig */
  {__pyx_k_tdp, sizeof(__pyx_k_tdp), 0, 1, 1}, /* PyObject cname: __pyx_n_u_tdp */
  {__pyx_k_tdt, sizeof(__pyx_k_tdt), 0, 1, 1}, /* PyObject cname: __pyx_n_u_tdt */
  {__pyx_k_test, sizeof(__pyx_k_test), 0, 1, 1}, /* PyObject cname: __pyx_n_u_test */
  {__pyx_k_tf, sizeof(__pyx_k_tf), 0, 1, 1}, /* PyObject cname: __pyx_n_u_tf */
  {__pyx_k_time0, sizeof(__pyx_k_time0), 0, 1, 1}, /* PyObject cname: __pyx_n_u_time0 */
  {__pyx_k_time0ret, sizeof(__pyx_k_time0ret), 0, 1, 1}, /* PyObject cname: __pyx_n_u_time0ret */
  {__pyx_k_timeDependentBC, sizeof(__pyx_k_timeDependentBC), 0, 1, 1}, /* PyObject cname: __pyx_n_u_timeDependentBC */
  {__pyx_k_timeDependentForcing, sizeof(__pyx_k_timeDependentForcing), 0, 1, 1}, /* PyObject cname: __pyx_n_u_timeDependentForcing */
  {__pyx_k_timeStep, sizeof(__pyx_k_timeStep), 0, 1, 1}, /* PyObject cname: __pyx_n_u_timeStep */
  {__pyx_k_timeStepPost, sizeof(__pyx_k_timeStepPost), 0, 1, 1}, /* PyObject cname: __pyx_n_u_timeStepPost */
  {__pyx_k_timer, sizeof(__pyx_k_timer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_timer */
  {__pyx_k_tmm4py_tmm4py_core, sizeof(__pyx_k_tmm4py_tmm4py_core), 0, 1, 1}, /* PyObject cname: __pyx_n_u_tmm4py_tmm4py_core */
  {__pyx_k_tmm4py_tmm4py_core_pyx, sizeof(__pyx_k_tmm4py_tmm4py_core_pyx), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_tmm4py_tmm4py_core_pyx */
  {__pyx_k_tot, sizeof(__pyx_k_tot), 0, 1, 1}, /* PyObject cname: __pyx_n_u_tot */
  {__pyx_k_totalNumProfiles, sizeof(__pyx_k_totalNumProfiles), 0, 1, 1}, /* PyObject cname: __pyx_n_u_totalNumProfiles */
  {__pyx_k_tracer, sizeof(__pyx_k_tracer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_tracer */
  {__pyx_k_tracer_names, sizeof(__pyx_k_tracer_names), 0, 1, 1}, /* PyObject cname: __pyx_n_u_tracer_names */
  {__pyx_k_typ, sizeof(__pyx_k_typ), 0, 1, 1}, /* PyObject cname: __pyx_n_u_typ */
  {__pyx_k_update, sizeof(__pyx_k_update), 0, 1, 1}, /* PyObject cname: __pyx_n_u_update */
  {__pyx_k_updateTMs, sizeof(__pyx_k_updateTMs), 0, 1, 1}, /* PyObject cname: __pyx_n_u_updateTMs */
  {__pyx_k_useExternalForcing, sizeof(__pyx_k_useExternalForcing), 0, 1, 1}, /* PyObject cname: __pyx_n_u_useExternalForcing */
  {__pyx_k_useForcingFromFile, sizeof(__pyx_k_useForcingFromFile), 0, 1, 1}, /* PyObject cname: __pyx_n_u_useForcingFromFile */
  {__pyx_k_useMonitor, sizeof(__pyx_k_useMonitor), 0, 1, 1}, /* PyObject cname: __pyx_n_u_useMonitor */
  {__pyx_k_usePrescribedBC, sizeof(__pyx_k_usePrescribedBC), 0, 1, 1}, /* PyObject cname: __pyx_n_u_usePrescribedBC */
  {__pyx_k_useProfiles, sizeof(__pyx_k_useProfiles), 0, 1, 1}, /* PyObject cname: __pyx_n_u_useProfiles */
  {__pyx_k_val, sizeof(__pyx_k_val), 0, 1, 1}, /* PyObject cname: __pyx_n_u_val */
  {__pyx_k_view, sizeof(__pyx_k_view), 0, 1, 1}, /* PyObject cname: __pyx_n_u_view */
  {__pyx_k_viewer, sizeof(__pyx_k_viewer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_viewer */
  {__pyx_k_warnings, sizeof(__pyx_k_warnings), 0, 1, 1}, /* PyObject cname: __pyx_n_u_warnings */
  {__pyx_k_when_loading, sizeof(__pyx_k_when_loading), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_when_loading */
  {__pyx_k_writeArrayToVec, sizeof(__pyx_k_writeArrayToVec), 0, 1, 1}, /* PyObject cname: __pyx_n_u_writeArrayToVec */
  {__pyx_k_writeBinaryArray, sizeof(__pyx_k_writeBinaryArray), 0, 1, 1}, /* PyObject cname: __pyx_n_u_writeBinaryArray */
  {__pyx_k_writeCalcBCFn, sizeof(__pyx_k_writeCalcBCFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_writeCalcBCFn */
  {__pyx_k_writeExternalForcingFn, sizeof(__pyx_k_writeExternalForcingFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_writeExternalForcingFn */
  {__pyx_k_writeMisfitFn, sizeof(__pyx_k_writeMisfitFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_writeMisfitFn */
  {__pyx_k_writeMonitorFn, sizeof(__pyx_k_writeMonitorFn), 0, 1, 1}, /* PyObject cname: __pyx_n_u_writeMonitorFn */
  {__pyx_k_writePickup, sizeof(__pyx_k_writePickup), 0, 1, 1}, /* PyObject cname: __pyx_n_u_writePickup */
  {__pyx_k_writeProfileScalarData, sizeof(__pyx_k_writeProfileScalarData), 0, 1, 1}, /* PyObject cname: __pyx_n_u_writeProfileScalarData */
  {__pyx_k_x, sizeof(__pyx_k_x), 0, 1, 1}, /* PyObject cname: __pyx_n_u_x */
  {__pyx_k_xarr, sizeof(__pyx_k_xarr), 0, 1, 1}, /* PyObject cname: __pyx_n_u_xarr */
  {__pyx_k_xarr_length, sizeof(__pyx_k_xarr_length), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_xarr_length */
  {__pyx_k_xarr_length_does_not_match_expec, sizeof(__pyx_k_xarr_length_does_not_match_expec), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_xarr_length_does_not_match_expec */
  {__pyx_k_xc, sizeof(__pyx_k_xc), 0, 1, 1}, /* PyObject cname: __pyx_n_u_xc */
  {__pyx_k_xdata_pointer, sizeof(__pyx_k_xdata_pointer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_xdata_pointer */
  {__pyx_k_y, sizeof(__pyx_k_y), 0, 1, 1}, /* PyObject cname: __pyx_n_u_y */
  {__pyx_k_yarr, sizeof(__pyx_k_yarr), 0, 1, 1}, /* PyObject cname: __pyx_n_u_yarr */
  {__pyx_k_yarr_length_does_not_match_expec, sizeof(__pyx_k_yarr_length_does_not_match_expec), 0, 1, 0}, /* PyObject cname: __pyx_kp_u_yarr_length_does_not_match_expec */
  {__pyx_k_ydata_pointer, sizeof(__pyx_k_ydata_pointer), 0, 1, 1}, /* PyObject cname: __pyx_n_u_ydata_pointer */
  {0, 0, 0, 0, 0}
};
/* InitStrings.proto */
static int __Pyx_InitStrings(__Pyx_StringTabEntry const *t, PyObject **target, const char* const* encoding_names);

/* #### Code section: cached_builtins ### */

static int __Pyx_InitCachedBuiltins(__pyx_mstatetype *__pyx_mstate) {
  CYTHON_UNUSED_VAR(__pyx_mstate);
  __pyx_builtin_RuntimeError = __Pyx_GetBuiltinName(__pyx_mstate->__pyx_n_u_RuntimeError); if (!__pyx_builtin_RuntimeError) __PYX_ERR(0, 305, __pyx_L1_error)
  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_mstate->__pyx_n_u_print); if (!__pyx_builtin_print) __PYX_ERR(0, 418, __pyx_L1_error)
  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_mstate->__pyx_n_u_range); if (!__pyx_builtin_range) __PYX_ERR(0, 683, __pyx_L1_error)
  __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_mstate->__pyx_n_u_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 2, __pyx_L1_error)
  __pyx_builtin_KeyError = __Pyx_GetBuiltinName(__pyx_mstate->__pyx_n_u_KeyError); if (!__pyx_builtin_KeyError) __PYX_ERR(0, 1049, __pyx_L1_error)
  __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_mstate->__pyx_n_u_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(3, 1026, __pyx_L1_error)
  return 0;
  __pyx_L1_error:;
  return -1;
}
/* #### Code section: cached_constants ### */

static int __Pyx_InitCachedConstants(__pyx_mstatetype *__pyx_mstate) {
  __Pyx_RefNannyDeclarations
  CYTHON_UNUSED_VAR(__pyx_mstate);
  __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);

  /* "tmm4py/tmm4py_core.pyx":659
 *         return toInt(self.state.numTracers)
 * 
 *     def setFromOptions(self, prefix="", doOutput=True):             # <<<<<<<<<<<<<<
 *         cdef const char* pre
 *         cdef PetscScalar *data_pointer
*/
  __pyx_mstate_global->__pyx_tuple[0] = PyTuple_Pack(2, __pyx_mstate_global->__pyx_kp_u_, Py_True); if (unlikely(!__pyx_mstate_global->__pyx_tuple[0])) __PYX_ERR(0, 659, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_mstate_global->__pyx_tuple[0]);
  __Pyx_GIVEREF(__pyx_mstate_global->__pyx_tuple[0]);

  /* "tmm4py/tmm4py_core.pyx":831
 * #             raise RuntimeError(f"TMMDestroy failed with error code {ierr}")
 * 
 *     def setTracer(self, alpha, itr=0):             # <<<<<<<<<<<<<<
 *         cdef PetscScalar sval = asReal(alpha)
 *         cdef PetscErrorCode ierr
*/
  __pyx_mstate_global->__pyx_tuple[1] = PyTuple_Pack(1, __pyx_mstate_global->__pyx_int_0); if (unlikely(!__pyx_mstate_global->__pyx_tuple[1])) __PYX_ERR(0, 831, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_mstate_global->__pyx_tuple[1]);
  __Pyx_GIVEREF(__pyx_mstate_global->__pyx_tuple[1]);

  /* "tmm4py/tmm4py_core.pyx":984
 *         pass
 * 
 *     def create(self, prefix="", prefix2prefix=None, PetscInt startTimeStep=0):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_pre
*/
  __pyx_mstate_global->__pyx_tuple[2] = PyTuple_Pack(3, __pyx_mstate_global->__pyx_kp_u_, Py_None, __pyx_mstate_global->__pyx_int_0); if (unlikely(!__pyx_mstate_global->__pyx_tuple[2])) __PYX_ERR(0, 984, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_mstate_global->__pyx_tuple[2]);
  __Pyx_GIVEREF(__pyx_mstate_global->__pyx_tuple[2]);

  /* "tmm4py/tmm4py_core.pyx":1026
 *         pass
 * 
 *     def create(self, prefix="", prefix2prefix=None, np.ndarray[double, ndim=1, mode="c"] tdp=None, cyclePeriod=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_pre
*/
  __pyx_mstate_global->__pyx_tuple[3] = PyTuple_Pack(4, __pyx_mstate_global->__pyx_kp_u_, Py_None, Py_None, Py_None); if (unlikely(!__pyx_mstate_global->__pyx_tuple[3])) __PYX_ERR(0, 1026, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_mstate_global->__pyx_tuple[3]);
  __Pyx_GIVEREF(__pyx_mstate_global->__pyx_tuple[3]);

  /* "tmm4py/tmm4py_core.pyx":1080
 *         pass
 * 
 *     def create(self, prefix="", prefix2prefix=None, np.ndarray[double, ndim=1, mode="c"] tdt=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef const char* c_pre
*/
  __pyx_mstate_global->__pyx_tuple[4] = PyTuple_Pack(3, __pyx_mstate_global->__pyx_kp_u_, Py_None, Py_None); if (unlikely(!__pyx_mstate_global->__pyx_tuple[4])) __PYX_ERR(0, 1080, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_mstate_global->__pyx_tuple[4]);
  __Pyx_GIVEREF(__pyx_mstate_global->__pyx_tuple[4]);

  /* "tmm4py/tmm4py_core.pyx":1130
 *         pass
 * 
 *     def create(self, typ='tracer', np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscPeriodicVec newvec
*/
  __pyx_mstate_global->__pyx_tuple[5] = PyTuple_Pack(2, __pyx_mstate_global->__pyx_n_u_tracer, Py_None); if (unlikely(!__pyx_mstate_global->__pyx_tuple[5])) __PYX_ERR(0, 1130, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_mstate_global->__pyx_tuple[5]);
  __Pyx_GIVEREF(__pyx_mstate_global->__pyx_tuple[5]);

  /* "tmm4py/tmm4py_core.pyx":1250
 *         pass
 * 
 *     def create(self, arrayLength, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *         cdef PetscErrorCode ierr
 *         cdef PetscPeriodicArray newarr
*/
  __pyx_mstate_global->__pyx_tuple[6] = PyTuple_Pack(1, Py_None); if (unlikely(!__pyx_mstate_global->__pyx_tuple[6])) __PYX_ERR(0, 1250, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_mstate_global->__pyx_tuple[6]);
  __Pyx_GIVEREF(__pyx_mstate_global->__pyx_tuple[6]);

  /* "tmm4py/tmm4py_core.pyx":1363
 * #       Note: the memory is owned by the array buf
 * 
 * def readProfileScalarData(filename, numValsPerProfile=1, np.ndarray[double, ndim=1, mode="c"] buf=None):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *data_pointer
*/
  __pyx_mstate_global->__pyx_tuple[7] = PyTuple_Pack(2, ((PyObject*)__pyx_mstate_global->__pyx_int_1), Py_None); if (unlikely(!__pyx_mstate_global->__pyx_tuple[7])) __PYX_ERR(0, 1363, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_mstate_global->__pyx_tuple[7]);
  __Pyx_GIVEREF(__pyx_mstate_global->__pyx_tuple[7]);

  /* "tmm4py/tmm4py_core.pyx":1386
 * #       Note: the memory is owned by the array buf
 * 
 * def writeProfileScalarData(filename, np.ndarray[double, ndim=1, mode="c"] arr not None, numValsPerProfile=1, appendToFile=False):             # <<<<<<<<<<<<<<
 *     cdef PetscErrorCode ierr
 *     cdef PetscScalar *data_pointer
*/
  __pyx_mstate_global->__pyx_tuple[8] = PyTuple_Pack(2, ((PyObject*)__pyx_mstate_global->__pyx_int_1), ((PyObject*)Py_False)); if (unlikely(!__pyx_mstate_global->__pyx_tuple[8])) __PYX_ERR(0, 1386, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_mstate_global->__pyx_tuple[8]);
  __Pyx_GIVEREF(__pyx_mstate_global->__pyx_tuple[8]);

  /* "tmm4py/tmm4py_core.pyx":1420
 *     c.destroy()
 * 
 * def writeBinaryArray(filename, np.ndarray[double, ndim=1, mode="c"] arr not None, appendToFile=False):             # <<<<<<<<<<<<<<
 * #   Note: writeBinaryScalarData only writes on rank 0. You can call this from all ranks
 *     cdef PetscErrorCode ierr
*/
  __pyx_mstate_global->__pyx_tuple[9] = PyTuple_Pack(1, ((PyObject*)Py_False)); if (unlikely(!__pyx_mstate_global->__pyx_tuple[9])) __PYX_ERR(0, 1420, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_mstate_global->__pyx_tuple[9]);
  __Pyx_GIVEREF(__pyx_mstate_global->__pyx_tuple[9]);

  /* "tmm4py/tmm4py_core.pyx":1566
 *         self.myId = myId
 * 
 *     def __array__(self, dtype=None, copy=None):             # <<<<<<<<<<<<<<
 *         cdef np.npy_intp shape[1]
 *         shape[0] = <np.npy_intp> self.size
*/
  __pyx_mstate_global->__pyx_tuple[10] = PyTuple_Pack(2, Py_None, Py_None); if (unlikely(!__pyx_mstate_global->__pyx_tuple[10])) __PYX_ERR(0, 1566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_mstate_global->__pyx_tuple[10]);
  __Pyx_GIVEREF(__pyx_mstate_global->__pyx_tuple[10]);
  __Pyx_RefNannyFinishContext();
  return 0;
  __pyx_L1_error:;
  __Pyx_RefNannyFinishContext();
  return -1;
}
/* #### Code section: init_constants ### */

static int __Pyx_InitConstants(__pyx_mstatetype *__pyx_mstate) {
  CYTHON_UNUSED_VAR(__pyx_mstate);
  __pyx_mstate->__pyx_umethod_PyDict_Type_pop.type = (PyObject*)&PyDict_Type;
  __pyx_mstate->__pyx_umethod_PyDict_Type_pop.method_name = &__pyx_mstate->__pyx_n_u_pop;
  if (__Pyx_InitStrings(__pyx_string_tab, __pyx_mstate->__pyx_string_tab, __pyx_string_tab_encodings) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
  __pyx_mstate->__pyx_int_0 = PyLong_FromLong(0); if (unlikely(!__pyx_mstate->__pyx_int_0)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_mstate->__pyx_int_1 = PyLong_FromLong(1); if (unlikely(!__pyx_mstate->__pyx_int_1)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_mstate->__pyx_int_neg_1 = PyLong_FromLong(-1); if (unlikely(!__pyx_mstate->__pyx_int_neg_1)) __PYX_ERR(0, 1, __pyx_L1_error)
  return 0;
  __pyx_L1_error:;
  return -1;
}
/* #### Code section: init_codeobjects ### */
\
        typedef struct {
            unsigned int argcount : 3;
            unsigned int num_posonly_args : 1;
            unsigned int num_kwonly_args : 1;
            unsigned int nlocals : 5;
            unsigned int flags : 10;
            unsigned int first_line : 11;
            unsigned int line_table_length : 15;
        } __Pyx_PyCode_New_function_description;
/* NewCodeObj.proto */
static PyObject* __Pyx_PyCode_New(
        const __Pyx_PyCode_New_function_description descr,
        PyObject * const *varnames,
        PyObject *filename,
        PyObject *funcname,
        const char *line_table,
        PyObject *tuple_dedup_map
);


static int __Pyx_CreateCodeObjects(__pyx_mstatetype *__pyx_mstate) {
  PyObject* tuple_dedup_map = PyDict_New();
  if (unlikely(!tuple_dedup_map)) return -1;
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 3, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 304, 11};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_index, __pyx_mstate->__pyx_n_u_item};
    __pyx_mstate_global->__pyx_codeobj_tab[0] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setitem, __pyx_k_aq, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[0])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 3, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 306, 11};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_index, __pyx_mstate->__pyx_n_u_item};
    __pyx_mstate_global->__pyx_codeobj_tab[1] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_insert, __pyx_k_aq, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[1])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 308, 11};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_item};
    __pyx_mstate_global->__pyx_codeobj_tab[2] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_append, __pyx_k_Qa, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[2])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 3, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 313, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_Id, __pyx_mstate->__pyx_n_u_prefix};
    __pyx_mstate_global->__pyx_codeobj_tab[3] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_init, __pyx_k_A, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[3])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 4, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 315, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iter, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[4] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_iniExternalForcingFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[4])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {5, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 317, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iter, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[5] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_calcExternalForcingFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[5])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {5, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 319, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iter, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[6] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_writeExternalForcingFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[6])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 4, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 321, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iter, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[7] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_finalizeExternalForcingFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[7])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {5, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 323, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iter, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[8] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_reInitializeExternalForcingFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[8])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {6, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 325, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iterc, __pyx_mstate->__pyx_n_u_tf, __pyx_mstate->__pyx_n_u_Iterf, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[9] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_iniCalcBCFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[9])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {7, 0, 0, 7, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 327, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iterc, __pyx_mstate->__pyx_n_u_tf, __pyx_mstate->__pyx_n_u_Iterf, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[10] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_calcCalcBCFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[10])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {5, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 329, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iter, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[11] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_writeCalcBCFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[11])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 4, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 331, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iter, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[12] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_finalizeCalcBCFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[12])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {5, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 333, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iter, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[13] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_reInitializeCalcBCFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[13])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 4, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 335, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iter, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[14] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_iniMonitorFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[14])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 4, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 337, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[15] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_calcMonitorFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[15])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 4, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 339, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[16] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_writeMonitorFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[16])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 4, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 341, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iter, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[17] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_finalizeMonitorFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[17])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 4, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 343, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iter, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[18] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_iniMisfitFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[18])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 4, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 345, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[19] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_calcMisfitFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[19])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 4, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 347, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[20] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_writeMisfitFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[20])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 4, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 349, 2};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iter, __pyx_mstate->__pyx_n_u_state};
    __pyx_mstate_global->__pyx_codeobj_tab[21] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_finalizeMisfitFn, __pyx_k_A_2, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[21])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 3, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 389, 46};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_newstate};
    __pyx_mstate_global->__pyx_codeobj_tab[22] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_create, __pyx_k_A_y_5_3fE_q_G1_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[22])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 412, 124};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[23] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setIniExternalForcingFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_we1B_1D_8NgU, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[23])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 427, 107};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[24] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setCalcExternalForcingFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1_AT_9PPWWX, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[24])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 440, 106};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[25] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setWriExternalForcingFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1D_8NgUV_1D, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[25])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 453, 106};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[26] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setFinExternalForcingFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1D_8NgUV_1D, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[26])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 466, 106};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[27] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setReiExternalForcingFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1D_8NgUV_1D, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[27])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 479, 104};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[28] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setIniCalcBCFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1_4x_G1_4xvQ, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[28])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 492, 104};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[29] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setCalcCalcBCFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_A_1D_gQ_1D_a, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[29])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 505, 104};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[30] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setWriCalcBCFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1_4x_G1_4xvQ, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[30])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 518, 104};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[31] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setFinCalcBCFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1_4x_G1_4xvQ, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[31])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 531, 104};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[32] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setReiCalcBCFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1_4x_G1_4xvQ, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[32])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 544, 120};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[33] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setIniMonitorFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1_we1B_6a_1D, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[33])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 558, 104};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[34] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setCalcMonitorFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_A_AT_q_AT_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[34])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 571, 104};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[35] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setWriMonitorFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1_1D_gQ_1D_a, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[35])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 584, 104};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[36] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setFinMonitorFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1_1D_gQ_1D_a, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[36])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 597, 104};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[37] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setIniMisfitFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1_4x_G1_4xvQ, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[37])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 610, 104};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[38] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setCalcMisfitFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_A_1D_gQ_1D_a, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[38])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 623, 104};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[39] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setWriMisfitFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1_4x_G1_4xvQ, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[39])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS), 636, 104};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_func, __pyx_mstate->__pyx_n_u_args, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_context, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[40] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setFinMisfitFunction, __pyx_k_A_4t7_1_aq_5_q_vV81_1_4x_G1_4xvQ, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[40])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 649, 18};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_config};
    __pyx_mstate_global->__pyx_codeobj_tab[41] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_getConfig, __pyx_k_A_4q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[41])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 656, 15};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[42] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_getNumTracers, __pyx_k_A_uAT_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[42])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 22, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 659, 1017};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_prefix, __pyx_mstate->__pyx_n_u_doOutput, __pyx_mstate->__pyx_n_u_pre, __pyx_mstate->__pyx_n_u_data_pointer, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_OptDBState, __pyx_mstate->__pyx_n_u_rank, __pyx_mstate->__pyx_n_u_c_2, __pyx_mstate->__pyx_n_u_itr, __pyx_mstate->__pyx_n_u_myId, __pyx_mstate->__pyx_n_u_qf_2, __pyx_mstate->__pyx_n_u_qef_2, __pyx_mstate->__pyx_n_u_qrel_2, __pyx_mstate->__pyx_n_u_cbc_2, __pyx_mstate->__pyx_n_u_cbf_2, __pyx_mstate->__pyx_n_u_itr, __pyx_mstate->__pyx_n_u_itr, __pyx_mstate->__pyx_n_u_itr, __pyx_mstate->__pyx_n_u_itr, __pyx_mstate->__pyx_n_u_itr, __pyx_mstate->__pyx_n_u_itr};
    __pyx_mstate_global->__pyx_codeobj_tab[43] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setFromOptions, __pyx_k_M_avWA_XU_5_3fE_q_IU_4vQ_L_Qd_H, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[43])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 8, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 746, 66};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iterc, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_tcc, __pyx_mstate->__pyx_n_u_Itercc, __pyx_mstate->__pyx_n_u_iLoopc, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[44] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_forcingUpdate, __pyx_k_A_vQa_uAQ_uAQ_q_XXT_5_3fE_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[44])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 8, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 756, 65};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iterc, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_tcc, __pyx_mstate->__pyx_n_u_Itercc, __pyx_mstate->__pyx_n_u_iLoopc, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[45] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_timeStep, __pyx_k_A_vQa_uAQ_uAQ_5_A_5_3fE_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[45])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 8, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 766, 67};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iterc, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_tcc, __pyx_mstate->__pyx_n_u_Itercc, __pyx_mstate->__pyx_n_u_iLoopc, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[46] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_timeStepPost, __pyx_k_A_vQa_uAQ_uAQ_auG7_a_5_3fE_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[46])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 8, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 777, 67};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_Iterc, __pyx_mstate->__pyx_n_u_iLoop, __pyx_mstate->__pyx_n_u_tcc, __pyx_mstate->__pyx_n_u_Itercc, __pyx_mstate->__pyx_n_u_iLoopc, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[47] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_output, __pyx_k_A_vQa_uAQ_uAQ_y_hhd_5_3fE_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[47])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 4, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS), 788, 138};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_kwargs, __pyx_mstate->__pyx_n_u_key, __pyx_mstate->__pyx_n_u_val};
    __pyx_mstate_global->__pyx_codeobj_tab[48] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_pushConfigVar, __pyx_k_A_G1_S_aq_t1E_L_4F_1_A_aq_t1E_L, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[48])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 3, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 803, 142};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[49] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_destroy, __pyx_k_A_7_q_5Q_4q_A_4q_A_4q_A_4q_A_4q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[49])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 831, 52};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_alpha, __pyx_mstate->__pyx_n_u_itr, __pyx_mstate->__pyx_n_u_sval, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[50] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_setTracer, __pyx_k_1_aq_vQd_6_5_3fE_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[50])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {5, 0, 0, 9, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 837, 239};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_typ, __pyx_mstate->__pyx_n_u_filename, __pyx_mstate->__pyx_n_u_itr, __pyx_mstate->__pyx_n_u_iRec, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_c_filename, __pyx_mstate->__pyx_n_u_iRecc, __pyx_mstate->__pyx_n_u_nl};
    __pyx_mstate_global->__pyx_codeobj_tab[51] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_loadTracerFromFile, __pyx_k_E_q_1HG1_S_Q_4A_F_AVSXXYY___5_3, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[51])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[52] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_reduce_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[52])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 3, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_pyx_state};
    __pyx_mstate_global->__pyx_codeobj_tab[53] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_setstate_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[53])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {0, 0, 0, 3, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 859, 110};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_tconfig, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_s};
    __pyx_mstate_global->__pyx_codeobj_tab[54] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_cleanUp, __pyx_k_M_G1N_7_1_QoQa_d_1_Qb_4A_xq_we1, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[54])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {0, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 871, 75};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_Iter0ret, __pyx_mstate->__pyx_n_u_maxStepsret, __pyx_mstate->__pyx_n_u_time0ret, __pyx_mstate->__pyx_n_u_deltaTClockret, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[55] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_initialize, __pyx_k_A_Qa_uCs_V1A_5_E_a, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[55])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 3, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 888, 39};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_tcc};
    __pyx_mstate_global->__pyx_codeobj_tab[56] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_updateTMs, __pyx_k_6_q_uCs_V1A, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[56])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 3, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 896, 39};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_tcc};
    __pyx_mstate_global->__pyx_codeobj_tab[57] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_finalize, __pyx_k_6_aq_uCs_V1A, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[57])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {0, 0, 0, 3, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 904, 203};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_config, __pyx_mstate->__pyx_n_u_k, __pyx_mstate->__pyx_n_u_key};
    __pyx_mstate_global->__pyx_codeobj_tab[58] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_getProfileConfig, __pyx_k_Qe6_WA_vQa_a_aq_E_uA_Rs_AU_q_Rs, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[58])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {0, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 926, 46};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_config};
    __pyx_mstate_global->__pyx_codeobj_tab[59] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_getTimeConfig, __pyx_k_iuAXYfAX_a_Ziiooppq_1, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[59])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {0, 0, 0, 0, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 930, 17};
    PyObject* const varnames[] = {0};
    __pyx_mstate_global->__pyx_codeobj_tab[60] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_getSizes, __pyx_k_5_e1A, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[60])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {0, 0, 0, 0, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 933, 35};
    PyObject* const varnames[] = {0};
    __pyx_mstate_global->__pyx_codeobj_tab[61] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_getBCSizes, __pyx_k_vQa_U_U_1_L, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[61])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 8, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 984, 168};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_prefix, __pyx_mstate->__pyx_n_u_prefix2prefix, __pyx_mstate->__pyx_n_u_startTimeStep, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_c_pre, __pyx_mstate->__pyx_n_u_c_pre2pre, __pyx_mstate->__pyx_n_u_newtimer};
    __pyx_mstate_global->__pyx_codeobj_tab[62] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_create, __pyx_k_K1_wa_A_a_a_G1_aq_5_3fE_q_G1_1G, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[62])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 3, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1006, 69};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_Iter, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[63] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_update, __pyx_k_A_avT_5_3fE_q_IT_q_T_q_D_a, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[63])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1014, 30};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[64] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_incr, __pyx_k_A_F_4vWBa_IT_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[64])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[65] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_reduce_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[65])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 3, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_pyx_state};
    __pyx_mstate_global->__pyx_codeobj_tab[66] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_setstate_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[66])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {5, 0, 0, 13, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1026, 355};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_prefix, __pyx_mstate->__pyx_n_u_prefix2prefix, __pyx_mstate->__pyx_n_u_tdp, __pyx_mstate->__pyx_n_u_cyclePeriod, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_c_pre, __pyx_mstate->__pyx_n_u_c_pre2pre, __pyx_mstate->__pyx_n_u_c_tdp, __pyx_mstate->__pyx_n_u_newtimer, __pyx_mstate->__pyx_n_u_OptDB, __pyx_mstate->__pyx_n_u_pre, __pyx_mstate->__pyx_n_u_n};
    __pyx_mstate_global->__pyx_codeobj_tab[67] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_create, __pyx_k_oop_XQ_A_a_m1A_4s_WAS_3c_l_2_c, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[67])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[68] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_reduce_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[68])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 3, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_pyx_state};
    __pyx_mstate_global->__pyx_codeobj_tab[69] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_setstate_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[69])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 12, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1080, 311};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_prefix, __pyx_mstate->__pyx_n_u_prefix2prefix, __pyx_mstate->__pyx_n_u_tdt, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_c_pre, __pyx_mstate->__pyx_n_u_c_pre2pre, __pyx_mstate->__pyx_n_u_c_tdt, __pyx_mstate->__pyx_n_u_newtimer, __pyx_mstate->__pyx_n_u_OptDB, __pyx_mstate->__pyx_n_u_pre, __pyx_mstate->__pyx_n_u_n};
    __pyx_mstate_global->__pyx_codeobj_tab[70] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_create, __pyx_k_XQ_A_a_m1A_4s_WAS_3c_l_2_c_B_G, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[70])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[71] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_reduce_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[71])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 3, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_pyx_state};
    __pyx_mstate_global->__pyx_codeobj_tab[72] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_setstate_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[72])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1130, 287};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_typ, __pyx_mstate->__pyx_n_u_buf, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_newvec, __pyx_mstate->__pyx_n_u_data_pointer};
    __pyx_mstate_global->__pyx_codeobj_tab[73] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_create, __pyx_k_LA_5_3fE_q_F_4s_s_c_ha_ha_4s_k, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[73])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 7, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1164, 93};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_timer, __pyx_mstate->__pyx_n_u_filename, __pyx_mstate->__pyx_n_u_tcc, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_c_filename};
    __pyx_mstate_global->__pyx_codeobj_tab[74] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_interp, __pyx_k_A_vQa_QhgQ_at4uF_VSbbggmmssww_5, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[74])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1173, 76};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[75] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_destroy, __pyx_k_A_D_z_4q_5_3fE_q_4q_5_3fE_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[75])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[76] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_reduce_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[76])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 3, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_pyx_state};
    __pyx_mstate_global->__pyx_codeobj_tab[77] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_setstate_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[77])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1190, 287};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_typ, __pyx_mstate->__pyx_n_u_buf, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_newvec, __pyx_mstate->__pyx_n_u_data_pointer};
    __pyx_mstate_global->__pyx_codeobj_tab[78] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_create, __pyx_k_LA_Qaq_5_3fE_q_F_4s_s_c_ha_ha_4, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[78])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 7, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1224, 84};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_timer, __pyx_mstate->__pyx_n_u_filename, __pyx_mstate->__pyx_n_u_tcc, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_c_filename};
    __pyx_mstate_global->__pyx_codeobj_tab[79] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_interp, __pyx_k_A_vQa_QhgQ_Qe1D_E_vU___ffg_5_3fE, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[79])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1233, 76};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[80] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_destroy, __pyx_k_A_D_z_4q_5_3fE_q_aq_A_5_3fE_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[80])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[81] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_reduce_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[81])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 3, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_pyx_state};
    __pyx_mstate_global->__pyx_codeobj_tab[82] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_setstate_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[82])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1250, 199};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_arrayLength, __pyx_mstate->__pyx_n_u_buf, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_newarr};
    __pyx_mstate_global->__pyx_codeobj_tab[83] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_create, __pyx_k_K1_1HA_5_3fE_q_F_HA_4s_k_l_4uAQ, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[83])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 7, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1275, 123};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_timer, __pyx_mstate->__pyx_n_u_filename, __pyx_mstate->__pyx_n_u_tcc, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_c_filename};
    __pyx_mstate_global->__pyx_codeobj_tab[84] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_interp, __pyx_k_A_vQa_QhgQ_5Qe4_eSYYggllr_s_B_B, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[84])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1284, 44};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[85] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_destroy, __pyx_k_A_D_1AT_5_3fE_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[85])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[86] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_reduce_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[86])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 3, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_pyx_state};
    __pyx_mstate_global->__pyx_codeobj_tab[87] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_setstate_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[87])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1299, 199};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_arrayLength, __pyx_mstate->__pyx_n_u_buf, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_newarr};
    __pyx_mstate_global->__pyx_codeobj_tab[88] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_create, __pyx_k_K1_q_5_3fE_q_F_HA_4s_k_l_4uAQ_g, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[88])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 7, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1324, 95};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_tc, __pyx_mstate->__pyx_n_u_timer, __pyx_mstate->__pyx_n_u_filename, __pyx_mstate->__pyx_n_u_tcc, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_c_filename};
    __pyx_mstate_global->__pyx_codeobj_tab[89] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_interp, __pyx_k_A_vQa_QhgQ_5_OSXX_iinnttzz_F_F_G, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[89])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1333, 44};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[90] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_destroy, __pyx_k_A_D_a_5_3fE_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[90])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[91] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_reduce_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[91])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 3, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_pyx_state};
    __pyx_mstate_global->__pyx_codeobj_tab[92] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_setstate_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[92])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1341, 144};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_filename, __pyx_mstate->__pyx_n_u_buf, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_data_pointer, __pyx_mstate->__pyx_n_u_c_filename, __pyx_mstate->__pyx_n_u_nparr};
    __pyx_mstate_global->__pyx_codeobj_tab[93] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_loadVecIntoArray, __pyx_k_q_t3a_1E_q_1_5_3fE_q_fA_q_q_1A, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[93])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 8, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1363, 184};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_filename, __pyx_mstate->__pyx_n_u_numValsPerProfile, __pyx_mstate->__pyx_n_u_buf, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_data_pointer, __pyx_mstate->__pyx_n_u_c_filename, __pyx_mstate->__pyx_n_u_lDim, __pyx_mstate->__pyx_n_u_nparr};
    __pyx_mstate_global->__pyx_codeobj_tab[94] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_readProfileScalarData, __pyx_k_9_q_t3a_1D_1K_A_5_3fE_q_V1_q_3a, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[94])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {4, 0, 0, 8, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1386, 119};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_filename, __pyx_mstate->__pyx_n_u_arr, __pyx_mstate->__pyx_n_u_numValsPerProfile, __pyx_mstate->__pyx_n_u_appendToFile, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_data_pointer, __pyx_mstate->__pyx_n_u_c_filename, __pyx_mstate->__pyx_n_u_lDim};
    __pyx_mstate_global->__pyx_codeobj_tab[95] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_writeProfileScalarData, __pyx_k_XXmmn_q_s_5_1_L_I_1Cq_5_I_ccdde, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[95])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1400, 77};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_filename, __pyx_mstate->__pyx_n_u_arr, __pyx_mstate->__pyx_n_u_mode, __pyx_mstate->__pyx_n_u_c_2, __pyx_mstate->__pyx_n_u_viewer};
    __pyx_mstate_global->__pyx_codeobj_tab[96] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_writeArrayToVec, __pyx_k_d_Qd_xvQ_U_5_U_1_XQ, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[96])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 7, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1420, 81};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_filename, __pyx_mstate->__pyx_n_u_arr, __pyx_mstate->__pyx_n_u_appendToFile, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_data_pointer, __pyx_mstate->__pyx_n_u_c_filename, __pyx_mstate->__pyx_n_u_N};
    __pyx_mstate_global->__pyx_codeobj_tab[97] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_writeBinaryArray, __pyx_k_RRS_c_1Cq_3fAQ_uCs_V1A, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[97])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {0, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1432, 30};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_ierr};
    __pyx_mstate_global->__pyx_codeobj_tab[98] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_barrier, __pyx_k_7_uCs_V1A, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[98])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 4, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1438, 56};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_x, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_xc, __pyx_mstate->__pyx_n_u_tot};
    __pyx_mstate_global->__pyx_codeobj_tab[99] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_globalScalarSum, __pyx_k_9AT_uCs_V1A_6, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[99])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1459, 71};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_xarr, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_xdata_pointer, __pyx_mstate->__pyx_n_u_res, __pyx_mstate->__pyx_n_u_nx};
    __pyx_mstate_global->__pyx_codeobj_tab[100] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_globalSum, __pyx_k_AQ_AT_81O5_aq_uCs_V1A_6, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[100])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 8, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1473, 119};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_xarr, __pyx_mstate->__pyx_n_u_yarr, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_xdata_pointer, __pyx_mstate->__pyx_n_u_ydata_pointer, __pyx_mstate->__pyx_n_u_res, __pyx_mstate->__pyx_n_u_nx, __pyx_mstate->__pyx_n_u_ny};
    __pyx_mstate_global->__pyx_codeobj_tab[101] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_dotProd, __pyx_k_AQ_AQ_s_Q_L_K1_AT_AT_uAU_1_uCs, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[101])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 6, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1493, 124};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_xarr, __pyx_mstate->__pyx_n_u_yarr, __pyx_mstate->__pyx_n_u_ierr, __pyx_mstate->__pyx_n_u_xdata_pointer, __pyx_mstate->__pyx_n_u_ydata_pointer, __pyx_mstate->__pyx_n_u_res};
    __pyx_mstate_global->__pyx_codeobj_tab[102] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_dotProdProfileScalarData, __pyx_k_1F_Q_L_J_1F_Q_L_J_AT_AT_uCs_V1A, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[102])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1514, 90};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_xarr, __pyx_mstate->__pyx_n_u_yarr, __pyx_mstate->__pyx_n_u_x, __pyx_mstate->__pyx_n_u_y, __pyx_mstate->__pyx_n_u_res};
    __pyx_mstate_global->__pyx_codeobj_tab[103] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_dotProdVecs, __pyx_k_d_Qe5_a_d_Qe5_a_Qa_XQ_XQ_1, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[103])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1566, 43};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_dtype, __pyx_mstate->__pyx_n_u_copy, __pyx_mstate->__pyx_n_u_shape, __pyx_mstate->__pyx_n_u_ndarray};
    __pyx_mstate_global->__pyx_codeobj_tab[104] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_array_2, __pyx_k_k_Qe_Q_as_A_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[104])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[105] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_reduce_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[105])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 3, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_pyx_state};
    __pyx_mstate_global->__pyx_codeobj_tab[106] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_setstate_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[106])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1605, 43};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_dtype, __pyx_mstate->__pyx_n_u_copy, __pyx_mstate->__pyx_n_u_shape, __pyx_mstate->__pyx_n_u_ndarray};
    __pyx_mstate_global->__pyx_codeobj_tab[107] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_array_2, __pyx_k_k_Qe_Q_as_A_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[107])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[108] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_reduce_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[108])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 3, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_pyx_state};
    __pyx_mstate_global->__pyx_codeobj_tab[109] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_setstate_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[109])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1624, 43};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_dtype, __pyx_mstate->__pyx_n_u_copy, __pyx_mstate->__pyx_n_u_shape, __pyx_mstate->__pyx_n_u_ndarray};
    __pyx_mstate_global->__pyx_codeobj_tab[110] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_array_2, __pyx_k_k_Qe_Q_as_T_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[110])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[111] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_reduce_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[111])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 3, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_pyx_state};
    __pyx_mstate_global->__pyx_codeobj_tab[112] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_setstate_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[112])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {3, 0, 0, 5, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1638, 43};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_dtype, __pyx_mstate->__pyx_n_u_copy, __pyx_mstate->__pyx_n_u_shape, __pyx_mstate->__pyx_n_u_ndarray};
    __pyx_mstate_global->__pyx_codeobj_tab[113] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_tmm4py_tmm4py_core_pyx, __pyx_mstate->__pyx_n_u_array_2, __pyx_k_k_Qe_Q_as_T_q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[113])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {1, 0, 0, 1, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 1, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self};
    __pyx_mstate_global->__pyx_codeobj_tab[114] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_reduce_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[114])) goto bad;
  }
  {
    const __Pyx_PyCode_New_function_description descr = {2, 0, 0, 2, (unsigned int)(CO_OPTIMIZED|CO_NEWLOCALS), 3, 9};
    PyObject* const varnames[] = {__pyx_mstate->__pyx_n_u_self, __pyx_mstate->__pyx_n_u_pyx_state};
    __pyx_mstate_global->__pyx_codeobj_tab[115] = __Pyx_PyCode_New(descr, varnames, __pyx_mstate->__pyx_kp_u_stringsource, __pyx_mstate->__pyx_n_u_setstate_cython, __pyx_k_Q, tuple_dedup_map); if (unlikely(!__pyx_mstate_global->__pyx_codeobj_tab[115])) goto bad;
  }
  Py_DECREF(tuple_dedup_map);
  return 0;
  bad:
  Py_DECREF(tuple_dedup_map);
  return -1;
}
/* #### Code section: init_globals ### */

static int __Pyx_InitGlobals(void) {
  /* PythonCompatibility.init */
  if (likely(__Pyx_init_co_variables() == 0)); else

if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1, __pyx_L1_error)

  /* CachedMethodType.init */
  #if CYTHON_COMPILING_IN_LIMITED_API
{
    PyObject *typesModule=NULL;
    typesModule = PyImport_ImportModule("types");
    if (typesModule) {
        __pyx_mstate_global->__Pyx_CachedMethodType = PyObject_GetAttrString(typesModule, "MethodType");
        Py_DECREF(typesModule);
    }
} // error handling follows
#endif

if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1, __pyx_L1_error)

  return 0;
  __pyx_L1_error:;
  return -1;
}
/* #### Code section: cleanup_globals ### */
/* #### Code section: cleanup_module ### */
/* #### Code section: main_method ### */
/* #### Code section: utility_code_pragmas ### */
#ifdef _MSC_VER
#pragma warning( push )
/* Warning 4127: conditional expression is constant
 * Cython uses constant conditional expressions to allow in inline functions to be optimized at
 * compile-time, so this warning is not useful
 */
#pragma warning( disable : 4127 )
#endif



/* #### Code section: utility_code_def ### */

/* --- Runtime support code --- */
/* Refnanny */
#if CYTHON_REFNANNY
static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname) {
    PyObject *m = NULL, *p = NULL;
    void *r = NULL;
    m = PyImport_ImportModule(modname);
    if (!m) goto end;
    p = PyObject_GetAttrString(m, "RefNannyAPI");
    if (!p) goto end;
    r = PyLong_AsVoidPtr(p);
end:
    Py_XDECREF(p);
    Py_XDECREF(m);
    return (__Pyx_RefNannyAPIStruct *)r;
}
#endif

/* PyErrExceptionMatches */
#if CYTHON_FAST_THREAD_STATE
static int __Pyx_PyErr_ExceptionMatchesTuple(PyObject *exc_type, PyObject *tuple) {
    Py_ssize_t i, n;
    n = PyTuple_GET_SIZE(tuple);
    for (i=0; i<n; i++) {
        if (exc_type == PyTuple_GET_ITEM(tuple, i)) return 1;
    }
    for (i=0; i<n; i++) {
        if (__Pyx_PyErr_GivenExceptionMatches(exc_type, PyTuple_GET_ITEM(tuple, i))) return 1;
    }
    return 0;
}
static CYTHON_INLINE int __Pyx_PyErr_ExceptionMatchesInState(PyThreadState* tstate, PyObject* err) {
    int result;
    PyObject *exc_type;
#if PY_VERSION_HEX >= 0x030C00A6
    PyObject *current_exception = tstate->current_exception;
    if (unlikely(!current_exception)) return 0;
    exc_type = (PyObject*) Py_TYPE(current_exception);
    if (exc_type == err) return 1;
#else
    exc_type = tstate->curexc_type;
    if (exc_type == err) return 1;
    if (unlikely(!exc_type)) return 0;
#endif
    #if CYTHON_AVOID_BORROWED_REFS
    Py_INCREF(exc_type);
    #endif
    if (unlikely(PyTuple_Check(err))) {
        result = __Pyx_PyErr_ExceptionMatchesTuple(exc_type, err);
    } else {
        result = __Pyx_PyErr_GivenExceptionMatches(exc_type, err);
    }
    #if CYTHON_AVOID_BORROWED_REFS
    Py_DECREF(exc_type);
    #endif
    return result;
}
#endif

/* PyErrFetchRestore */
#if CYTHON_FAST_THREAD_STATE
static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
#if PY_VERSION_HEX >= 0x030C00A6
    PyObject *tmp_value;
    assert(type == NULL || (value != NULL && type == (PyObject*) Py_TYPE(value)));
    if (value) {
        #if CYTHON_COMPILING_IN_CPYTHON
        if (unlikely(((PyBaseExceptionObject*) value)->traceback != tb))
        #endif
            PyException_SetTraceback(value, tb);
    }
    tmp_value = tstate->current_exception;
    tstate->current_exception = value;
    Py_XDECREF(tmp_value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
#else
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    tmp_type = tstate->curexc_type;
    tmp_value = tstate->curexc_value;
    tmp_tb = tstate->curexc_traceback;
    tstate->curexc_type = type;
    tstate->curexc_value = value;
    tstate->curexc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
#endif
}
static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
#if PY_VERSION_HEX >= 0x030C00A6
    PyObject* exc_value;
    exc_value = tstate->current_exception;
    tstate->current_exception = 0;
    *value = exc_value;
    *type = NULL;
    *tb = NULL;
    if (exc_value) {
        *type = (PyObject*) Py_TYPE(exc_value);
        Py_INCREF(*type);
        #if CYTHON_COMPILING_IN_CPYTHON
        *tb = ((PyBaseExceptionObject*) exc_value)->traceback;
        Py_XINCREF(*tb);
        #else
        *tb = PyException_GetTraceback(exc_value);
        #endif
    }
#else
    *type = tstate->curexc_type;
    *value = tstate->curexc_value;
    *tb = tstate->curexc_traceback;
    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
#endif
}
#endif

/* PyObjectGetAttrStr */
#if CYTHON_USE_TYPE_SLOTS
static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStr(PyObject* obj, PyObject* attr_name) {
    PyTypeObject* tp = Py_TYPE(obj);
    if (likely(tp->tp_getattro))
        return tp->tp_getattro(obj, attr_name);
    return PyObject_GetAttr(obj, attr_name);
}
#endif

/* PyObjectGetAttrStrNoError */
#if __PYX_LIMITED_VERSION_HEX < 0x030d0000
static void __Pyx_PyObject_GetAttrStr_ClearAttributeError(void) {
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    if (likely(__Pyx_PyErr_ExceptionMatches(PyExc_AttributeError)))
        __Pyx_PyErr_Clear();
}
#endif
static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStrNoError(PyObject* obj, PyObject* attr_name) {
    PyObject *result;
#if __PYX_LIMITED_VERSION_HEX >= 0x030d0000
    (void) PyObject_GetOptionalAttr(obj, attr_name, &result);
    return result;
#else
#if CYTHON_COMPILING_IN_CPYTHON && CYTHON_USE_TYPE_SLOTS
    PyTypeObject* tp = Py_TYPE(obj);
    if (likely(tp->tp_getattro == PyObject_GenericGetAttr)) {
        return _PyObject_GenericGetAttrWithDict(obj, attr_name, NULL, 1);
    }
#endif
    result = __Pyx_PyObject_GetAttrStr(obj, attr_name);
    if (unlikely(!result)) {
        __Pyx_PyObject_GetAttrStr_ClearAttributeError();
    }
    return result;
#endif
}

/* GetBuiltinName */
static PyObject *__Pyx_GetBuiltinName(PyObject *name) {
    PyObject* result = __Pyx_PyObject_GetAttrStrNoError(__pyx_mstate_global->__pyx_b, name);
    if (unlikely(!result) && !PyErr_Occurred()) {
        PyErr_Format(PyExc_NameError,
            "name '%U' is not defined", name);
    }
    return result;
}

/* GetTopmostException */
#if CYTHON_USE_EXC_INFO_STACK && CYTHON_FAST_THREAD_STATE
static _PyErr_StackItem *
__Pyx_PyErr_GetTopmostException(PyThreadState *tstate)
{
    _PyErr_StackItem *exc_info = tstate->exc_info;
    while ((exc_info->exc_value == NULL || exc_info->exc_value == Py_None) &&
           exc_info->previous_item != NULL)
    {
        exc_info = exc_info->previous_item;
    }
    return exc_info;
}
#endif

/* SaveResetException */
#if CYTHON_FAST_THREAD_STATE
static CYTHON_INLINE void __Pyx__ExceptionSave(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
  #if CYTHON_USE_EXC_INFO_STACK && PY_VERSION_HEX >= 0x030B00a4
    _PyErr_StackItem *exc_info = __Pyx_PyErr_GetTopmostException(tstate);
    PyObject *exc_value = exc_info->exc_value;
    if (exc_value == NULL || exc_value == Py_None) {
        *value = NULL;
        *type = NULL;
        *tb = NULL;
    } else {
        *value = exc_value;
        Py_INCREF(*value);
        *type = (PyObject*) Py_TYPE(exc_value);
        Py_INCREF(*type);
        *tb = PyException_GetTraceback(exc_value);
    }
  #elif CYTHON_USE_EXC_INFO_STACK
    _PyErr_StackItem *exc_info = __Pyx_PyErr_GetTopmostException(tstate);
    *type = exc_info->exc_type;
    *value = exc_info->exc_value;
    *tb = exc_info->exc_traceback;
    Py_XINCREF(*type);
    Py_XINCREF(*value);
    Py_XINCREF(*tb);
  #else
    *type = tstate->exc_type;
    *value = tstate->exc_value;
    *tb = tstate->exc_traceback;
    Py_XINCREF(*type);
    Py_XINCREF(*value);
    Py_XINCREF(*tb);
  #endif
}
static CYTHON_INLINE void __Pyx__ExceptionReset(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
  #if CYTHON_USE_EXC_INFO_STACK && PY_VERSION_HEX >= 0x030B00a4
    _PyErr_StackItem *exc_info = tstate->exc_info;
    PyObject *tmp_value = exc_info->exc_value;
    exc_info->exc_value = value;
    Py_XDECREF(tmp_value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
  #else
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    #if CYTHON_USE_EXC_INFO_STACK
    _PyErr_StackItem *exc_info = tstate->exc_info;
    tmp_type = exc_info->exc_type;
    tmp_value = exc_info->exc_value;
    tmp_tb = exc_info->exc_traceback;
    exc_info->exc_type = type;
    exc_info->exc_value = value;
    exc_info->exc_traceback = tb;
    #else
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = type;
    tstate->exc_value = value;
    tstate->exc_traceback = tb;
    #endif
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
  #endif
}
#endif

/* GetException */
#if CYTHON_FAST_THREAD_STATE
static int __Pyx__GetException(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb)
#else
static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb)
#endif
{
    PyObject *local_type = NULL, *local_value, *local_tb = NULL;
#if CYTHON_FAST_THREAD_STATE
    PyObject *tmp_type, *tmp_value, *tmp_tb;
  #if PY_VERSION_HEX >= 0x030C0000
    local_value = tstate->current_exception;
    tstate->current_exception = 0;
  #else
    local_type = tstate->curexc_type;
    local_value = tstate->curexc_value;
    local_tb = tstate->curexc_traceback;
    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
  #endif
#elif __PYX_LIMITED_VERSION_HEX > 0x030C0000
    local_value = PyErr_GetRaisedException();
#else
    PyErr_Fetch(&local_type, &local_value, &local_tb);
#endif
#if __PYX_LIMITED_VERSION_HEX > 0x030C0000
    if (likely(local_value)) {
        local_type = (PyObject*) Py_TYPE(local_value);
        Py_INCREF(local_type);
        local_tb = PyException_GetTraceback(local_value);
    }
#else
    PyErr_NormalizeException(&local_type, &local_value, &local_tb);
#if CYTHON_FAST_THREAD_STATE
    if (unlikely(tstate->curexc_type))
#else
    if (unlikely(PyErr_Occurred()))
#endif
        goto bad;
    if (local_tb) {
        if (unlikely(PyException_SetTraceback(local_value, local_tb) < 0))
            goto bad;
    }
#endif // __PYX_LIMITED_VERSION_HEX > 0x030C0000
    Py_XINCREF(local_tb);
    Py_XINCREF(local_type);
    Py_XINCREF(local_value);
    *type = local_type;
    *value = local_value;
    *tb = local_tb;
#if CYTHON_FAST_THREAD_STATE
    #if CYTHON_USE_EXC_INFO_STACK
    {
        _PyErr_StackItem *exc_info = tstate->exc_info;
      #if PY_VERSION_HEX >= 0x030B00a4
        tmp_value = exc_info->exc_value;
        exc_info->exc_value = local_value;
        tmp_type = NULL;
        tmp_tb = NULL;
        Py_XDECREF(local_type);
        Py_XDECREF(local_tb);
      #else
        tmp_type = exc_info->exc_type;
        tmp_value = exc_info->exc_value;
        tmp_tb = exc_info->exc_traceback;
        exc_info->exc_type = local_type;
        exc_info->exc_value = local_value;
        exc_info->exc_traceback = local_tb;
      #endif
    }
    #else
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = local_type;
    tstate->exc_value = local_value;
    tstate->exc_traceback = local_tb;
    #endif
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
#elif __PYX_LIMITED_VERSION_HEX >= 0x030b0000
    PyErr_SetHandledException(local_value);
    Py_XDECREF(local_value);
    Py_XDECREF(local_type);
    Py_XDECREF(local_tb);
#else
    PyErr_SetExcInfo(local_type, local_value, local_tb);
#endif
    return 0;
#if __PYX_LIMITED_VERSION_HEX <= 0x030C0000
bad:
    *type = 0;
    *value = 0;
    *tb = 0;
    Py_XDECREF(local_type);
    Py_XDECREF(local_value);
    Py_XDECREF(local_tb);
    return -1;
#endif
}

/* PyFunctionFastCall */
#if CYTHON_FAST_PYCALL && !CYTHON_VECTORCALL
static PyObject* __Pyx_PyFunction_FastCallNoKw(PyCodeObject *co, PyObject *const *args, Py_ssize_t na,
                                               PyObject *globals) {
    PyFrameObject *f;
    PyThreadState *tstate = __Pyx_PyThreadState_Current;
    PyObject **fastlocals;
    Py_ssize_t i;
    PyObject *result;
    assert(globals != NULL);
    /* XXX Perhaps we should create a specialized
       PyFrame_New() that doesn't take locals, but does
       take builtins without sanity checking them.
       */
    assert(tstate != NULL);
    f = PyFrame_New(tstate, co, globals, NULL);
    if (f == NULL) {
        return NULL;
    }
    fastlocals = __Pyx_PyFrame_GetLocalsplus(f);
    for (i = 0; i < na; i++) {
        Py_INCREF(*args);
        fastlocals[i] = *args++;
    }
    result = PyEval_EvalFrameEx(f,0);
    ++tstate->recursion_depth;
    Py_DECREF(f);
    --tstate->recursion_depth;
    return result;
}
static PyObject *__Pyx_PyFunction_FastCallDict(PyObject *func, PyObject *const *args, Py_ssize_t nargs, PyObject *kwargs) {
    PyCodeObject *co = (PyCodeObject *)PyFunction_GET_CODE(func);
    PyObject *globals = PyFunction_GET_GLOBALS(func);
    PyObject *argdefs = PyFunction_GET_DEFAULTS(func);
    PyObject *closure;
    PyObject *kwdefs;
    PyObject *kwtuple, **k;
    PyObject **d;
    Py_ssize_t nd;
    Py_ssize_t nk;
    PyObject *result;
    assert(kwargs == NULL || PyDict_Check(kwargs));
    nk = kwargs ? PyDict_Size(kwargs) : 0;
    if (unlikely(Py_EnterRecursiveCall(" while calling a Python object"))) {
        return NULL;
    }
    if (
            co->co_kwonlyargcount == 0 &&
            likely(kwargs == NULL || nk == 0) &&
            co->co_flags == (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)) {
        if (argdefs == NULL && co->co_argcount == nargs) {
            result = __Pyx_PyFunction_FastCallNoKw(co, args, nargs, globals);
            goto done;
        }
        else if (nargs == 0 && argdefs != NULL
                 && co->co_argcount == Py_SIZE(argdefs)) {
            /* function called with no arguments, but all parameters have
               a default value: use default values as arguments .*/
            args = &PyTuple_GET_ITEM(argdefs, 0);
            result =__Pyx_PyFunction_FastCallNoKw(co, args, Py_SIZE(argdefs), globals);
            goto done;
        }
    }
    if (kwargs != NULL) {
        Py_ssize_t pos, i;
        kwtuple = PyTuple_New(2 * nk);
        if (kwtuple == NULL) {
            result = NULL;
            goto done;
        }
        k = &PyTuple_GET_ITEM(kwtuple, 0);
        pos = i = 0;
        while (PyDict_Next(kwargs, &pos, &k[i], &k[i+1])) {
            Py_INCREF(k[i]);
            Py_INCREF(k[i+1]);
            i += 2;
        }
        nk = i / 2;
    }
    else {
        kwtuple = NULL;
        k = NULL;
    }
    closure = PyFunction_GET_CLOSURE(func);
    kwdefs = PyFunction_GET_KW_DEFAULTS(func);
    if (argdefs != NULL) {
        d = &PyTuple_GET_ITEM(argdefs, 0);
        nd = Py_SIZE(argdefs);
    }
    else {
        d = NULL;
        nd = 0;
    }
    result = PyEval_EvalCodeEx((PyObject*)co, globals, (PyObject *)NULL,
                               args, (int)nargs,
                               k, (int)nk,
                               d, (int)nd, kwdefs, closure);
    Py_XDECREF(kwtuple);
done:
    Py_LeaveRecursiveCall();
    return result;
}
#endif

/* PyObjectCall */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
    PyObject *result;
    ternaryfunc call = Py_TYPE(func)->tp_call;
    if (unlikely(!call))
        return PyObject_Call(func, arg, kw);
    if (unlikely(Py_EnterRecursiveCall(" while calling a Python object")))
        return NULL;
    result = (*call)(func, arg, kw);
    Py_LeaveRecursiveCall();
    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
        PyErr_SetString(
            PyExc_SystemError,
            "NULL result without error in PyObject_Call");
    }
    return result;
}
#endif

/* PyObjectCallMethO */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg) {
    PyObject *self, *result;
    PyCFunction cfunc;
    cfunc = __Pyx_CyOrPyCFunction_GET_FUNCTION(func);
    self = __Pyx_CyOrPyCFunction_GET_SELF(func);
    if (unlikely(Py_EnterRecursiveCall(" while calling a Python object")))
        return NULL;
    result = cfunc(self, arg);
    Py_LeaveRecursiveCall();
    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
        PyErr_SetString(
            PyExc_SystemError,
            "NULL result without error in PyObject_Call");
    }
    return result;
}
#endif

/* PyObjectFastCall */
#if PY_VERSION_HEX < 0x03090000 || CYTHON_COMPILING_IN_LIMITED_API
static PyObject* __Pyx_PyObject_FastCall_fallback(PyObject *func, PyObject * const*args, size_t nargs, PyObject *kwargs) {
    PyObject *argstuple;
    PyObject *result = 0;
    size_t i;
    argstuple = PyTuple_New((Py_ssize_t)nargs);
    if (unlikely(!argstuple)) return NULL;
    for (i = 0; i < nargs; i++) {
        Py_INCREF(args[i]);
        if (__Pyx_PyTuple_SET_ITEM(argstuple, (Py_ssize_t)i, args[i]) != (0)) goto bad;
    }
    result = __Pyx_PyObject_Call(func, argstuple, kwargs);
  bad:
    Py_DECREF(argstuple);
    return result;
}
#endif
#if CYTHON_VECTORCALL && !CYTHON_COMPILING_IN_LIMITED_API
  #if PY_VERSION_HEX < 0x03090000
    #define __Pyx_PyVectorcall_Function(callable) _PyVectorcall_Function(callable)
  #elif CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE vectorcallfunc __Pyx_PyVectorcall_Function(PyObject *callable) {
    PyTypeObject *tp = Py_TYPE(callable);
    #if defined(__Pyx_CyFunction_USED)
    if (__Pyx_CyFunction_CheckExact(callable)) {
        return __Pyx_CyFunction_func_vectorcall(callable);
    }
    #endif
    if (!PyType_HasFeature(tp, Py_TPFLAGS_HAVE_VECTORCALL)) {
        return NULL;
    }
    assert(PyCallable_Check(callable));
    Py_ssize_t offset = tp->tp_vectorcall_offset;
    assert(offset > 0);
    vectorcallfunc ptr;
    memcpy(&ptr, (char *) callable + offset, sizeof(ptr));
    return ptr;
}
  #else
    #define __Pyx_PyVectorcall_Function(callable) PyVectorcall_Function(callable)
  #endif
#endif
static CYTHON_INLINE PyObject* __Pyx_PyObject_FastCallDict(PyObject *func, PyObject *const *args, size_t _nargs, PyObject *kwargs) {
    Py_ssize_t nargs = __Pyx_PyVectorcall_NARGS(_nargs);
#if CYTHON_COMPILING_IN_CPYTHON
    if (nargs == 0 && kwargs == NULL) {
        if (__Pyx_CyOrPyCFunction_Check(func) && likely( __Pyx_CyOrPyCFunction_GET_FLAGS(func) & METH_NOARGS))
            return __Pyx_PyObject_CallMethO(func, NULL);
    }
    else if (nargs == 1 && kwargs == NULL) {
        if (__Pyx_CyOrPyCFunction_Check(func) && likely( __Pyx_CyOrPyCFunction_GET_FLAGS(func) & METH_O))
            return __Pyx_PyObject_CallMethO(func, args[0]);
    }
#endif
    #if PY_VERSION_HEX < 0x030800B1
    #if CYTHON_FAST_PYCCALL
    if (PyCFunction_Check(func)) {
        if (kwargs) {
            return _PyCFunction_FastCallDict(func, args, nargs, kwargs);
        } else {
            return _PyCFunction_FastCallKeywords(func, args, nargs, NULL);
        }
    }
    if (!kwargs && __Pyx_IS_TYPE(func, &PyMethodDescr_Type)) {
        return _PyMethodDescr_FastCallKeywords(func, args, nargs, NULL);
    }
    #endif
    #if CYTHON_FAST_PYCALL
    if (PyFunction_Check(func)) {
        return __Pyx_PyFunction_FastCallDict(func, args, nargs, kwargs);
    }
    #endif
    #endif
    if (kwargs == NULL) {
        #if CYTHON_VECTORCALL && !CYTHON_COMPILING_IN_LIMITED_API
        vectorcallfunc f = __Pyx_PyVectorcall_Function(func);
        if (f) {
            return f(func, args, _nargs, NULL);
        }
        #elif defined(__Pyx_CyFunction_USED) && CYTHON_BACKPORT_VECTORCALL
        if (__Pyx_CyFunction_CheckExact(func)) {
            __pyx_vectorcallfunc f = __Pyx_CyFunction_func_vectorcall(func);
            if (f) return f(func, args, _nargs, NULL);
        }
        #elif CYTHON_COMPILING_IN_LIMITED_API && CYTHON_VECTORCALL
        return PyObject_Vectorcall(func, args, _nargs, NULL);
        #endif
    }
    if (nargs == 0) {
        return __Pyx_PyObject_Call(func, __pyx_mstate_global->__pyx_empty_tuple, kwargs);
    }
    #if PY_VERSION_HEX >= 0x03090000 && !CYTHON_COMPILING_IN_LIMITED_API
    return PyObject_VectorcallDict(func, args, (size_t)nargs, kwargs);
    #else
    return __Pyx_PyObject_FastCall_fallback(func, args, (size_t)nargs, kwargs);
    #endif
}

/* RaiseException */
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause) {
    PyObject* owned_instance = NULL;
    if (tb == Py_None) {
        tb = 0;
    } else if (tb && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto bad;
    }
    if (value == Py_None)
        value = 0;
    if (PyExceptionInstance_Check(type)) {
        if (value) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto bad;
        }
        value = type;
        type = (PyObject*) Py_TYPE(value);
    } else if (PyExceptionClass_Check(type)) {
        PyObject *instance_class = NULL;
        if (value && PyExceptionInstance_Check(value)) {
            instance_class = (PyObject*) Py_TYPE(value);
            if (instance_class != type) {
                int is_subclass = PyObject_IsSubclass(instance_class, type);
                if (!is_subclass) {
                    instance_class = NULL;
                } else if (unlikely(is_subclass == -1)) {
                    goto bad;
                } else {
                    type = instance_class;
                }
            }
        }
        if (!instance_class) {
            PyObject *args;
            if (!value)
                args = PyTuple_New(0);
            else if (PyTuple_Check(value)) {
                Py_INCREF(value);
                args = value;
            } else
                args = PyTuple_Pack(1, value);
            if (!args)
                goto bad;
            owned_instance = PyObject_Call(type, args, NULL);
            Py_DECREF(args);
            if (!owned_instance)
                goto bad;
            value = owned_instance;
            if (!PyExceptionInstance_Check(value)) {
                PyErr_Format(PyExc_TypeError,
                             "calling %R should have returned an instance of "
                             "BaseException, not %R",
                             type, Py_TYPE(value));
                goto bad;
            }
        }
    } else {
        PyErr_SetString(PyExc_TypeError,
            "raise: exception class must be a subclass of BaseException");
        goto bad;
    }
    if (cause) {
        PyObject *fixed_cause;
        if (cause == Py_None) {
            fixed_cause = NULL;
        } else if (PyExceptionClass_Check(cause)) {
            fixed_cause = PyObject_CallObject(cause, NULL);
            if (fixed_cause == NULL)
                goto bad;
        } else if (PyExceptionInstance_Check(cause)) {
            fixed_cause = cause;
            Py_INCREF(fixed_cause);
        } else {
            PyErr_SetString(PyExc_TypeError,
                            "exception causes must derive from "
                            "BaseException");
            goto bad;
        }
        PyException_SetCause(value, fixed_cause);
    }
    PyErr_SetObject(type, value);
    if (tb) {
#if PY_VERSION_HEX >= 0x030C00A6
        PyException_SetTraceback(value, tb);
#elif CYTHON_FAST_THREAD_STATE
        PyThreadState *tstate = __Pyx_PyThreadState_Current;
        PyObject* tmp_tb = tstate->curexc_traceback;
        if (tb != tmp_tb) {
            Py_INCREF(tb);
            tstate->curexc_traceback = tb;
            Py_XDECREF(tmp_tb);
        }
#else
        PyObject *tmp_type, *tmp_value, *tmp_tb;
        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
        Py_INCREF(tb);
        PyErr_Restore(tmp_type, tmp_value, tb);
        Py_XDECREF(tmp_tb);
#endif
    }
bad:
    Py_XDECREF(owned_instance);
    return;
}

/* RaiseTooManyValuesToUnpack */
static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
    PyErr_Format(PyExc_ValueError,
                 "too many values to unpack (expected %" CYTHON_FORMAT_SSIZE_T "d)", expected);
}

/* RaiseNeedMoreValuesToUnpack */
static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
    PyErr_Format(PyExc_ValueError,
                 "need more than %" CYTHON_FORMAT_SSIZE_T "d value%.1s to unpack",
                 index, (index == 1) ? "" : "s");
}

/* IterFinish */
static CYTHON_INLINE int __Pyx_IterFinish(void) {
    PyObject* exc_type;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    exc_type = __Pyx_PyErr_CurrentExceptionType();
    if (unlikely(exc_type)) {
        if (unlikely(!__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration)))
            return -1;
        __Pyx_PyErr_Clear();
        return 0;
    }
    return 0;
}

/* UnpackItemEndCheck */
static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
    if (unlikely(retval)) {
        Py_DECREF(retval);
        __Pyx_RaiseTooManyValuesError(expected);
        return -1;
    }
    return __Pyx_IterFinish();
}

/* PyObjectCallOneArg */
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
    PyObject *args[2] = {NULL, arg};
    return __Pyx_PyObject_FastCall(func, args+1, 1 | __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET);
}

/* WriteUnraisableException */
static void __Pyx_WriteUnraisable(const char *name, int clineno,
                                  int lineno, const char *filename,
                                  int full_traceback, int nogil) {
    PyObject *old_exc, *old_val, *old_tb;
    PyObject *ctx;
    __Pyx_PyThreadState_declare
    PyGILState_STATE state;
    if (nogil)
        state = PyGILState_Ensure();
    else state = (PyGILState_STATE)0;
    CYTHON_UNUSED_VAR(clineno);
    CYTHON_UNUSED_VAR(lineno);
    CYTHON_UNUSED_VAR(filename);
    CYTHON_MAYBE_UNUSED_VAR(nogil);
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&old_exc, &old_val, &old_tb);
    if (full_traceback) {
        Py_XINCREF(old_exc);
        Py_XINCREF(old_val);
        Py_XINCREF(old_tb);
        __Pyx_ErrRestore(old_exc, old_val, old_tb);
        PyErr_PrintEx(0);
    }
    ctx = PyUnicode_FromString(name);
    __Pyx_ErrRestore(old_exc, old_val, old_tb);
    if (!ctx) {
        PyErr_WriteUnraisable(Py_None);
    } else {
        PyErr_WriteUnraisable(ctx);
        Py_DECREF(ctx);
    }
    if (nogil)
        PyGILState_Release(state);
}

/* TupleAndListFromArray */
#if !CYTHON_COMPILING_IN_CPYTHON && CYTHON_METH_FASTCALL
static CYTHON_INLINE PyObject *
__Pyx_PyTuple_FromArray(PyObject *const *src, Py_ssize_t n)
{
    PyObject *res;
    Py_ssize_t i;
    if (n <= 0) {
        return __Pyx_NewRef(__pyx_mstate_global->__pyx_empty_tuple);
    }
    res = PyTuple_New(n);
    if (unlikely(res == NULL)) return NULL;
    for (i = 0; i < n; i++) {
        if (unlikely(__Pyx_PyTuple_SET_ITEM(res, i, src[i]) < 0)) {
            Py_DECREF(res);
            return NULL;
        }
        Py_INCREF(src[i]);
    }
    return res;
}
#elif CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE void __Pyx_copy_object_array(PyObject *const *CYTHON_RESTRICT src, PyObject** CYTHON_RESTRICT dest, Py_ssize_t length) {
    PyObject *v;
    Py_ssize_t i;
    for (i = 0; i < length; i++) {
        v = dest[i] = src[i];
        Py_INCREF(v);
    }
}
static CYTHON_INLINE PyObject *
__Pyx_PyTuple_FromArray(PyObject *const *src, Py_ssize_t n)
{
    PyObject *res;
    if (n <= 0) {
        return __Pyx_NewRef(__pyx_mstate_global->__pyx_empty_tuple);
    }
    res = PyTuple_New(n);
    if (unlikely(res == NULL)) return NULL;
    __Pyx_copy_object_array(src, ((PyTupleObject*)res)->ob_item, n);
    return res;
}
static CYTHON_INLINE PyObject *
__Pyx_PyList_FromArray(PyObject *const *src, Py_ssize_t n)
{
    PyObject *res;
    if (n <= 0) {
        return PyList_New(0);
    }
    res = PyList_New(n);
    if (unlikely(res == NULL)) return NULL;
    __Pyx_copy_object_array(src, ((PyListObject*)res)->ob_item, n);
    return res;
}
#endif

/* BytesEquals */
static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals) {
#if CYTHON_COMPILING_IN_PYPY || CYTHON_COMPILING_IN_LIMITED_API || CYTHON_COMPILING_IN_GRAAL ||\
        !(CYTHON_ASSUME_SAFE_SIZE && CYTHON_ASSUME_SAFE_MACROS)
    return PyObject_RichCompareBool(s1, s2, equals);
#else
    if (s1 == s2) {
        return (equals == Py_EQ);
    } else if (PyBytes_CheckExact(s1) & PyBytes_CheckExact(s2)) {
        const char *ps1, *ps2;
        Py_ssize_t length = PyBytes_GET_SIZE(s1);
        if (length != PyBytes_GET_SIZE(s2))
            return (equals == Py_NE);
        ps1 = PyBytes_AS_STRING(s1);
        ps2 = PyBytes_AS_STRING(s2);
        if (ps1[0] != ps2[0]) {
            return (equals == Py_NE);
        } else if (length == 1) {
            return (equals == Py_EQ);
        } else {
            int result;
#if CYTHON_USE_UNICODE_INTERNALS && (PY_VERSION_HEX < 0x030B0000)
            Py_hash_t hash1, hash2;
            hash1 = ((PyBytesObject*)s1)->ob_shash;
            hash2 = ((PyBytesObject*)s2)->ob_shash;
            if (hash1 != hash2 && hash1 != -1 && hash2 != -1) {
                return (equals == Py_NE);
            }
#endif
            result = memcmp(ps1, ps2, (size_t)length);
            return (equals == Py_EQ) ? (result == 0) : (result != 0);
        }
    } else if ((s1 == Py_None) & PyBytes_CheckExact(s2)) {
        return (equals == Py_NE);
    } else if ((s2 == Py_None) & PyBytes_CheckExact(s1)) {
        return (equals == Py_NE);
    } else {
        int result;
        PyObject* py_result = PyObject_RichCompare(s1, s2, equals);
        if (!py_result)
            return -1;
        result = __Pyx_PyObject_IsTrue(py_result);
        Py_DECREF(py_result);
        return result;
    }
#endif
}

/* UnicodeEquals */
static CYTHON_INLINE int __Pyx_PyUnicode_Equals(PyObject* s1, PyObject* s2, int equals) {
#if CYTHON_COMPILING_IN_PYPY || CYTHON_COMPILING_IN_LIMITED_API || CYTHON_COMPILING_IN_GRAAL
    return PyObject_RichCompareBool(s1, s2, equals);
#else
    int s1_is_unicode, s2_is_unicode;
    if (s1 == s2) {
        goto return_eq;
    }
    s1_is_unicode = PyUnicode_CheckExact(s1);
    s2_is_unicode = PyUnicode_CheckExact(s2);
    if (s1_is_unicode & s2_is_unicode) {
        Py_ssize_t length, length2;
        int kind;
        void *data1, *data2;
        #if !CYTHON_COMPILING_IN_LIMITED_API
        if (unlikely(__Pyx_PyUnicode_READY(s1) < 0) || unlikely(__Pyx_PyUnicode_READY(s2) < 0))
            return -1;
        #endif
        length = __Pyx_PyUnicode_GET_LENGTH(s1);
        #if !CYTHON_ASSUME_SAFE_SIZE
        if (unlikely(length < 0)) return -1;
        #endif
        length2 = __Pyx_PyUnicode_GET_LENGTH(s2);
        #if !CYTHON_ASSUME_SAFE_SIZE
        if (unlikely(length2 < 0)) return -1;
        #endif
        if (length != length2) {
            goto return_ne;
        }
#if CYTHON_USE_UNICODE_INTERNALS
        {
            Py_hash_t hash1, hash2;
            hash1 = ((PyASCIIObject*)s1)->hash;
            hash2 = ((PyASCIIObject*)s2)->hash;
            if (hash1 != hash2 && hash1 != -1 && hash2 != -1) {
                goto return_ne;
            }
        }
#endif
        kind = __Pyx_PyUnicode_KIND(s1);
        if (kind != __Pyx_PyUnicode_KIND(s2)) {
            goto return_ne;
        }
        data1 = __Pyx_PyUnicode_DATA(s1);
        data2 = __Pyx_PyUnicode_DATA(s2);
        if (__Pyx_PyUnicode_READ(kind, data1, 0) != __Pyx_PyUnicode_READ(kind, data2, 0)) {
            goto return_ne;
        } else if (length == 1) {
            goto return_eq;
        } else {
            int result = memcmp(data1, data2, (size_t)(length * kind));
            return (equals == Py_EQ) ? (result == 0) : (result != 0);
        }
    } else if ((s1 == Py_None) & s2_is_unicode) {
        goto return_ne;
    } else if ((s2 == Py_None) & s1_is_unicode) {
        goto return_ne;
    } else {
        int result;
        PyObject* py_result = PyObject_RichCompare(s1, s2, equals);
        if (!py_result)
            return -1;
        result = __Pyx_PyObject_IsTrue(py_result);
        Py_DECREF(py_result);
        return result;
    }
return_eq:
    return (equals == Py_EQ);
return_ne:
    return (equals == Py_NE);
#endif
}

/* fastcall */
#if CYTHON_METH_FASTCALL
static CYTHON_INLINE PyObject * __Pyx_GetKwValue_FASTCALL(PyObject *kwnames, PyObject *const *kwvalues, PyObject *s)
{
    Py_ssize_t i, n = __Pyx_PyTuple_GET_SIZE(kwnames);
    #if !CYTHON_ASSUME_SAFE_SIZE
    if (unlikely(n == -1)) return NULL;
    #endif
    for (i = 0; i < n; i++)
    {
        PyObject *namei = __Pyx_PyTuple_GET_ITEM(kwnames, i);
        #if !CYTHON_ASSUME_SAFE_MACROS
        if (unlikely(!namei)) return NULL;
        #endif
        if (s == namei) return kwvalues[i];
    }
    for (i = 0; i < n; i++)
    {
        PyObject *namei = __Pyx_PyTuple_GET_ITEM(kwnames, i);
        #if !CYTHON_ASSUME_SAFE_MACROS
        if (unlikely(!namei)) return NULL;
        #endif
        int eq = __Pyx_PyUnicode_Equals(s, namei, Py_EQ);
        if (unlikely(eq != 0)) {
            if (unlikely(eq < 0)) return NULL;
            return kwvalues[i];
        }
    }
    return NULL;
}
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030d0000 || CYTHON_COMPILING_IN_LIMITED_API
CYTHON_UNUSED static PyObject *__Pyx_KwargsAsDict_FASTCALL(PyObject *kwnames, PyObject *const *kwvalues) {
    Py_ssize_t i, nkwargs;
    PyObject *dict;
#if !CYTHON_ASSUME_SAFE_SIZE
    nkwargs = PyTuple_Size(kwnames);
    if (unlikely(nkwargs < 0)) return NULL;
#else
    nkwargs = PyTuple_GET_SIZE(kwnames);
#endif
    dict = PyDict_New();
    if (unlikely(!dict))
        return NULL;
    for (i=0; i<nkwargs; i++) {
#if !CYTHON_ASSUME_SAFE_MACROS
        PyObject *key = PyTuple_GetItem(kwnames, i);
        if (!key) goto bad;
#else
        PyObject *key = PyTuple_GET_ITEM(kwnames, i);
#endif
        if (unlikely(PyDict_SetItem(dict, key, kwvalues[i]) < 0))
            goto bad;
    }
    return dict;
bad:
    Py_DECREF(dict);
    return NULL;
}
#endif
#endif

/* RaiseDoubleKeywords */
static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name,
    PyObject* kw_name)
{
    PyErr_Format(PyExc_TypeError,
        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
}

/* UnpackUnboundCMethod */
#if CYTHON_COMPILING_IN_LIMITED_API && __PYX_LIMITED_VERSION_HEX < 0x030C0000
static PyObject *__Pyx_SelflessCall(PyObject *method, PyObject *args, PyObject *kwargs) {
    PyObject *result;
    PyObject *selfless_args = PyTuple_GetSlice(args, 1, PyTuple_Size(args));
    if (unlikely(!selfless_args)) return NULL;
    result = PyObject_Call(method, selfless_args, kwargs);
    Py_DECREF(selfless_args);
    return result;
}
#elif CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX < 0x03090000
static PyObject *__Pyx_SelflessCall(PyObject *method, PyObject **args, Py_ssize_t nargs, PyObject *kwnames) {
        return _PyObject_Vectorcall
            (method, args ? args+1 : NULL, nargs ? nargs-1 : 0, kwnames);
}
#else
static PyObject *__Pyx_SelflessCall(PyObject *method, PyObject *const *args, Py_ssize_t nargs, PyObject *kwnames) {
    return
#if PY_VERSION_HEX < 0x03090000
    _PyObject_Vectorcall
#else
    PyObject_Vectorcall
#endif
        (method, args ? args+1 : NULL, nargs ? (size_t) nargs-1 : 0, kwnames);
}
#endif
static PyMethodDef __Pyx_UnboundCMethod_Def = {
     "CythonUnboundCMethod",
     __PYX_REINTERPRET_FUNCION(PyCFunction, __Pyx_SelflessCall),
#if CYTHON_COMPILING_IN_LIMITED_API && __PYX_LIMITED_VERSION_HEX < 0x030C0000
     METH_VARARGS | METH_KEYWORDS,
#else
     METH_FASTCALL | METH_KEYWORDS,
#endif
     NULL
};
static int __Pyx_TryUnpackUnboundCMethod(__Pyx_CachedCFunction* target) {
    PyObject *method, *result=NULL;
    method = __Pyx_PyObject_GetAttrStr(target->type, *target->method_name);
    if (unlikely(!method))
        return -1;
    result = method;
#if CYTHON_COMPILING_IN_CPYTHON
    if (likely(__Pyx_TypeCheck(method, &PyMethodDescr_Type)))
    {
        PyMethodDescrObject *descr = (PyMethodDescrObject*) method;
        target->func = descr->d_method->ml_meth;
        target->flag = descr->d_method->ml_flags & ~(METH_CLASS | METH_STATIC | METH_COEXIST | METH_STACKLESS);
    } else
#endif
#if CYTHON_COMPILING_IN_PYPY
#else
    if (PyCFunction_Check(method))
#endif
    {
        PyObject *self;
        int self_found;
#if CYTHON_COMPILING_IN_LIMITED_API || CYTHON_COMPILING_IN_PYPY
        self = PyObject_GetAttrString(method, "__self__");
        if (!self) {
            PyErr_Clear();
        }
#else
        self = PyCFunction_GET_SELF(method);
#endif
        self_found = (self && self != Py_None);
#if CYTHON_COMPILING_IN_LIMITED_API || CYTHON_COMPILING_IN_PYPY
        Py_XDECREF(self);
#endif
        if (self_found) {
            PyObject *unbound_method = PyCFunction_New(&__Pyx_UnboundCMethod_Def, method);
            if (unlikely(!unbound_method)) return -1;
            Py_DECREF(method);
            result = unbound_method;
        }
    }
#if !CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
    if (unlikely(target->method)) {
        Py_DECREF(result);
    } else
#endif
    target->method = result;
    return 0;
}

/* CallUnboundCMethod2 */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject *__Pyx_CallUnboundCMethod2(__Pyx_CachedCFunction *cfunc, PyObject *self, PyObject *arg1, PyObject *arg2) {
    int was_initialized = __Pyx_CachedCFunction_GetAndSetInitializing(cfunc);
    if (likely(was_initialized == 2 && cfunc->func)) {
        PyObject *args[2] = {arg1, arg2};
        if (cfunc->flag == METH_FASTCALL) {
            return __Pyx_CallCFunctionFast(cfunc, self, args, 2);
        }
        if (cfunc->flag == (METH_FASTCALL | METH_KEYWORDS))
            return __Pyx_CallCFunctionFastWithKeywords(cfunc, self, args, 2, NULL);
    }
#if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
    else if (unlikely(was_initialized == 1)) {
        __Pyx_CachedCFunction tmp_cfunc = {
#ifndef __cplusplus
            0
#endif
        };
        tmp_cfunc.type = cfunc->type;
        tmp_cfunc.method_name = cfunc->method_name;
        return __Pyx__CallUnboundCMethod2(&tmp_cfunc, self, arg1, arg2);
    }
#endif
    PyObject *result = __Pyx__CallUnboundCMethod2(cfunc, self, arg1, arg2);
    __Pyx_CachedCFunction_SetFinishedInitializing(cfunc);
    return result;
}
#endif
static PyObject* __Pyx__CallUnboundCMethod2(__Pyx_CachedCFunction* cfunc, PyObject* self, PyObject* arg1, PyObject* arg2){
    if (unlikely(!cfunc->func && !cfunc->method) && unlikely(__Pyx_TryUnpackUnboundCMethod(cfunc) < 0)) return NULL;
#if CYTHON_COMPILING_IN_CPYTHON
    if (cfunc->func && (cfunc->flag & METH_VARARGS)) {
        PyObject *result = NULL;
        PyObject *args = PyTuple_New(2);
        if (unlikely(!args)) return NULL;
        Py_INCREF(arg1);
        PyTuple_SET_ITEM(args, 0, arg1);
        Py_INCREF(arg2);
        PyTuple_SET_ITEM(args, 1, arg2);
        if (cfunc->flag & METH_KEYWORDS)
            result = __Pyx_CallCFunctionWithKeywords(cfunc, self, args, NULL);
        else
            result = __Pyx_CallCFunction(cfunc, self, args);
        Py_DECREF(args);
        return result;
    }
#endif
    {
        PyObject *args[4] = {NULL, self, arg1, arg2};
        return __Pyx_PyObject_FastCall(cfunc->method, args+1, 3 | __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET);
    }
}

/* ParseKeywords */
static int __Pyx_ValidateDuplicatePosArgs(
    PyObject *kwds,
    PyObject ** const argnames[],
    PyObject ** const *first_kw_arg,
    const char* function_name)
{
    PyObject ** const *name = argnames;
    while (name != first_kw_arg) {
        PyObject *key = **name;
        int found = PyDict_Contains(kwds, key);
        if (unlikely(found)) {
            if (found == 1) __Pyx_RaiseDoubleKeywordsError(function_name, key);
            goto bad;
        }
        name++;
    }
    return 0;
bad:
    return -1;
}
#if CYTHON_USE_UNICODE_INTERNALS
static CYTHON_INLINE int __Pyx_UnicodeKeywordsEqual(PyObject *s1, PyObject *s2) {
    int kind;
    Py_ssize_t len = PyUnicode_GET_LENGTH(s1);
    if (len != PyUnicode_GET_LENGTH(s2)) return 0;
    kind = PyUnicode_KIND(s1);
    if (kind != PyUnicode_KIND(s2)) return 0;
    const void *data1 = PyUnicode_DATA(s1);
    const void *data2 = PyUnicode_DATA(s2);
    return (memcmp(data1, data2, (size_t) len * (size_t) kind) == 0);
}
#endif
static int __Pyx_MatchKeywordArg_str(
    PyObject *key,
    PyObject ** const argnames[],
    PyObject ** const *first_kw_arg,
    size_t *index_found,
    const char *function_name)
{
    PyObject ** const *name;
    #if CYTHON_USE_UNICODE_INTERNALS
    Py_hash_t key_hash = ((PyASCIIObject*)key)->hash;
    if (unlikely(key_hash == -1)) {
        key_hash = PyObject_Hash(key);
        if (unlikely(key_hash == -1))
            goto bad;
    }
    #endif
    name = first_kw_arg;
    while (*name) {
        PyObject *name_str = **name;
        #if CYTHON_USE_UNICODE_INTERNALS
        if (key_hash == ((PyASCIIObject*)name_str)->hash && __Pyx_UnicodeKeywordsEqual(name_str, key)) {
            *index_found = (size_t) (name - argnames);
            return 1;
        }
        #else
        #if CYTHON_ASSUME_SAFE_SIZE
        if (PyUnicode_GET_LENGTH(name_str) == PyUnicode_GET_LENGTH(key))
        #endif
        {
            int cmp = PyUnicode_Compare(name_str, key);
            if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
            if (cmp == 0) {
                *index_found = (size_t) (name - argnames);
                return 1;
            }
        }
        #endif
        name++;
    }
    name = argnames;
    while (name != first_kw_arg) {
        PyObject *name_str = **name;
        #if CYTHON_USE_UNICODE_INTERNALS
        if (unlikely(key_hash == ((PyASCIIObject*)name_str)->hash)) {
            if (__Pyx_UnicodeKeywordsEqual(name_str, key))
                goto arg_passed_twice;
        }
        #else
        #if CYTHON_ASSUME_SAFE_SIZE
        if (PyUnicode_GET_LENGTH(name_str) == PyUnicode_GET_LENGTH(key))
        #endif
        {
            if (unlikely(name_str == key)) goto arg_passed_twice;
            int cmp = PyUnicode_Compare(name_str, key);
            if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
            if (cmp == 0) goto arg_passed_twice;
        }
        #endif
        name++;
    }
    return 0;
arg_passed_twice:
    __Pyx_RaiseDoubleKeywordsError(function_name, key);
    goto bad;
bad:
    return -1;
}
static int __Pyx_MatchKeywordArg_nostr(
    PyObject *key,
    PyObject ** const argnames[],
    PyObject ** const *first_kw_arg,
    size_t *index_found,
    const char *function_name)
{
    PyObject ** const *name;
    if (unlikely(!PyUnicode_Check(key))) goto invalid_keyword_type;
    name = first_kw_arg;
    while (*name) {
        int cmp = PyObject_RichCompareBool(**name, key, Py_EQ);
        if (cmp == 1) {
            *index_found = (size_t) (name - argnames);
            return 1;
        }
        if (unlikely(cmp == -1)) goto bad;
        name++;
    }
    name = argnames;
    while (name != first_kw_arg) {
        int cmp = PyObject_RichCompareBool(**name, key, Py_EQ);
        if (unlikely(cmp != 0)) {
            if (cmp == 1) goto arg_passed_twice;
            else goto bad;
        }
        name++;
    }
    return 0;
arg_passed_twice:
    __Pyx_RaiseDoubleKeywordsError(function_name, key);
    goto bad;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%.200s() keywords must be strings", function_name);
    goto bad;
bad:
    return -1;
}
static CYTHON_INLINE int __Pyx_MatchKeywordArg(
    PyObject *key,
    PyObject ** const argnames[],
    PyObject ** const *first_kw_arg,
    size_t *index_found,
    const char *function_name)
{
    return likely(PyUnicode_CheckExact(key)) ?
        __Pyx_MatchKeywordArg_str(key, argnames, first_kw_arg, index_found, function_name) :
        __Pyx_MatchKeywordArg_nostr(key, argnames, first_kw_arg, index_found, function_name);
}
static void __Pyx_RejectUnknownKeyword(
    PyObject *kwds,
    PyObject ** const argnames[],
    PyObject ** const *first_kw_arg,
    const char *function_name)
{
    Py_ssize_t pos = 0;
    PyObject *key = NULL;
    __Pyx_BEGIN_CRITICAL_SECTION(kwds);
    while (PyDict_Next(kwds, &pos, &key, NULL)) {
        PyObject** const *name = first_kw_arg;
        while (*name && (**name != key)) name++;
        if (!*name) {
            #if CYTHON_AVOID_BORROWED_REFS
            Py_INCREF(key);
            #endif
            size_t index_found = 0;
            int cmp = __Pyx_MatchKeywordArg(key, argnames, first_kw_arg, &index_found, function_name);
            if (cmp != 1) {
                if (cmp == 0) {
                    PyErr_Format(PyExc_TypeError,
                        "%s() got an unexpected keyword argument '%U'",
                        function_name, key);
                }
                #if CYTHON_AVOID_BORROWED_REFS
                Py_DECREF(key);
                #endif
                break;
            }
            #if CYTHON_AVOID_BORROWED_REFS
            Py_DECREF(key);
            #endif
        }
    }
    __Pyx_END_CRITICAL_SECTION();
    assert(PyErr_Occurred());
}
static int __Pyx_ParseKeywordDict(
    PyObject *kwds,
    PyObject ** const argnames[],
    PyObject *values[],
    Py_ssize_t num_pos_args,
    Py_ssize_t num_kwargs,
    const char* function_name,
    int ignore_unknown_kwargs)
{
    PyObject** const *name;
    PyObject** const *first_kw_arg = argnames + num_pos_args;
    Py_ssize_t extracted = 0;
#if !CYTHON_COMPILING_IN_PYPY || defined(PyArg_ValidateKeywordArguments)
    if (unlikely(!PyArg_ValidateKeywordArguments(kwds))) return -1;
#endif
    name = first_kw_arg;
    while (*name && num_kwargs > extracted) {
        PyObject * key = **name;
        PyObject *value;
        int found = 0;
        #if __PYX_LIMITED_VERSION_HEX >= 0x030d0000
        found = PyDict_GetItemRef(kwds, key, &value);
        #else
        value = PyDict_GetItemWithError(kwds, key);
        if (value) {
            Py_INCREF(value);
            found = 1;
        } else {
            if (unlikely(PyErr_Occurred())) goto bad;
        }
        #endif
        if (found) {
            if (unlikely(found < 0)) goto bad;
            values[name-argnames] = value;
            extracted++;
        }
        name++;
    }
    if (num_kwargs > extracted) {
        if (ignore_unknown_kwargs) {
            if (unlikely(__Pyx_ValidateDuplicatePosArgs(kwds, argnames, first_kw_arg, function_name) == -1))
                goto bad;
        } else {
            __Pyx_RejectUnknownKeyword(kwds, argnames, first_kw_arg, function_name);
            goto bad;
        }
    }
    return 0;
bad:
    return -1;
}
static int __Pyx_ParseKeywordDictToDict(
    PyObject *kwds,
    PyObject ** const argnames[],
    PyObject *kwds2,
    PyObject *values[],
    Py_ssize_t num_pos_args,
    const char* function_name)
{
    PyObject** const *name;
    PyObject** const *first_kw_arg = argnames + num_pos_args;
    Py_ssize_t len;
#if !CYTHON_COMPILING_IN_PYPY || defined(PyArg_ValidateKeywordArguments)
    if (unlikely(!PyArg_ValidateKeywordArguments(kwds))) return -1;
#endif
    if (PyDict_Update(kwds2, kwds) < 0) goto bad;
    name = first_kw_arg;
    while (*name) {
        PyObject *key = **name;
        PyObject *value;
#if !CYTHON_COMPILING_IN_LIMITED_API && (PY_VERSION_HEX >= 0x030d00A2 || defined(PyDict_Pop))
        int found = PyDict_Pop(kwds2, key, &value);
        if (found) {
            if (unlikely(found < 0)) goto bad;
            values[name-argnames] = value;
        }
#elif __PYX_LIMITED_VERSION_HEX >= 0x030d0000
        int found = PyDict_GetItemRef(kwds2, key, &value);
        if (found) {
            if (unlikely(found < 0)) goto bad;
            values[name-argnames] = value;
            if (unlikely(PyDict_DelItem(kwds2, key) < 0)) goto bad;
        }
#else
    #if CYTHON_COMPILING_IN_CPYTHON
        value = _PyDict_Pop(kwds2, key, kwds2);
    #else
        value = __Pyx_CallUnboundCMethod2(&__pyx_mstate_global->__pyx_umethod_PyDict_Type_pop, kwds2, key, kwds2);
    #endif
        if (value == kwds2) {
            Py_DECREF(value);
        } else {
            if (unlikely(!value)) goto bad;
            values[name-argnames] = value;
        }
#endif
        name++;
    }
    len = PyDict_Size(kwds2);
    if (len > 0) {
        return __Pyx_ValidateDuplicatePosArgs(kwds, argnames, first_kw_arg, function_name);
    } else if (unlikely(len == -1)) {
        goto bad;
    }
    return 0;
bad:
    return -1;
}
static int __Pyx_ParseKeywordsTuple(
    PyObject *kwds,
    PyObject * const *kwvalues,
    PyObject ** const argnames[],
    PyObject *kwds2,
    PyObject *values[],
    Py_ssize_t num_pos_args,
    Py_ssize_t num_kwargs,
    const char* function_name,
    int ignore_unknown_kwargs)
{
    PyObject *key = NULL;
    PyObject** const * name;
    PyObject** const *first_kw_arg = argnames + num_pos_args;
    for (Py_ssize_t pos = 0; pos < num_kwargs; pos++) {
#if CYTHON_AVOID_BORROWED_REFS
        key = __Pyx_PySequence_ITEM(kwds, pos);
#else
        key = __Pyx_PyTuple_GET_ITEM(kwds, pos);
#endif
#if !CYTHON_ASSUME_SAFE_MACROS
        if (unlikely(!key)) goto bad;
#endif
        name = first_kw_arg;
        while (*name && (**name != key)) name++;
        if (*name) {
            PyObject *value = kwvalues[pos];
            values[name-argnames] = __Pyx_NewRef(value);
        } else {
            size_t index_found = 0;
            int cmp = __Pyx_MatchKeywordArg(key, argnames, first_kw_arg, &index_found, function_name);
            if (cmp == 1) {
                PyObject *value = kwvalues[pos];
                values[index_found] = __Pyx_NewRef(value);
            } else {
                if (unlikely(cmp == -1)) goto bad;
                if (kwds2) {
                    PyObject *value = kwvalues[pos];
                    if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
                } else if (!ignore_unknown_kwargs) {
                    goto invalid_keyword;
                }
            }
        }
        #if CYTHON_AVOID_BORROWED_REFS
        Py_DECREF(key);
        key = NULL;
        #endif
    }
    return 0;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    goto bad;
bad:
    #if CYTHON_AVOID_BORROWED_REFS
    Py_XDECREF(key);
    #endif
    return -1;
}
static int __Pyx_ParseKeywords(
    PyObject *kwds,
    PyObject * const *kwvalues,
    PyObject ** const argnames[],
    PyObject *kwds2,
    PyObject *values[],
    Py_ssize_t num_pos_args,
    Py_ssize_t num_kwargs,
    const char* function_name,
    int ignore_unknown_kwargs)
{
    if (CYTHON_METH_FASTCALL && likely(PyTuple_Check(kwds)))
        return __Pyx_ParseKeywordsTuple(kwds, kwvalues, argnames, kwds2, values, num_pos_args, num_kwargs, function_name, ignore_unknown_kwargs);
    else if (kwds2)
        return __Pyx_ParseKeywordDictToDict(kwds, argnames, kwds2, values, num_pos_args, function_name);
    else
        return __Pyx_ParseKeywordDict(kwds, argnames, values, num_pos_args, num_kwargs, function_name, ignore_unknown_kwargs);
}

/* RaiseArgTupleInvalid */
static void __Pyx_RaiseArgtupleInvalid(
    const char* func_name,
    int exact,
    Py_ssize_t num_min,
    Py_ssize_t num_max,
    Py_ssize_t num_found)
{
    Py_ssize_t num_expected;
    const char *more_or_less;
    if (num_found < num_min) {
        num_expected = num_min;
        more_or_less = "at least";
    } else {
        num_expected = num_max;
        more_or_less = "at most";
    }
    if (exact) {
        more_or_less = "exactly";
    }
    PyErr_Format(PyExc_TypeError,
                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
                 func_name, more_or_less, num_expected,
                 (num_expected == 1) ? "" : "s", num_found);
}

/* PyObjectSetAttrStr */
#if CYTHON_USE_TYPE_SLOTS
static CYTHON_INLINE int __Pyx_PyObject_SetAttrStr(PyObject* obj, PyObject* attr_name, PyObject* value) {
    PyTypeObject* tp = Py_TYPE(obj);
    if (likely(tp->tp_setattro))
        return tp->tp_setattro(obj, attr_name, value);
    return PyObject_SetAttr(obj, attr_name, value);
}
#endif

/* RejectKeywords */
static void __Pyx_RejectKeywords(const char* function_name, PyObject *kwds) {
    PyObject *key = NULL;
    if (CYTHON_METH_FASTCALL && likely(PyTuple_Check(kwds))) {
        key = __Pyx_PySequence_ITEM(kwds, 0);
    } else {
        Py_ssize_t pos = 0;
#if !CYTHON_COMPILING_IN_PYPY || defined(PyArg_ValidateKeywordArguments)
        if (unlikely(!PyArg_ValidateKeywordArguments(kwds))) return;
#endif
        PyDict_Next(kwds, &pos, &key, NULL);
        Py_INCREF(key);
    }
    if (likely(key)) {
        PyErr_Format(PyExc_TypeError,
            "%s() got an unexpected keyword argument '%U'",
            function_name, key);
        Py_DECREF(key);
    }
}

/* PyObjectCall2Args */
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2) {
    PyObject *args[3] = {NULL, arg1, arg2};
    return __Pyx_PyObject_FastCall(function, args+1, 2 | __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET);
}

/* PyObjectGetMethod */
static int __Pyx_PyObject_GetMethod(PyObject *obj, PyObject *name, PyObject **method) {
    PyObject *attr;
#if CYTHON_UNPACK_METHODS && CYTHON_COMPILING_IN_CPYTHON && CYTHON_USE_PYTYPE_LOOKUP
    __Pyx_TypeName type_name;
    PyTypeObject *tp = Py_TYPE(obj);
    PyObject *descr;
    descrgetfunc f = NULL;
    PyObject **dictptr, *dict;
    int meth_found = 0;
    assert (*method == NULL);
    if (unlikely(tp->tp_getattro != PyObject_GenericGetAttr)) {
        attr = __Pyx_PyObject_GetAttrStr(obj, name);
        goto try_unpack;
    }
    if (unlikely(tp->tp_dict == NULL) && unlikely(PyType_Ready(tp) < 0)) {
        return 0;
    }
    descr = _PyType_Lookup(tp, name);
    if (likely(descr != NULL)) {
        Py_INCREF(descr);
#if defined(Py_TPFLAGS_METHOD_DESCRIPTOR) && Py_TPFLAGS_METHOD_DESCRIPTOR
        if (__Pyx_PyType_HasFeature(Py_TYPE(descr), Py_TPFLAGS_METHOD_DESCRIPTOR))
#else
        #ifdef __Pyx_CyFunction_USED
        if (likely(PyFunction_Check(descr) || __Pyx_IS_TYPE(descr, &PyMethodDescr_Type) || __Pyx_CyFunction_Check(descr)))
        #else
        if (likely(PyFunction_Check(descr) || __Pyx_IS_TYPE(descr, &PyMethodDescr_Type)))
        #endif
#endif
        {
            meth_found = 1;
        } else {
            f = Py_TYPE(descr)->tp_descr_get;
            if (f != NULL && PyDescr_IsData(descr)) {
                attr = f(descr, obj, (PyObject *)Py_TYPE(obj));
                Py_DECREF(descr);
                goto try_unpack;
            }
        }
    }
    dictptr = _PyObject_GetDictPtr(obj);
    if (dictptr != NULL && (dict = *dictptr) != NULL) {
        Py_INCREF(dict);
        attr = __Pyx_PyDict_GetItemStr(dict, name);
        if (attr != NULL) {
            Py_INCREF(attr);
            Py_DECREF(dict);
            Py_XDECREF(descr);
            goto try_unpack;
        }
        Py_DECREF(dict);
    }
    if (meth_found) {
        *method = descr;
        return 1;
    }
    if (f != NULL) {
        attr = f(descr, obj, (PyObject *)Py_TYPE(obj));
        Py_DECREF(descr);
        goto try_unpack;
    }
    if (likely(descr != NULL)) {
        *method = descr;
        return 0;
    }
    type_name = __Pyx_PyType_GetFullyQualifiedName(tp);
    PyErr_Format(PyExc_AttributeError,
                 "'" __Pyx_FMT_TYPENAME "' object has no attribute '%U'",
                 type_name, name);
    __Pyx_DECREF_TypeName(type_name);
    return 0;
#else
    attr = __Pyx_PyObject_GetAttrStr(obj, name);
    goto try_unpack;
#endif
try_unpack:
#if CYTHON_UNPACK_METHODS
    if (likely(attr) && PyMethod_Check(attr) && likely(PyMethod_GET_SELF(attr) == obj)) {
        PyObject *function = PyMethod_GET_FUNCTION(attr);
        Py_INCREF(function);
        Py_DECREF(attr);
        *method = function;
        return 1;
    }
#endif
    *method = attr;
    return 0;
}

/* PyObjectCallMethod1 */
#if !(CYTHON_VECTORCALL && (__PYX_LIMITED_VERSION_HEX >= 0x030C0000 || (!CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX >= 0x03090000)))
static PyObject* __Pyx__PyObject_CallMethod1(PyObject* method, PyObject* arg) {
    PyObject *result = __Pyx_PyObject_CallOneArg(method, arg);
    Py_DECREF(method);
    return result;
}
#endif
static PyObject* __Pyx_PyObject_CallMethod1(PyObject* obj, PyObject* method_name, PyObject* arg) {
#if CYTHON_VECTORCALL && (__PYX_LIMITED_VERSION_HEX >= 0x030C0000 || (!CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX >= 0x03090000))
    PyObject *args[2] = {obj, arg};
    (void) __Pyx_PyObject_GetMethod;
    (void) __Pyx_PyObject_CallOneArg;
    (void) __Pyx_PyObject_Call2Args;
    return PyObject_VectorcallMethod(method_name, args, 2 | PY_VECTORCALL_ARGUMENTS_OFFSET, NULL);
#else
    PyObject *method = NULL, *result;
    int is_method = __Pyx_PyObject_GetMethod(obj, method_name, &method);
    if (likely(is_method)) {
        result = __Pyx_PyObject_Call2Args(method, obj, arg);
        Py_DECREF(method);
        return result;
    }
    if (unlikely(!method)) return NULL;
    return __Pyx__PyObject_CallMethod1(method, arg);
#endif
}

/* append */
static CYTHON_INLINE int __Pyx_PyObject_Append(PyObject* L, PyObject* x) {
    if (likely(PyList_CheckExact(L))) {
        if (unlikely(__Pyx_PyList_Append(L, x) < 0)) return -1;
    } else {
        PyObject* retval = __Pyx_PyObject_CallMethod1(L, __pyx_mstate_global->__pyx_n_u_append, x);
        if (unlikely(!retval))
            return -1;
        Py_DECREF(retval);
    }
    return 0;
}

/* PyDictVersioning */
#if CYTHON_USE_DICT_VERSIONS && CYTHON_USE_TYPE_SLOTS
static CYTHON_INLINE PY_UINT64_T __Pyx_get_tp_dict_version(PyObject *obj) {
    PyObject *dict = Py_TYPE(obj)->tp_dict;
    return likely(dict) ? __PYX_GET_DICT_VERSION(dict) : 0;
}
static CYTHON_INLINE PY_UINT64_T __Pyx_get_object_dict_version(PyObject *obj) {
    PyObject **dictptr = NULL;
    Py_ssize_t offset = Py_TYPE(obj)->tp_dictoffset;
    if (offset) {
#if CYTHON_COMPILING_IN_CPYTHON
        dictptr = (likely(offset > 0)) ? (PyObject **) ((char *)obj + offset) : _PyObject_GetDictPtr(obj);
#else
        dictptr = _PyObject_GetDictPtr(obj);
#endif
    }
    return (dictptr && *dictptr) ? __PYX_GET_DICT_VERSION(*dictptr) : 0;
}
static CYTHON_INLINE int __Pyx_object_dict_version_matches(PyObject* obj, PY_UINT64_T tp_dict_version, PY_UINT64_T obj_dict_version) {
    PyObject *dict = Py_TYPE(obj)->tp_dict;
    if (unlikely(!dict) || unlikely(tp_dict_version != __PYX_GET_DICT_VERSION(dict)))
        return 0;
    return obj_dict_version == __Pyx_get_object_dict_version(obj);
}
#endif

/* GetModuleGlobalName */
#if CYTHON_USE_DICT_VERSIONS
static PyObject *__Pyx__GetModuleGlobalName(PyObject *name, PY_UINT64_T *dict_version, PyObject **dict_cached_value)
#else
static CYTHON_INLINE PyObject *__Pyx__GetModuleGlobalName(PyObject *name)
#endif
{
    PyObject *result;
#if CYTHON_COMPILING_IN_LIMITED_API
    if (unlikely(!__pyx_m)) {
        if (!PyErr_Occurred())
            PyErr_SetNone(PyExc_NameError);
        return NULL;
    }
    result = PyObject_GetAttr(__pyx_m, name);
    if (likely(result)) {
        return result;
    }
    PyErr_Clear();
#elif CYTHON_AVOID_BORROWED_REFS || CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS
    if (unlikely(__Pyx_PyDict_GetItemRef(__pyx_mstate_global->__pyx_d, name, &result) == -1)) PyErr_Clear();
    __PYX_UPDATE_DICT_CACHE(__pyx_mstate_global->__pyx_d, result, *dict_cached_value, *dict_version)
    if (likely(result)) {
        return result;
    }
#else
    result = _PyDict_GetItem_KnownHash(__pyx_mstate_global->__pyx_d, name, ((PyASCIIObject *) name)->hash);
    __PYX_UPDATE_DICT_CACHE(__pyx_mstate_global->__pyx_d, result, *dict_cached_value, *dict_version)
    if (likely(result)) {
        return __Pyx_NewRef(result);
    }
    PyErr_Clear();
#endif
    return __Pyx_GetBuiltinName(name);
}

/* DictGetItem */
#if !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key) {
    PyObject *value;
    if (unlikely(__Pyx_PyDict_GetItemRef(d, key, &value) == 0)) { // no value, no error
        if (unlikely(PyTuple_Check(key))) {
            PyObject* args = PyTuple_Pack(1, key);
            if (likely(args)) {
                PyErr_SetObject(PyExc_KeyError, args);
                Py_DECREF(args);
            }
        } else {
            PyErr_SetObject(PyExc_KeyError, key);
        }
    }
    return value;
}
#endif

/* PyObjectFastCallMethod */
#if !CYTHON_VECTORCALL || PY_VERSION_HEX < 0x03090000
static PyObject *__Pyx_PyObject_FastCallMethod(PyObject *name, PyObject *const *args, size_t nargsf) {
    PyObject *result;
    PyObject *attr = PyObject_GetAttr(args[0], name);
    if (unlikely(!attr))
        return NULL;
    result = __Pyx_PyObject_FastCall(attr, args+1, nargsf - 1);
    Py_DECREF(attr);
    return result;
}
#endif

/* JoinPyUnicode */
static PyObject* __Pyx_PyUnicode_Join(PyObject** values, Py_ssize_t value_count, Py_ssize_t result_ulength,
                                      Py_UCS4 max_char) {
#if CYTHON_USE_UNICODE_INTERNALS && CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    PyObject *result_uval;
    int result_ukind, kind_shift;
    Py_ssize_t i, char_pos;
    void *result_udata;
    if (max_char > 1114111) max_char = 1114111;
    result_uval = PyUnicode_New(result_ulength, max_char);
    if (unlikely(!result_uval)) return NULL;
    result_ukind = (max_char <= 255) ? PyUnicode_1BYTE_KIND : (max_char <= 65535) ? PyUnicode_2BYTE_KIND : PyUnicode_4BYTE_KIND;
    kind_shift = (result_ukind == PyUnicode_4BYTE_KIND) ? 2 : result_ukind - 1;
    result_udata = PyUnicode_DATA(result_uval);
    assert(kind_shift == 2 || kind_shift == 1 || kind_shift == 0);
    if (unlikely((PY_SSIZE_T_MAX >> kind_shift) - result_ulength < 0))
        goto overflow;
    char_pos = 0;
    for (i=0; i < value_count; i++) {
        int ukind;
        Py_ssize_t ulength;
        void *udata;
        PyObject *uval = values[i];
        #if !CYTHON_COMPILING_IN_LIMITED_API
        if (__Pyx_PyUnicode_READY(uval) == (-1))
            goto bad;
        #endif
        ulength = __Pyx_PyUnicode_GET_LENGTH(uval);
        #if !CYTHON_ASSUME_SAFE_SIZE
        if (unlikely(ulength < 0)) goto bad;
        #endif
        if (unlikely(!ulength))
            continue;
        if (unlikely((PY_SSIZE_T_MAX >> kind_shift) - ulength < char_pos))
            goto overflow;
        ukind = __Pyx_PyUnicode_KIND(uval);
        udata = __Pyx_PyUnicode_DATA(uval);
        if (ukind == result_ukind) {
            memcpy((char *)result_udata + (char_pos << kind_shift), udata, (size_t) (ulength << kind_shift));
        } else {
            #if PY_VERSION_HEX >= 0x030d0000
            if (unlikely(PyUnicode_CopyCharacters(result_uval, char_pos, uval, 0, ulength) < 0)) goto bad;
            #elif CYTHON_COMPILING_IN_CPYTHON || defined(_PyUnicode_FastCopyCharacters)
            _PyUnicode_FastCopyCharacters(result_uval, char_pos, uval, 0, ulength);
            #else
            Py_ssize_t j;
            for (j=0; j < ulength; j++) {
                Py_UCS4 uchar = __Pyx_PyUnicode_READ(ukind, udata, j);
                __Pyx_PyUnicode_WRITE(result_ukind, result_udata, char_pos+j, uchar);
            }
            #endif
        }
        char_pos += ulength;
    }
    return result_uval;
overflow:
    PyErr_SetString(PyExc_OverflowError, "join() result is too long for a Python string");
bad:
    Py_DECREF(result_uval);
    return NULL;
#else
    Py_ssize_t i;
    PyObject *result = NULL;
    PyObject *value_tuple = PyTuple_New(value_count);
    if (unlikely(!value_tuple)) return NULL;
    CYTHON_UNUSED_VAR(max_char);
    CYTHON_UNUSED_VAR(result_ulength);
    for (i=0; i<value_count; i++) {
        if (__Pyx_PyTuple_SET_ITEM(value_tuple, i, values[i]) != (0)) goto bad;
        Py_INCREF(values[i]);
    }
    result = PyUnicode_Join(__pyx_mstate_global->__pyx_empty_unicode, value_tuple);
bad:
    Py_DECREF(value_tuple);
    return result;
#endif
}

/* KeywordStringCheck */
static int __Pyx_CheckKeywordStrings(
    const char* function_name,
    PyObject *kw)
{
#if CYTHON_COMPILING_IN_PYPY && !defined(PyArg_ValidateKeywordArguments)
    CYTHON_UNUSED_VAR(function_name);
    CYTHON_UNUSED_VAR(kw);
    return 0;
#else
    if (CYTHON_METH_FASTCALL && likely(PyTuple_Check(kw))) {
#if PY_VERSION_HEX >= 0x03090000
        CYTHON_UNUSED_VAR(function_name);
#else
        Py_ssize_t kwsize;
        #if CYTHON_ASSUME_SAFE_SIZE
        kwsize = PyTuple_GET_SIZE(kw);
        #else
        kwsize = PyTuple_Size(kw);
        if (unlikely(kwsize < 0)) return -1;
        #endif
        for (Py_ssize_t pos = 0; pos < kwsize; pos++) {
            PyObject* key = NULL;
            #if CYTHON_ASSUME_SAFE_MACROS
            key = PyTuple_GET_ITEM(kw, pos);
            #else
            key = PyTuple_GetItem(kw, pos);
            if (unlikely(!key)) return -1;
            #endif
            if (unlikely(!PyUnicode_Check(key))) {
                PyErr_Format(PyExc_TypeError,
                    "%.200s() keywords must be strings", function_name);
                return -1;
            }
        }
#endif
    } else {
        if (unlikely(!PyArg_ValidateKeywordArguments(kw))) return -1;
    }
    return 0;
#endif
}

/* PyObjectCallNoArg */
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
    PyObject *arg[2] = {NULL, NULL};
    return __Pyx_PyObject_FastCall(func, arg + 1, 0 | __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET);
}

/* PyObjectCallMethod0 */
static PyObject* __Pyx_PyObject_CallMethod0(PyObject* obj, PyObject* method_name) {
#if CYTHON_VECTORCALL && (__PYX_LIMITED_VERSION_HEX >= 0x030C0000 || (!CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX >= 0x03090000))
    PyObject *args[1] = {obj};
    (void) __Pyx_PyObject_GetMethod;
    (void) __Pyx_PyObject_CallOneArg;
    (void) __Pyx_PyObject_CallNoArg;
    return PyObject_VectorcallMethod(method_name, args, 1 | PY_VECTORCALL_ARGUMENTS_OFFSET, NULL);
#else
    PyObject *method = NULL, *result = NULL;
    int is_method = __Pyx_PyObject_GetMethod(obj, method_name, &method);
    if (likely(is_method)) {
        result = __Pyx_PyObject_CallOneArg(method, obj);
        Py_DECREF(method);
        return result;
    }
    if (unlikely(!method)) goto bad;
    result = __Pyx_PyObject_CallNoArg(method);
    Py_DECREF(method);
bad:
    return result;
#endif
}

/* RaiseNoneIterError */
static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
}

/* UnpackTupleError */
static void __Pyx_UnpackTupleError(PyObject *t, Py_ssize_t index) {
    if (t == Py_None) {
      __Pyx_RaiseNoneNotIterableError();
    } else {
      Py_ssize_t size = __Pyx_PyTuple_GET_SIZE(t);
 #if !CYTHON_ASSUME_SAFE_SIZE
      if (unlikely(size < 0)) return;
 #endif
      if (size < index) {
        __Pyx_RaiseNeedMoreValuesError(size);
      } else {
        __Pyx_RaiseTooManyValuesError(index);
      }
    }
}

/* UnpackTuple2 */
static CYTHON_INLINE int __Pyx_unpack_tuple2(
        PyObject* tuple, PyObject** value1, PyObject** value2, int is_tuple, int has_known_size, int decref_tuple) {
    if (likely(is_tuple || PyTuple_Check(tuple))) {
        Py_ssize_t size;
        if (has_known_size) {
            return __Pyx_unpack_tuple2_exact(tuple, value1, value2, decref_tuple);
        }
        size = __Pyx_PyTuple_GET_SIZE(tuple);
        if (likely(size == 2)) {
            return __Pyx_unpack_tuple2_exact(tuple, value1, value2, decref_tuple);
        }
        if (size >= 0) {
            __Pyx_UnpackTupleError(tuple, 2);
        }
        return -1;
    } else {
        return __Pyx_unpack_tuple2_generic(tuple, value1, value2, has_known_size, decref_tuple);
    }
}
static CYTHON_INLINE int __Pyx_unpack_tuple2_exact(
        PyObject* tuple, PyObject** pvalue1, PyObject** pvalue2, int decref_tuple) {
    PyObject *value1 = NULL, *value2 = NULL;
#if CYTHON_AVOID_BORROWED_REFS || !CYTHON_ASSUME_SAFE_MACROS
    value1 = __Pyx_PySequence_ITEM(tuple, 0);  if (unlikely(!value1)) goto bad;
    value2 = __Pyx_PySequence_ITEM(tuple, 1);  if (unlikely(!value2)) goto bad;
#else
    value1 = PyTuple_GET_ITEM(tuple, 0);  Py_INCREF(value1);
    value2 = PyTuple_GET_ITEM(tuple, 1);  Py_INCREF(value2);
#endif
    if (decref_tuple) {
        Py_DECREF(tuple);
    }
    *pvalue1 = value1;
    *pvalue2 = value2;
    return 0;
#if CYTHON_AVOID_BORROWED_REFS || !CYTHON_ASSUME_SAFE_MACROS
bad:
    Py_XDECREF(value1);
    Py_XDECREF(value2);
    if (decref_tuple) { Py_XDECREF(tuple); }
    return -1;
#endif
}
static int __Pyx_unpack_tuple2_generic(PyObject* tuple, PyObject** pvalue1, PyObject** pvalue2,
                                       int has_known_size, int decref_tuple) {
    Py_ssize_t index;
    PyObject *value1 = NULL, *value2 = NULL, *iter = NULL;
    iternextfunc iternext;
    iter = PyObject_GetIter(tuple);
    if (unlikely(!iter)) goto bad;
    if (decref_tuple) { Py_DECREF(tuple); tuple = NULL; }
    iternext = __Pyx_PyObject_GetIterNextFunc(iter);
    value1 = iternext(iter); if (unlikely(!value1)) { index = 0; goto unpacking_failed; }
    value2 = iternext(iter); if (unlikely(!value2)) { index = 1; goto unpacking_failed; }
    if (!has_known_size && unlikely(__Pyx_IternextUnpackEndCheck(iternext(iter), 2))) goto bad;
    Py_DECREF(iter);
    *pvalue1 = value1;
    *pvalue2 = value2;
    return 0;
unpacking_failed:
    if (!has_known_size && __Pyx_IterFinish() == 0)
        __Pyx_RaiseNeedMoreValuesError(index);
bad:
    Py_XDECREF(iter);
    Py_XDECREF(value1);
    Py_XDECREF(value2);
    if (decref_tuple) { Py_XDECREF(tuple); }
    return -1;
}

/* dict_iter */
#if CYTHON_COMPILING_IN_PYPY
#include <string.h>
#endif
static CYTHON_INLINE PyObject* __Pyx_dict_iterator(PyObject* iterable, int is_dict, PyObject* method_name,
                                                   Py_ssize_t* p_orig_length, int* p_source_is_dict) {
    is_dict = is_dict || likely(PyDict_CheckExact(iterable));
    *p_source_is_dict = is_dict;
    if (is_dict) {
#if !CYTHON_COMPILING_IN_PYPY
        *p_orig_length = PyDict_Size(iterable);
        Py_INCREF(iterable);
        return iterable;
#else
        static PyObject *py_items = NULL, *py_keys = NULL, *py_values = NULL;
        PyObject **pp = NULL;
        if (method_name) {
            const char *name = PyUnicode_AsUTF8(method_name);
            if (strcmp(name, "iteritems") == 0) pp = &py_items;
            else if (strcmp(name, "iterkeys") == 0) pp = &py_keys;
            else if (strcmp(name, "itervalues") == 0) pp = &py_values;
            if (pp) {
                if (!*pp) {
                    *pp = PyUnicode_FromString(name + 4);
                    if (!*pp)
                        return NULL;
                }
                method_name = *pp;
            }
        }
#endif
    }
    *p_orig_length = 0;
    if (method_name) {
        PyObject* iter;
        iterable = __Pyx_PyObject_CallMethod0(iterable, method_name);
        if (!iterable)
            return NULL;
#if !CYTHON_COMPILING_IN_PYPY
        if (PyTuple_CheckExact(iterable) || PyList_CheckExact(iterable))
            return iterable;
#endif
        iter = PyObject_GetIter(iterable);
        Py_DECREF(iterable);
        return iter;
    }
    return PyObject_GetIter(iterable);
}
#if !CYTHON_COMPILING_IN_PYPY
static CYTHON_INLINE int __Pyx_dict_iter_next_source_is_dict(
        PyObject* iter_obj, CYTHON_NCP_UNUSED Py_ssize_t orig_length, CYTHON_NCP_UNUSED Py_ssize_t* ppos,
        PyObject** pkey, PyObject** pvalue, PyObject** pitem) {
    PyObject *key, *value;
    if (unlikely(orig_length != PyDict_Size(iter_obj))) {
        PyErr_SetString(PyExc_RuntimeError, "dictionary changed size during iteration");
        return -1;
    }
    if (unlikely(!PyDict_Next(iter_obj, ppos, &key, &value))) {
        return 0;
    }
    if (pitem) {
        PyObject* tuple = PyTuple_New(2);
        if (unlikely(!tuple)) {
            return -1;
        }
        Py_INCREF(key);
        Py_INCREF(value);
        #if CYTHON_ASSUME_SAFE_MACROS
        PyTuple_SET_ITEM(tuple, 0, key);
        PyTuple_SET_ITEM(tuple, 1, value);
        #else
        if (unlikely(PyTuple_SetItem(tuple, 0, key) < 0)) {
            Py_DECREF(value);
            Py_DECREF(tuple);
            return -1;
        }
        if (unlikely(PyTuple_SetItem(tuple, 1, value) < 0)) {
            Py_DECREF(tuple);
            return -1;
        }
        #endif
        *pitem = tuple;
    } else {
        if (pkey) {
            Py_INCREF(key);
            *pkey = key;
        }
        if (pvalue) {
            Py_INCREF(value);
            *pvalue = value;
        }
    }
    return 1;
}
#endif
static CYTHON_INLINE int __Pyx_dict_iter_next(
        PyObject* iter_obj, CYTHON_NCP_UNUSED Py_ssize_t orig_length, CYTHON_NCP_UNUSED Py_ssize_t* ppos,
        PyObject** pkey, PyObject** pvalue, PyObject** pitem, int source_is_dict) {
    PyObject* next_item;
#if !CYTHON_COMPILING_IN_PYPY
    if (source_is_dict) {
        int result;
#if PY_VERSION_HEX >= 0x030d0000 && !CYTHON_COMPILING_IN_LIMITED_API
        Py_BEGIN_CRITICAL_SECTION(iter_obj);
#endif
        result = __Pyx_dict_iter_next_source_is_dict(iter_obj, orig_length, ppos, pkey, pvalue, pitem);
#if PY_VERSION_HEX >= 0x030d0000 && !CYTHON_COMPILING_IN_LIMITED_API
        Py_END_CRITICAL_SECTION();
#endif
        return result;
    } else if (PyTuple_CheckExact(iter_obj)) {
        Py_ssize_t pos = *ppos;
        Py_ssize_t tuple_size = __Pyx_PyTuple_GET_SIZE(iter_obj);
        #if !CYTHON_ASSUME_SAFE_SIZE
        if (unlikely(tuple_size < 0)) return -1;
        #endif
        if (unlikely(pos >= tuple_size)) return 0;
        *ppos = pos + 1;
        #if CYTHON_ASSUME_SAFE_MACROS
        next_item = PyTuple_GET_ITEM(iter_obj, pos);
        #else
        next_item = PyTuple_GetItem(iter_obj, pos);
        if (unlikely(!next_item)) return -1;
        #endif
        Py_INCREF(next_item);
    } else if (PyList_CheckExact(iter_obj)) {
        Py_ssize_t pos = *ppos;
        Py_ssize_t list_size = __Pyx_PyList_GET_SIZE(iter_obj);
        #if !CYTHON_ASSUME_SAFE_SIZE
        if (unlikely(list_size < 0)) return -1;
        #endif
        if (unlikely(pos >= list_size)) return 0;
        *ppos = pos + 1;
        #if CYTHON_AVOID_THREAD_UNSAFE_BORROWED_REFS
        next_item = PyList_GetItemRef(iter_obj, pos);
        if (unlikely(!next_item)) return -1;
        #elif CYTHON_ASSUME_SAFE_MACROS
        next_item = PyList_GET_ITEM(iter_obj, pos);
        Py_INCREF(next_item);
        #else
        next_item = PyList_GetItem(iter_obj, pos);
        if (unlikely(!next_item)) return -1;
        Py_INCREF(next_item);
        #endif
    } else
#endif
    {
        next_item = PyIter_Next(iter_obj);
        if (unlikely(!next_item)) {
            return __Pyx_IterFinish();
        }
    }
    if (pitem) {
        *pitem = next_item;
    } else if (pkey && pvalue) {
        if (__Pyx_unpack_tuple2(next_item, pkey, pvalue, source_is_dict, source_is_dict, 1))
            return -1;
    } else if (pkey) {
        *pkey = next_item;
    } else {
        *pvalue = next_item;
    }
    return 1;
}

/* pop_index */
static PyObject* __Pyx__PyObject_PopNewIndex(PyObject* L, PyObject* py_ix) {
    PyObject *r;
    if (unlikely(!py_ix)) return NULL;
    r = __Pyx__PyObject_PopIndex(L, py_ix);
    Py_DECREF(py_ix);
    return r;
}
static PyObject* __Pyx__PyObject_PopIndex(PyObject* L, PyObject* py_ix) {
    return __Pyx_PyObject_CallMethod1(L, __pyx_mstate_global->__pyx_n_u_pop, py_ix);
}
#if CYTHON_USE_PYLIST_INTERNALS && CYTHON_ASSUME_SAFE_MACROS && CYTHON_ASSUME_SAFE_SIZE
static PyObject* __Pyx__PyList_PopIndex(PyObject* L, PyObject* py_ix, Py_ssize_t ix) {
    Py_ssize_t size = PyList_GET_SIZE(L);
    if (likely(size > (((PyListObject*)L)->allocated >> 1))) {
        Py_ssize_t cix = ix;
        if (cix < 0) {
            cix += size;
        }
        if (likely(__Pyx_is_valid_index(cix, size))) {
            PyObject* v = PyList_GET_ITEM(L, cix);
            __Pyx_SET_SIZE(L, Py_SIZE(L) - 1);
            size -= 1;
            memmove(&PyList_GET_ITEM(L, cix), &PyList_GET_ITEM(L, cix+1), (size_t)(size-cix)*sizeof(PyObject*));
            return v;
        }
    }
    if (py_ix == Py_None) {
        return __Pyx__PyObject_PopNewIndex(L, PyLong_FromSsize_t(ix));
    } else {
        return __Pyx__PyObject_PopIndex(L, py_ix);
    }
}
#endif

/* ArgTypeTest */
static int __Pyx__ArgTypeTest(PyObject *obj, PyTypeObject *type, const char *name, int exact)
{
    __Pyx_TypeName type_name;
    __Pyx_TypeName obj_type_name;
    PyObject *extra_info = __pyx_mstate_global->__pyx_empty_unicode;
    int from_annotation_subclass = 0;
    if (unlikely(!type)) {
        PyErr_SetString(PyExc_SystemError, "Missing type object");
        return 0;
    }
    else if (!exact) {
        if (likely(__Pyx_TypeCheck(obj, type))) return 1;
    } else if (exact == 2) {
        if (__Pyx_TypeCheck(obj, type)) {
            from_annotation_subclass = 1;
            extra_info = __pyx_mstate_global->__pyx_kp_u_Note_that_Cython_is_deliberately;
        }
    }
    type_name = __Pyx_PyType_GetFullyQualifiedName(type);
    obj_type_name = __Pyx_PyType_GetFullyQualifiedName(Py_TYPE(obj));
    PyErr_Format(PyExc_TypeError,
        "Argument '%.200s' has incorrect type (expected " __Pyx_FMT_TYPENAME
        ", got " __Pyx_FMT_TYPENAME ")"
#if __PYX_LIMITED_VERSION_HEX < 0x030C0000
        "%s%U"
#endif
        , name, type_name, obj_type_name
#if __PYX_LIMITED_VERSION_HEX < 0x030C0000
        , (from_annotation_subclass ? ". " : ""), extra_info
#endif
        );
#if __PYX_LIMITED_VERSION_HEX >= 0x030C0000
    if (exact == 2 && from_annotation_subclass) {
        PyObject *res;
        PyObject *vargs[2];
        vargs[0] = PyErr_GetRaisedException();
        vargs[1] = extra_info;
        res = PyObject_VectorcallMethod(__pyx_mstate_global->__pyx_kp_u_add_note, vargs, 2, NULL);
        Py_XDECREF(res);
        PyErr_SetRaisedException(vargs[0]);
    }
#endif
    __Pyx_DECREF_TypeName(type_name);
    __Pyx_DECREF_TypeName(obj_type_name);
    return 0;
}

/* IsLittleEndian */
static CYTHON_INLINE int __Pyx_Is_Little_Endian(void)
{
  union {
    uint32_t u32;
    uint8_t u8[4];
  } S;
  S.u32 = 0x01020304;
  return S.u8[0] == 4;
}

/* BufferFormatCheck */
static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
                              __Pyx_BufFmt_StackElem* stack,
                              const __Pyx_TypeInfo* type) {
  stack[0].field = &ctx->root;
  stack[0].parent_offset = 0;
  ctx->root.type = type;
  ctx->root.name = "buffer dtype";
  ctx->root.offset = 0;
  ctx->head = stack;
  ctx->head->field = &ctx->root;
  ctx->fmt_offset = 0;
  ctx->head->parent_offset = 0;
  ctx->new_packmode = '@';
  ctx->enc_packmode = '@';
  ctx->new_count = 1;
  ctx->enc_count = 0;
  ctx->enc_type = 0;
  ctx->is_complex = 0;
  ctx->is_valid_array = 0;
  ctx->struct_alignment = 0;
  while (type->typegroup == 'S') {
    ++ctx->head;
    ctx->head->field = type->fields;
    ctx->head->parent_offset = 0;
    type = type->fields->type;
  }
}
static int __Pyx_BufFmt_ParseNumber(const char** ts) {
    int count;
    const char* t = *ts;
    if (*t < '0' || *t > '9') {
      return -1;
    } else {
        count = *t++ - '0';
        while (*t >= '0' && *t <= '9') {
            count *= 10;
            count += *t++ - '0';
        }
    }
    *ts = t;
    return count;
}
static int __Pyx_BufFmt_ExpectNumber(const char **ts) {
    int number = __Pyx_BufFmt_ParseNumber(ts);
    if (number == -1)
        PyErr_Format(PyExc_ValueError,\
                     "Does not understand character buffer dtype format string ('%c')", **ts);
    return number;
}
static void __Pyx_BufFmt_RaiseUnexpectedChar(char ch) {
  PyErr_Format(PyExc_ValueError,
               "Unexpected format string character: '%c'", ch);
}
static const char* __Pyx_BufFmt_DescribeTypeChar(char ch, int is_complex) {
  switch (ch) {
    case '?': return "'bool'";
    case 'c': return "'char'";
    case 'b': return "'signed char'";
    case 'B': return "'unsigned char'";
    case 'h': return "'short'";
    case 'H': return "'unsigned short'";
    case 'i': return "'int'";
    case 'I': return "'unsigned int'";
    case 'l': return "'long'";
    case 'L': return "'unsigned long'";
    case 'q': return "'long long'";
    case 'Q': return "'unsigned long long'";
    case 'f': return (is_complex ? "'complex float'" : "'float'");
    case 'd': return (is_complex ? "'complex double'" : "'double'");
    case 'g': return (is_complex ? "'complex long double'" : "'long double'");
    case 'T': return "a struct";
    case 'O': return "Python object";
    case 'P': return "a pointer";
    case 's': case 'p': return "a string";
    case 0: return "end";
    default: return "unparsable format string";
  }
}
static size_t __Pyx_BufFmt_TypeCharToStandardSize(char ch, int is_complex) {
  switch (ch) {
    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
    case 'h': case 'H': return 2;
    case 'i': case 'I': case 'l': case 'L': return 4;
    case 'q': case 'Q': return 8;
    case 'f': return (is_complex ? 8 : 4);
    case 'd': return (is_complex ? 16 : 8);
    case 'g': {
      PyErr_SetString(PyExc_ValueError, "Python does not define a standard format string size for long double ('g')..");
      return 0;
    }
    case 'O': case 'P': return sizeof(void*);
    default:
      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
      return 0;
    }
}
static size_t __Pyx_BufFmt_TypeCharToNativeSize(char ch, int is_complex) {
  switch (ch) {
    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
    case 'h': case 'H': return sizeof(short);
    case 'i': case 'I': return sizeof(int);
    case 'l': case 'L': return sizeof(long);
    #ifdef HAVE_LONG_LONG
    case 'q': case 'Q': return sizeof(PY_LONG_LONG);
    #endif
    case 'f': return sizeof(float) * (is_complex ? 2 : 1);
    case 'd': return sizeof(double) * (is_complex ? 2 : 1);
    case 'g': return sizeof(long double) * (is_complex ? 2 : 1);
    case 'O': case 'P': return sizeof(void*);
    default: {
      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
      return 0;
    }
  }
}
typedef struct { char c; short x; } __Pyx_st_short;
typedef struct { char c; int x; } __Pyx_st_int;
typedef struct { char c; long x; } __Pyx_st_long;
typedef struct { char c; float x; } __Pyx_st_float;
typedef struct { char c; double x; } __Pyx_st_double;
typedef struct { char c; long double x; } __Pyx_st_longdouble;
typedef struct { char c; void *x; } __Pyx_st_void_p;
#ifdef HAVE_LONG_LONG
typedef struct { char c; PY_LONG_LONG x; } __Pyx_st_longlong;
#endif
static size_t __Pyx_BufFmt_TypeCharToAlignment(char ch, int is_complex) {
  CYTHON_UNUSED_VAR(is_complex);
  switch (ch) {
    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
    case 'h': case 'H': return sizeof(__Pyx_st_short) - sizeof(short);
    case 'i': case 'I': return sizeof(__Pyx_st_int) - sizeof(int);
    case 'l': case 'L': return sizeof(__Pyx_st_long) - sizeof(long);
#ifdef HAVE_LONG_LONG
    case 'q': case 'Q': return sizeof(__Pyx_st_longlong) - sizeof(PY_LONG_LONG);
#endif
    case 'f': return sizeof(__Pyx_st_float) - sizeof(float);
    case 'd': return sizeof(__Pyx_st_double) - sizeof(double);
    case 'g': return sizeof(__Pyx_st_longdouble) - sizeof(long double);
    case 'P': case 'O': return sizeof(__Pyx_st_void_p) - sizeof(void*);
    default:
      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
      return 0;
    }
}
/* These are for computing the padding at the end of the struct to align
   on the first member of the struct. This will probably the same as above,
   but we don't have any guarantees.
 */
typedef struct { short x; char c; } __Pyx_pad_short;
typedef struct { int x; char c; } __Pyx_pad_int;
typedef struct { long x; char c; } __Pyx_pad_long;
typedef struct { float x; char c; } __Pyx_pad_float;
typedef struct { double x; char c; } __Pyx_pad_double;
typedef struct { long double x; char c; } __Pyx_pad_longdouble;
typedef struct { void *x; char c; } __Pyx_pad_void_p;
#ifdef HAVE_LONG_LONG
typedef struct { PY_LONG_LONG x; char c; } __Pyx_pad_longlong;
#endif
static size_t __Pyx_BufFmt_TypeCharToPadding(char ch, int is_complex) {
  CYTHON_UNUSED_VAR(is_complex);
  switch (ch) {
    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
    case 'h': case 'H': return sizeof(__Pyx_pad_short) - sizeof(short);
    case 'i': case 'I': return sizeof(__Pyx_pad_int) - sizeof(int);
    case 'l': case 'L': return sizeof(__Pyx_pad_long) - sizeof(long);
#ifdef HAVE_LONG_LONG
    case 'q': case 'Q': return sizeof(__Pyx_pad_longlong) - sizeof(PY_LONG_LONG);
#endif
    case 'f': return sizeof(__Pyx_pad_float) - sizeof(float);
    case 'd': return sizeof(__Pyx_pad_double) - sizeof(double);
    case 'g': return sizeof(__Pyx_pad_longdouble) - sizeof(long double);
    case 'P': case 'O': return sizeof(__Pyx_pad_void_p) - sizeof(void*);
    default:
      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
      return 0;
    }
}
static char __Pyx_BufFmt_TypeCharToGroup(char ch, int is_complex) {
  switch (ch) {
    case 'c':
        return 'H';
    case 'b': case 'h': case 'i':
    case 'l': case 'q': case 's': case 'p':
        return 'I';
    case '?': case 'B': case 'H': case 'I': case 'L': case 'Q':
        return 'U';
    case 'f': case 'd': case 'g':
        return (is_complex ? 'C' : 'R');
    case 'O':
        return 'O';
    case 'P':
        return 'P';
    default: {
      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
      return 0;
    }
  }
}
static void __Pyx_BufFmt_RaiseExpected(__Pyx_BufFmt_Context* ctx) {
  if (ctx->head == NULL || ctx->head->field == &ctx->root) {
    const char* expected;
    const char* quote;
    if (ctx->head == NULL) {
      expected = "end";
      quote = "";
    } else {
      expected = ctx->head->field->type->name;
      quote = "'";
    }
    PyErr_Format(PyExc_ValueError,
                 "Buffer dtype mismatch, expected %s%s%s but got %s",
                 quote, expected, quote,
                 __Pyx_BufFmt_DescribeTypeChar(ctx->enc_type, ctx->is_complex));
  } else {
    const __Pyx_StructField* field = ctx->head->field;
    const __Pyx_StructField* parent = (ctx->head - 1)->field;
    PyErr_Format(PyExc_ValueError,
                 "Buffer dtype mismatch, expected '%s' but got %s in '%s.%s'",
                 field->type->name, __Pyx_BufFmt_DescribeTypeChar(ctx->enc_type, ctx->is_complex),
                 parent->type->name, field->name);
  }
}
static int __Pyx_BufFmt_ProcessTypeChunk(__Pyx_BufFmt_Context* ctx) {
  char group;
  size_t size, offset, arraysize = 1;
  if (ctx->enc_type == 0) return 0;
  if (ctx->head->field->type->arraysize[0]) {
    int i, ndim = 0;
    if (ctx->enc_type == 's' || ctx->enc_type == 'p') {
        ctx->is_valid_array = ctx->head->field->type->ndim == 1;
        ndim = 1;
        if (ctx->enc_count != ctx->head->field->type->arraysize[0]) {
            PyErr_Format(PyExc_ValueError,
                         "Expected a dimension of size %zu, got %zu",
                         ctx->head->field->type->arraysize[0], ctx->enc_count);
            return -1;
        }
    }
    if (!ctx->is_valid_array) {
      PyErr_Format(PyExc_ValueError, "Expected %d dimensions, got %d",
                   ctx->head->field->type->ndim, ndim);
      return -1;
    }
    for (i = 0; i < ctx->head->field->type->ndim; i++) {
      arraysize *= ctx->head->field->type->arraysize[i];
    }
    ctx->is_valid_array = 0;
    ctx->enc_count = 1;
  }
  group = __Pyx_BufFmt_TypeCharToGroup(ctx->enc_type, ctx->is_complex);
  do {
    const __Pyx_StructField* field = ctx->head->field;
    const __Pyx_TypeInfo* type = field->type;
    if (ctx->enc_packmode == '@' || ctx->enc_packmode == '^') {
      size = __Pyx_BufFmt_TypeCharToNativeSize(ctx->enc_type, ctx->is_complex);
    } else {
      size = __Pyx_BufFmt_TypeCharToStandardSize(ctx->enc_type, ctx->is_complex);
    }
    if (ctx->enc_packmode == '@') {
      size_t align_at = __Pyx_BufFmt_TypeCharToAlignment(ctx->enc_type, ctx->is_complex);
      size_t align_mod_offset;
      if (align_at == 0) return -1;
      align_mod_offset = ctx->fmt_offset % align_at;
      if (align_mod_offset > 0) ctx->fmt_offset += align_at - align_mod_offset;
      if (ctx->struct_alignment == 0)
          ctx->struct_alignment = __Pyx_BufFmt_TypeCharToPadding(ctx->enc_type,
                                                                 ctx->is_complex);
    }
    if (type->size != size || type->typegroup != group) {
      if (type->typegroup == 'C' && type->fields != NULL) {
        size_t parent_offset = ctx->head->parent_offset + field->offset;
        ++ctx->head;
        ctx->head->field = type->fields;
        ctx->head->parent_offset = parent_offset;
        continue;
      }
      if ((type->typegroup == 'H' || group == 'H') && type->size == size) {
      } else {
          __Pyx_BufFmt_RaiseExpected(ctx);
          return -1;
      }
    }
    offset = ctx->head->parent_offset + field->offset;
    if (ctx->fmt_offset != offset) {
      PyErr_Format(PyExc_ValueError,
                   "Buffer dtype mismatch; next field is at offset %" CYTHON_FORMAT_SSIZE_T "d but %" CYTHON_FORMAT_SSIZE_T "d expected",
                   (Py_ssize_t)ctx->fmt_offset, (Py_ssize_t)offset);
      return -1;
    }
    ctx->fmt_offset += size;
    if (arraysize)
      ctx->fmt_offset += (arraysize - 1) * size;
    --ctx->enc_count;
    while (1) {
      if (field == &ctx->root) {
        ctx->head = NULL;
        if (ctx->enc_count != 0) {
          __Pyx_BufFmt_RaiseExpected(ctx);
          return -1;
        }
        break;
      }
      ctx->head->field = ++field;
      if (field->type == NULL) {
        --ctx->head;
        field = ctx->head->field;
        continue;
      } else if (field->type->typegroup == 'S') {
        size_t parent_offset = ctx->head->parent_offset + field->offset;
        if (field->type->fields->type == NULL) continue;
        field = field->type->fields;
        ++ctx->head;
        ctx->head->field = field;
        ctx->head->parent_offset = parent_offset;
        break;
      } else {
        break;
      }
    }
  } while (ctx->enc_count);
  ctx->enc_type = 0;
  ctx->is_complex = 0;
  return 0;
}
static int
__pyx_buffmt_parse_array(__Pyx_BufFmt_Context* ctx, const char** tsp)
{
    const char *ts = *tsp;
    int i = 0, number, ndim;
    ++ts;
    if (ctx->new_count != 1) {
        PyErr_SetString(PyExc_ValueError,
                        "Cannot handle repeated arrays in format string");
        return -1;
    }
    if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return -1;
    ndim = ctx->head->field->type->ndim;
    while (*ts && *ts != ')') {
        switch (*ts) {
            case ' ': case '\f': case '\r': case '\n': case '\t': case '\v':  continue;
            default:  break;
        }
        number = __Pyx_BufFmt_ExpectNumber(&ts);
        if (number == -1) return -1;
        if (i < ndim && (size_t) number != ctx->head->field->type->arraysize[i]) {
            PyErr_Format(PyExc_ValueError,
                        "Expected a dimension of size %zu, got %d",
                        ctx->head->field->type->arraysize[i], number);
            return -1;
        }
        if (*ts != ',' && *ts != ')') {
            PyErr_Format(PyExc_ValueError,
                                "Expected a comma in format string, got '%c'", *ts);
            return -1;
        }
        if (*ts == ',') ts++;
        i++;
    }
    if (i != ndim) {
        PyErr_Format(PyExc_ValueError, "Expected %d dimension(s), got %d",
                            ctx->head->field->type->ndim, i);
        return -1;
    }
    if (!*ts) {
        PyErr_SetString(PyExc_ValueError,
                        "Unexpected end of format string, expected ')'");
        return -1;
    }
    ctx->is_valid_array = 1;
    ctx->new_count = 1;
    *tsp = ++ts;
    return 0;
}
static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts) {
  int got_Z = 0;
  while (1) {
    switch(*ts) {
      case 0:
        if (ctx->enc_type != 0 && ctx->head == NULL) {
          __Pyx_BufFmt_RaiseExpected(ctx);
          return NULL;
        }
        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
        if (ctx->head != NULL) {
          __Pyx_BufFmt_RaiseExpected(ctx);
          return NULL;
        }
        return ts;
      case ' ':
      case '\r':
      case '\n':
        ++ts;
        break;
      case '<':
        if (!__Pyx_Is_Little_Endian()) {
          PyErr_SetString(PyExc_ValueError, "Little-endian buffer not supported on big-endian compiler");
          return NULL;
        }
        ctx->new_packmode = '=';
        ++ts;
        break;
      case '>':
      case '!':
        if (__Pyx_Is_Little_Endian()) {
          PyErr_SetString(PyExc_ValueError, "Big-endian buffer not supported on little-endian compiler");
          return NULL;
        }
        ctx->new_packmode = '=';
        ++ts;
        break;
      case '=':
      case '@':
      case '^':
        ctx->new_packmode = *ts++;
        break;
      case 'T':
        {
          const char* ts_after_sub;
          size_t i, struct_count = ctx->new_count;
          size_t struct_alignment = ctx->struct_alignment;
          ctx->new_count = 1;
          ++ts;
          if (*ts != '{') {
            PyErr_SetString(PyExc_ValueError, "Buffer acquisition: Expected '{' after 'T'");
            return NULL;
          }
          if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
          ctx->enc_type = 0;
          ctx->enc_count = 0;
          ctx->struct_alignment = 0;
          ++ts;
          ts_after_sub = ts;
          for (i = 0; i != struct_count; ++i) {
            ts_after_sub = __Pyx_BufFmt_CheckString(ctx, ts);
            if (!ts_after_sub) return NULL;
          }
          ts = ts_after_sub;
          if (struct_alignment) ctx->struct_alignment = struct_alignment;
        }
        break;
      case '}':
        {
          size_t alignment = ctx->struct_alignment;
          ++ts;
          if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
          ctx->enc_type = 0;
          if (alignment && ctx->fmt_offset % alignment) {
            ctx->fmt_offset += alignment - (ctx->fmt_offset % alignment);
          }
        }
        return ts;
      case 'x':
        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
        ctx->fmt_offset += ctx->new_count;
        ctx->new_count = 1;
        ctx->enc_count = 0;
        ctx->enc_type = 0;
        ctx->enc_packmode = ctx->new_packmode;
        ++ts;
        break;
      case 'Z':
        got_Z = 1;
        ++ts;
        if (*ts != 'f' && *ts != 'd' && *ts != 'g') {
          __Pyx_BufFmt_RaiseUnexpectedChar('Z');
          return NULL;
        }
        CYTHON_FALLTHROUGH;
      case '?': case 'c': case 'b': case 'B': case 'h': case 'H': case 'i': case 'I':
      case 'l': case 'L': case 'q': case 'Q':
      case 'f': case 'd': case 'g':
      case 'O': case 'p':
        if ((ctx->enc_type == *ts) && (got_Z == ctx->is_complex) &&
            (ctx->enc_packmode == ctx->new_packmode) && (!ctx->is_valid_array)) {
          ctx->enc_count += ctx->new_count;
          ctx->new_count = 1;
          got_Z = 0;
          ++ts;
          break;
        }
        CYTHON_FALLTHROUGH;
      case 's':
        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
        ctx->enc_count = ctx->new_count;
        ctx->enc_packmode = ctx->new_packmode;
        ctx->enc_type = *ts;
        ctx->is_complex = got_Z;
        ++ts;
        ctx->new_count = 1;
        got_Z = 0;
        break;
      case ':':
        ++ts;
        while(*ts != ':') ++ts;
        ++ts;
        break;
      case '(':
        if (__pyx_buffmt_parse_array(ctx, &ts) < 0) return NULL;
        break;
      default:
        {
          int number = __Pyx_BufFmt_ExpectNumber(&ts);
          if (number == -1) return NULL;
          ctx->new_count = (size_t)number;
        }
    }
  }
}

/* BufferGetAndValidate */
  static CYTHON_INLINE void __Pyx_SafeReleaseBuffer(Py_buffer* info) {
  if (unlikely(info->buf == NULL)) return;
  if (info->suboffsets == __Pyx_minusones) info->suboffsets = NULL;
  PyBuffer_Release(info);
}
static void __Pyx_ZeroBuffer(Py_buffer* buf) {
  buf->buf = NULL;
  buf->obj = NULL;
  buf->strides = __Pyx_zeros;
  buf->shape = __Pyx_zeros;
  buf->suboffsets = __Pyx_minusones;
}
static int __Pyx__GetBufferAndValidate(
        Py_buffer* buf, PyObject* obj,  const __Pyx_TypeInfo* dtype, int flags,
        int nd, int cast, __Pyx_BufFmt_StackElem* stack)
{
  buf->buf = NULL;
  if (unlikely(PyObject_GetBuffer(obj, buf, flags) == -1)) {
    __Pyx_ZeroBuffer(buf);
    return -1;
  }
  if (unlikely(buf->ndim != nd)) {
    PyErr_Format(PyExc_ValueError,
                 "Buffer has wrong number of dimensions (expected %d, got %d)",
                 nd, buf->ndim);
    goto fail;
  }
  if (!cast) {
    __Pyx_BufFmt_Context ctx;
    __Pyx_BufFmt_Init(&ctx, stack, dtype);
    if (!__Pyx_BufFmt_CheckString(&ctx, buf->format)) goto fail;
  }
  if (unlikely((size_t)buf->itemsize != dtype->size)) {
    PyErr_Format(PyExc_ValueError,
      "Item size of buffer (%" CYTHON_FORMAT_SSIZE_T "d byte%s) does not match size of '%s' (%" CYTHON_FORMAT_SSIZE_T "d byte%s)",
      buf->itemsize, (buf->itemsize > 1) ? "s" : "",
      dtype->name, (Py_ssize_t)dtype->size, (dtype->size > 1) ? "s" : "");
    goto fail;
  }
  if (buf->suboffsets == NULL) buf->suboffsets = __Pyx_minusones;
  return 0;
fail:;
  __Pyx_SafeReleaseBuffer(buf);
  return -1;
}

/* CIntToDigits */
  static const char DIGIT_PAIRS_10[2*10*10+1] = {
    "00010203040506070809"
    "10111213141516171819"
    "20212223242526272829"
    "30313233343536373839"
    "40414243444546474849"
    "50515253545556575859"
    "60616263646566676869"
    "70717273747576777879"
    "80818283848586878889"
    "90919293949596979899"
};
static const char DIGIT_PAIRS_8[2*8*8+1] = {
    "0001020304050607"
    "1011121314151617"
    "2021222324252627"
    "3031323334353637"
    "4041424344454647"
    "5051525354555657"
    "6061626364656667"
    "7071727374757677"
};
static const char DIGITS_HEX[2*16+1] = {
    "0123456789abcdef"
    "0123456789ABCDEF"
};

/* BuildPyUnicode */
  static PyObject* __Pyx_PyUnicode_BuildFromAscii(Py_ssize_t ulength, const char* chars, int clength,
                                                int prepend_sign, char padding_char) {
    PyObject *uval;
    Py_ssize_t uoffset = ulength - clength;
#if CYTHON_USE_UNICODE_INTERNALS
    Py_ssize_t i;
    void *udata;
    uval = PyUnicode_New(ulength, 127);
    if (unlikely(!uval)) return NULL;
    udata = PyUnicode_DATA(uval);
    if (uoffset > 0) {
        i = 0;
        if (prepend_sign) {
            __Pyx_PyUnicode_WRITE(PyUnicode_1BYTE_KIND, udata, 0, '-');
            i++;
        }
        for (; i < uoffset; i++) {
            __Pyx_PyUnicode_WRITE(PyUnicode_1BYTE_KIND, udata, i, padding_char);
        }
    }
    for (i=0; i < clength; i++) {
        __Pyx_PyUnicode_WRITE(PyUnicode_1BYTE_KIND, udata, uoffset+i, chars[i]);
    }
#else
    {
        PyObject *sign = NULL, *padding = NULL;
        uval = NULL;
        if (uoffset > 0) {
            prepend_sign = !!prepend_sign;
            if (uoffset > prepend_sign) {
                padding = PyUnicode_FromOrdinal(padding_char);
                if (likely(padding) && uoffset > prepend_sign + 1) {
                    PyObject *tmp = PySequence_Repeat(padding, uoffset - prepend_sign);
                    Py_DECREF(padding);
                    padding = tmp;
                }
                if (unlikely(!padding)) goto done_or_error;
            }
            if (prepend_sign) {
                sign = PyUnicode_FromOrdinal('-');
                if (unlikely(!sign)) goto done_or_error;
            }
        }
        uval = PyUnicode_DecodeASCII(chars, clength, NULL);
        if (likely(uval) && padding) {
            PyObject *tmp = PyUnicode_Concat(padding, uval);
            Py_DECREF(uval);
            uval = tmp;
        }
        if (likely(uval) && sign) {
            PyObject *tmp = PyUnicode_Concat(sign, uval);
            Py_DECREF(uval);
            uval = tmp;
        }
done_or_error:
        Py_XDECREF(padding);
        Py_XDECREF(sign);
    }
#endif
    return uval;
}

/* COrdinalToPyUnicode */
  static CYTHON_INLINE int __Pyx_CheckUnicodeValue(int value) {
    return value <= 1114111;
}
static PyObject* __Pyx_PyUnicode_FromOrdinal_Padded(int value, Py_ssize_t ulength, char padding_char) {
    if (likely(ulength <= 250)) {
        char chars[256];
        if (value <= 255) {
            memset(chars, padding_char, (size_t) (ulength - 1));
            chars[ulength-1] = (char) value;
            return PyUnicode_DecodeLatin1(chars, ulength, NULL);
        }
        char *cpos = chars + sizeof(chars);
        if (value < 0x800) {
            *--cpos = (char) (0x80 | (value & 0x3f));
            value >>= 6;
            *--cpos = (char) (0xc0 | (value & 0x1f));
        } else if (value < 0x10000) {
            *--cpos = (char) (0x80 | (value & 0x3f));
            value >>= 6;
            *--cpos = (char) (0x80 | (value & 0x3f));
            value >>= 6;
            *--cpos = (char) (0xe0 | (value & 0x0f));
        } else {
            *--cpos = (char) (0x80 | (value & 0x3f));
            value >>= 6;
            *--cpos = (char) (0x80 | (value & 0x3f));
            value >>= 6;
            *--cpos = (char) (0x80 | (value & 0x3f));
            value >>= 6;
            *--cpos = (char) (0xf0 | (value & 0x07));
        }
        cpos -= ulength;
        memset(cpos, padding_char, (size_t) (ulength - 1));
        return PyUnicode_DecodeUTF8(cpos, chars + sizeof(chars) - cpos, NULL);
    }
    if (value <= 127 && CYTHON_USE_UNICODE_INTERNALS) {
        const char chars[1] = {(char) value};
        return __Pyx_PyUnicode_BuildFromAscii(ulength, chars, 1, 0, padding_char);
    }
    {
        PyObject *uchar, *padding_uchar, *padding, *result;
        padding_uchar = PyUnicode_FromOrdinal(padding_char);
        if (unlikely(!padding_uchar)) return NULL;
        padding = PySequence_Repeat(padding_uchar, ulength - 1);
        Py_DECREF(padding_uchar);
        if (unlikely(!padding)) return NULL;
        uchar = PyUnicode_FromOrdinal(value);
        if (unlikely(!uchar)) {
            Py_DECREF(padding);
            return NULL;
        }
        result = PyUnicode_Concat(padding, uchar);
        Py_DECREF(padding);
        Py_DECREF(uchar);
        return result;
    }
}

/* CIntToPyUnicode */
  static CYTHON_INLINE PyObject* __Pyx_PyUnicode_From_Py_ssize_t(Py_ssize_t value, Py_ssize_t width, char padding_char, char format_char) {
    char digits[sizeof(Py_ssize_t)*3+2];
    char *dpos, *end = digits + sizeof(Py_ssize_t)*3+2;
    const char *hex_digits = DIGITS_HEX;
    Py_ssize_t length, ulength;
    int prepend_sign, last_one_off;
    Py_ssize_t remaining;
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wconversion"
#endif
    const Py_ssize_t neg_one = (Py_ssize_t) -1, const_zero = (Py_ssize_t) 0;
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic pop
#endif
    const int is_unsigned = neg_one > const_zero;
    if (format_char == 'c') {
        if (unlikely(!(is_unsigned || value == 0 || value > 0) ||
                     !(sizeof(value) <= 2 || value & ~ (Py_ssize_t) 0x01fffff || __Pyx_CheckUnicodeValue((int) value)))) {
            PyErr_SetString(PyExc_OverflowError, "%c arg not in range(0x110000)");
            return NULL;
        }
        if (width <= 1) {
            return PyUnicode_FromOrdinal((int) value);
        }
        return __Pyx_PyUnicode_FromOrdinal_Padded((int) value, width, padding_char);
    }
    if (format_char == 'X') {
        hex_digits += 16;
        format_char = 'x';
    }
    remaining = value;
    last_one_off = 0;
    dpos = end;
    do {
        int digit_pos;
        switch (format_char) {
        case 'o':
            digit_pos = abs((int)(remaining % (8*8)));
            remaining = (Py_ssize_t) (remaining / (8*8));
            dpos -= 2;
            memcpy(dpos, DIGIT_PAIRS_8 + digit_pos * 2, 2);
            last_one_off = (digit_pos < 8);
            break;
        case 'd':
            digit_pos = abs((int)(remaining % (10*10)));
            remaining = (Py_ssize_t) (remaining / (10*10));
            dpos -= 2;
            memcpy(dpos, DIGIT_PAIRS_10 + digit_pos * 2, 2);
            last_one_off = (digit_pos < 10);
            break;
        case 'x':
            *(--dpos) = hex_digits[abs((int)(remaining % 16))];
            remaining = (Py_ssize_t) (remaining / 16);
            break;
        default:
            assert(0);
            break;
        }
    } while (unlikely(remaining != 0));
    assert(!last_one_off || *dpos == '0');
    dpos += last_one_off;
    length = end - dpos;
    ulength = length;
    prepend_sign = 0;
    if (!is_unsigned && value <= neg_one) {
        if (padding_char == ' ' || width <= length + 1) {
            *(--dpos) = '-';
            ++length;
        } else {
            prepend_sign = 1;
        }
        ++ulength;
    }
    if (width > ulength) {
        ulength = width;
    }
    if (ulength == 1) {
        return PyUnicode_FromOrdinal(*dpos);
    }
    return __Pyx_PyUnicode_BuildFromAscii(ulength, dpos, (int) length, prepend_sign, padding_char);
}

/* BufferIndexError */
  static void __Pyx_RaiseBufferIndexError(int axis) {
  PyErr_Format(PyExc_IndexError,
     "Out of bounds on buffer access (axis %d)", axis);
}

/* PyObjectVectorCallKwBuilder */
  #if CYTHON_VECTORCALL
static int __Pyx_VectorcallBuilder_AddArg(PyObject *key, PyObject *value, PyObject *builder, PyObject **args, int n) {
    (void)__Pyx_PyObject_FastCallDict;
    if (__Pyx_PyTuple_SET_ITEM(builder, n, key) != (0)) return -1;
    Py_INCREF(key);
    args[n] = value;
    return 0;
}
CYTHON_UNUSED static int __Pyx_VectorcallBuilder_AddArg_Check(PyObject *key, PyObject *value, PyObject *builder, PyObject **args, int n) {
    (void)__Pyx_VectorcallBuilder_AddArgStr;
    if (unlikely(!PyUnicode_Check(key))) {
        PyErr_SetString(PyExc_TypeError, "keywords must be strings");
        return -1;
    }
    return __Pyx_VectorcallBuilder_AddArg(key, value, builder, args, n);
}
static int __Pyx_VectorcallBuilder_AddArgStr(const char *key, PyObject *value, PyObject *builder, PyObject **args, int n) {
    PyObject *pyKey = PyUnicode_FromString(key);
    if (!pyKey) return -1;
    return __Pyx_VectorcallBuilder_AddArg(pyKey, value, builder, args, n);
}
#else // CYTHON_VECTORCALL
CYTHON_UNUSED static int __Pyx_VectorcallBuilder_AddArg_Check(PyObject *key, PyObject *value, PyObject *builder, CYTHON_UNUSED PyObject **args, CYTHON_UNUSED int n) {
    if (unlikely(!PyUnicode_Check(key))) {
        PyErr_SetString(PyExc_TypeError, "keywords must be strings");
        return -1;
    }
    return PyDict_SetItem(builder, key, value);
}
#endif

/* PyObjectVectorCallMethodKwBuilder */
  #if !CYTHON_VECTORCALL || PY_VERSION_HEX < 0x03090000
static PyObject *__Pyx_Object_VectorcallMethod_CallFromBuilder(PyObject *name, PyObject *const *args, size_t nargsf, PyObject *kwnames) {
    PyObject *result;
    PyObject *obj = PyObject_GetAttr(args[0], name);
    if (unlikely(!obj))
        return NULL;
    result = __Pyx_Object_Vectorcall_CallFromBuilder(obj, args+1, nargsf-1, kwnames);
    Py_DECREF(obj);
    return result;
}
#endif

/* PyUnicode_Unicode */
  static CYTHON_INLINE PyObject* __Pyx_PyUnicode_Unicode(PyObject *obj) {
    if (unlikely(obj == Py_None))
        obj = __pyx_mstate_global->__pyx_kp_u_None;
    return __Pyx_NewRef(obj);
}

/* RaiseUnexpectedTypeError */
  static int
__Pyx_RaiseUnexpectedTypeError(const char *expected, PyObject *obj)
{
    __Pyx_TypeName obj_type_name = __Pyx_PyType_GetFullyQualifiedName(Py_TYPE(obj));
    PyErr_Format(PyExc_TypeError, "Expected %s, got " __Pyx_FMT_TYPENAME,
                 expected, obj_type_name);
    __Pyx_DECREF_TypeName(obj_type_name);
    return 0;
}

/* ExtTypeTest */
  static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    __Pyx_TypeName obj_type_name;
    __Pyx_TypeName type_name;
    if (unlikely(!type)) {
        PyErr_SetString(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (likely(__Pyx_TypeCheck(obj, type)))
        return 1;
    obj_type_name = __Pyx_PyType_GetFullyQualifiedName(Py_TYPE(obj));
    type_name = __Pyx_PyType_GetFullyQualifiedName(type);
    PyErr_Format(PyExc_TypeError,
                 "Cannot convert " __Pyx_FMT_TYPENAME " to " __Pyx_FMT_TYPENAME,
                 obj_type_name, type_name);
    __Pyx_DECREF_TypeName(obj_type_name);
    __Pyx_DECREF_TypeName(type_name);
    return 0;
}

/* CallTypeTraverse */
  #if !CYTHON_USE_TYPE_SPECS || (!CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x03090000)
#else
static int __Pyx_call_type_traverse(PyObject *o, int always_call, visitproc visit, void *arg) {
    #if CYTHON_COMPILING_IN_LIMITED_API && __PYX_LIMITED_VERSION_HEX < 0x03090000
    if (__Pyx_get_runtime_version() < 0x03090000) return 0;
    #endif
    if (!always_call) {
        PyTypeObject *base = __Pyx_PyObject_GetSlot(o, tp_base, PyTypeObject*);
        unsigned long flags = PyType_GetFlags(base);
        if (flags & Py_TPFLAGS_HEAPTYPE) {
            return 0;
        }
    }
    Py_VISIT((PyObject*)Py_TYPE(o));
    return 0;
}
#endif

/* LimitedApiGetTypeDict */
  #if CYTHON_COMPILING_IN_LIMITED_API
static Py_ssize_t __Pyx_GetTypeDictOffset(void) {
    PyObject *tp_dictoffset_o;
    Py_ssize_t tp_dictoffset;
    tp_dictoffset_o = PyObject_GetAttrString((PyObject*)(&PyType_Type), "__dictoffset__");
    if (unlikely(!tp_dictoffset_o)) return -1;
    tp_dictoffset = PyLong_AsSsize_t(tp_dictoffset_o);
    Py_DECREF(tp_dictoffset_o);
    if (unlikely(tp_dictoffset == 0)) {
        PyErr_SetString(
            PyExc_TypeError,
            "'type' doesn't have a dictoffset");
        return -1;
    } else if (unlikely(tp_dictoffset < 0)) {
        PyErr_SetString(
            PyExc_TypeError,
            "'type' has an unexpected negative dictoffset. "
            "Please report this as Cython bug");
        return -1;
    }
    return tp_dictoffset;
}
static PyObject *__Pyx_GetTypeDict(PyTypeObject *tp) {
    static Py_ssize_t tp_dictoffset = 0;
    if (unlikely(tp_dictoffset == 0)) {
        tp_dictoffset = __Pyx_GetTypeDictOffset();
        if (unlikely(tp_dictoffset == -1 && PyErr_Occurred())) {
            tp_dictoffset = 0; // try again next time?
            return NULL;
        }
    }
    return *(PyObject**)((char*)tp + tp_dictoffset);
}
#endif

/* SetItemOnTypeDict */
  static int __Pyx__SetItemOnTypeDict(PyTypeObject *tp, PyObject *k, PyObject *v) {
    int result;
    PyObject *tp_dict;
#if CYTHON_COMPILING_IN_LIMITED_API
    tp_dict = __Pyx_GetTypeDict(tp);
    if (unlikely(!tp_dict)) return -1;
#else
    tp_dict = tp->tp_dict;
#endif
    result = PyDict_SetItem(tp_dict, k, v);
    if (likely(!result)) {
        PyType_Modified(tp);
        if (unlikely(PyObject_HasAttr(v, __pyx_mstate_global->__pyx_n_u_set_name))) {
            PyObject *setNameResult = PyObject_CallMethodObjArgs(v, __pyx_mstate_global->__pyx_n_u_set_name,  (PyObject *) tp, k, NULL);
            if (!setNameResult) return -1;
            Py_DECREF(setNameResult);
        }
    }
    return result;
}

/* FixUpExtensionType */
  static int __Pyx_fix_up_extension_type_from_spec(PyType_Spec *spec, PyTypeObject *type) {
#if __PYX_LIMITED_VERSION_HEX > 0x030900B1
    CYTHON_UNUSED_VAR(spec);
    CYTHON_UNUSED_VAR(type);
    CYTHON_UNUSED_VAR(__Pyx__SetItemOnTypeDict);
#else
    const PyType_Slot *slot = spec->slots;
    int changed = 0;
#if !CYTHON_COMPILING_IN_LIMITED_API
    while (slot && slot->slot && slot->slot != Py_tp_members)
        slot++;
    if (slot && slot->slot == Py_tp_members) {
#if !CYTHON_COMPILING_IN_CPYTHON
        const
#endif  // !CYTHON_COMPILING_IN_CPYTHON)
            PyMemberDef *memb = (PyMemberDef*) slot->pfunc;
        while (memb && memb->name) {
            if (memb->name[0] == '_' && memb->name[1] == '_') {
                if (strcmp(memb->name, "__weaklistoffset__") == 0) {
                    assert(memb->type == T_PYSSIZET);
                    assert(memb->flags == READONLY);
                    type->tp_weaklistoffset = memb->offset;
                    changed = 1;
                }
                else if (strcmp(memb->name, "__dictoffset__") == 0) {
                    assert(memb->type == T_PYSSIZET);
                    assert(memb->flags == READONLY);
                    type->tp_dictoffset = memb->offset;
                    changed = 1;
                }
#if CYTHON_METH_FASTCALL
                else if (strcmp(memb->name, "__vectorcalloffset__") == 0) {
                    assert(memb->type == T_PYSSIZET);
                    assert(memb->flags == READONLY);
#if PY_VERSION_HEX >= 0x030800b4
                    type->tp_vectorcall_offset = memb->offset;
#else
                    type->tp_print = (printfunc) memb->offset;
#endif
                    changed = 1;
                }
#endif  // CYTHON_METH_FASTCALL
#if !CYTHON_COMPILING_IN_PYPY
                else if (strcmp(memb->name, "__module__") == 0) {
                    PyObject *descr;
                    assert(memb->type == T_OBJECT);
                    assert(memb->flags == 0 || memb->flags == READONLY);
                    descr = PyDescr_NewMember(type, memb);
                    if (unlikely(!descr))
                        return -1;
                    int set_item_result = PyDict_SetItem(type->tp_dict, PyDescr_NAME(descr), descr);
                    Py_DECREF(descr);
                    if (unlikely(set_item_result < 0)) {
                        return -1;
                    }
                    changed = 1;
                }
#endif  // !CYTHON_COMPILING_IN_PYPY
            }
            memb++;
        }
    }
#endif  // !CYTHON_COMPILING_IN_LIMITED_API
#if !CYTHON_COMPILING_IN_PYPY
    slot = spec->slots;
    while (slot && slot->slot && slot->slot != Py_tp_getset)
        slot++;
    if (slot && slot->slot == Py_tp_getset) {
        PyGetSetDef *getset = (PyGetSetDef*) slot->pfunc;
        while (getset && getset->name) {
            if (getset->name[0] == '_' && getset->name[1] == '_' && strcmp(getset->name, "__module__") == 0) {
                PyObject *descr = PyDescr_NewGetSet(type, getset);
                if (unlikely(!descr))
                    return -1;
                #if CYTHON_COMPILING_IN_LIMITED_API
                PyObject *pyname = PyUnicode_FromString(getset->name);
                if (unlikely(!pyname)) {
                    Py_DECREF(descr);
                    return -1;
                }
                int set_item_result = __Pyx_SetItemOnTypeDict(type, pyname, descr);
                Py_DECREF(pyname);
                #else
                CYTHON_UNUSED_VAR(__Pyx__SetItemOnTypeDict);
                int set_item_result = PyDict_SetItem(type->tp_dict, PyDescr_NAME(descr), descr);
                #endif
                Py_DECREF(descr);
                if (unlikely(set_item_result < 0)) {
                    return -1;
                }
                changed = 1;
            }
            ++getset;
        }
    }
#endif  // !CYTHON_COMPILING_IN_PYPY
    if (changed)
        PyType_Modified(type);
#endif  // PY_VERSION_HEX > 0x030900B1
    return 0;
}

/* ValidateBasesTuple */
  #if CYTHON_COMPILING_IN_CPYTHON || CYTHON_COMPILING_IN_LIMITED_API || CYTHON_USE_TYPE_SPECS
static int __Pyx_validate_bases_tuple(const char *type_name, Py_ssize_t dictoffset, PyObject *bases) {
    Py_ssize_t i, n;
#if CYTHON_ASSUME_SAFE_SIZE
    n = PyTuple_GET_SIZE(bases);
#else
    n = PyTuple_Size(bases);
    if (unlikely(n < 0)) return -1;
#endif
    for (i = 1; i < n; i++)
    {
        PyTypeObject *b;
#if CYTHON_AVOID_BORROWED_REFS
        PyObject *b0 = PySequence_GetItem(bases, i);
        if (!b0) return -1;
#elif CYTHON_ASSUME_SAFE_MACROS
        PyObject *b0 = PyTuple_GET_ITEM(bases, i);
#else
        PyObject *b0 = PyTuple_GetItem(bases, i);
        if (!b0) return -1;
#endif
        b = (PyTypeObject*) b0;
        if (!__Pyx_PyType_HasFeature(b, Py_TPFLAGS_HEAPTYPE))
        {
            __Pyx_TypeName b_name = __Pyx_PyType_GetFullyQualifiedName(b);
            PyErr_Format(PyExc_TypeError,
                "base class '" __Pyx_FMT_TYPENAME "' is not a heap type", b_name);
            __Pyx_DECREF_TypeName(b_name);
#if CYTHON_AVOID_BORROWED_REFS
            Py_DECREF(b0);
#endif
            return -1;
        }
        if (dictoffset == 0)
        {
            Py_ssize_t b_dictoffset = 0;
#if CYTHON_USE_TYPE_SLOTS
            b_dictoffset = b->tp_dictoffset;
#else
            PyObject *py_b_dictoffset = PyObject_GetAttrString((PyObject*)b, "__dictoffset__");
            if (!py_b_dictoffset) goto dictoffset_return;
            b_dictoffset = PyLong_AsSsize_t(py_b_dictoffset);
            Py_DECREF(py_b_dictoffset);
            if (b_dictoffset == -1 && PyErr_Occurred()) goto dictoffset_return;
#endif
            if (b_dictoffset) {
                {
                    __Pyx_TypeName b_name = __Pyx_PyType_GetFullyQualifiedName(b);
                    PyErr_Format(PyExc_TypeError,
                        "extension type '%.200s' has no __dict__ slot, "
                        "but base type '" __Pyx_FMT_TYPENAME "' has: "
                        "either add 'cdef dict __dict__' to the extension type "
                        "or add '__slots__ = [...]' to the base type",
                        type_name, b_name);
                    __Pyx_DECREF_TypeName(b_name);
                }
#if !CYTHON_USE_TYPE_SLOTS
              dictoffset_return:
#endif
#if CYTHON_AVOID_BORROWED_REFS
                Py_DECREF(b0);
#endif
                return -1;
            }
        }
#if CYTHON_AVOID_BORROWED_REFS
        Py_DECREF(b0);
#endif
    }
    return 0;
}
#endif

/* PyType_Ready */
  CYTHON_UNUSED static int __Pyx_PyType_HasMultipleInheritance(PyTypeObject *t) {
    while (t) {
        PyObject *bases = __Pyx_PyType_GetSlot(t, tp_bases, PyObject*);
        if (bases) {
            return 1;
        }
        t = __Pyx_PyType_GetSlot(t, tp_base, PyTypeObject*);
    }
    return 0;
}
static int __Pyx_PyType_Ready(PyTypeObject *t) {
#if CYTHON_USE_TYPE_SPECS || !CYTHON_COMPILING_IN_CPYTHON || defined(PYSTON_MAJOR_VERSION)
    (void)__Pyx_PyObject_CallMethod0;
#if CYTHON_USE_TYPE_SPECS
    (void)__Pyx_validate_bases_tuple;
#endif
    return PyType_Ready(t);
#else
    int r;
    if (!__Pyx_PyType_HasMultipleInheritance(t)) {
        return PyType_Ready(t);
    }
    PyObject *bases = __Pyx_PyType_GetSlot(t, tp_bases, PyObject*);
    if (bases && unlikely(__Pyx_validate_bases_tuple(t->tp_name, t->tp_dictoffset, bases) == -1))
        return -1;
#if !defined(PYSTON_MAJOR_VERSION)
    {
        int gc_was_enabled;
    #if PY_VERSION_HEX >= 0x030A00b1
        gc_was_enabled = PyGC_Disable();
        (void)__Pyx_PyObject_CallMethod0;
    #else
        PyObject *ret, *py_status;
        PyObject *gc = NULL;
        #if (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM+0 >= 0x07030400) &&\
                !CYTHON_COMPILING_IN_GRAAL
        gc = PyImport_GetModule(__pyx_mstate_global->__pyx_kp_u_gc);
        #endif
        if (unlikely(!gc)) gc = PyImport_Import(__pyx_mstate_global->__pyx_kp_u_gc);
        if (unlikely(!gc)) return -1;
        py_status = __Pyx_PyObject_CallMethod0(gc, __pyx_mstate_global->__pyx_kp_u_isenabled);
        if (unlikely(!py_status)) {
            Py_DECREF(gc);
            return -1;
        }
        gc_was_enabled = __Pyx_PyObject_IsTrue(py_status);
        Py_DECREF(py_status);
        if (gc_was_enabled > 0) {
            ret = __Pyx_PyObject_CallMethod0(gc, __pyx_mstate_global->__pyx_kp_u_disable);
            if (unlikely(!ret)) {
                Py_DECREF(gc);
                return -1;
            }
            Py_DECREF(ret);
        } else if (unlikely(gc_was_enabled == -1)) {
            Py_DECREF(gc);
            return -1;
        }
    #endif
        t->tp_flags |= Py_TPFLAGS_HEAPTYPE;
#if PY_VERSION_HEX >= 0x030A0000
        t->tp_flags |= Py_TPFLAGS_IMMUTABLETYPE;
#endif
#else
        (void)__Pyx_PyObject_CallMethod0;
#endif
    r = PyType_Ready(t);
#if !defined(PYSTON_MAJOR_VERSION)
        t->tp_flags &= ~Py_TPFLAGS_HEAPTYPE;
    #if PY_VERSION_HEX >= 0x030A00b1
        if (gc_was_enabled)
            PyGC_Enable();
    #else
        if (gc_was_enabled) {
            PyObject *tp, *v, *tb;
            PyErr_Fetch(&tp, &v, &tb);
            ret = __Pyx_PyObject_CallMethod0(gc, __pyx_mstate_global->__pyx_kp_u_enable);
            if (likely(ret || r == -1)) {
                Py_XDECREF(ret);
                PyErr_Restore(tp, v, tb);
            } else {
                Py_XDECREF(tp);
                Py_XDECREF(v);
                Py_XDECREF(tb);
                r = -1;
            }
        }
        Py_DECREF(gc);
    #endif
    }
#endif
    return r;
#endif
}

/* DelItemOnTypeDict */
  static int __Pyx__DelItemOnTypeDict(PyTypeObject *tp, PyObject *k) {
    int result;
    PyObject *tp_dict;
#if CYTHON_COMPILING_IN_LIMITED_API
    tp_dict = __Pyx_GetTypeDict(tp);
    if (unlikely(!tp_dict)) return -1;
#else
    tp_dict = tp->tp_dict;
#endif
    result = PyDict_DelItem(tp_dict, k);
    if (likely(!result)) PyType_Modified(tp);
    return result;
}

/* SetupReduce */
  static int __Pyx_setup_reduce_is_named(PyObject* meth, PyObject* name) {
  int ret;
  PyObject *name_attr;
  name_attr = __Pyx_PyObject_GetAttrStrNoError(meth, __pyx_mstate_global->__pyx_n_u_name);
  if (likely(name_attr)) {
      ret = PyObject_RichCompareBool(name_attr, name, Py_EQ);
  } else {
      ret = -1;
  }
  if (unlikely(ret < 0)) {
      PyErr_Clear();
      ret = 0;
  }
  Py_XDECREF(name_attr);
  return ret;
}
static int __Pyx_setup_reduce(PyObject* type_obj) {
    int ret = 0;
    PyObject *object_reduce = NULL;
    PyObject *object_getstate = NULL;
    PyObject *object_reduce_ex = NULL;
    PyObject *reduce = NULL;
    PyObject *reduce_ex = NULL;
    PyObject *reduce_cython = NULL;
    PyObject *setstate = NULL;
    PyObject *setstate_cython = NULL;
    PyObject *getstate = NULL;
#if CYTHON_USE_PYTYPE_LOOKUP
    getstate = _PyType_Lookup((PyTypeObject*)type_obj, __pyx_mstate_global->__pyx_n_u_getstate);
#else
    getstate = __Pyx_PyObject_GetAttrStrNoError(type_obj, __pyx_mstate_global->__pyx_n_u_getstate);
    if (!getstate && PyErr_Occurred()) {
        goto __PYX_BAD;
    }
#endif
    if (getstate) {
#if CYTHON_USE_PYTYPE_LOOKUP
        object_getstate = _PyType_Lookup(&PyBaseObject_Type, __pyx_mstate_global->__pyx_n_u_getstate);
#else
        object_getstate = __Pyx_PyObject_GetAttrStrNoError((PyObject*)&PyBaseObject_Type, __pyx_mstate_global->__pyx_n_u_getstate);
        if (!object_getstate && PyErr_Occurred()) {
            goto __PYX_BAD;
        }
#endif
        if (object_getstate != getstate) {
            goto __PYX_GOOD;
        }
    }
#if CYTHON_USE_PYTYPE_LOOKUP
    object_reduce_ex = _PyType_Lookup(&PyBaseObject_Type, __pyx_mstate_global->__pyx_n_u_reduce_ex); if (!object_reduce_ex) goto __PYX_BAD;
#else
    object_reduce_ex = __Pyx_PyObject_GetAttrStr((PyObject*)&PyBaseObject_Type, __pyx_mstate_global->__pyx_n_u_reduce_ex); if (!object_reduce_ex) goto __PYX_BAD;
#endif
    reduce_ex = __Pyx_PyObject_GetAttrStr(type_obj, __pyx_mstate_global->__pyx_n_u_reduce_ex); if (unlikely(!reduce_ex)) goto __PYX_BAD;
    if (reduce_ex == object_reduce_ex) {
#if CYTHON_USE_PYTYPE_LOOKUP
        object_reduce = _PyType_Lookup(&PyBaseObject_Type, __pyx_mstate_global->__pyx_n_u_reduce); if (!object_reduce) goto __PYX_BAD;
#else
        object_reduce = __Pyx_PyObject_GetAttrStr((PyObject*)&PyBaseObject_Type, __pyx_mstate_global->__pyx_n_u_reduce); if (!object_reduce) goto __PYX_BAD;
#endif
        reduce = __Pyx_PyObject_GetAttrStr(type_obj, __pyx_mstate_global->__pyx_n_u_reduce); if (unlikely(!reduce)) goto __PYX_BAD;
        if (reduce == object_reduce || __Pyx_setup_reduce_is_named(reduce, __pyx_mstate_global->__pyx_n_u_reduce_cython)) {
            reduce_cython = __Pyx_PyObject_GetAttrStrNoError(type_obj, __pyx_mstate_global->__pyx_n_u_reduce_cython);
            if (likely(reduce_cython)) {
                ret = __Pyx_SetItemOnTypeDict((PyTypeObject*)type_obj, __pyx_mstate_global->__pyx_n_u_reduce, reduce_cython); if (unlikely(ret < 0)) goto __PYX_BAD;
                ret = __Pyx_DelItemOnTypeDict((PyTypeObject*)type_obj, __pyx_mstate_global->__pyx_n_u_reduce_cython); if (unlikely(ret < 0)) goto __PYX_BAD;
            } else if (reduce == object_reduce || PyErr_Occurred()) {
                goto __PYX_BAD;
            }
            setstate = __Pyx_PyObject_GetAttrStrNoError(type_obj, __pyx_mstate_global->__pyx_n_u_setstate);
            if (!setstate) PyErr_Clear();
            if (!setstate || __Pyx_setup_reduce_is_named(setstate, __pyx_mstate_global->__pyx_n_u_setstate_cython)) {
                setstate_cython = __Pyx_PyObject_GetAttrStrNoError(type_obj, __pyx_mstate_global->__pyx_n_u_setstate_cython);
                if (likely(setstate_cython)) {
                    ret = __Pyx_SetItemOnTypeDict((PyTypeObject*)type_obj, __pyx_mstate_global->__pyx_n_u_setstate, setstate_cython); if (unlikely(ret < 0)) goto __PYX_BAD;
                    ret = __Pyx_DelItemOnTypeDict((PyTypeObject*)type_obj, __pyx_mstate_global->__pyx_n_u_setstate_cython); if (unlikely(ret < 0)) goto __PYX_BAD;
                } else if (!setstate || PyErr_Occurred()) {
                    goto __PYX_BAD;
                }
            }
            PyType_Modified((PyTypeObject*)type_obj);
        }
    }
    goto __PYX_GOOD;
__PYX_BAD:
    if (!PyErr_Occurred()) {
        __Pyx_TypeName type_obj_name =
            __Pyx_PyType_GetFullyQualifiedName((PyTypeObject*)type_obj);
        PyErr_Format(PyExc_RuntimeError,
            "Unable to initialize pickling for " __Pyx_FMT_TYPENAME, type_obj_name);
        __Pyx_DECREF_TypeName(type_obj_name);
    }
    ret = -1;
__PYX_GOOD:
#if !CYTHON_USE_PYTYPE_LOOKUP
    Py_XDECREF(object_reduce);
    Py_XDECREF(object_reduce_ex);
    Py_XDECREF(object_getstate);
    Py_XDECREF(getstate);
#endif
    Py_XDECREF(reduce);
    Py_XDECREF(reduce_ex);
    Py_XDECREF(reduce_cython);
    Py_XDECREF(setstate);
    Py_XDECREF(setstate_cython);
    return ret;
}

/* SetVTable */
  static int __Pyx_SetVtable(PyTypeObject *type, void *vtable) {
    PyObject *ob = PyCapsule_New(vtable, 0, 0);
    if (unlikely(!ob))
        goto bad;
#if CYTHON_COMPILING_IN_LIMITED_API
    if (unlikely(PyObject_SetAttr((PyObject *) type, __pyx_mstate_global->__pyx_n_u_pyx_vtable, ob) < 0))
#else
    if (unlikely(PyDict_SetItem(type->tp_dict, __pyx_mstate_global->__pyx_n_u_pyx_vtable, ob) < 0))
#endif
        goto bad;
    Py_DECREF(ob);
    return 0;
bad:
    Py_XDECREF(ob);
    return -1;
}

/* GetVTable */
  static void* __Pyx_GetVtable(PyTypeObject *type) {
    void* ptr;
#if CYTHON_COMPILING_IN_LIMITED_API
    PyObject *ob = PyObject_GetAttr((PyObject *)type, __pyx_mstate_global->__pyx_n_u_pyx_vtable);
#else
    PyObject *ob = PyObject_GetItem(type->tp_dict, __pyx_mstate_global->__pyx_n_u_pyx_vtable);
#endif
    if (!ob)
        goto bad;
    ptr = PyCapsule_GetPointer(ob, 0);
    if (!ptr && !PyErr_Occurred())
        PyErr_SetString(PyExc_RuntimeError, "invalid vtable found for imported type");
    Py_DECREF(ob);
    return ptr;
bad:
    Py_XDECREF(ob);
    return NULL;
}

/* MergeVTables */
  static int __Pyx_MergeVtables(PyTypeObject *type) {
    int i=0;
    Py_ssize_t size;
    void** base_vtables;
    __Pyx_TypeName tp_base_name = NULL;
    __Pyx_TypeName base_name = NULL;
    void* unknown = (void*)-1;
    PyObject* bases = __Pyx_PyType_GetSlot(type, tp_bases, PyObject*);
    int base_depth = 0;
    {
        PyTypeObject* base = __Pyx_PyType_GetSlot(type, tp_base, PyTypeObject*);
        while (base) {
            base_depth += 1;
            base = __Pyx_PyType_GetSlot(base, tp_base, PyTypeObject*);
        }
    }
    base_vtables = (void**) PyMem_Malloc(sizeof(void*) * (size_t)(base_depth + 1));
    base_vtables[0] = unknown;
#if CYTHON_COMPILING_IN_LIMITED_API
    size = PyTuple_Size(bases);
    if (size < 0) goto other_failure;
#else
    size = PyTuple_GET_SIZE(bases);
#endif
    for (i = 1; i < size; i++) {
        PyObject *basei;
        void* base_vtable;
#if CYTHON_AVOID_BORROWED_REFS
        basei = PySequence_GetItem(bases, i);
        if (unlikely(!basei)) goto other_failure;
#elif !CYTHON_ASSUME_SAFE_MACROS
        basei = PyTuple_GetItem(bases, i);
        if (unlikely(!basei)) goto other_failure;
#else
        basei = PyTuple_GET_ITEM(bases, i);
#endif
        base_vtable = __Pyx_GetVtable((PyTypeObject*)basei);
#if CYTHON_AVOID_BORROWED_REFS
        Py_DECREF(basei);
#endif
        if (base_vtable != NULL) {
            int j;
            PyTypeObject* base = __Pyx_PyType_GetSlot(type, tp_base, PyTypeObject*);
            for (j = 0; j < base_depth; j++) {
                if (base_vtables[j] == unknown) {
                    base_vtables[j] = __Pyx_GetVtable(base);
                    base_vtables[j + 1] = unknown;
                }
                if (base_vtables[j] == base_vtable) {
                    break;
                } else if (base_vtables[j] == NULL) {
                    goto bad;
                }
                base = __Pyx_PyType_GetSlot(base, tp_base, PyTypeObject*);
            }
        }
    }
    PyErr_Clear();
    PyMem_Free(base_vtables);
    return 0;
bad:
    {
        PyTypeObject* basei = NULL;
        PyTypeObject* tp_base = __Pyx_PyType_GetSlot(type, tp_base, PyTypeObject*);
        tp_base_name = __Pyx_PyType_GetFullyQualifiedName(tp_base);
#if CYTHON_AVOID_BORROWED_REFS
        basei = (PyTypeObject*)PySequence_GetItem(bases, i);
        if (unlikely(!basei)) goto really_bad;
#elif !CYTHON_ASSUME_SAFE_MACROS
        basei = (PyTypeObject*)PyTuple_GetItem(bases, i);
        if (unlikely(!basei)) goto really_bad;
#else
        basei = (PyTypeObject*)PyTuple_GET_ITEM(bases, i);
#endif
        base_name = __Pyx_PyType_GetFullyQualifiedName(basei);
#if CYTHON_AVOID_BORROWED_REFS
        Py_DECREF(basei);
#endif
    }
    PyErr_Format(PyExc_TypeError,
        "multiple bases have vtable conflict: '" __Pyx_FMT_TYPENAME "' and '" __Pyx_FMT_TYPENAME "'", tp_base_name, base_name);
#if CYTHON_AVOID_BORROWED_REFS || !CYTHON_ASSUME_SAFE_MACROS
really_bad: // bad has failed!
#endif
    __Pyx_DECREF_TypeName(tp_base_name);
    __Pyx_DECREF_TypeName(base_name);
#if CYTHON_COMPILING_IN_LIMITED_API || CYTHON_AVOID_BORROWED_REFS || !CYTHON_ASSUME_SAFE_MACROS
other_failure:
#endif
    PyMem_Free(base_vtables);
    return -1;
}

/* TypeImport */
  #ifndef __PYX_HAVE_RT_ImportType_3_1_3
#define __PYX_HAVE_RT_ImportType_3_1_3
static PyTypeObject *__Pyx_ImportType_3_1_3(PyObject *module, const char *module_name, const char *class_name,
    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_1_3 check_size)
{
    PyObject *result = 0;
    Py_ssize_t basicsize;
    Py_ssize_t itemsize;
#if CYTHON_COMPILING_IN_LIMITED_API
    PyObject *py_basicsize;
    PyObject *py_itemsize;
#endif
    result = PyObject_GetAttrString(module, class_name);
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError,
            "%.200s.%.200s is not a type object",
            module_name, class_name);
        goto bad;
    }
#if !CYTHON_COMPILING_IN_LIMITED_API
    basicsize = ((PyTypeObject *)result)->tp_basicsize;
    itemsize = ((PyTypeObject *)result)->tp_itemsize;
#else
    if (size == 0) {
        return (PyTypeObject *)result;
    }
    py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
    if (!py_basicsize)
        goto bad;
    basicsize = PyLong_AsSsize_t(py_basicsize);
    Py_DECREF(py_basicsize);
    py_basicsize = 0;
    if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
        goto bad;
    py_itemsize = PyObject_GetAttrString(result, "__itemsize__");
    if (!py_itemsize)
        goto bad;
    itemsize = PyLong_AsSsize_t(py_itemsize);
    Py_DECREF(py_itemsize);
    py_itemsize = 0;
    if (itemsize == (Py_ssize_t)-1 && PyErr_Occurred())
        goto bad;
#endif
    if (itemsize) {
        if (size % alignment) {
            alignment = size % alignment;
        }
        if (itemsize < (Py_ssize_t)alignment)
            itemsize = (Py_ssize_t)alignment;
    }
    if ((size_t)(basicsize + itemsize) < size) {
        PyErr_Format(PyExc_ValueError,
            "%.200s.%.200s size changed, may indicate binary incompatibility. "
            "Expected %zd from C header, got %zd from PyObject",
            module_name, class_name, size, basicsize+itemsize);
        goto bad;
    }
    if (check_size == __Pyx_ImportType_CheckSize_Error_3_1_3 &&
            ((size_t)basicsize > size || (size_t)(basicsize + itemsize) < size)) {
        PyErr_Format(PyExc_ValueError,
            "%.200s.%.200s size changed, may indicate binary incompatibility. "
            "Expected %zd from C header, got %zd-%zd from PyObject",
            module_name, class_name, size, basicsize, basicsize+itemsize);
        goto bad;
    }
    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_1_3 && (size_t)basicsize > size) {
        if (PyErr_WarnFormat(NULL, 0,
                "%.200s.%.200s size changed, may indicate binary incompatibility. "
                "Expected %zd from C header, got %zd from PyObject",
                module_name, class_name, size, basicsize) < 0) {
            goto bad;
        }
    }
    return (PyTypeObject *)result;
bad:
    Py_XDECREF(result);
    return NULL;
}
#endif

/* Import */
  static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
    PyObject *module = 0;
    PyObject *empty_dict = 0;
    PyObject *empty_list = 0;
    empty_dict = PyDict_New();
    if (unlikely(!empty_dict))
        goto bad;
    if (level == -1) {
        const char* package_sep = strchr(__Pyx_MODULE_NAME, '.');
        if (package_sep != (0)) {
            module = PyImport_ImportModuleLevelObject(
                name, __pyx_mstate_global->__pyx_d, empty_dict, from_list, 1);
            if (unlikely(!module)) {
                if (unlikely(!PyErr_ExceptionMatches(PyExc_ImportError)))
                    goto bad;
                PyErr_Clear();
            }
        }
        level = 0;
    }
    if (!module) {
        module = PyImport_ImportModuleLevelObject(
            name, __pyx_mstate_global->__pyx_d, empty_dict, from_list, level);
    }
bad:
    Py_XDECREF(empty_dict);
    Py_XDECREF(empty_list);
    return module;
}

/* ImportDottedModule */
  static PyObject *__Pyx__ImportDottedModule_Error(PyObject *name, PyObject *parts_tuple, Py_ssize_t count) {
    PyObject *partial_name = NULL, *slice = NULL, *sep = NULL;
    Py_ssize_t size;
    if (unlikely(PyErr_Occurred())) {
        PyErr_Clear();
    }
#if CYTHON_ASSUME_SAFE_SIZE
    size = PyTuple_GET_SIZE(parts_tuple);
#else
    size = PyTuple_Size(parts_tuple);
    if (size < 0) goto bad;
#endif
    if (likely(size == count)) {
        partial_name = name;
    } else {
        slice = PySequence_GetSlice(parts_tuple, 0, count);
        if (unlikely(!slice))
            goto bad;
        sep = PyUnicode_FromStringAndSize(".", 1);
        if (unlikely(!sep))
            goto bad;
        partial_name = PyUnicode_Join(sep, slice);
    }
    PyErr_Format(
        PyExc_ModuleNotFoundError,
        "No module named '%U'", partial_name);
bad:
    Py_XDECREF(sep);
    Py_XDECREF(slice);
    Py_XDECREF(partial_name);
    return NULL;
}
static PyObject *__Pyx__ImportDottedModule_Lookup(PyObject *name) {
    PyObject *imported_module;
#if (CYTHON_COMPILING_IN_PYPY && PYPY_VERSION_NUM  < 0x07030400) ||\
        CYTHON_COMPILING_IN_GRAAL
    PyObject *modules = PyImport_GetModuleDict();
    if (unlikely(!modules))
        return NULL;
    imported_module = __Pyx_PyDict_GetItemStr(modules, name);
    Py_XINCREF(imported_module);
#else
    imported_module = PyImport_GetModule(name);
#endif
    return imported_module;
}
static PyObject *__Pyx_ImportDottedModule_WalkParts(PyObject *module, PyObject *name, PyObject *parts_tuple) {
    Py_ssize_t i, nparts;
#if CYTHON_ASSUME_SAFE_SIZE
    nparts = PyTuple_GET_SIZE(parts_tuple);
#else
    nparts = PyTuple_Size(parts_tuple);
    if (nparts < 0) return NULL;
#endif
    for (i=1; i < nparts && module; i++) {
        PyObject *part, *submodule;
#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
        part = PyTuple_GET_ITEM(parts_tuple, i);
#else
        part = __Pyx_PySequence_ITEM(parts_tuple, i);
        if (!part) return NULL;
#endif
        submodule = __Pyx_PyObject_GetAttrStrNoError(module, part);
#if !(CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS)
        Py_DECREF(part);
#endif
        Py_DECREF(module);
        module = submodule;
    }
    if (unlikely(!module)) {
        return __Pyx__ImportDottedModule_Error(name, parts_tuple, i);
    }
    return module;
}
static PyObject *__Pyx__ImportDottedModule(PyObject *name, PyObject *parts_tuple) {
    PyObject *imported_module;
    PyObject *module = __Pyx_Import(name, NULL, 0);
    if (!parts_tuple || unlikely(!module))
        return module;
    imported_module = __Pyx__ImportDottedModule_Lookup(name);
    if (likely(imported_module)) {
        Py_DECREF(module);
        return imported_module;
    }
    PyErr_Clear();
    return __Pyx_ImportDottedModule_WalkParts(module, name, parts_tuple);
}
static PyObject *__Pyx_ImportDottedModule(PyObject *name, PyObject *parts_tuple) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyObject *module = __Pyx__ImportDottedModule_Lookup(name);
    if (likely(module)) {
        PyObject *spec = __Pyx_PyObject_GetAttrStrNoError(module, __pyx_mstate_global->__pyx_n_u_spec);
        if (likely(spec)) {
            PyObject *unsafe = __Pyx_PyObject_GetAttrStrNoError(spec, __pyx_mstate_global->__pyx_n_u_initializing);
            if (likely(!unsafe || !__Pyx_PyObject_IsTrue(unsafe))) {
                Py_DECREF(spec);
                spec = NULL;
            }
            Py_XDECREF(unsafe);
        }
        if (likely(!spec)) {
            PyErr_Clear();
            return module;
        }
        Py_DECREF(spec);
        Py_DECREF(module);
    } else if (PyErr_Occurred()) {
        PyErr_Clear();
    }
#endif
    return __Pyx__ImportDottedModule(name, parts_tuple);
}

/* ListPack */
  static PyObject *__Pyx_PyList_Pack(Py_ssize_t n, ...) {
    va_list va;
    PyObject *l = PyList_New(n);
    va_start(va, n);
    if (unlikely(!l)) goto end;
    for (Py_ssize_t i=0; i<n; ++i) {
        PyObject *arg = va_arg(va, PyObject*);
        Py_INCREF(arg);
        if (__Pyx_PyList_SET_ITEM(l, i, arg) != (0)) {
            Py_CLEAR(l);
            goto end;
        }
    }
    end:
    va_end(va);
    return l;
}

/* ImportFrom */
  static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name) {
    PyObject* value = __Pyx_PyObject_GetAttrStr(module, name);
    if (unlikely(!value) && PyErr_ExceptionMatches(PyExc_AttributeError)) {
        const char* module_name_str = 0;
        PyObject* module_name = 0;
        PyObject* module_dot = 0;
        PyObject* full_name = 0;
        PyErr_Clear();
        module_name_str = PyModule_GetName(module);
        if (unlikely(!module_name_str)) { goto modbad; }
        module_name = PyUnicode_FromString(module_name_str);
        if (unlikely(!module_name)) { goto modbad; }
        module_dot = PyUnicode_Concat(module_name, __pyx_mstate_global->__pyx_kp_u__4);
        if (unlikely(!module_dot)) { goto modbad; }
        full_name = PyUnicode_Concat(module_dot, name);
        if (unlikely(!full_name)) { goto modbad; }
        #if (CYTHON_COMPILING_IN_PYPY && PYPY_VERSION_NUM  < 0x07030400) ||\
                CYTHON_COMPILING_IN_GRAAL
        {
            PyObject *modules = PyImport_GetModuleDict();
            if (unlikely(!modules))
                goto modbad;
            value = PyObject_GetItem(modules, full_name);
        }
        #else
        value = PyImport_GetModule(full_name);
        #endif
      modbad:
        Py_XDECREF(full_name);
        Py_XDECREF(module_dot);
        Py_XDECREF(module_name);
    }
    if (unlikely(!value)) {
        PyErr_Format(PyExc_ImportError, "cannot import name %S", name);
    }
    return value;
}

/* Py3UpdateBases */
  static PyObject*
__Pyx_PEP560_update_bases(PyObject *bases)
{
    Py_ssize_t i, j, size_bases;
    PyObject *base = NULL, *meth, *new_base, *result, *new_bases = NULL;
#if CYTHON_ASSUME_SAFE_SIZE
    size_bases = PyTuple_GET_SIZE(bases);
#else
    size_bases = PyTuple_Size(bases);
    if (size_bases < 0) return NULL;
#endif
    for (i = 0; i < size_bases; i++) {
#if CYTHON_AVOID_BORROWED_REFS
        Py_CLEAR(base);
#endif
#if CYTHON_ASSUME_SAFE_MACROS
        base = PyTuple_GET_ITEM(bases, i);
#else
        base = PyTuple_GetItem(bases, i);
        if (!base) goto error;
#endif
#if CYTHON_AVOID_BORROWED_REFS
        Py_INCREF(base);
#endif
        if (PyType_Check(base)) {
            if (new_bases) {
                if (PyList_Append(new_bases, base) < 0) {
                    goto error;
                }
            }
            continue;
        }
        meth = __Pyx_PyObject_GetAttrStrNoError(base, __pyx_mstate_global->__pyx_n_u_mro_entries);
        if (!meth && PyErr_Occurred()) {
            goto error;
        }
        if (!meth) {
            if (new_bases) {
                if (PyList_Append(new_bases, base) < 0) {
                    goto error;
                }
            }
            continue;
        }
        new_base = __Pyx_PyObject_CallOneArg(meth, bases);
        Py_DECREF(meth);
        if (!new_base) {
            goto error;
        }
        if (!PyTuple_Check(new_base)) {
            PyErr_SetString(PyExc_TypeError,
                            "__mro_entries__ must return a tuple");
            Py_DECREF(new_base);
            goto error;
        }
        if (!new_bases) {
            if (!(new_bases = PyList_New(i))) {
                goto error;
            }
            for (j = 0; j < i; j++) {
                PyObject *base_from_list;
#if CYTHON_ASSUME_SAFE_MACROS
                base_from_list = PyTuple_GET_ITEM(bases, j);
                PyList_SET_ITEM(new_bases, j, base_from_list);
                Py_INCREF(base_from_list);
#else
                base_from_list = PyTuple_GetItem(bases, j);
                if (!base_from_list) goto error;
                Py_INCREF(base_from_list);
                if (PyList_SetItem(new_bases, j, base_from_list) < 0) goto error;
#endif
            }
        }
#if CYTHON_ASSUME_SAFE_SIZE
        j = PyList_GET_SIZE(new_bases);
#else
        j = PyList_Size(new_bases);
        if (j < 0) goto error;
#endif
        if (PyList_SetSlice(new_bases, j, j, new_base) < 0) {
            goto error;
        }
        Py_DECREF(new_base);
    }
    if (!new_bases) {
        Py_INCREF(bases);
        return bases;
    }
    result = PyList_AsTuple(new_bases);
    Py_DECREF(new_bases);
#if CYTHON_AVOID_BORROWED_REFS
    Py_XDECREF(base);
#endif
    return result;
error:
    Py_XDECREF(new_bases);
#if CYTHON_AVOID_BORROWED_REFS
    Py_XDECREF(base);
#endif
    return NULL;
}

/* CalculateMetaclass */
  static PyObject *__Pyx_CalculateMetaclass(PyTypeObject *metaclass, PyObject *bases) {
    Py_ssize_t i, nbases;
#if CYTHON_ASSUME_SAFE_SIZE
    nbases = PyTuple_GET_SIZE(bases);
#else
    nbases = PyTuple_Size(bases);
    if (nbases < 0) return NULL;
#endif
    for (i=0; i < nbases; i++) {
        PyTypeObject *tmptype;
#if CYTHON_ASSUME_SAFE_MACROS
        PyObject *tmp = PyTuple_GET_ITEM(bases, i);
#else
        PyObject *tmp = PyTuple_GetItem(bases, i);
        if (!tmp) return NULL;
#endif
        tmptype = Py_TYPE(tmp);
        if (!metaclass) {
            metaclass = tmptype;
            continue;
        }
        if (PyType_IsSubtype(metaclass, tmptype))
            continue;
        if (PyType_IsSubtype(tmptype, metaclass)) {
            metaclass = tmptype;
            continue;
        }
        PyErr_SetString(PyExc_TypeError,
                        "metaclass conflict: "
                        "the metaclass of a derived class "
                        "must be a (non-strict) subclass "
                        "of the metaclasses of all its bases");
        return NULL;
    }
    if (!metaclass) {
        metaclass = &PyType_Type;
    }
    Py_INCREF((PyObject*) metaclass);
    return (PyObject*) metaclass;
}

/* FetchSharedCythonModule */
  static PyObject *__Pyx_FetchSharedCythonABIModule(void) {
    return __Pyx_PyImport_AddModuleRef(__PYX_ABI_MODULE_NAME);
}

/* dict_setdefault */
  static CYTHON_INLINE PyObject *__Pyx_PyDict_SetDefault(PyObject *d, PyObject *key, PyObject *default_value,
                                                       int is_safe_type) {
    PyObject* value;
    CYTHON_MAYBE_UNUSED_VAR(is_safe_type);
#if CYTHON_COMPILING_IN_LIMITED_API
    value = PyObject_CallMethod(d, "setdefault", "OO", key, default_value);
#elif PY_VERSION_HEX >= 0x030d0000
    PyDict_SetDefaultRef(d, key, default_value, &value);
#else
    value = PyDict_SetDefault(d, key, default_value);
    if (unlikely(!value)) return NULL;
    Py_INCREF(value);
#endif
    return value;
}

/* FetchCommonType */
  #if __PYX_LIMITED_VERSION_HEX < 0x030C0000
static PyObject* __Pyx_PyType_FromMetaclass(PyTypeObject *metaclass, PyObject *module, PyType_Spec *spec, PyObject *bases) {
    PyObject *result = __Pyx_PyType_FromModuleAndSpec(module, spec, bases);
    if (result && metaclass) {
        PyObject *old_tp = (PyObject*)Py_TYPE(result);
    Py_INCREF((PyObject*)metaclass);
#if __PYX_LIMITED_VERSION_HEX >= 0x03090000
        Py_SET_TYPE(result, metaclass);
#else
        result->ob_type = metaclass;
#endif
        Py_DECREF(old_tp);
    }
    return result;
}
#else
#define __Pyx_PyType_FromMetaclass(me, mo, s, b) PyType_FromMetaclass(me, mo, s, b)
#endif
static int __Pyx_VerifyCachedType(PyObject *cached_type,
                               const char *name,
                               Py_ssize_t expected_basicsize) {
    Py_ssize_t basicsize;
    if (!PyType_Check(cached_type)) {
        PyErr_Format(PyExc_TypeError,
            "Shared Cython type %.200s is not a type object", name);
        return -1;
    }
    if (expected_basicsize == 0) {
        return 0; // size is inherited, nothing useful to check
    }
#if CYTHON_COMPILING_IN_LIMITED_API
    PyObject *py_basicsize;
    py_basicsize = PyObject_GetAttrString(cached_type, "__basicsize__");
    if (unlikely(!py_basicsize)) return -1;
    basicsize = PyLong_AsSsize_t(py_basicsize);
    Py_DECREF(py_basicsize);
    py_basicsize = NULL;
    if (unlikely(basicsize == (Py_ssize_t)-1) && PyErr_Occurred()) return -1;
#else
    basicsize = ((PyTypeObject*) cached_type)->tp_basicsize;
#endif
    if (basicsize != expected_basicsize) {
        PyErr_Format(PyExc_TypeError,
            "Shared Cython type %.200s has the wrong size, try recompiling",
            name);
        return -1;
    }
    return 0;
}
static PyTypeObject *__Pyx_FetchCommonTypeFromSpec(PyTypeObject *metaclass, PyObject *module, PyType_Spec *spec, PyObject *bases) {
    PyObject *abi_module = NULL, *cached_type = NULL, *abi_module_dict, *new_cached_type, *py_object_name;
    int get_item_ref_result;
    const char* object_name = strrchr(spec->name, '.');
    object_name = object_name ? object_name+1 : spec->name;
    py_object_name = PyUnicode_FromString(object_name);
    if (!py_object_name) return NULL;
    abi_module = __Pyx_FetchSharedCythonABIModule();
    if (!abi_module) goto done;
    abi_module_dict = PyModule_GetDict(abi_module);
    if (!abi_module_dict) goto done;
    get_item_ref_result = __Pyx_PyDict_GetItemRef(abi_module_dict, py_object_name, &cached_type);
    if (get_item_ref_result == 1) {
        if (__Pyx_VerifyCachedType(
              cached_type,
              object_name,
              spec->basicsize) < 0) {
            goto bad;
        }
        goto done;
    } else if (unlikely(get_item_ref_result == -1)) {
        goto bad;
    }
    CYTHON_UNUSED_VAR(module);
    cached_type = __Pyx_PyType_FromMetaclass(metaclass, abi_module, spec, bases);
    if (unlikely(!cached_type)) goto bad;
    if (unlikely(__Pyx_fix_up_extension_type_from_spec(spec, (PyTypeObject *) cached_type) < 0)) goto bad;
    new_cached_type = __Pyx_PyDict_SetDefault(abi_module_dict, py_object_name, cached_type, 1);
    if (unlikely(new_cached_type != cached_type)) {
        if (unlikely(!new_cached_type)) goto bad;
        Py_DECREF(cached_type);
        cached_type = new_cached_type;
        if (__Pyx_VerifyCachedType(
                cached_type,
                object_name,
                spec->basicsize) < 0) {
            goto bad;
        }
        goto done;
    } else {
        Py_DECREF(new_cached_type);
    }
done:
    Py_XDECREF(abi_module);
    Py_DECREF(py_object_name);
    assert(cached_type == NULL || PyType_Check(cached_type));
    return (PyTypeObject *) cached_type;
bad:
    Py_XDECREF(cached_type);
    cached_type = NULL;
    goto done;
}

/* CommonTypesMetaclass */
  static PyObject* __pyx_CommonTypesMetaclass_get_module(CYTHON_UNUSED PyObject *self, CYTHON_UNUSED void* context) {
    return PyUnicode_FromString(__PYX_ABI_MODULE_NAME);
}
static PyGetSetDef __pyx_CommonTypesMetaclass_getset[] = {
    {"__module__", __pyx_CommonTypesMetaclass_get_module, NULL, NULL, NULL},
    {0, 0, 0, 0, 0}
};
static PyType_Slot __pyx_CommonTypesMetaclass_slots[] = {
    {Py_tp_getset, (void *)__pyx_CommonTypesMetaclass_getset},
    {0, 0}
};
static PyType_Spec __pyx_CommonTypesMetaclass_spec = {
    __PYX_TYPE_MODULE_PREFIX "_common_types_metatype",
    0,
    0,
#if PY_VERSION_HEX >= 0x030A0000
    Py_TPFLAGS_IMMUTABLETYPE |
    Py_TPFLAGS_DISALLOW_INSTANTIATION |
#endif
    Py_TPFLAGS_DEFAULT,
    __pyx_CommonTypesMetaclass_slots
};
static int __pyx_CommonTypesMetaclass_init(PyObject *module) {
    __pyx_mstatetype *mstate = __Pyx_PyModule_GetState(module);
    PyObject *bases = PyTuple_Pack(1, &PyType_Type);
    if (unlikely(!bases)) {
        return -1;
    }
    mstate->__pyx_CommonTypesMetaclassType = __Pyx_FetchCommonTypeFromSpec(NULL, module, &__pyx_CommonTypesMetaclass_spec, bases);
    if (unlikely(mstate->__pyx_CommonTypesMetaclassType == NULL)) {
        return -1;
    }
    return 0;
}

/* PyMethodNew */
  #if CYTHON_COMPILING_IN_LIMITED_API
static PyObject *__Pyx_PyMethod_New(PyObject *func, PyObject *self, PyObject *typ) {
    PyObject *result;
    CYTHON_UNUSED_VAR(typ);
    if (!self)
        return __Pyx_NewRef(func);
    #if __PYX_LIMITED_VERSION_HEX >= 0x030C0000
    {
        PyObject *args[] = {func, self};
        result = PyObject_Vectorcall(__pyx_mstate_global->__Pyx_CachedMethodType, args, 2, NULL);
    }
    #else
    result = PyObject_CallFunctionObjArgs(__pyx_mstate_global->__Pyx_CachedMethodType, func, self, NULL);
    #endif
    return result;
}
#else
static PyObject *__Pyx_PyMethod_New(PyObject *func, PyObject *self, PyObject *typ) {
    CYTHON_UNUSED_VAR(typ);
    if (!self)
        return __Pyx_NewRef(func);
    return PyMethod_New(func, self);
}
#endif

/* PyVectorcallFastCallDict */
  #if CYTHON_METH_FASTCALL && (CYTHON_VECTORCALL || CYTHON_BACKPORT_VECTORCALL)
static PyObject *__Pyx_PyVectorcall_FastCallDict_kw(PyObject *func, __pyx_vectorcallfunc vc, PyObject *const *args, size_t nargs, PyObject *kw)
{
    PyObject *res = NULL;
    PyObject *kwnames;
    PyObject **newargs;
    PyObject **kwvalues;
    Py_ssize_t i, pos;
    size_t j;
    PyObject *key, *value;
    unsigned long keys_are_strings;
    #if !CYTHON_ASSUME_SAFE_SIZE
    Py_ssize_t nkw = PyDict_Size(kw);
    if (unlikely(nkw == -1)) return NULL;
    #else
    Py_ssize_t nkw = PyDict_GET_SIZE(kw);
    #endif
    newargs = (PyObject **)PyMem_Malloc((nargs + (size_t)nkw) * sizeof(args[0]));
    if (unlikely(newargs == NULL)) {
        PyErr_NoMemory();
        return NULL;
    }
    for (j = 0; j < nargs; j++) newargs[j] = args[j];
    kwnames = PyTuple_New(nkw);
    if (unlikely(kwnames == NULL)) {
        PyMem_Free(newargs);
        return NULL;
    }
    kwvalues = newargs + nargs;
    pos = i = 0;
    keys_are_strings = Py_TPFLAGS_UNICODE_SUBCLASS;
    while (PyDict_Next(kw, &pos, &key, &value)) {
        keys_are_strings &=
        #if CYTHON_COMPILING_IN_LIMITED_API
            PyType_GetFlags(Py_TYPE(key));
        #else
            Py_TYPE(key)->tp_flags;
        #endif
        Py_INCREF(key);
        Py_INCREF(value);
        #if !CYTHON_ASSUME_SAFE_MACROS
        if (unlikely(PyTuple_SetItem(kwnames, i, key) < 0)) goto cleanup;
        #else
        PyTuple_SET_ITEM(kwnames, i, key);
        #endif
        kwvalues[i] = value;
        i++;
    }
    if (unlikely(!keys_are_strings)) {
        PyErr_SetString(PyExc_TypeError, "keywords must be strings");
        goto cleanup;
    }
    res = vc(func, newargs, nargs, kwnames);
cleanup:
    Py_DECREF(kwnames);
    for (i = 0; i < nkw; i++)
        Py_DECREF(kwvalues[i]);
    PyMem_Free(newargs);
    return res;
}
static CYTHON_INLINE PyObject *__Pyx_PyVectorcall_FastCallDict(PyObject *func, __pyx_vectorcallfunc vc, PyObject *const *args, size_t nargs, PyObject *kw)
{
    Py_ssize_t kw_size =
        likely(kw == NULL) ?
        0 :
#if !CYTHON_ASSUME_SAFE_SIZE
        PyDict_Size(kw);
#else
        PyDict_GET_SIZE(kw);
#endif
    if (kw_size == 0) {
        return vc(func, args, nargs, NULL);
    }
#if !CYTHON_ASSUME_SAFE_SIZE
    else if (unlikely(kw_size == -1)) {
        return NULL;
    }
#endif
    return __Pyx_PyVectorcall_FastCallDict_kw(func, vc, args, nargs, kw);
}
#endif

/* CythonFunctionShared */
  #if CYTHON_COMPILING_IN_LIMITED_API
static CYTHON_INLINE int __Pyx__IsSameCyOrCFunctionNoMethod(PyObject *func, void (*cfunc)(void)) {
    if (__Pyx_CyFunction_Check(func)) {
        return PyCFunction_GetFunction(((__pyx_CyFunctionObject*)func)->func) == (PyCFunction) cfunc;
    } else if (PyCFunction_Check(func)) {
        return PyCFunction_GetFunction(func) == (PyCFunction) cfunc;
    }
    return 0;
}
static CYTHON_INLINE int __Pyx__IsSameCyOrCFunction(PyObject *func, void (*cfunc)(void)) {
    if ((PyObject*)Py_TYPE(func) == __pyx_mstate_global->__Pyx_CachedMethodType) {
        int result;
        PyObject *newFunc = PyObject_GetAttr(func, __pyx_mstate_global->__pyx_n_u_func_2);
        if (unlikely(!newFunc)) {
            PyErr_Clear(); // It's only an optimization, so don't throw an error
            return 0;
        }
        result = __Pyx__IsSameCyOrCFunctionNoMethod(newFunc, cfunc);
        Py_DECREF(newFunc);
        return result;
    }
    return __Pyx__IsSameCyOrCFunctionNoMethod(func, cfunc);
}
#else
static CYTHON_INLINE int __Pyx__IsSameCyOrCFunction(PyObject *func, void (*cfunc)(void)) {
    if (PyMethod_Check(func)) {
        func = PyMethod_GET_FUNCTION(func);
    }
    return __Pyx_CyOrPyCFunction_Check(func) && __Pyx_CyOrPyCFunction_GET_FUNCTION(func) == (PyCFunction) cfunc;
}
#endif
static CYTHON_INLINE void __Pyx__CyFunction_SetClassObj(__pyx_CyFunctionObject* f, PyObject* classobj) {
#if PY_VERSION_HEX < 0x030900B1 || CYTHON_COMPILING_IN_LIMITED_API
    __Pyx_Py_XDECREF_SET(
        __Pyx_CyFunction_GetClassObj(f),
            ((classobj) ? __Pyx_NewRef(classobj) : NULL));
#else
    __Pyx_Py_XDECREF_SET(
        ((PyCMethodObject *) (f))->mm_class,
        (PyTypeObject*)((classobj) ? __Pyx_NewRef(classobj) : NULL));
#endif
}
static PyObject *
__Pyx_CyFunction_get_doc_locked(__pyx_CyFunctionObject *op)
{
    if (unlikely(op->func_doc == NULL)) {
#if CYTHON_COMPILING_IN_LIMITED_API
        op->func_doc = PyObject_GetAttrString(op->func, "__doc__");
        if (unlikely(!op->func_doc)) return NULL;
#else
        if (((PyCFunctionObject*)op)->m_ml->ml_doc) {
            op->func_doc = PyUnicode_FromString(((PyCFunctionObject*)op)->m_ml->ml_doc);
            if (unlikely(op->func_doc == NULL))
                return NULL;
        } else {
            Py_INCREF(Py_None);
            return Py_None;
        }
#endif
    }
    Py_INCREF(op->func_doc);
    return op->func_doc;
}
static PyObject *
__Pyx_CyFunction_get_doc(__pyx_CyFunctionObject *op, void *closure) {
    PyObject *result;
    CYTHON_UNUSED_VAR(closure);
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    result = __Pyx_CyFunction_get_doc_locked(op);
    __Pyx_END_CRITICAL_SECTION();
    return result;
}
static int
__Pyx_CyFunction_set_doc(__pyx_CyFunctionObject *op, PyObject *value, void *context)
{
    CYTHON_UNUSED_VAR(context);
    if (value == NULL) {
        value = Py_None;
    }
    Py_INCREF(value);
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    __Pyx_Py_XDECREF_SET(op->func_doc, value);
    __Pyx_END_CRITICAL_SECTION();
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_name_locked(__pyx_CyFunctionObject *op)
{
    if (unlikely(op->func_name == NULL)) {
#if CYTHON_COMPILING_IN_LIMITED_API
        op->func_name = PyObject_GetAttrString(op->func, "__name__");
#else
        op->func_name = PyUnicode_InternFromString(((PyCFunctionObject*)op)->m_ml->ml_name);
#endif
        if (unlikely(op->func_name == NULL))
            return NULL;
    }
    Py_INCREF(op->func_name);
    return op->func_name;
}
static PyObject *
__Pyx_CyFunction_get_name(__pyx_CyFunctionObject *op, void *context)
{
    PyObject *result = NULL;
    CYTHON_UNUSED_VAR(context);
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    result = __Pyx_CyFunction_get_name_locked(op);
    __Pyx_END_CRITICAL_SECTION();
    return result;
}
static int
__Pyx_CyFunction_set_name(__pyx_CyFunctionObject *op, PyObject *value, void *context)
{
    CYTHON_UNUSED_VAR(context);
    if (unlikely(value == NULL || !PyUnicode_Check(value))) {
        PyErr_SetString(PyExc_TypeError,
                        "__name__ must be set to a string object");
        return -1;
    }
    Py_INCREF(value);
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    __Pyx_Py_XDECREF_SET(op->func_name, value);
    __Pyx_END_CRITICAL_SECTION();
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_qualname(__pyx_CyFunctionObject *op, void *context)
{
    CYTHON_UNUSED_VAR(context);
    PyObject *result;
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    Py_INCREF(op->func_qualname);
    result = op->func_qualname;
    __Pyx_END_CRITICAL_SECTION();
    return result;
}
static int
__Pyx_CyFunction_set_qualname(__pyx_CyFunctionObject *op, PyObject *value, void *context)
{
    CYTHON_UNUSED_VAR(context);
    if (unlikely(value == NULL || !PyUnicode_Check(value))) {
        PyErr_SetString(PyExc_TypeError,
                        "__qualname__ must be set to a string object");
        return -1;
    }
    Py_INCREF(value);
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    __Pyx_Py_XDECREF_SET(op->func_qualname, value);
    __Pyx_END_CRITICAL_SECTION();
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_dict_locked(__pyx_CyFunctionObject *op)
{
    if (unlikely(op->func_dict == NULL)) {
        op->func_dict = PyDict_New();
        if (unlikely(op->func_dict == NULL))
            return NULL;
    }
    Py_INCREF(op->func_dict);
    return op->func_dict;
}
static PyObject *
__Pyx_CyFunction_get_dict(__pyx_CyFunctionObject *op, void *context)
{
    CYTHON_UNUSED_VAR(context);
    PyObject *result;
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    result = __Pyx_CyFunction_get_dict_locked(op);
    __Pyx_END_CRITICAL_SECTION();
    return result;
}
static int
__Pyx_CyFunction_set_dict(__pyx_CyFunctionObject *op, PyObject *value, void *context)
{
    CYTHON_UNUSED_VAR(context);
    if (unlikely(value == NULL)) {
        PyErr_SetString(PyExc_TypeError,
               "function's dictionary may not be deleted");
        return -1;
    }
    if (unlikely(!PyDict_Check(value))) {
        PyErr_SetString(PyExc_TypeError,
               "setting function's dictionary to a non-dict");
        return -1;
    }
    Py_INCREF(value);
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    __Pyx_Py_XDECREF_SET(op->func_dict, value);
    __Pyx_END_CRITICAL_SECTION();
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_globals(__pyx_CyFunctionObject *op, void *context)
{
    CYTHON_UNUSED_VAR(context);
    Py_INCREF(op->func_globals);
    return op->func_globals;
}
static PyObject *
__Pyx_CyFunction_get_closure(__pyx_CyFunctionObject *op, void *context)
{
    CYTHON_UNUSED_VAR(op);
    CYTHON_UNUSED_VAR(context);
    Py_INCREF(Py_None);
    return Py_None;
}
static PyObject *
__Pyx_CyFunction_get_code(__pyx_CyFunctionObject *op, void *context)
{
    PyObject* result = (op->func_code) ? op->func_code : Py_None;
    CYTHON_UNUSED_VAR(context);
    Py_INCREF(result);
    return result;
}
static int
__Pyx_CyFunction_init_defaults(__pyx_CyFunctionObject *op) {
    int result = 0;
    PyObject *res = op->defaults_getter((PyObject *) op);
    if (unlikely(!res))
        return -1;
    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
    op->defaults_tuple = PyTuple_GET_ITEM(res, 0);
    Py_INCREF(op->defaults_tuple);
    op->defaults_kwdict = PyTuple_GET_ITEM(res, 1);
    Py_INCREF(op->defaults_kwdict);
    #else
    op->defaults_tuple = __Pyx_PySequence_ITEM(res, 0);
    if (unlikely(!op->defaults_tuple)) result = -1;
    else {
        op->defaults_kwdict = __Pyx_PySequence_ITEM(res, 1);
        if (unlikely(!op->defaults_kwdict)) result = -1;
    }
    #endif
    Py_DECREF(res);
    return result;
}
static int
__Pyx_CyFunction_set_defaults(__pyx_CyFunctionObject *op, PyObject* value, void *context) {
    CYTHON_UNUSED_VAR(context);
    if (!value) {
        value = Py_None;
    } else if (unlikely(value != Py_None && !PyTuple_Check(value))) {
        PyErr_SetString(PyExc_TypeError,
                        "__defaults__ must be set to a tuple object");
        return -1;
    }
    PyErr_WarnEx(PyExc_RuntimeWarning, "changes to cyfunction.__defaults__ will not "
                 "currently affect the values used in function calls", 1);
    Py_INCREF(value);
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    __Pyx_Py_XDECREF_SET(op->defaults_tuple, value);
    __Pyx_END_CRITICAL_SECTION();
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_defaults_locked(__pyx_CyFunctionObject *op) {
    PyObject* result = op->defaults_tuple;
    if (unlikely(!result)) {
        if (op->defaults_getter) {
            if (unlikely(__Pyx_CyFunction_init_defaults(op) < 0)) return NULL;
            result = op->defaults_tuple;
        } else {
            result = Py_None;
        }
    }
    Py_INCREF(result);
    return result;
}
static PyObject *
__Pyx_CyFunction_get_defaults(__pyx_CyFunctionObject *op, void *context) {
    PyObject* result = NULL;
    CYTHON_UNUSED_VAR(context);
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    result = __Pyx_CyFunction_get_defaults_locked(op);
    __Pyx_END_CRITICAL_SECTION();
    return result;
}
static int
__Pyx_CyFunction_set_kwdefaults(__pyx_CyFunctionObject *op, PyObject* value, void *context) {
    CYTHON_UNUSED_VAR(context);
    if (!value) {
        value = Py_None;
    } else if (unlikely(value != Py_None && !PyDict_Check(value))) {
        PyErr_SetString(PyExc_TypeError,
                        "__kwdefaults__ must be set to a dict object");
        return -1;
    }
    PyErr_WarnEx(PyExc_RuntimeWarning, "changes to cyfunction.__kwdefaults__ will not "
                 "currently affect the values used in function calls", 1);
    Py_INCREF(value);
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    __Pyx_Py_XDECREF_SET(op->defaults_kwdict, value);
    __Pyx_END_CRITICAL_SECTION();
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_kwdefaults_locked(__pyx_CyFunctionObject *op) {
    PyObject* result = op->defaults_kwdict;
    if (unlikely(!result)) {
        if (op->defaults_getter) {
            if (unlikely(__Pyx_CyFunction_init_defaults(op) < 0)) return NULL;
            result = op->defaults_kwdict;
        } else {
            result = Py_None;
        }
    }
    Py_INCREF(result);
    return result;
}
static PyObject *
__Pyx_CyFunction_get_kwdefaults(__pyx_CyFunctionObject *op, void *context) {
    PyObject* result;
    CYTHON_UNUSED_VAR(context);
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    result = __Pyx_CyFunction_get_kwdefaults_locked(op);
    __Pyx_END_CRITICAL_SECTION();
    return result;
}
static int
__Pyx_CyFunction_set_annotations(__pyx_CyFunctionObject *op, PyObject* value, void *context) {
    CYTHON_UNUSED_VAR(context);
    if (!value || value == Py_None) {
        value = NULL;
    } else if (unlikely(!PyDict_Check(value))) {
        PyErr_SetString(PyExc_TypeError,
                        "__annotations__ must be set to a dict object");
        return -1;
    }
    Py_XINCREF(value);
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    __Pyx_Py_XDECREF_SET(op->func_annotations, value);
    __Pyx_END_CRITICAL_SECTION();
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_annotations_locked(__pyx_CyFunctionObject *op) {
    PyObject* result = op->func_annotations;
    if (unlikely(!result)) {
        result = PyDict_New();
        if (unlikely(!result)) return NULL;
        op->func_annotations = result;
    }
    Py_INCREF(result);
    return result;
}
static PyObject *
__Pyx_CyFunction_get_annotations(__pyx_CyFunctionObject *op, void *context) {
    PyObject *result;
    CYTHON_UNUSED_VAR(context);
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    result = __Pyx_CyFunction_get_annotations_locked(op);
    __Pyx_END_CRITICAL_SECTION();
    return result;
}
static PyObject *
__Pyx_CyFunction_get_is_coroutine_value(__pyx_CyFunctionObject *op) {
    int is_coroutine = op->flags & __Pyx_CYFUNCTION_COROUTINE;
    if (is_coroutine) {
        PyObject *is_coroutine_value, *module, *fromlist, *marker = __pyx_mstate_global->__pyx_n_u_is_coroutine;
        fromlist = PyList_New(1);
        if (unlikely(!fromlist)) return NULL;
        Py_INCREF(marker);
#if CYTHON_ASSUME_SAFE_MACROS
        PyList_SET_ITEM(fromlist, 0, marker);
#else
        if (unlikely(PyList_SetItem(fromlist, 0, marker) < 0)) {
            Py_DECREF(marker);
            Py_DECREF(fromlist);
            return NULL;
        }
#endif
        module = PyImport_ImportModuleLevelObject(__pyx_mstate_global->__pyx_n_u_asyncio_coroutines, NULL, NULL, fromlist, 0);
        Py_DECREF(fromlist);
        if (unlikely(!module)) goto ignore;
        is_coroutine_value = __Pyx_PyObject_GetAttrStr(module, marker);
        Py_DECREF(module);
        if (likely(is_coroutine_value)) {
            return is_coroutine_value;
        }
ignore:
        PyErr_Clear();
    }
    return __Pyx_PyBool_FromLong(is_coroutine);
}
static PyObject *
__Pyx_CyFunction_get_is_coroutine(__pyx_CyFunctionObject *op, void *context) {
    PyObject *result;
    CYTHON_UNUSED_VAR(context);
    if (op->func_is_coroutine) {
        return __Pyx_NewRef(op->func_is_coroutine);
    }
    result = __Pyx_CyFunction_get_is_coroutine_value(op);
    if (unlikely(!result))
        return NULL;
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    if (op->func_is_coroutine) {
        Py_DECREF(result);
        result = __Pyx_NewRef(op->func_is_coroutine);
    } else {
        op->func_is_coroutine = __Pyx_NewRef(result);
    }
    __Pyx_END_CRITICAL_SECTION();
    return result;
}
static void __Pyx_CyFunction_raise_argument_count_error(__pyx_CyFunctionObject *func, const char* message, Py_ssize_t size) {
#if CYTHON_COMPILING_IN_LIMITED_API
    PyObject *py_name = __Pyx_CyFunction_get_name(func, NULL);
    if (!py_name) return;
    PyErr_Format(PyExc_TypeError,
        "%.200S() %s (%" CYTHON_FORMAT_SSIZE_T "d given)",
        py_name, message, size);
    Py_DECREF(py_name);
#else
    const char* name = ((PyCFunctionObject*)func)->m_ml->ml_name;
    PyErr_Format(PyExc_TypeError,
        "%.200s() %s (%" CYTHON_FORMAT_SSIZE_T "d given)",
        name, message, size);
#endif
}
static void __Pyx_CyFunction_raise_type_error(__pyx_CyFunctionObject *func, const char* message) {
#if CYTHON_COMPILING_IN_LIMITED_API
    PyObject *py_name = __Pyx_CyFunction_get_name(func, NULL);
    if (!py_name) return;
    PyErr_Format(PyExc_TypeError,
        "%.200S() %s",
        py_name, message);
    Py_DECREF(py_name);
#else
    const char* name = ((PyCFunctionObject*)func)->m_ml->ml_name;
    PyErr_Format(PyExc_TypeError,
        "%.200s() %s",
        name, message);
#endif
}
#if CYTHON_COMPILING_IN_LIMITED_API
static PyObject *
__Pyx_CyFunction_get_module(__pyx_CyFunctionObject *op, void *context) {
    CYTHON_UNUSED_VAR(context);
    return PyObject_GetAttrString(op->func, "__module__");
}
static int
__Pyx_CyFunction_set_module(__pyx_CyFunctionObject *op, PyObject* value, void *context) {
    CYTHON_UNUSED_VAR(context);
    return PyObject_SetAttrString(op->func, "__module__", value);
}
#endif
static PyGetSetDef __pyx_CyFunction_getsets[] = {
    {"func_doc", (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
    {"__doc__",  (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
    {"func_name", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
    {"__name__", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
    {"__qualname__", (getter)__Pyx_CyFunction_get_qualname, (setter)__Pyx_CyFunction_set_qualname, 0, 0},
    {"func_dict", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
    {"__dict__", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
    {"func_globals", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
    {"__globals__", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
    {"func_closure", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
    {"__closure__", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
    {"func_code", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
    {"__code__", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
    {"func_defaults", (getter)__Pyx_CyFunction_get_defaults, (setter)__Pyx_CyFunction_set_defaults, 0, 0},
    {"__defaults__", (getter)__Pyx_CyFunction_get_defaults, (setter)__Pyx_CyFunction_set_defaults, 0, 0},
    {"__kwdefaults__", (getter)__Pyx_CyFunction_get_kwdefaults, (setter)__Pyx_CyFunction_set_kwdefaults, 0, 0},
    {"__annotations__", (getter)__Pyx_CyFunction_get_annotations, (setter)__Pyx_CyFunction_set_annotations, 0, 0},
    {"_is_coroutine", (getter)__Pyx_CyFunction_get_is_coroutine, 0, 0, 0},
#if CYTHON_COMPILING_IN_LIMITED_API
    {"__module__", (getter)__Pyx_CyFunction_get_module, (setter)__Pyx_CyFunction_set_module, 0, 0},
#endif
    {0, 0, 0, 0, 0}
};
static PyMemberDef __pyx_CyFunction_members[] = {
#if !CYTHON_COMPILING_IN_LIMITED_API
    {"__module__", T_OBJECT, offsetof(PyCFunctionObject, m_module), 0, 0},
#endif
    {"__dictoffset__", T_PYSSIZET, offsetof(__pyx_CyFunctionObject, func_dict), READONLY, 0},
#if CYTHON_METH_FASTCALL
#if CYTHON_BACKPORT_VECTORCALL || CYTHON_COMPILING_IN_LIMITED_API
    {"__vectorcalloffset__", T_PYSSIZET, offsetof(__pyx_CyFunctionObject, func_vectorcall), READONLY, 0},
#else
    {"__vectorcalloffset__", T_PYSSIZET, offsetof(PyCFunctionObject, vectorcall), READONLY, 0},
#endif
#if CYTHON_COMPILING_IN_LIMITED_API
    {"__weaklistoffset__", T_PYSSIZET, offsetof(__pyx_CyFunctionObject, func_weakreflist), READONLY, 0},
#else
    {"__weaklistoffset__", T_PYSSIZET, offsetof(PyCFunctionObject, m_weakreflist), READONLY, 0},
#endif
#endif
    {0, 0, 0,  0, 0}
};
static PyObject *
__Pyx_CyFunction_reduce(__pyx_CyFunctionObject *m, PyObject *args)
{
    PyObject *result = NULL;
    CYTHON_UNUSED_VAR(args);
    __Pyx_BEGIN_CRITICAL_SECTION(m);
    Py_INCREF(m->func_qualname);
    result = m->func_qualname;
    __Pyx_END_CRITICAL_SECTION();
    return result;
}
static PyMethodDef __pyx_CyFunction_methods[] = {
    {"__reduce__", (PyCFunction)__Pyx_CyFunction_reduce, METH_VARARGS, 0},
    {0, 0, 0, 0}
};
#if CYTHON_COMPILING_IN_LIMITED_API
#define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func_weakreflist)
#else
#define __Pyx_CyFunction_weakreflist(cyfunc) (((PyCFunctionObject*)cyfunc)->m_weakreflist)
#endif
static PyObject *__Pyx_CyFunction_Init(__pyx_CyFunctionObject *op, PyMethodDef *ml, int flags, PyObject* qualname,
                                       PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
#if !CYTHON_COMPILING_IN_LIMITED_API
    PyCFunctionObject *cf = (PyCFunctionObject*) op;
#endif
    if (unlikely(op == NULL))
        return NULL;
#if CYTHON_COMPILING_IN_LIMITED_API
    op->func = PyCFunction_NewEx(ml, (PyObject*)op, module);
    if (unlikely(!op->func)) return NULL;
#endif
    op->flags = flags;
    __Pyx_CyFunction_weakreflist(op) = NULL;
#if !CYTHON_COMPILING_IN_LIMITED_API
    cf->m_ml = ml;
    cf->m_self = (PyObject *) op;
#endif
    Py_XINCREF(closure);
    op->func_closure = closure;
#if !CYTHON_COMPILING_IN_LIMITED_API
    Py_XINCREF(module);
    cf->m_module = module;
#endif
    op->func_dict = NULL;
    op->func_name = NULL;
    Py_INCREF(qualname);
    op->func_qualname = qualname;
    op->func_doc = NULL;
#if PY_VERSION_HEX < 0x030900B1 || CYTHON_COMPILING_IN_LIMITED_API
    op->func_classobj = NULL;
#else
    ((PyCMethodObject*)op)->mm_class = NULL;
#endif
    op->func_globals = globals;
    Py_INCREF(op->func_globals);
    Py_XINCREF(code);
    op->func_code = code;
    op->defaults = NULL;
    op->defaults_tuple = NULL;
    op->defaults_kwdict = NULL;
    op->defaults_getter = NULL;
    op->func_annotations = NULL;
    op->func_is_coroutine = NULL;
#if CYTHON_METH_FASTCALL
    switch (ml->ml_flags & (METH_VARARGS | METH_FASTCALL | METH_NOARGS | METH_O | METH_KEYWORDS | METH_METHOD)) {
    case METH_NOARGS:
        __Pyx_CyFunction_func_vectorcall(op) = __Pyx_CyFunction_Vectorcall_NOARGS;
        break;
    case METH_O:
        __Pyx_CyFunction_func_vectorcall(op) = __Pyx_CyFunction_Vectorcall_O;
        break;
    case METH_METHOD | METH_FASTCALL | METH_KEYWORDS:
        __Pyx_CyFunction_func_vectorcall(op) = __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD;
        break;
    case METH_FASTCALL | METH_KEYWORDS:
        __Pyx_CyFunction_func_vectorcall(op) = __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS;
        break;
    case METH_VARARGS | METH_KEYWORDS:
        __Pyx_CyFunction_func_vectorcall(op) = NULL;
        break;
    default:
        PyErr_SetString(PyExc_SystemError, "Bad call flags for CyFunction");
        Py_DECREF(op);
        return NULL;
    }
#endif
    return (PyObject *) op;
}
static int
__Pyx_CyFunction_clear(__pyx_CyFunctionObject *m)
{
    Py_CLEAR(m->func_closure);
#if CYTHON_COMPILING_IN_LIMITED_API
    Py_CLEAR(m->func);
#else
    Py_CLEAR(((PyCFunctionObject*)m)->m_module);
#endif
    Py_CLEAR(m->func_dict);
    Py_CLEAR(m->func_name);
    Py_CLEAR(m->func_qualname);
    Py_CLEAR(m->func_doc);
    Py_CLEAR(m->func_globals);
    Py_CLEAR(m->func_code);
#if !CYTHON_COMPILING_IN_LIMITED_API
#if PY_VERSION_HEX < 0x030900B1
    Py_CLEAR(__Pyx_CyFunction_GetClassObj(m));
#else
    {
        PyObject *cls = (PyObject*) ((PyCMethodObject *) (m))->mm_class;
        ((PyCMethodObject *) (m))->mm_class = NULL;
        Py_XDECREF(cls);
    }
#endif
#endif
    Py_CLEAR(m->defaults_tuple);
    Py_CLEAR(m->defaults_kwdict);
    Py_CLEAR(m->func_annotations);
    Py_CLEAR(m->func_is_coroutine);
    Py_CLEAR(m->defaults);
    return 0;
}
static void __Pyx__CyFunction_dealloc(__pyx_CyFunctionObject *m)
{
    if (__Pyx_CyFunction_weakreflist(m) != NULL)
        PyObject_ClearWeakRefs((PyObject *) m);
    __Pyx_CyFunction_clear(m);
    __Pyx_PyHeapTypeObject_GC_Del(m);
}
static void __Pyx_CyFunction_dealloc(__pyx_CyFunctionObject *m)
{
    PyObject_GC_UnTrack(m);
    __Pyx__CyFunction_dealloc(m);
}
static int __Pyx_CyFunction_traverse(__pyx_CyFunctionObject *m, visitproc visit, void *arg)
{
    {
        int e = __Pyx_call_type_traverse((PyObject*)m, 1, visit, arg);
        if (e) return e;
    }
    Py_VISIT(m->func_closure);
#if CYTHON_COMPILING_IN_LIMITED_API
    Py_VISIT(m->func);
#else
    Py_VISIT(((PyCFunctionObject*)m)->m_module);
#endif
    Py_VISIT(m->func_dict);
    __Pyx_VISIT_CONST(m->func_name);
    __Pyx_VISIT_CONST(m->func_qualname);
    Py_VISIT(m->func_doc);
    Py_VISIT(m->func_globals);
    __Pyx_VISIT_CONST(m->func_code);
#if !CYTHON_COMPILING_IN_LIMITED_API
    Py_VISIT(__Pyx_CyFunction_GetClassObj(m));
#endif
    Py_VISIT(m->defaults_tuple);
    Py_VISIT(m->defaults_kwdict);
    Py_VISIT(m->func_is_coroutine);
    Py_VISIT(m->defaults);
    return 0;
}
static PyObject*
__Pyx_CyFunction_repr(__pyx_CyFunctionObject *op)
{
    PyObject *repr;
    __Pyx_BEGIN_CRITICAL_SECTION(op);
    repr = PyUnicode_FromFormat("<cyfunction %U at %p>",
                                op->func_qualname, (void *)op);
    __Pyx_END_CRITICAL_SECTION();
    return repr;
}
static PyObject * __Pyx_CyFunction_CallMethod(PyObject *func, PyObject *self, PyObject *arg, PyObject *kw) {
#if CYTHON_COMPILING_IN_LIMITED_API
    PyObject *f = ((__pyx_CyFunctionObject*)func)->func;
    PyCFunction meth;
    int flags;
    meth = PyCFunction_GetFunction(f);
    if (unlikely(!meth)) return NULL;
    flags = PyCFunction_GetFlags(f);
    if (unlikely(flags < 0)) return NULL;
#else
    PyCFunctionObject* f = (PyCFunctionObject*)func;
    PyCFunction meth = f->m_ml->ml_meth;
    int flags = f->m_ml->ml_flags;
#endif
    Py_ssize_t size;
    switch (flags & (METH_VARARGS | METH_KEYWORDS | METH_NOARGS | METH_O)) {
    case METH_VARARGS:
        if (likely(kw == NULL || PyDict_Size(kw) == 0))
            return (*meth)(self, arg);
        break;
    case METH_VARARGS | METH_KEYWORDS:
        return (*(PyCFunctionWithKeywords)(void(*)(void))meth)(self, arg, kw);
    case METH_NOARGS:
        if (likely(kw == NULL || PyDict_Size(kw) == 0)) {
#if CYTHON_ASSUME_SAFE_SIZE
            size = PyTuple_GET_SIZE(arg);
#else
            size = PyTuple_Size(arg);
            if (unlikely(size < 0)) return NULL;
#endif
            if (likely(size == 0))
                return (*meth)(self, NULL);
            __Pyx_CyFunction_raise_argument_count_error(
                (__pyx_CyFunctionObject*)func,
                "takes no arguments", size);
            return NULL;
        }
        break;
    case METH_O:
        if (likely(kw == NULL || PyDict_Size(kw) == 0)) {
#if CYTHON_ASSUME_SAFE_SIZE
            size = PyTuple_GET_SIZE(arg);
#else
            size = PyTuple_Size(arg);
            if (unlikely(size < 0)) return NULL;
#endif
            if (likely(size == 1)) {
                PyObject *result, *arg0;
                #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
                arg0 = PyTuple_GET_ITEM(arg, 0);
                #else
                arg0 = __Pyx_PySequence_ITEM(arg, 0); if (unlikely(!arg0)) return NULL;
                #endif
                result = (*meth)(self, arg0);
                #if !(CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS)
                Py_DECREF(arg0);
                #endif
                return result;
            }
            __Pyx_CyFunction_raise_argument_count_error(
                (__pyx_CyFunctionObject*)func,
                "takes exactly one argument", size);
            return NULL;
        }
        break;
    default:
        PyErr_SetString(PyExc_SystemError, "Bad call flags for CyFunction");
        return NULL;
    }
    __Pyx_CyFunction_raise_type_error(
        (__pyx_CyFunctionObject*)func, "takes no keyword arguments");
    return NULL;
}
static CYTHON_INLINE PyObject *__Pyx_CyFunction_Call(PyObject *func, PyObject *arg, PyObject *kw) {
    PyObject *self, *result;
#if CYTHON_COMPILING_IN_LIMITED_API
    self = PyCFunction_GetSelf(((__pyx_CyFunctionObject*)func)->func);
    if (unlikely(!self) && PyErr_Occurred()) return NULL;
#else
    self = ((PyCFunctionObject*)func)->m_self;
#endif
    result = __Pyx_CyFunction_CallMethod(func, self, arg, kw);
    return result;
}
static PyObject *__Pyx_CyFunction_CallAsMethod(PyObject *func, PyObject *args, PyObject *kw) {
    PyObject *result;
    __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *) func;
#if CYTHON_METH_FASTCALL && (CYTHON_VECTORCALL || CYTHON_BACKPORT_VECTORCALL)
     __pyx_vectorcallfunc vc = __Pyx_CyFunction_func_vectorcall(cyfunc);
    if (vc) {
#if CYTHON_ASSUME_SAFE_MACROS && CYTHON_ASSUME_SAFE_SIZE
        return __Pyx_PyVectorcall_FastCallDict(func, vc, &PyTuple_GET_ITEM(args, 0), (size_t)PyTuple_GET_SIZE(args), kw);
#else
        (void) &__Pyx_PyVectorcall_FastCallDict;
        return PyVectorcall_Call(func, args, kw);
#endif
    }
#endif
    if ((cyfunc->flags & __Pyx_CYFUNCTION_CCLASS) && !(cyfunc->flags & __Pyx_CYFUNCTION_STATICMETHOD)) {
        Py_ssize_t argc;
        PyObject *new_args;
        PyObject *self;
#if CYTHON_ASSUME_SAFE_SIZE
        argc = PyTuple_GET_SIZE(args);
#else
        argc = PyTuple_Size(args);
        if (unlikely(argc < 0)) return NULL;
#endif
        new_args = PyTuple_GetSlice(args, 1, argc);
        if (unlikely(!new_args))
            return NULL;
        self = PyTuple_GetItem(args, 0);
        if (unlikely(!self)) {
            Py_DECREF(new_args);
            PyErr_Format(PyExc_TypeError,
                         "unbound method %.200S() needs an argument",
                         cyfunc->func_qualname);
            return NULL;
        }
        result = __Pyx_CyFunction_CallMethod(func, self, new_args, kw);
        Py_DECREF(new_args);
    } else {
        result = __Pyx_CyFunction_Call(func, args, kw);
    }
    return result;
}
#if CYTHON_METH_FASTCALL && (CYTHON_VECTORCALL || CYTHON_BACKPORT_VECTORCALL)
static CYTHON_INLINE int __Pyx_CyFunction_Vectorcall_CheckArgs(__pyx_CyFunctionObject *cyfunc, Py_ssize_t nargs, PyObject *kwnames)
{
    int ret = 0;
    if ((cyfunc->flags & __Pyx_CYFUNCTION_CCLASS) && !(cyfunc->flags & __Pyx_CYFUNCTION_STATICMETHOD)) {
        if (unlikely(nargs < 1)) {
            __Pyx_CyFunction_raise_type_error(
                cyfunc, "needs an argument");
            return -1;
        }
        ret = 1;
    }
    if (unlikely(kwnames) && unlikely(__Pyx_PyTuple_GET_SIZE(kwnames))) {
        __Pyx_CyFunction_raise_type_error(
            cyfunc, "takes no keyword arguments");
        return -1;
    }
    return ret;
}
static PyObject * __Pyx_CyFunction_Vectorcall_NOARGS(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
{
    __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
#if CYTHON_BACKPORT_VECTORCALL
    Py_ssize_t nargs = (Py_ssize_t)nargsf;
#else
    Py_ssize_t nargs = PyVectorcall_NARGS(nargsf);
#endif
    PyObject *self;
#if CYTHON_COMPILING_IN_LIMITED_API
    PyCFunction meth = PyCFunction_GetFunction(cyfunc->func);
    if (unlikely(!meth)) return NULL;
#else
    PyCFunction meth = ((PyCFunctionObject*)cyfunc)->m_ml->ml_meth;
#endif
    switch (__Pyx_CyFunction_Vectorcall_CheckArgs(cyfunc, nargs, kwnames)) {
    case 1:
        self = args[0];
        args += 1;
        nargs -= 1;
        break;
    case 0:
#if CYTHON_COMPILING_IN_LIMITED_API
        self = PyCFunction_GetSelf(((__pyx_CyFunctionObject*)cyfunc)->func);
        if (unlikely(!self) && PyErr_Occurred()) return NULL;
#else
        self = ((PyCFunctionObject*)cyfunc)->m_self;
#endif
        break;
    default:
        return NULL;
    }
    if (unlikely(nargs != 0)) {
        __Pyx_CyFunction_raise_argument_count_error(
            cyfunc, "takes no arguments", nargs);
        return NULL;
    }
    return meth(self, NULL);
}
static PyObject * __Pyx_CyFunction_Vectorcall_O(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
{
    __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
#if CYTHON_BACKPORT_VECTORCALL
    Py_ssize_t nargs = (Py_ssize_t)nargsf;
#else
    Py_ssize_t nargs = PyVectorcall_NARGS(nargsf);
#endif
    PyObject *self;
#if CYTHON_COMPILING_IN_LIMITED_API
    PyCFunction meth = PyCFunction_GetFunction(cyfunc->func);
    if (unlikely(!meth)) return NULL;
#else
    PyCFunction meth = ((PyCFunctionObject*)cyfunc)->m_ml->ml_meth;
#endif
    switch (__Pyx_CyFunction_Vectorcall_CheckArgs(cyfunc, nargs, kwnames)) {
    case 1:
        self = args[0];
        args += 1;
        nargs -= 1;
        break;
    case 0:
#if CYTHON_COMPILING_IN_LIMITED_API
        self = PyCFunction_GetSelf(((__pyx_CyFunctionObject*)cyfunc)->func);
        if (unlikely(!self) && PyErr_Occurred()) return NULL;
#else
        self = ((PyCFunctionObject*)cyfunc)->m_self;
#endif
        break;
    default:
        return NULL;
    }
    if (unlikely(nargs != 1)) {
        __Pyx_CyFunction_raise_argument_count_error(
            cyfunc, "takes exactly one argument", nargs);
        return NULL;
    }
    return meth(self, args[0]);
}
static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
{
    __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
#if CYTHON_BACKPORT_VECTORCALL
    Py_ssize_t nargs = (Py_ssize_t)nargsf;
#else
    Py_ssize_t nargs = PyVectorcall_NARGS(nargsf);
#endif
    PyObject *self;
#if CYTHON_COMPILING_IN_LIMITED_API
    PyCFunction meth = PyCFunction_GetFunction(cyfunc->func);
    if (unlikely(!meth)) return NULL;
#else
    PyCFunction meth = ((PyCFunctionObject*)cyfunc)->m_ml->ml_meth;
#endif
    switch (__Pyx_CyFunction_Vectorcall_CheckArgs(cyfunc, nargs, NULL)) {
    case 1:
        self = args[0];
        args += 1;
        nargs -= 1;
        break;
    case 0:
#if CYTHON_COMPILING_IN_LIMITED_API
        self = PyCFunction_GetSelf(((__pyx_CyFunctionObject*)cyfunc)->func);
        if (unlikely(!self) && PyErr_Occurred()) return NULL;
#else
        self = ((PyCFunctionObject*)cyfunc)->m_self;
#endif
        break;
    default:
        return NULL;
    }
    return ((__Pyx_PyCFunctionFastWithKeywords)(void(*)(void))meth)(self, args, nargs, kwnames);
}
static PyObject * __Pyx_CyFunction_Vectorcall_FASTCALL_KEYWORDS_METHOD(PyObject *func, PyObject *const *args, size_t nargsf, PyObject *kwnames)
{
    __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *)func;
    PyTypeObject *cls = (PyTypeObject *) __Pyx_CyFunction_GetClassObj(cyfunc);
#if CYTHON_BACKPORT_VECTORCALL
    Py_ssize_t nargs = (Py_ssize_t)nargsf;
#else
    Py_ssize_t nargs = PyVectorcall_NARGS(nargsf);
#endif
    PyObject *self;
#if CYTHON_COMPILING_IN_LIMITED_API
    PyCFunction meth = PyCFunction_GetFunction(cyfunc->func);
    if (unlikely(!meth)) return NULL;
#else
    PyCFunction meth = ((PyCFunctionObject*)cyfunc)->m_ml->ml_meth;
#endif
    switch (__Pyx_CyFunction_Vectorcall_CheckArgs(cyfunc, nargs, NULL)) {
    case 1:
        self = args[0];
        args += 1;
        nargs -= 1;
        break;
    case 0:
#if CYTHON_COMPILING_IN_LIMITED_API
        self = PyCFunction_GetSelf(((__pyx_CyFunctionObject*)cyfunc)->func);
        if (unlikely(!self) && PyErr_Occurred()) return NULL;
#else
        self = ((PyCFunctionObject*)cyfunc)->m_self;
#endif
        break;
    default:
        return NULL;
    }
    return ((__Pyx_PyCMethod)(void(*)(void))meth)(self, cls, args, (size_t)nargs, kwnames);
}
#endif
static PyType_Slot __pyx_CyFunctionType_slots[] = {
    {Py_tp_dealloc, (void *)__Pyx_CyFunction_dealloc},
    {Py_tp_repr, (void *)__Pyx_CyFunction_repr},
    {Py_tp_call, (void *)__Pyx_CyFunction_CallAsMethod},
    {Py_tp_traverse, (void *)__Pyx_CyFunction_traverse},
    {Py_tp_clear, (void *)__Pyx_CyFunction_clear},
    {Py_tp_methods, (void *)__pyx_CyFunction_methods},
    {Py_tp_members, (void *)__pyx_CyFunction_members},
    {Py_tp_getset, (void *)__pyx_CyFunction_getsets},
    {Py_tp_descr_get, (void *)__Pyx_PyMethod_New},
    {0, 0},
};
static PyType_Spec __pyx_CyFunctionType_spec = {
    __PYX_TYPE_MODULE_PREFIX "cython_function_or_method",
    sizeof(__pyx_CyFunctionObject),
    0,
#ifdef Py_TPFLAGS_METHOD_DESCRIPTOR
    Py_TPFLAGS_METHOD_DESCRIPTOR |
#endif
#if CYTHON_METH_FASTCALL
#if defined(Py_TPFLAGS_HAVE_VECTORCALL)
    Py_TPFLAGS_HAVE_VECTORCALL |
#elif defined(_Py_TPFLAGS_HAVE_VECTORCALL)
    _Py_TPFLAGS_HAVE_VECTORCALL |
#endif
#endif // CYTHON_METH_FASTCALL
#if PY_VERSION_HEX >= 0x030A0000
    Py_TPFLAGS_IMMUTABLETYPE |
#endif
    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_GC | Py_TPFLAGS_BASETYPE,
    __pyx_CyFunctionType_slots
};
static int __pyx_CyFunction_init(PyObject *module) {
    __pyx_mstatetype *mstate = __Pyx_PyModule_GetState(module);
    mstate->__pyx_CyFunctionType = __Pyx_FetchCommonTypeFromSpec(
        mstate->__pyx_CommonTypesMetaclassType, module, &__pyx_CyFunctionType_spec, NULL);
    if (unlikely(mstate->__pyx_CyFunctionType == NULL)) {
        return -1;
    }
    return 0;
}
static CYTHON_INLINE PyObject *__Pyx_CyFunction_InitDefaults(PyObject *func, PyTypeObject *defaults_type) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->defaults = PyObject_CallObject((PyObject*)defaults_type, NULL); // _PyObject_New(defaults_type);
    if (unlikely(!m->defaults))
        return NULL;
    return m->defaults;
}
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *func, PyObject *tuple) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->defaults_tuple = tuple;
    Py_INCREF(tuple);
}
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *func, PyObject *dict) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->defaults_kwdict = dict;
    Py_INCREF(dict);
}
static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *func, PyObject *dict) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->func_annotations = dict;
    Py_INCREF(dict);
}

/* CythonFunction */
  static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml, int flags, PyObject* qualname,
                                      PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
    PyObject *op = __Pyx_CyFunction_Init(
        PyObject_GC_New(__pyx_CyFunctionObject, __pyx_mstate_global->__pyx_CyFunctionType),
        ml, flags, qualname, closure, module, globals, code
    );
    if (likely(op)) {
        PyObject_GC_Track(op);
    }
    return op;
}

/* PyObjectLookupSpecial */
  #if CYTHON_USE_PYTYPE_LOOKUP && CYTHON_USE_TYPE_SLOTS
static CYTHON_INLINE PyObject* __Pyx__PyObject_LookupSpecial(PyObject* obj, PyObject* attr_name, int with_error) {
    PyObject *res;
    PyTypeObject *tp = Py_TYPE(obj);
    res = _PyType_Lookup(tp, attr_name);
    if (likely(res)) {
        descrgetfunc f = Py_TYPE(res)->tp_descr_get;
        if (!f) {
            Py_INCREF(res);
        } else {
            res = f(res, obj, (PyObject *)tp);
        }
    } else if (with_error) {
        PyErr_SetObject(PyExc_AttributeError, attr_name);
    }
    return res;
}
#endif

/* Py3ClassCreate */
  static PyObject *__Pyx_Py3MetaclassPrepare(PyObject *metaclass, PyObject *bases, PyObject *name,
                                           PyObject *qualname, PyObject *mkw, PyObject *modname, PyObject *doc) {
    PyObject *ns;
    if (metaclass) {
        PyObject *prep = __Pyx_PyObject_GetAttrStrNoError(metaclass, __pyx_mstate_global->__pyx_n_u_prepare);
        if (prep) {
            PyObject *pargs[3] = {NULL, name, bases};
            ns = __Pyx_PyObject_FastCallDict(prep, pargs+1, 2 | __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET, mkw);
            Py_DECREF(prep);
        } else {
            if (unlikely(PyErr_Occurred()))
                return NULL;
            ns = PyDict_New();
        }
    } else {
        ns = PyDict_New();
    }
    if (unlikely(!ns))
        return NULL;
    if (unlikely(PyObject_SetItem(ns, __pyx_mstate_global->__pyx_n_u_module, modname) < 0)) goto bad;
    if (unlikely(PyObject_SetItem(ns, __pyx_mstate_global->__pyx_n_u_qualname, qualname) < 0)) goto bad;
    if (unlikely(doc && PyObject_SetItem(ns, __pyx_mstate_global->__pyx_n_u_doc, doc) < 0)) goto bad;
    return ns;
bad:
    Py_DECREF(ns);
    return NULL;
}
static PyObject *__Pyx_Py3ClassCreate(PyObject *metaclass, PyObject *name, PyObject *bases,
                                      PyObject *dict, PyObject *mkw,
                                      int calculate_metaclass, int allow_py2_metaclass) {
    PyObject *result;
    PyObject *owned_metaclass = NULL;
    PyObject *margs[4] = {NULL, name, bases, dict};
    if (allow_py2_metaclass) {
        owned_metaclass = PyObject_GetItem(dict, __pyx_mstate_global->__pyx_n_u_metaclass);
        if (owned_metaclass) {
            metaclass = owned_metaclass;
        } else if (likely(PyErr_ExceptionMatches(PyExc_KeyError))) {
            PyErr_Clear();
        } else {
            return NULL;
        }
    }
    if (calculate_metaclass && (!metaclass || PyType_Check(metaclass))) {
        metaclass = __Pyx_CalculateMetaclass((PyTypeObject*) metaclass, bases);
        Py_XDECREF(owned_metaclass);
        if (unlikely(!metaclass))
            return NULL;
        owned_metaclass = metaclass;
    }
    result = __Pyx_PyObject_FastCallDict(metaclass, margs+1, 3 | __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET, mkw);
    Py_XDECREF(owned_metaclass);
    return result;
}

/* CLineInTraceback */
  #if CYTHON_CLINE_IN_TRACEBACK && CYTHON_CLINE_IN_TRACEBACK_RUNTIME
static int __Pyx_CLineForTraceback(PyThreadState *tstate, int c_line) {
    PyObject *use_cline;
    PyObject *ptype, *pvalue, *ptraceback;
#if CYTHON_COMPILING_IN_CPYTHON
    PyObject **cython_runtime_dict;
#endif
    CYTHON_MAYBE_UNUSED_VAR(tstate);
    if (unlikely(!__pyx_mstate_global->__pyx_cython_runtime)) {
        return c_line;
    }
    __Pyx_ErrFetchInState(tstate, &ptype, &pvalue, &ptraceback);
#if CYTHON_COMPILING_IN_CPYTHON
    cython_runtime_dict = _PyObject_GetDictPtr(__pyx_mstate_global->__pyx_cython_runtime);
    if (likely(cython_runtime_dict)) {
        __Pyx_BEGIN_CRITICAL_SECTION(*cython_runtime_dict);
        __PYX_PY_DICT_LOOKUP_IF_MODIFIED(
            use_cline, *cython_runtime_dict,
            __Pyx_PyDict_GetItemStr(*cython_runtime_dict, __pyx_mstate_global->__pyx_n_u_cline_in_traceback))
        Py_XINCREF(use_cline);
        __Pyx_END_CRITICAL_SECTION();
    } else
#endif
    {
      PyObject *use_cline_obj = __Pyx_PyObject_GetAttrStrNoError(__pyx_mstate_global->__pyx_cython_runtime, __pyx_mstate_global->__pyx_n_u_cline_in_traceback);
      if (use_cline_obj) {
        use_cline = PyObject_Not(use_cline_obj) ? Py_False : Py_True;
        Py_INCREF(use_cline);
        Py_DECREF(use_cline_obj);
      } else {
        PyErr_Clear();
        use_cline = NULL;
      }
    }
    if (!use_cline) {
        c_line = 0;
        (void) PyObject_SetAttr(__pyx_mstate_global->__pyx_cython_runtime, __pyx_mstate_global->__pyx_n_u_cline_in_traceback, Py_False);
    }
    else if (use_cline == Py_False || (use_cline != Py_True && PyObject_Not(use_cline) != 0)) {
        c_line = 0;
    }
    Py_XDECREF(use_cline);
    __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
    return c_line;
}
#endif

/* CodeObjectCache */
  static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line) {
    int start = 0, mid = 0, end = count - 1;
    if (end >= 0 && code_line > entries[end].code_line) {
        return count;
    }
    while (start < end) {
        mid = start + (end - start) / 2;
        if (code_line < entries[mid].code_line) {
            end = mid;
        } else if (code_line > entries[mid].code_line) {
             start = mid + 1;
        } else {
            return mid;
        }
    }
    if (code_line <= entries[mid].code_line) {
        return mid;
    } else {
        return mid + 1;
    }
}
static __Pyx_CachedCodeObjectType *__pyx__find_code_object(struct __Pyx_CodeObjectCache *code_cache, int code_line) {
    __Pyx_CachedCodeObjectType* code_object;
    int pos;
    if (unlikely(!code_line) || unlikely(!code_cache->entries)) {
        return NULL;
    }
    pos = __pyx_bisect_code_objects(code_cache->entries, code_cache->count, code_line);
    if (unlikely(pos >= code_cache->count) || unlikely(code_cache->entries[pos].code_line != code_line)) {
        return NULL;
    }
    code_object = code_cache->entries[pos].code_object;
    Py_INCREF(code_object);
    return code_object;
}
static __Pyx_CachedCodeObjectType *__pyx_find_code_object(int code_line) {
#if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING && !CYTHON_ATOMICS
    (void)__pyx__find_code_object;
    return NULL; // Most implementation should have atomics. But otherwise, don't make it thread-safe, just miss.
#else
    struct __Pyx_CodeObjectCache *code_cache = &__pyx_mstate_global->__pyx_code_cache;
#if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
    __pyx_nonatomic_int_type old_count = __pyx_atomic_incr_acq_rel(&code_cache->accessor_count);
    if (old_count < 0) {
        __pyx_atomic_decr_acq_rel(&code_cache->accessor_count);
        return NULL;
    }
#endif
    __Pyx_CachedCodeObjectType *result = __pyx__find_code_object(code_cache, code_line);
#if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
    __pyx_atomic_decr_acq_rel(&code_cache->accessor_count);
#endif
    return result;
#endif
}
static void __pyx__insert_code_object(struct __Pyx_CodeObjectCache *code_cache, int code_line, __Pyx_CachedCodeObjectType* code_object)
{
    int pos, i;
    __Pyx_CodeObjectCacheEntry* entries = code_cache->entries;
    if (unlikely(!code_line)) {
        return;
    }
    if (unlikely(!entries)) {
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Malloc(64*sizeof(__Pyx_CodeObjectCacheEntry));
        if (likely(entries)) {
            code_cache->entries = entries;
            code_cache->max_count = 64;
            code_cache->count = 1;
            entries[0].code_line = code_line;
            entries[0].code_object = code_object;
            Py_INCREF(code_object);
        }
        return;
    }
    pos = __pyx_bisect_code_objects(code_cache->entries, code_cache->count, code_line);
    if ((pos < code_cache->count) && unlikely(code_cache->entries[pos].code_line == code_line)) {
        __Pyx_CachedCodeObjectType* tmp = entries[pos].code_object;
        entries[pos].code_object = code_object;
        Py_INCREF(code_object);
        Py_DECREF(tmp);
        return;
    }
    if (code_cache->count == code_cache->max_count) {
        int new_max = code_cache->max_count + 64;
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Realloc(
            code_cache->entries, ((size_t)new_max) * sizeof(__Pyx_CodeObjectCacheEntry));
        if (unlikely(!entries)) {
            return;
        }
        code_cache->entries = entries;
        code_cache->max_count = new_max;
    }
    for (i=code_cache->count; i>pos; i--) {
        entries[i] = entries[i-1];
    }
    entries[pos].code_line = code_line;
    entries[pos].code_object = code_object;
    code_cache->count++;
    Py_INCREF(code_object);
}
static void __pyx_insert_code_object(int code_line, __Pyx_CachedCodeObjectType* code_object) {
#if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING && !CYTHON_ATOMICS
    (void)__pyx__insert_code_object;
    return; // Most implementation should have atomics. But otherwise, don't make it thread-safe, just fail.
#else
    struct __Pyx_CodeObjectCache *code_cache = &__pyx_mstate_global->__pyx_code_cache;
#if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
    __pyx_nonatomic_int_type expected = 0;
    if (!__pyx_atomic_int_cmp_exchange(&code_cache->accessor_count, &expected, INT_MIN)) {
        return;
    }
#endif
    __pyx__insert_code_object(code_cache, code_line, code_object);
#if CYTHON_COMPILING_IN_CPYTHON_FREETHREADING
    __pyx_atomic_sub(&code_cache->accessor_count, INT_MIN);
#endif
#endif
}

/* AddTraceback */
  #include "compile.h"
#include "frameobject.h"
#include "traceback.h"
#if PY_VERSION_HEX >= 0x030b00a6 && !CYTHON_COMPILING_IN_LIMITED_API && !defined(PYPY_VERSION)
  #ifndef Py_BUILD_CORE
    #define Py_BUILD_CORE 1
  #endif
  #include "internal/pycore_frame.h"
#endif
#if CYTHON_COMPILING_IN_LIMITED_API
static PyObject *__Pyx_PyCode_Replace_For_AddTraceback(PyObject *code, PyObject *scratch_dict,
                                                       PyObject *firstlineno, PyObject *name) {
    PyObject *replace = NULL;
    if (unlikely(PyDict_SetItemString(scratch_dict, "co_firstlineno", firstlineno))) return NULL;
    if (unlikely(PyDict_SetItemString(scratch_dict, "co_name", name))) return NULL;
    replace = PyObject_GetAttrString(code, "replace");
    if (likely(replace)) {
        PyObject *result = PyObject_Call(replace, __pyx_mstate_global->__pyx_empty_tuple, scratch_dict);
        Py_DECREF(replace);
        return result;
    }
    PyErr_Clear();
    return NULL;
}
static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename) {
    PyObject *code_object = NULL, *py_py_line = NULL, *py_funcname = NULL, *dict = NULL;
    PyObject *replace = NULL, *getframe = NULL, *frame = NULL;
    PyObject *exc_type, *exc_value, *exc_traceback;
    int success = 0;
    if (c_line) {
        (void) __pyx_cfilenm;
        (void) __Pyx_CLineForTraceback(__Pyx_PyThreadState_Current, c_line);
    }
    PyErr_Fetch(&exc_type, &exc_value, &exc_traceback);
    code_object = __pyx_find_code_object(c_line ? -c_line : py_line);
    if (!code_object) {
        code_object = Py_CompileString("_getframe()", filename, Py_eval_input);
        if (unlikely(!code_object)) goto bad;
        py_py_line = PyLong_FromLong(py_line);
        if (unlikely(!py_py_line)) goto bad;
        py_funcname = PyUnicode_FromString(funcname);
        if (unlikely(!py_funcname)) goto bad;
        dict = PyDict_New();
        if (unlikely(!dict)) goto bad;
        {
            PyObject *old_code_object = code_object;
            code_object = __Pyx_PyCode_Replace_For_AddTraceback(code_object, dict, py_py_line, py_funcname);
            Py_DECREF(old_code_object);
        }
        if (unlikely(!code_object)) goto bad;
        __pyx_insert_code_object(c_line ? -c_line : py_line, code_object);
    } else {
        dict = PyDict_New();
    }
    getframe = PySys_GetObject("_getframe");
    if (unlikely(!getframe)) goto bad;
    if (unlikely(PyDict_SetItemString(dict, "_getframe", getframe))) goto bad;
    frame = PyEval_EvalCode(code_object, dict, dict);
    if (unlikely(!frame) || frame == Py_None) goto bad;
    success = 1;
  bad:
    PyErr_Restore(exc_type, exc_value, exc_traceback);
    Py_XDECREF(code_object);
    Py_XDECREF(py_py_line);
    Py_XDECREF(py_funcname);
    Py_XDECREF(dict);
    Py_XDECREF(replace);
    if (success) {
        PyTraceBack_Here(
            (struct _frame*)frame);
    }
    Py_XDECREF(frame);
}
#else
static PyCodeObject* __Pyx_CreateCodeObjectForTraceback(
            const char *funcname, int c_line,
            int py_line, const char *filename) {
    PyCodeObject *py_code = NULL;
    PyObject *py_funcname = NULL;
    if (c_line) {
        py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
        if (!py_funcname) goto bad;
        funcname = PyUnicode_AsUTF8(py_funcname);
        if (!funcname) goto bad;
    }
    py_code = PyCode_NewEmpty(filename, funcname, py_line);
    Py_XDECREF(py_funcname);
    return py_code;
bad:
    Py_XDECREF(py_funcname);
    return NULL;
}
static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename) {
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    PyThreadState *tstate = __Pyx_PyThreadState_Current;
    PyObject *ptype, *pvalue, *ptraceback;
    if (c_line) {
        c_line = __Pyx_CLineForTraceback(tstate, c_line);
    }
    py_code = __pyx_find_code_object(c_line ? -c_line : py_line);
    if (!py_code) {
        __Pyx_ErrFetchInState(tstate, &ptype, &pvalue, &ptraceback);
        py_code = __Pyx_CreateCodeObjectForTraceback(
            funcname, c_line, py_line, filename);
        if (!py_code) {
            /* If the code object creation fails, then we should clear the
               fetched exception references and propagate the new exception */
            Py_XDECREF(ptype);
            Py_XDECREF(pvalue);
            Py_XDECREF(ptraceback);
            goto bad;
        }
        __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
        __pyx_insert_code_object(c_line ? -c_line : py_line, py_code);
    }
    py_frame = PyFrame_New(
        tstate,            /*PyThreadState *tstate,*/
        py_code,           /*PyCodeObject *code,*/
        __pyx_mstate_global->__pyx_d,    /*PyObject *globals,*/
        0                  /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    __Pyx_PyFrame_SetLineNumber(py_frame, py_line);
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}
#endif

/* CIntFromPyVerify */
  #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
    {\
        func_type value = func_value;\
        if (sizeof(target_type) < sizeof(func_type)) {\
            if (unlikely(value != (func_type) (target_type) value)) {\
                func_type zero = 0;\
                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
                    return (target_type) -1;\
                if (is_unsigned && unlikely(value < zero))\
                    goto raise_neg_overflow;\
                else\
                    goto raise_overflow;\
            }\
        }\
        return (target_type) value;\
    }

/* Declarations */
  #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
  #ifdef __cplusplus
    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
      return ::std::complex< float >(x, y);
    }
  #else
    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
      return x + y*(__pyx_t_float_complex)_Complex_I;
    }
  #endif
#else
    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
      __pyx_t_float_complex z;
      z.real = x;
      z.imag = y;
      return z;
    }
#endif

/* Arithmetic */
  #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
#else
    static CYTHON_INLINE int __Pyx_c_eq_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
       return (a.real == b.real) && (a.imag == b.imag);
    }
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_sum_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
        __pyx_t_float_complex z;
        z.real = a.real + b.real;
        z.imag = a.imag + b.imag;
        return z;
    }
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_diff_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
        __pyx_t_float_complex z;
        z.real = a.real - b.real;
        z.imag = a.imag - b.imag;
        return z;
    }
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_prod_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
        __pyx_t_float_complex z;
        z.real = a.real * b.real - a.imag * b.imag;
        z.imag = a.real * b.imag + a.imag * b.real;
        return z;
    }
    #if 1
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quot_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
        if (b.imag == 0) {
            return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.real);
        } else if (fabsf(b.real) >= fabsf(b.imag)) {
            if (b.real == 0 && b.imag == 0) {
                return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.imag);
            } else {
                float r = b.imag / b.real;
                float s = (float)(1.0) / (b.real + b.imag * r);
                return __pyx_t_float_complex_from_parts(
                    (a.real + a.imag * r) * s, (a.imag - a.real * r) * s);
            }
        } else {
            float r = b.real / b.imag;
            float s = (float)(1.0) / (b.imag + b.real * r);
            return __pyx_t_float_complex_from_parts(
                (a.real * r + a.imag) * s, (a.imag * r - a.real) * s);
        }
    }
    #else
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quot_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
        if (b.imag == 0) {
            return __pyx_t_float_complex_from_parts(a.real / b.real, a.imag / b.real);
        } else {
            float denom = b.real * b.real + b.imag * b.imag;
            return __pyx_t_float_complex_from_parts(
                (a.real * b.real + a.imag * b.imag) / denom,
                (a.imag * b.real - a.real * b.imag) / denom);
        }
    }
    #endif
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_neg_float(__pyx_t_float_complex a) {
        __pyx_t_float_complex z;
        z.real = -a.real;
        z.imag = -a.imag;
        return z;
    }
    static CYTHON_INLINE int __Pyx_c_is_zero_float(__pyx_t_float_complex a) {
       return (a.real == 0) && (a.imag == 0);
    }
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_conj_float(__pyx_t_float_complex a) {
        __pyx_t_float_complex z;
        z.real =  a.real;
        z.imag = -a.imag;
        return z;
    }
    #if 1
        static CYTHON_INLINE float __Pyx_c_abs_float(__pyx_t_float_complex z) {
          #if !defined(HAVE_HYPOT) || defined(_MSC_VER)
            return sqrtf(z.real*z.real + z.imag*z.imag);
          #else
            return hypotf(z.real, z.imag);
          #endif
        }
        static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_pow_float(__pyx_t_float_complex a, __pyx_t_float_complex b) {
            __pyx_t_float_complex z;
            float r, lnr, theta, z_r, z_theta;
            if (b.imag == 0 && b.real == (int)b.real) {
                if (b.real < 0) {
                    float denom = a.real * a.real + a.imag * a.imag;
                    a.real = a.real / denom;
                    a.imag = -a.imag / denom;
                    b.real = -b.real;
                }
                switch ((int)b.real) {
                    case 0:
                        z.real = 1;
                        z.imag = 0;
                        return z;
                    case 1:
                        return a;
                    case 2:
                        return __Pyx_c_prod_float(a, a);
                    case 3:
                        z = __Pyx_c_prod_float(a, a);
                        return __Pyx_c_prod_float(z, a);
                    case 4:
                        z = __Pyx_c_prod_float(a, a);
                        return __Pyx_c_prod_float(z, z);
                }
            }
            if (a.imag == 0) {
                if (a.real == 0) {
                    return a;
                } else if ((b.imag == 0) && (a.real >= 0)) {
                    z.real = powf(a.real, b.real);
                    z.imag = 0;
                    return z;
                } else if (a.real > 0) {
                    r = a.real;
                    theta = 0;
                } else {
                    r = -a.real;
                    theta = atan2f(0.0, -1.0);
                }
            } else {
                r = __Pyx_c_abs_float(a);
                theta = atan2f(a.imag, a.real);
            }
            lnr = logf(r);
            z_r = expf(lnr * b.real - theta * b.imag);
            z_theta = theta * b.real + lnr * b.imag;
            z.real = z_r * cosf(z_theta);
            z.imag = z_r * sinf(z_theta);
            return z;
        }
    #endif
#endif

/* Declarations */
  #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
  #ifdef __cplusplus
    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
      return ::std::complex< double >(x, y);
    }
  #else
    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
      return x + y*(__pyx_t_double_complex)_Complex_I;
    }
  #endif
#else
    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
      __pyx_t_double_complex z;
      z.real = x;
      z.imag = y;
      return z;
    }
#endif

/* Arithmetic */
  #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
#else
    static CYTHON_INLINE int __Pyx_c_eq_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
       return (a.real == b.real) && (a.imag == b.imag);
    }
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        __pyx_t_double_complex z;
        z.real = a.real + b.real;
        z.imag = a.imag + b.imag;
        return z;
    }
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        __pyx_t_double_complex z;
        z.real = a.real - b.real;
        z.imag = a.imag - b.imag;
        return z;
    }
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        __pyx_t_double_complex z;
        z.real = a.real * b.real - a.imag * b.imag;
        z.imag = a.real * b.imag + a.imag * b.real;
        return z;
    }
    #if 1
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        if (b.imag == 0) {
            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
        } else if (fabs(b.real) >= fabs(b.imag)) {
            if (b.real == 0 && b.imag == 0) {
                return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.imag);
            } else {
                double r = b.imag / b.real;
                double s = (double)(1.0) / (b.real + b.imag * r);
                return __pyx_t_double_complex_from_parts(
                    (a.real + a.imag * r) * s, (a.imag - a.real * r) * s);
            }
        } else {
            double r = b.real / b.imag;
            double s = (double)(1.0) / (b.imag + b.real * r);
            return __pyx_t_double_complex_from_parts(
                (a.real * r + a.imag) * s, (a.imag * r - a.real) * s);
        }
    }
    #else
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        if (b.imag == 0) {
            return __pyx_t_double_complex_from_parts(a.real / b.real, a.imag / b.real);
        } else {
            double denom = b.real * b.real + b.imag * b.imag;
            return __pyx_t_double_complex_from_parts(
                (a.real * b.real + a.imag * b.imag) / denom,
                (a.imag * b.real - a.real * b.imag) / denom);
        }
    }
    #endif
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg_double(__pyx_t_double_complex a) {
        __pyx_t_double_complex z;
        z.real = -a.real;
        z.imag = -a.imag;
        return z;
    }
    static CYTHON_INLINE int __Pyx_c_is_zero_double(__pyx_t_double_complex a) {
       return (a.real == 0) && (a.imag == 0);
    }
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj_double(__pyx_t_double_complex a) {
        __pyx_t_double_complex z;
        z.real =  a.real;
        z.imag = -a.imag;
        return z;
    }
    #if 1
        static CYTHON_INLINE double __Pyx_c_abs_double(__pyx_t_double_complex z) {
          #if !defined(HAVE_HYPOT) || defined(_MSC_VER)
            return sqrt(z.real*z.real + z.imag*z.imag);
          #else
            return hypot(z.real, z.imag);
          #endif
        }
        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow_double(__pyx_t_double_complex a, __pyx_t_double_complex b) {
            __pyx_t_double_complex z;
            double r, lnr, theta, z_r, z_theta;
            if (b.imag == 0 && b.real == (int)b.real) {
                if (b.real < 0) {
                    double denom = a.real * a.real + a.imag * a.imag;
                    a.real = a.real / denom;
                    a.imag = -a.imag / denom;
                    b.real = -b.real;
                }
                switch ((int)b.real) {
                    case 0:
                        z.real = 1;
                        z.imag = 0;
                        return z;
                    case 1:
                        return a;
                    case 2:
                        return __Pyx_c_prod_double(a, a);
                    case 3:
                        z = __Pyx_c_prod_double(a, a);
                        return __Pyx_c_prod_double(z, a);
                    case 4:
                        z = __Pyx_c_prod_double(a, a);
                        return __Pyx_c_prod_double(z, z);
                }
            }
            if (a.imag == 0) {
                if (a.real == 0) {
                    return a;
                } else if ((b.imag == 0) && (a.real >= 0)) {
                    z.real = pow(a.real, b.real);
                    z.imag = 0;
                    return z;
                } else if (a.real > 0) {
                    r = a.real;
                    theta = 0;
                } else {
                    r = -a.real;
                    theta = atan2(0.0, -1.0);
                }
            } else {
                r = __Pyx_c_abs_double(a);
                theta = atan2(a.imag, a.real);
            }
            lnr = log(r);
            z_r = exp(lnr * b.real - theta * b.imag);
            z_theta = theta * b.real + lnr * b.imag;
            z.real = z_r * cos(z_theta);
            z.imag = z_r * sin(z_theta);
            return z;
        }
    #endif
#endif

/* Declarations */
  #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
  #ifdef __cplusplus
    static CYTHON_INLINE __pyx_t_long_double_complex __pyx_t_long_double_complex_from_parts(long double x, long double y) {
      return ::std::complex< long double >(x, y);
    }
  #else
    static CYTHON_INLINE __pyx_t_long_double_complex __pyx_t_long_double_complex_from_parts(long double x, long double y) {
      return x + y*(__pyx_t_long_double_complex)_Complex_I;
    }
  #endif
#else
    static CYTHON_INLINE __pyx_t_long_double_complex __pyx_t_long_double_complex_from_parts(long double x, long double y) {
      __pyx_t_long_double_complex z;
      z.real = x;
      z.imag = y;
      return z;
    }
#endif

/* Arithmetic */
  #if CYTHON_CCOMPLEX && (1) && (!0 || __cplusplus)
#else
    static CYTHON_INLINE int __Pyx_c_eq_long__double(__pyx_t_long_double_complex a, __pyx_t_long_double_complex b) {
       return (a.real == b.real) && (a.imag == b.imag);
    }
    static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_sum_long__double(__pyx_t_long_double_complex a, __pyx_t_long_double_complex b) {
        __pyx_t_long_double_complex z;
        z.real = a.real + b.real;
        z.imag = a.imag + b.imag;
        return z;
    }
    static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_diff_long__double(__pyx_t_long_double_complex a, __pyx_t_long_double_complex b) {
        __pyx_t_long_double_complex z;
        z.real = a.real - b.real;
        z.imag = a.imag - b.imag;
        return z;
    }
    static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_prod_long__double(__pyx_t_long_double_complex a, __pyx_t_long_double_complex b) {
        __pyx_t_long_double_complex z;
        z.real = a.real * b.real - a.imag * b.imag;
        z.imag = a.real * b.imag + a.imag * b.real;
        return z;
    }
    #if 1
    static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_quot_long__double(__pyx_t_long_double_complex a, __pyx_t_long_double_complex b) {
        if (b.imag == 0) {
            return __pyx_t_long_double_complex_from_parts(a.real / b.real, a.imag / b.real);
        } else if (fabsl(b.real) >= fabsl(b.imag)) {
            if (b.real == 0 && b.imag == 0) {
                return __pyx_t_long_double_complex_from_parts(a.real / b.real, a.imag / b.imag);
            } else {
                long double r = b.imag / b.real;
                long double s = (long double)(1.0) / (b.real + b.imag * r);
                return __pyx_t_long_double_complex_from_parts(
                    (a.real + a.imag * r) * s, (a.imag - a.real * r) * s);
            }
        } else {
            long double r = b.real / b.imag;
            long double s = (long double)(1.0) / (b.imag + b.real * r);
            return __pyx_t_long_double_complex_from_parts(
                (a.real * r + a.imag) * s, (a.imag * r - a.real) * s);
        }
    }
    #else
    static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_quot_long__double(__pyx_t_long_double_complex a, __pyx_t_long_double_complex b) {
        if (b.imag == 0) {
            return __pyx_t_long_double_complex_from_parts(a.real / b.real, a.imag / b.real);
        } else {
            long double denom = b.real * b.real + b.imag * b.imag;
            return __pyx_t_long_double_complex_from_parts(
                (a.real * b.real + a.imag * b.imag) / denom,
                (a.imag * b.real - a.real * b.imag) / denom);
        }
    }
    #endif
    static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_neg_long__double(__pyx_t_long_double_complex a) {
        __pyx_t_long_double_complex z;
        z.real = -a.real;
        z.imag = -a.imag;
        return z;
    }
    static CYTHON_INLINE int __Pyx_c_is_zero_long__double(__pyx_t_long_double_complex a) {
       return (a.real == 0) && (a.imag == 0);
    }
    static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_conj_long__double(__pyx_t_long_double_complex a) {
        __pyx_t_long_double_complex z;
        z.real =  a.real;
        z.imag = -a.imag;
        return z;
    }
    #if 1
        static CYTHON_INLINE long double __Pyx_c_abs_long__double(__pyx_t_long_double_complex z) {
          #if !defined(HAVE_HYPOT) || defined(_MSC_VER)
            return sqrtl(z.real*z.real + z.imag*z.imag);
          #else
            return hypotl(z.real, z.imag);
          #endif
        }
        static CYTHON_INLINE __pyx_t_long_double_complex __Pyx_c_pow_long__double(__pyx_t_long_double_complex a, __pyx_t_long_double_complex b) {
            __pyx_t_long_double_complex z;
            long double r, lnr, theta, z_r, z_theta;
            if (b.imag == 0 && b.real == (int)b.real) {
                if (b.real < 0) {
                    long double denom = a.real * a.real + a.imag * a.imag;
                    a.real = a.real / denom;
                    a.imag = -a.imag / denom;
                    b.real = -b.real;
                }
                switch ((int)b.real) {
                    case 0:
                        z.real = 1;
                        z.imag = 0;
                        return z;
                    case 1:
                        return a;
                    case 2:
                        return __Pyx_c_prod_long__double(a, a);
                    case 3:
                        z = __Pyx_c_prod_long__double(a, a);
                        return __Pyx_c_prod_long__double(z, a);
                    case 4:
                        z = __Pyx_c_prod_long__double(a, a);
                        return __Pyx_c_prod_long__double(z, z);
                }
            }
            if (a.imag == 0) {
                if (a.real == 0) {
                    return a;
                } else if ((b.imag == 0) && (a.real >= 0)) {
                    z.real = powl(a.real, b.real);
                    z.imag = 0;
                    return z;
                } else if (a.real > 0) {
                    r = a.real;
                    theta = 0;
                } else {
                    r = -a.real;
                    theta = atan2l(0.0, -1.0);
                }
            } else {
                r = __Pyx_c_abs_long__double(a);
                theta = atan2l(a.imag, a.real);
            }
            lnr = logl(r);
            z_r = expl(lnr * b.real - theta * b.imag);
            z_theta = theta * b.real + lnr * b.imag;
            z.real = z_r * cosl(z_theta);
            z.imag = z_r * sinl(z_theta);
            return z;
        }
    #endif
#endif

/* CIntToPy */
  static CYTHON_INLINE PyObject* __Pyx_PyLong_From_PetscInt(PetscInt value) {
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wconversion"
#endif
    const PetscInt neg_one = (PetscInt) -1, const_zero = (PetscInt) 0;
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic pop
#endif
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(PetscInt) < sizeof(long)) {
            return PyLong_FromLong((long) value);
        } else if (sizeof(PetscInt) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
#if defined(HAVE_LONG_LONG) && !CYTHON_COMPILING_IN_PYPY
        } else if (sizeof(PetscInt) <= sizeof(unsigned PY_LONG_LONG)) {
            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
#endif
        }
    } else {
        if (sizeof(PetscInt) <= sizeof(long)) {
            return PyLong_FromLong((long) value);
#ifdef HAVE_LONG_LONG
        } else if (sizeof(PetscInt) <= sizeof(PY_LONG_LONG)) {
            return PyLong_FromLongLong((PY_LONG_LONG) value);
#endif
        }
    }
    {
        unsigned char *bytes = (unsigned char *)&value;
#if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX >= 0x030d00A4
        if (is_unsigned) {
            return PyLong_FromUnsignedNativeBytes(bytes, sizeof(value), -1);
        } else {
            return PyLong_FromNativeBytes(bytes, sizeof(value), -1);
        }
#elif !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
        int one = 1; int little = (int)*(unsigned char *)&one;
        return _PyLong_FromByteArray(bytes, sizeof(PetscInt),
                                     little, !is_unsigned);
#else
        int one = 1; int little = (int)*(unsigned char *)&one;
        PyObject *from_bytes, *result = NULL, *kwds = NULL;
        PyObject *py_bytes = NULL, *order_str = NULL;
        from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
        if (!from_bytes) return NULL;
        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(PetscInt));
        if (!py_bytes) goto limited_bad;
        order_str = PyUnicode_FromString(little ? "little" : "big");
        if (!order_str) goto limited_bad;
        {
            PyObject *args[3+(CYTHON_VECTORCALL ? 1 : 0)] = { NULL, py_bytes, order_str };
            if (!is_unsigned) {
                kwds = __Pyx_MakeVectorcallBuilderKwds(1);
                if (!kwds) goto limited_bad;
                if (__Pyx_VectorcallBuilder_AddArgStr("signed", __Pyx_NewRef(Py_True), kwds, args+3, 0) < 0) goto limited_bad;
            }
            result = __Pyx_Object_Vectorcall_CallFromBuilder(from_bytes, args+1, 2 | __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET, kwds);
        }
        limited_bad:
        Py_XDECREF(kwds);
        Py_XDECREF(order_str);
        Py_XDECREF(py_bytes);
        Py_XDECREF(from_bytes);
        return result;
#endif
    }
}

/* CIntFromPy */
  static CYTHON_INLINE PetscInt __Pyx_PyLong_As_PetscInt(PyObject *x) {
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wconversion"
#endif
    const PetscInt neg_one = (PetscInt) -1, const_zero = (PetscInt) 0;
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic pop
#endif
    const int is_unsigned = neg_one > const_zero;
    if (unlikely(!PyLong_Check(x))) {
        PetscInt val;
        PyObject *tmp = __Pyx_PyNumber_Long(x);
        if (!tmp) return (PetscInt) -1;
        val = __Pyx_PyLong_As_PetscInt(tmp);
        Py_DECREF(tmp);
        return val;
    }
    if (is_unsigned) {
#if CYTHON_USE_PYLONG_INTERNALS
        if (unlikely(__Pyx_PyLong_IsNeg(x))) {
            goto raise_neg_overflow;
        } else if (__Pyx_PyLong_IsCompact(x)) {
            __PYX_VERIFY_RETURN_INT(PetscInt, __Pyx_compact_upylong, __Pyx_PyLong_CompactValueUnsigned(x))
        } else {
            const digit* digits = __Pyx_PyLong_Digits(x);
            assert(__Pyx_PyLong_DigitCount(x) > 1);
            switch (__Pyx_PyLong_DigitCount(x)) {
                case 2:
                    if ((8 * sizeof(PetscInt) > 1 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(PetscInt, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(PetscInt) >= 2 * PyLong_SHIFT)) {
                            return (PetscInt) (((((PetscInt)digits[1]) << PyLong_SHIFT) | (PetscInt)digits[0]));
                        }
                    }
                    break;
                case 3:
                    if ((8 * sizeof(PetscInt) > 2 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(PetscInt, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(PetscInt) >= 3 * PyLong_SHIFT)) {
                            return (PetscInt) (((((((PetscInt)digits[2]) << PyLong_SHIFT) | (PetscInt)digits[1]) << PyLong_SHIFT) | (PetscInt)digits[0]));
                        }
                    }
                    break;
                case 4:
                    if ((8 * sizeof(PetscInt) > 3 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(PetscInt, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(PetscInt) >= 4 * PyLong_SHIFT)) {
                            return (PetscInt) (((((((((PetscInt)digits[3]) << PyLong_SHIFT) | (PetscInt)digits[2]) << PyLong_SHIFT) | (PetscInt)digits[1]) << PyLong_SHIFT) | (PetscInt)digits[0]));
                        }
                    }
                    break;
            }
        }
#endif
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030C00A7
        if (unlikely(Py_SIZE(x) < 0)) {
            goto raise_neg_overflow;
        }
#else
        {
            int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
            if (unlikely(result < 0))
                return (PetscInt) -1;
            if (unlikely(result == 1))
                goto raise_neg_overflow;
        }
#endif
        if ((sizeof(PetscInt) <= sizeof(unsigned long))) {
            __PYX_VERIFY_RETURN_INT_EXC(PetscInt, unsigned long, PyLong_AsUnsignedLong(x))
#ifdef HAVE_LONG_LONG
        } else if ((sizeof(PetscInt) <= sizeof(unsigned PY_LONG_LONG))) {
            __PYX_VERIFY_RETURN_INT_EXC(PetscInt, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
#endif
        }
    } else {
#if CYTHON_USE_PYLONG_INTERNALS
        if (__Pyx_PyLong_IsCompact(x)) {
            __PYX_VERIFY_RETURN_INT(PetscInt, __Pyx_compact_pylong, __Pyx_PyLong_CompactValue(x))
        } else {
            const digit* digits = __Pyx_PyLong_Digits(x);
            assert(__Pyx_PyLong_DigitCount(x) > 1);
            switch (__Pyx_PyLong_SignedDigitCount(x)) {
                case -2:
                    if ((8 * sizeof(PetscInt) - 1 > 1 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(PetscInt, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(PetscInt) - 1 > 2 * PyLong_SHIFT)) {
                            return (PetscInt) (((PetscInt)-1)*(((((PetscInt)digits[1]) << PyLong_SHIFT) | (PetscInt)digits[0])));
                        }
                    }
                    break;
                case 2:
                    if ((8 * sizeof(PetscInt) > 1 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(PetscInt, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(PetscInt) - 1 > 2 * PyLong_SHIFT)) {
                            return (PetscInt) ((((((PetscInt)digits[1]) << PyLong_SHIFT) | (PetscInt)digits[0])));
                        }
                    }
                    break;
                case -3:
                    if ((8 * sizeof(PetscInt) - 1 > 2 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(PetscInt, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(PetscInt) - 1 > 3 * PyLong_SHIFT)) {
                            return (PetscInt) (((PetscInt)-1)*(((((((PetscInt)digits[2]) << PyLong_SHIFT) | (PetscInt)digits[1]) << PyLong_SHIFT) | (PetscInt)digits[0])));
                        }
                    }
                    break;
                case 3:
                    if ((8 * sizeof(PetscInt) > 2 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(PetscInt, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(PetscInt) - 1 > 3 * PyLong_SHIFT)) {
                            return (PetscInt) ((((((((PetscInt)digits[2]) << PyLong_SHIFT) | (PetscInt)digits[1]) << PyLong_SHIFT) | (PetscInt)digits[0])));
                        }
                    }
                    break;
                case -4:
                    if ((8 * sizeof(PetscInt) - 1 > 3 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(PetscInt, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(PetscInt) - 1 > 4 * PyLong_SHIFT)) {
                            return (PetscInt) (((PetscInt)-1)*(((((((((PetscInt)digits[3]) << PyLong_SHIFT) | (PetscInt)digits[2]) << PyLong_SHIFT) | (PetscInt)digits[1]) << PyLong_SHIFT) | (PetscInt)digits[0])));
                        }
                    }
                    break;
                case 4:
                    if ((8 * sizeof(PetscInt) > 3 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(PetscInt, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(PetscInt) - 1 > 4 * PyLong_SHIFT)) {
                            return (PetscInt) ((((((((((PetscInt)digits[3]) << PyLong_SHIFT) | (PetscInt)digits[2]) << PyLong_SHIFT) | (PetscInt)digits[1]) << PyLong_SHIFT) | (PetscInt)digits[0])));
                        }
                    }
                    break;
            }
        }
#endif
        if ((sizeof(PetscInt) <= sizeof(long))) {
            __PYX_VERIFY_RETURN_INT_EXC(PetscInt, long, PyLong_AsLong(x))
#ifdef HAVE_LONG_LONG
        } else if ((sizeof(PetscInt) <= sizeof(PY_LONG_LONG))) {
            __PYX_VERIFY_RETURN_INT_EXC(PetscInt, PY_LONG_LONG, PyLong_AsLongLong(x))
#endif
        }
    }
    {
        PetscInt val;
        int ret = -1;
#if PY_VERSION_HEX >= 0x030d00A6 && !CYTHON_COMPILING_IN_LIMITED_API
        Py_ssize_t bytes_copied = PyLong_AsNativeBytes(
            x, &val, sizeof(val), Py_ASNATIVEBYTES_NATIVE_ENDIAN | (is_unsigned ? Py_ASNATIVEBYTES_UNSIGNED_BUFFER | Py_ASNATIVEBYTES_REJECT_NEGATIVE : 0));
        if (unlikely(bytes_copied == -1)) {
        } else if (unlikely(bytes_copied > (Py_ssize_t) sizeof(val))) {
            goto raise_overflow;
        } else {
            ret = 0;
        }
#elif PY_VERSION_HEX < 0x030d0000 && !(CYTHON_COMPILING_IN_PYPY || CYTHON_COMPILING_IN_LIMITED_API) || defined(_PyLong_AsByteArray)
        int one = 1; int is_little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&val;
        ret = _PyLong_AsByteArray((PyLongObject *)x,
                                    bytes, sizeof(val),
                                    is_little, !is_unsigned);
#else
        PyObject *v;
        PyObject *stepval = NULL, *mask = NULL, *shift = NULL;
        int bits, remaining_bits, is_negative = 0;
        int chunk_size = (sizeof(long) < 8) ? 30 : 62;
        if (likely(PyLong_CheckExact(x))) {
            v = __Pyx_NewRef(x);
        } else {
            v = PyNumber_Long(x);
            if (unlikely(!v)) return (PetscInt) -1;
            assert(PyLong_CheckExact(v));
        }
        {
            int result = PyObject_RichCompareBool(v, Py_False, Py_LT);
            if (unlikely(result < 0)) {
                Py_DECREF(v);
                return (PetscInt) -1;
            }
            is_negative = result == 1;
        }
        if (is_unsigned && unlikely(is_negative)) {
            Py_DECREF(v);
            goto raise_neg_overflow;
        } else if (is_negative) {
            stepval = PyNumber_Invert(v);
            Py_DECREF(v);
            if (unlikely(!stepval))
                return (PetscInt) -1;
        } else {
            stepval = v;
        }
        v = NULL;
        val = (PetscInt) 0;
        mask = PyLong_FromLong((1L << chunk_size) - 1); if (unlikely(!mask)) goto done;
        shift = PyLong_FromLong(chunk_size); if (unlikely(!shift)) goto done;
        for (bits = 0; bits < (int) sizeof(PetscInt) * 8 - chunk_size; bits += chunk_size) {
            PyObject *tmp, *digit;
            long idigit;
            digit = PyNumber_And(stepval, mask);
            if (unlikely(!digit)) goto done;
            idigit = PyLong_AsLong(digit);
            Py_DECREF(digit);
            if (unlikely(idigit < 0)) goto done;
            val |= ((PetscInt) idigit) << bits;
            tmp = PyNumber_Rshift(stepval, shift);
            if (unlikely(!tmp)) goto done;
            Py_DECREF(stepval); stepval = tmp;
        }
        Py_DECREF(shift); shift = NULL;
        Py_DECREF(mask); mask = NULL;
        {
            long idigit = PyLong_AsLong(stepval);
            if (unlikely(idigit < 0)) goto done;
            remaining_bits = ((int) sizeof(PetscInt) * 8) - bits - (is_unsigned ? 0 : 1);
            if (unlikely(idigit >= (1L << remaining_bits)))
                goto raise_overflow;
            val |= ((PetscInt) idigit) << bits;
        }
        if (!is_unsigned) {
            if (unlikely(val & (((PetscInt) 1) << (sizeof(PetscInt) * 8 - 1))))
                goto raise_overflow;
            if (is_negative)
                val = ~val;
        }
        ret = 0;
    done:
        Py_XDECREF(shift);
        Py_XDECREF(mask);
        Py_XDECREF(stepval);
#endif
        if (unlikely(ret))
            return (PetscInt) -1;
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to PetscInt");
    return (PetscInt) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to PetscInt");
    return (PetscInt) -1;
}

/* CIntToPy */
  static CYTHON_INLINE PyObject* __Pyx_PyLong_From_PetscErrorCode(PetscErrorCode value) {
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wconversion"
#endif
    const PetscErrorCode neg_one = (PetscErrorCode) -1, const_zero = (PetscErrorCode) 0;
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic pop
#endif
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(PetscErrorCode) < sizeof(long)) {
            return PyLong_FromLong((long) value);
        } else if (sizeof(PetscErrorCode) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
#if defined(HAVE_LONG_LONG) && !CYTHON_COMPILING_IN_PYPY
        } else if (sizeof(PetscErrorCode) <= sizeof(unsigned PY_LONG_LONG)) {
            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
#endif
        }
    } else {
        if (sizeof(PetscErrorCode) <= sizeof(long)) {
            return PyLong_FromLong((long) value);
#ifdef HAVE_LONG_LONG
        } else if (sizeof(PetscErrorCode) <= sizeof(PY_LONG_LONG)) {
            return PyLong_FromLongLong((PY_LONG_LONG) value);
#endif
        }
    }
    {
        unsigned char *bytes = (unsigned char *)&value;
#if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX >= 0x030d00A4
        if (is_unsigned) {
            return PyLong_FromUnsignedNativeBytes(bytes, sizeof(value), -1);
        } else {
            return PyLong_FromNativeBytes(bytes, sizeof(value), -1);
        }
#elif !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
        int one = 1; int little = (int)*(unsigned char *)&one;
        return _PyLong_FromByteArray(bytes, sizeof(PetscErrorCode),
                                     little, !is_unsigned);
#else
        int one = 1; int little = (int)*(unsigned char *)&one;
        PyObject *from_bytes, *result = NULL, *kwds = NULL;
        PyObject *py_bytes = NULL, *order_str = NULL;
        from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
        if (!from_bytes) return NULL;
        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(PetscErrorCode));
        if (!py_bytes) goto limited_bad;
        order_str = PyUnicode_FromString(little ? "little" : "big");
        if (!order_str) goto limited_bad;
        {
            PyObject *args[3+(CYTHON_VECTORCALL ? 1 : 0)] = { NULL, py_bytes, order_str };
            if (!is_unsigned) {
                kwds = __Pyx_MakeVectorcallBuilderKwds(1);
                if (!kwds) goto limited_bad;
                if (__Pyx_VectorcallBuilder_AddArgStr("signed", __Pyx_NewRef(Py_True), kwds, args+3, 0) < 0) goto limited_bad;
            }
            result = __Pyx_Object_Vectorcall_CallFromBuilder(from_bytes, args+1, 2 | __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET, kwds);
        }
        limited_bad:
        Py_XDECREF(kwds);
        Py_XDECREF(order_str);
        Py_XDECREF(py_bytes);
        Py_XDECREF(from_bytes);
        return result;
#endif
    }
}

/* CIntFromPy */
  static CYTHON_INLINE size_t __Pyx_PyLong_As_size_t(PyObject *x) {
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wconversion"
#endif
    const size_t neg_one = (size_t) -1, const_zero = (size_t) 0;
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic pop
#endif
    const int is_unsigned = neg_one > const_zero;
    if (unlikely(!PyLong_Check(x))) {
        size_t val;
        PyObject *tmp = __Pyx_PyNumber_Long(x);
        if (!tmp) return (size_t) -1;
        val = __Pyx_PyLong_As_size_t(tmp);
        Py_DECREF(tmp);
        return val;
    }
    if (is_unsigned) {
#if CYTHON_USE_PYLONG_INTERNALS
        if (unlikely(__Pyx_PyLong_IsNeg(x))) {
            goto raise_neg_overflow;
        } else if (__Pyx_PyLong_IsCompact(x)) {
            __PYX_VERIFY_RETURN_INT(size_t, __Pyx_compact_upylong, __Pyx_PyLong_CompactValueUnsigned(x))
        } else {
            const digit* digits = __Pyx_PyLong_Digits(x);
            assert(__Pyx_PyLong_DigitCount(x) > 1);
            switch (__Pyx_PyLong_DigitCount(x)) {
                case 2:
                    if ((8 * sizeof(size_t) > 1 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(size_t, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(size_t) >= 2 * PyLong_SHIFT)) {
                            return (size_t) (((((size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
                        }
                    }
                    break;
                case 3:
                    if ((8 * sizeof(size_t) > 2 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(size_t, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(size_t) >= 3 * PyLong_SHIFT)) {
                            return (size_t) (((((((size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
                        }
                    }
                    break;
                case 4:
                    if ((8 * sizeof(size_t) > 3 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(size_t, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(size_t) >= 4 * PyLong_SHIFT)) {
                            return (size_t) (((((((((size_t)digits[3]) << PyLong_SHIFT) | (size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
                        }
                    }
                    break;
            }
        }
#endif
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030C00A7
        if (unlikely(Py_SIZE(x) < 0)) {
            goto raise_neg_overflow;
        }
#else
        {
            int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
            if (unlikely(result < 0))
                return (size_t) -1;
            if (unlikely(result == 1))
                goto raise_neg_overflow;
        }
#endif
        if ((sizeof(size_t) <= sizeof(unsigned long))) {
            __PYX_VERIFY_RETURN_INT_EXC(size_t, unsigned long, PyLong_AsUnsignedLong(x))
#ifdef HAVE_LONG_LONG
        } else if ((sizeof(size_t) <= sizeof(unsigned PY_LONG_LONG))) {
            __PYX_VERIFY_RETURN_INT_EXC(size_t, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
#endif
        }
    } else {
#if CYTHON_USE_PYLONG_INTERNALS
        if (__Pyx_PyLong_IsCompact(x)) {
            __PYX_VERIFY_RETURN_INT(size_t, __Pyx_compact_pylong, __Pyx_PyLong_CompactValue(x))
        } else {
            const digit* digits = __Pyx_PyLong_Digits(x);
            assert(__Pyx_PyLong_DigitCount(x) > 1);
            switch (__Pyx_PyLong_SignedDigitCount(x)) {
                case -2:
                    if ((8 * sizeof(size_t) - 1 > 1 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(size_t, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(size_t) - 1 > 2 * PyLong_SHIFT)) {
                            return (size_t) (((size_t)-1)*(((((size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0])));
                        }
                    }
                    break;
                case 2:
                    if ((8 * sizeof(size_t) > 1 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(size_t, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(size_t) - 1 > 2 * PyLong_SHIFT)) {
                            return (size_t) ((((((size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0])));
                        }
                    }
                    break;
                case -3:
                    if ((8 * sizeof(size_t) - 1 > 2 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(size_t, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(size_t) - 1 > 3 * PyLong_SHIFT)) {
                            return (size_t) (((size_t)-1)*(((((((size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0])));
                        }
                    }
                    break;
                case 3:
                    if ((8 * sizeof(size_t) > 2 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(size_t, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(size_t) - 1 > 3 * PyLong_SHIFT)) {
                            return (size_t) ((((((((size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0])));
                        }
                    }
                    break;
                case -4:
                    if ((8 * sizeof(size_t) - 1 > 3 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(size_t, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(size_t) - 1 > 4 * PyLong_SHIFT)) {
                            return (size_t) (((size_t)-1)*(((((((((size_t)digits[3]) << PyLong_SHIFT) | (size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0])));
                        }
                    }
                    break;
                case 4:
                    if ((8 * sizeof(size_t) > 3 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(size_t, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(size_t) - 1 > 4 * PyLong_SHIFT)) {
                            return (size_t) ((((((((((size_t)digits[3]) << PyLong_SHIFT) | (size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0])));
                        }
                    }
                    break;
            }
        }
#endif
        if ((sizeof(size_t) <= sizeof(long))) {
            __PYX_VERIFY_RETURN_INT_EXC(size_t, long, PyLong_AsLong(x))
#ifdef HAVE_LONG_LONG
        } else if ((sizeof(size_t) <= sizeof(PY_LONG_LONG))) {
            __PYX_VERIFY_RETURN_INT_EXC(size_t, PY_LONG_LONG, PyLong_AsLongLong(x))
#endif
        }
    }
    {
        size_t val;
        int ret = -1;
#if PY_VERSION_HEX >= 0x030d00A6 && !CYTHON_COMPILING_IN_LIMITED_API
        Py_ssize_t bytes_copied = PyLong_AsNativeBytes(
            x, &val, sizeof(val), Py_ASNATIVEBYTES_NATIVE_ENDIAN | (is_unsigned ? Py_ASNATIVEBYTES_UNSIGNED_BUFFER | Py_ASNATIVEBYTES_REJECT_NEGATIVE : 0));
        if (unlikely(bytes_copied == -1)) {
        } else if (unlikely(bytes_copied > (Py_ssize_t) sizeof(val))) {
            goto raise_overflow;
        } else {
            ret = 0;
        }
#elif PY_VERSION_HEX < 0x030d0000 && !(CYTHON_COMPILING_IN_PYPY || CYTHON_COMPILING_IN_LIMITED_API) || defined(_PyLong_AsByteArray)
        int one = 1; int is_little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&val;
        ret = _PyLong_AsByteArray((PyLongObject *)x,
                                    bytes, sizeof(val),
                                    is_little, !is_unsigned);
#else
        PyObject *v;
        PyObject *stepval = NULL, *mask = NULL, *shift = NULL;
        int bits, remaining_bits, is_negative = 0;
        int chunk_size = (sizeof(long) < 8) ? 30 : 62;
        if (likely(PyLong_CheckExact(x))) {
            v = __Pyx_NewRef(x);
        } else {
            v = PyNumber_Long(x);
            if (unlikely(!v)) return (size_t) -1;
            assert(PyLong_CheckExact(v));
        }
        {
            int result = PyObject_RichCompareBool(v, Py_False, Py_LT);
            if (unlikely(result < 0)) {
                Py_DECREF(v);
                return (size_t) -1;
            }
            is_negative = result == 1;
        }
        if (is_unsigned && unlikely(is_negative)) {
            Py_DECREF(v);
            goto raise_neg_overflow;
        } else if (is_negative) {
            stepval = PyNumber_Invert(v);
            Py_DECREF(v);
            if (unlikely(!stepval))
                return (size_t) -1;
        } else {
            stepval = v;
        }
        v = NULL;
        val = (size_t) 0;
        mask = PyLong_FromLong((1L << chunk_size) - 1); if (unlikely(!mask)) goto done;
        shift = PyLong_FromLong(chunk_size); if (unlikely(!shift)) goto done;
        for (bits = 0; bits < (int) sizeof(size_t) * 8 - chunk_size; bits += chunk_size) {
            PyObject *tmp, *digit;
            long idigit;
            digit = PyNumber_And(stepval, mask);
            if (unlikely(!digit)) goto done;
            idigit = PyLong_AsLong(digit);
            Py_DECREF(digit);
            if (unlikely(idigit < 0)) goto done;
            val |= ((size_t) idigit) << bits;
            tmp = PyNumber_Rshift(stepval, shift);
            if (unlikely(!tmp)) goto done;
            Py_DECREF(stepval); stepval = tmp;
        }
        Py_DECREF(shift); shift = NULL;
        Py_DECREF(mask); mask = NULL;
        {
            long idigit = PyLong_AsLong(stepval);
            if (unlikely(idigit < 0)) goto done;
            remaining_bits = ((int) sizeof(size_t) * 8) - bits - (is_unsigned ? 0 : 1);
            if (unlikely(idigit >= (1L << remaining_bits)))
                goto raise_overflow;
            val |= ((size_t) idigit) << bits;
        }
        if (!is_unsigned) {
            if (unlikely(val & (((size_t) 1) << (sizeof(size_t) * 8 - 1))))
                goto raise_overflow;
            if (is_negative)
                val = ~val;
        }
        ret = 0;
    done:
        Py_XDECREF(shift);
        Py_XDECREF(mask);
        Py_XDECREF(stepval);
#endif
        if (unlikely(ret))
            return (size_t) -1;
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to size_t");
    return (size_t) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to size_t");
    return (size_t) -1;
}

/* CIntFromPy */
  static CYTHON_INLINE int __Pyx_PyLong_As_int(PyObject *x) {
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wconversion"
#endif
    const int neg_one = (int) -1, const_zero = (int) 0;
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic pop
#endif
    const int is_unsigned = neg_one > const_zero;
    if (unlikely(!PyLong_Check(x))) {
        int val;
        PyObject *tmp = __Pyx_PyNumber_Long(x);
        if (!tmp) return (int) -1;
        val = __Pyx_PyLong_As_int(tmp);
        Py_DECREF(tmp);
        return val;
    }
    if (is_unsigned) {
#if CYTHON_USE_PYLONG_INTERNALS
        if (unlikely(__Pyx_PyLong_IsNeg(x))) {
            goto raise_neg_overflow;
        } else if (__Pyx_PyLong_IsCompact(x)) {
            __PYX_VERIFY_RETURN_INT(int, __Pyx_compact_upylong, __Pyx_PyLong_CompactValueUnsigned(x))
        } else {
            const digit* digits = __Pyx_PyLong_Digits(x);
            assert(__Pyx_PyLong_DigitCount(x) > 1);
            switch (__Pyx_PyLong_DigitCount(x)) {
                case 2:
                    if ((8 * sizeof(int) > 1 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(int) >= 2 * PyLong_SHIFT)) {
                            return (int) (((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                        }
                    }
                    break;
                case 3:
                    if ((8 * sizeof(int) > 2 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(int) >= 3 * PyLong_SHIFT)) {
                            return (int) (((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                        }
                    }
                    break;
                case 4:
                    if ((8 * sizeof(int) > 3 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(int) >= 4 * PyLong_SHIFT)) {
                            return (int) (((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                        }
                    }
                    break;
            }
        }
#endif
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030C00A7
        if (unlikely(Py_SIZE(x) < 0)) {
            goto raise_neg_overflow;
        }
#else
        {
            int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
            if (unlikely(result < 0))
                return (int) -1;
            if (unlikely(result == 1))
                goto raise_neg_overflow;
        }
#endif
        if ((sizeof(int) <= sizeof(unsigned long))) {
            __PYX_VERIFY_RETURN_INT_EXC(int, unsigned long, PyLong_AsUnsignedLong(x))
#ifdef HAVE_LONG_LONG
        } else if ((sizeof(int) <= sizeof(unsigned PY_LONG_LONG))) {
            __PYX_VERIFY_RETURN_INT_EXC(int, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
#endif
        }
    } else {
#if CYTHON_USE_PYLONG_INTERNALS
        if (__Pyx_PyLong_IsCompact(x)) {
            __PYX_VERIFY_RETURN_INT(int, __Pyx_compact_pylong, __Pyx_PyLong_CompactValue(x))
        } else {
            const digit* digits = __Pyx_PyLong_Digits(x);
            assert(__Pyx_PyLong_DigitCount(x) > 1);
            switch (__Pyx_PyLong_SignedDigitCount(x)) {
                case -2:
                    if ((8 * sizeof(int) - 1 > 1 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
                            return (int) (((int)-1)*(((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case 2:
                    if ((8 * sizeof(int) > 1 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
                            return (int) ((((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case -3:
                    if ((8 * sizeof(int) - 1 > 2 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
                            return (int) (((int)-1)*(((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case 3:
                    if ((8 * sizeof(int) > 2 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
                            return (int) ((((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case -4:
                    if ((8 * sizeof(int) - 1 > 3 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(int) - 1 > 4 * PyLong_SHIFT)) {
                            return (int) (((int)-1)*(((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case 4:
                    if ((8 * sizeof(int) > 3 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(int) - 1 > 4 * PyLong_SHIFT)) {
                            return (int) ((((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
            }
        }
#endif
        if ((sizeof(int) <= sizeof(long))) {
            __PYX_VERIFY_RETURN_INT_EXC(int, long, PyLong_AsLong(x))
#ifdef HAVE_LONG_LONG
        } else if ((sizeof(int) <= sizeof(PY_LONG_LONG))) {
            __PYX_VERIFY_RETURN_INT_EXC(int, PY_LONG_LONG, PyLong_AsLongLong(x))
#endif
        }
    }
    {
        int val;
        int ret = -1;
#if PY_VERSION_HEX >= 0x030d00A6 && !CYTHON_COMPILING_IN_LIMITED_API
        Py_ssize_t bytes_copied = PyLong_AsNativeBytes(
            x, &val, sizeof(val), Py_ASNATIVEBYTES_NATIVE_ENDIAN | (is_unsigned ? Py_ASNATIVEBYTES_UNSIGNED_BUFFER | Py_ASNATIVEBYTES_REJECT_NEGATIVE : 0));
        if (unlikely(bytes_copied == -1)) {
        } else if (unlikely(bytes_copied > (Py_ssize_t) sizeof(val))) {
            goto raise_overflow;
        } else {
            ret = 0;
        }
#elif PY_VERSION_HEX < 0x030d0000 && !(CYTHON_COMPILING_IN_PYPY || CYTHON_COMPILING_IN_LIMITED_API) || defined(_PyLong_AsByteArray)
        int one = 1; int is_little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&val;
        ret = _PyLong_AsByteArray((PyLongObject *)x,
                                    bytes, sizeof(val),
                                    is_little, !is_unsigned);
#else
        PyObject *v;
        PyObject *stepval = NULL, *mask = NULL, *shift = NULL;
        int bits, remaining_bits, is_negative = 0;
        int chunk_size = (sizeof(long) < 8) ? 30 : 62;
        if (likely(PyLong_CheckExact(x))) {
            v = __Pyx_NewRef(x);
        } else {
            v = PyNumber_Long(x);
            if (unlikely(!v)) return (int) -1;
            assert(PyLong_CheckExact(v));
        }
        {
            int result = PyObject_RichCompareBool(v, Py_False, Py_LT);
            if (unlikely(result < 0)) {
                Py_DECREF(v);
                return (int) -1;
            }
            is_negative = result == 1;
        }
        if (is_unsigned && unlikely(is_negative)) {
            Py_DECREF(v);
            goto raise_neg_overflow;
        } else if (is_negative) {
            stepval = PyNumber_Invert(v);
            Py_DECREF(v);
            if (unlikely(!stepval))
                return (int) -1;
        } else {
            stepval = v;
        }
        v = NULL;
        val = (int) 0;
        mask = PyLong_FromLong((1L << chunk_size) - 1); if (unlikely(!mask)) goto done;
        shift = PyLong_FromLong(chunk_size); if (unlikely(!shift)) goto done;
        for (bits = 0; bits < (int) sizeof(int) * 8 - chunk_size; bits += chunk_size) {
            PyObject *tmp, *digit;
            long idigit;
            digit = PyNumber_And(stepval, mask);
            if (unlikely(!digit)) goto done;
            idigit = PyLong_AsLong(digit);
            Py_DECREF(digit);
            if (unlikely(idigit < 0)) goto done;
            val |= ((int) idigit) << bits;
            tmp = PyNumber_Rshift(stepval, shift);
            if (unlikely(!tmp)) goto done;
            Py_DECREF(stepval); stepval = tmp;
        }
        Py_DECREF(shift); shift = NULL;
        Py_DECREF(mask); mask = NULL;
        {
            long idigit = PyLong_AsLong(stepval);
            if (unlikely(idigit < 0)) goto done;
            remaining_bits = ((int) sizeof(int) * 8) - bits - (is_unsigned ? 0 : 1);
            if (unlikely(idigit >= (1L << remaining_bits)))
                goto raise_overflow;
            val |= ((int) idigit) << bits;
        }
        if (!is_unsigned) {
            if (unlikely(val & (((int) 1) << (sizeof(int) * 8 - 1))))
                goto raise_overflow;
            if (is_negative)
                val = ~val;
        }
        ret = 0;
    done:
        Py_XDECREF(shift);
        Py_XDECREF(mask);
        Py_XDECREF(stepval);
#endif
        if (unlikely(ret))
            return (int) -1;
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to int");
    return (int) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to int");
    return (int) -1;
}

/* FormatTypeName */
  #if CYTHON_COMPILING_IN_LIMITED_API && __PYX_LIMITED_VERSION_HEX < 0x030d0000
static __Pyx_TypeName
__Pyx_PyType_GetFullyQualifiedName(PyTypeObject* tp)
{
    PyObject *module = NULL, *name = NULL, *result = NULL;
    #if __PYX_LIMITED_VERSION_HEX < 0x030b0000
    name = __Pyx_PyObject_GetAttrStr((PyObject *)tp,
                                               __pyx_mstate_global->__pyx_n_u_qualname);
    #else
    name = PyType_GetQualName(tp);
    #endif
    if (unlikely(name == NULL) || unlikely(!PyUnicode_Check(name))) goto bad;
    module = __Pyx_PyObject_GetAttrStr((PyObject *)tp,
                                               __pyx_mstate_global->__pyx_n_u_module);
    if (unlikely(module == NULL) || unlikely(!PyUnicode_Check(module))) goto bad;
    if (PyUnicode_CompareWithASCIIString(module, "builtins") == 0) {
        result = name;
        name = NULL;
        goto done;
    }
    result = PyUnicode_FromFormat("%U.%U", module, name);
    if (unlikely(result == NULL)) goto bad;
  done:
    Py_XDECREF(name);
    Py_XDECREF(module);
    return result;
  bad:
    PyErr_Clear();
    if (name) {
        result = name;
        name = NULL;
    } else {
        result = __Pyx_NewRef(__pyx_mstate_global->__pyx_kp_u__5);
    }
    goto done;
}
#endif

/* CIntToPy */
  static CYTHON_INLINE PyObject* __Pyx_PyLong_From_long(long value) {
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wconversion"
#endif
    const long neg_one = (long) -1, const_zero = (long) 0;
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic pop
#endif
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(long) < sizeof(long)) {
            return PyLong_FromLong((long) value);
        } else if (sizeof(long) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
#if defined(HAVE_LONG_LONG) && !CYTHON_COMPILING_IN_PYPY
        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
#endif
        }
    } else {
        if (sizeof(long) <= sizeof(long)) {
            return PyLong_FromLong((long) value);
#ifdef HAVE_LONG_LONG
        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
            return PyLong_FromLongLong((PY_LONG_LONG) value);
#endif
        }
    }
    {
        unsigned char *bytes = (unsigned char *)&value;
#if !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX >= 0x030d00A4
        if (is_unsigned) {
            return PyLong_FromUnsignedNativeBytes(bytes, sizeof(value), -1);
        } else {
            return PyLong_FromNativeBytes(bytes, sizeof(value), -1);
        }
#elif !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX < 0x030d0000
        int one = 1; int little = (int)*(unsigned char *)&one;
        return _PyLong_FromByteArray(bytes, sizeof(long),
                                     little, !is_unsigned);
#else
        int one = 1; int little = (int)*(unsigned char *)&one;
        PyObject *from_bytes, *result = NULL, *kwds = NULL;
        PyObject *py_bytes = NULL, *order_str = NULL;
        from_bytes = PyObject_GetAttrString((PyObject*)&PyLong_Type, "from_bytes");
        if (!from_bytes) return NULL;
        py_bytes = PyBytes_FromStringAndSize((char*)bytes, sizeof(long));
        if (!py_bytes) goto limited_bad;
        order_str = PyUnicode_FromString(little ? "little" : "big");
        if (!order_str) goto limited_bad;
        {
            PyObject *args[3+(CYTHON_VECTORCALL ? 1 : 0)] = { NULL, py_bytes, order_str };
            if (!is_unsigned) {
                kwds = __Pyx_MakeVectorcallBuilderKwds(1);
                if (!kwds) goto limited_bad;
                if (__Pyx_VectorcallBuilder_AddArgStr("signed", __Pyx_NewRef(Py_True), kwds, args+3, 0) < 0) goto limited_bad;
            }
            result = __Pyx_Object_Vectorcall_CallFromBuilder(from_bytes, args+1, 2 | __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET, kwds);
        }
        limited_bad:
        Py_XDECREF(kwds);
        Py_XDECREF(order_str);
        Py_XDECREF(py_bytes);
        Py_XDECREF(from_bytes);
        return result;
#endif
    }
}

/* CIntFromPy */
  static CYTHON_INLINE long __Pyx_PyLong_As_long(PyObject *x) {
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wconversion"
#endif
    const long neg_one = (long) -1, const_zero = (long) 0;
#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
#pragma GCC diagnostic pop
#endif
    const int is_unsigned = neg_one > const_zero;
    if (unlikely(!PyLong_Check(x))) {
        long val;
        PyObject *tmp = __Pyx_PyNumber_Long(x);
        if (!tmp) return (long) -1;
        val = __Pyx_PyLong_As_long(tmp);
        Py_DECREF(tmp);
        return val;
    }
    if (is_unsigned) {
#if CYTHON_USE_PYLONG_INTERNALS
        if (unlikely(__Pyx_PyLong_IsNeg(x))) {
            goto raise_neg_overflow;
        } else if (__Pyx_PyLong_IsCompact(x)) {
            __PYX_VERIFY_RETURN_INT(long, __Pyx_compact_upylong, __Pyx_PyLong_CompactValueUnsigned(x))
        } else {
            const digit* digits = __Pyx_PyLong_Digits(x);
            assert(__Pyx_PyLong_DigitCount(x) > 1);
            switch (__Pyx_PyLong_DigitCount(x)) {
                case 2:
                    if ((8 * sizeof(long) > 1 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(long) >= 2 * PyLong_SHIFT)) {
                            return (long) (((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                        }
                    }
                    break;
                case 3:
                    if ((8 * sizeof(long) > 2 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(long) >= 3 * PyLong_SHIFT)) {
                            return (long) (((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                        }
                    }
                    break;
                case 4:
                    if ((8 * sizeof(long) > 3 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(long) >= 4 * PyLong_SHIFT)) {
                            return (long) (((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                        }
                    }
                    break;
            }
        }
#endif
#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030C00A7
        if (unlikely(Py_SIZE(x) < 0)) {
            goto raise_neg_overflow;
        }
#else
        {
            int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
            if (unlikely(result < 0))
                return (long) -1;
            if (unlikely(result == 1))
                goto raise_neg_overflow;
        }
#endif
        if ((sizeof(long) <= sizeof(unsigned long))) {
            __PYX_VERIFY_RETURN_INT_EXC(long, unsigned long, PyLong_AsUnsignedLong(x))
#ifdef HAVE_LONG_LONG
        } else if ((sizeof(long) <= sizeof(unsigned PY_LONG_LONG))) {
            __PYX_VERIFY_RETURN_INT_EXC(long, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
#endif
        }
    } else {
#if CYTHON_USE_PYLONG_INTERNALS
        if (__Pyx_PyLong_IsCompact(x)) {
            __PYX_VERIFY_RETURN_INT(long, __Pyx_compact_pylong, __Pyx_PyLong_CompactValue(x))
        } else {
            const digit* digits = __Pyx_PyLong_Digits(x);
            assert(__Pyx_PyLong_DigitCount(x) > 1);
            switch (__Pyx_PyLong_SignedDigitCount(x)) {
                case -2:
                    if ((8 * sizeof(long) - 1 > 1 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
                            return (long) (((long)-1)*(((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case 2:
                    if ((8 * sizeof(long) > 1 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 2 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
                            return (long) ((((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case -3:
                    if ((8 * sizeof(long) - 1 > 2 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
                            return (long) (((long)-1)*(((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case 3:
                    if ((8 * sizeof(long) > 2 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 3 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
                            return (long) ((((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case -4:
                    if ((8 * sizeof(long) - 1 > 3 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(long) - 1 > 4 * PyLong_SHIFT)) {
                            return (long) (((long)-1)*(((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case 4:
                    if ((8 * sizeof(long) > 3 * PyLong_SHIFT)) {
                        if ((8 * sizeof(unsigned long) > 4 * PyLong_SHIFT)) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if ((8 * sizeof(long) - 1 > 4 * PyLong_SHIFT)) {
                            return (long) ((((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
            }
        }
#endif
        if ((sizeof(long) <= sizeof(long))) {
            __PYX_VERIFY_RETURN_INT_EXC(long, long, PyLong_AsLong(x))
#ifdef HAVE_LONG_LONG
        } else if ((sizeof(long) <= sizeof(PY_LONG_LONG))) {
            __PYX_VERIFY_RETURN_INT_EXC(long, PY_LONG_LONG, PyLong_AsLongLong(x))
#endif
        }
    }
    {
        long val;
        int ret = -1;
#if PY_VERSION_HEX >= 0x030d00A6 && !CYTHON_COMPILING_IN_LIMITED_API
        Py_ssize_t bytes_copied = PyLong_AsNativeBytes(
            x, &val, sizeof(val), Py_ASNATIVEBYTES_NATIVE_ENDIAN | (is_unsigned ? Py_ASNATIVEBYTES_UNSIGNED_BUFFER | Py_ASNATIVEBYTES_REJECT_NEGATIVE : 0));
        if (unlikely(bytes_copied == -1)) {
        } else if (unlikely(bytes_copied > (Py_ssize_t) sizeof(val))) {
            goto raise_overflow;
        } else {
            ret = 0;
        }
#elif PY_VERSION_HEX < 0x030d0000 && !(CYTHON_COMPILING_IN_PYPY || CYTHON_COMPILING_IN_LIMITED_API) || defined(_PyLong_AsByteArray)
        int one = 1; int is_little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&val;
        ret = _PyLong_AsByteArray((PyLongObject *)x,
                                    bytes, sizeof(val),
                                    is_little, !is_unsigned);
#else
        PyObject *v;
        PyObject *stepval = NULL, *mask = NULL, *shift = NULL;
        int bits, remaining_bits, is_negative = 0;
        int chunk_size = (sizeof(long) < 8) ? 30 : 62;
        if (likely(PyLong_CheckExact(x))) {
            v = __Pyx_NewRef(x);
        } else {
            v = PyNumber_Long(x);
            if (unlikely(!v)) return (long) -1;
            assert(PyLong_CheckExact(v));
        }
        {
            int result = PyObject_RichCompareBool(v, Py_False, Py_LT);
            if (unlikely(result < 0)) {
                Py_DECREF(v);
                return (long) -1;
            }
            is_negative = result == 1;
        }
        if (is_unsigned && unlikely(is_negative)) {
            Py_DECREF(v);
            goto raise_neg_overflow;
        } else if (is_negative) {
            stepval = PyNumber_Invert(v);
            Py_DECREF(v);
            if (unlikely(!stepval))
                return (long) -1;
        } else {
            stepval = v;
        }
        v = NULL;
        val = (long) 0;
        mask = PyLong_FromLong((1L << chunk_size) - 1); if (unlikely(!mask)) goto done;
        shift = PyLong_FromLong(chunk_size); if (unlikely(!shift)) goto done;
        for (bits = 0; bits < (int) sizeof(long) * 8 - chunk_size; bits += chunk_size) {
            PyObject *tmp, *digit;
            long idigit;
            digit = PyNumber_And(stepval, mask);
            if (unlikely(!digit)) goto done;
            idigit = PyLong_AsLong(digit);
            Py_DECREF(digit);
            if (unlikely(idigit < 0)) goto done;
            val |= ((long) idigit) << bits;
            tmp = PyNumber_Rshift(stepval, shift);
            if (unlikely(!tmp)) goto done;
            Py_DECREF(stepval); stepval = tmp;
        }
        Py_DECREF(shift); shift = NULL;
        Py_DECREF(mask); mask = NULL;
        {
            long idigit = PyLong_AsLong(stepval);
            if (unlikely(idigit < 0)) goto done;
            remaining_bits = ((int) sizeof(long) * 8) - bits - (is_unsigned ? 0 : 1);
            if (unlikely(idigit >= (1L << remaining_bits)))
                goto raise_overflow;
            val |= ((long) idigit) << bits;
        }
        if (!is_unsigned) {
            if (unlikely(val & (((long) 1) << (sizeof(long) * 8 - 1))))
                goto raise_overflow;
            if (is_negative)
                val = ~val;
        }
        ret = 0;
    done:
        Py_XDECREF(shift);
        Py_XDECREF(mask);
        Py_XDECREF(stepval);
#endif
        if (unlikely(ret))
            return (long) -1;
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to long");
    return (long) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to long");
    return (long) -1;
}

/* FastTypeChecks */
  #if CYTHON_COMPILING_IN_CPYTHON
static int __Pyx_InBases(PyTypeObject *a, PyTypeObject *b) {
    while (a) {
        a = __Pyx_PyType_GetSlot(a, tp_base, PyTypeObject*);
        if (a == b)
            return 1;
    }
    return b == &PyBaseObject_Type;
}
static CYTHON_INLINE int __Pyx_IsSubtype(PyTypeObject *a, PyTypeObject *b) {
    PyObject *mro;
    if (a == b) return 1;
    mro = a->tp_mro;
    if (likely(mro)) {
        Py_ssize_t i, n;
        n = PyTuple_GET_SIZE(mro);
        for (i = 0; i < n; i++) {
            if (PyTuple_GET_ITEM(mro, i) == (PyObject *)b)
                return 1;
        }
        return 0;
    }
    return __Pyx_InBases(a, b);
}
static CYTHON_INLINE int __Pyx_IsAnySubtype2(PyTypeObject *cls, PyTypeObject *a, PyTypeObject *b) {
    PyObject *mro;
    if (cls == a || cls == b) return 1;
    mro = cls->tp_mro;
    if (likely(mro)) {
        Py_ssize_t i, n;
        n = PyTuple_GET_SIZE(mro);
        for (i = 0; i < n; i++) {
            PyObject *base = PyTuple_GET_ITEM(mro, i);
            if (base == (PyObject *)a || base == (PyObject *)b)
                return 1;
        }
        return 0;
    }
    return __Pyx_InBases(cls, a) || __Pyx_InBases(cls, b);
}
static CYTHON_INLINE int __Pyx_inner_PyErr_GivenExceptionMatches2(PyObject *err, PyObject* exc_type1, PyObject *exc_type2) {
    if (exc_type1) {
        return __Pyx_IsAnySubtype2((PyTypeObject*)err, (PyTypeObject*)exc_type1, (PyTypeObject*)exc_type2);
    } else {
        return __Pyx_IsSubtype((PyTypeObject*)err, (PyTypeObject*)exc_type2);
    }
}
static int __Pyx_PyErr_GivenExceptionMatchesTuple(PyObject *exc_type, PyObject *tuple) {
    Py_ssize_t i, n;
    assert(PyExceptionClass_Check(exc_type));
    n = PyTuple_GET_SIZE(tuple);
    for (i=0; i<n; i++) {
        if (exc_type == PyTuple_GET_ITEM(tuple, i)) return 1;
    }
    for (i=0; i<n; i++) {
        PyObject *t = PyTuple_GET_ITEM(tuple, i);
        if (likely(PyExceptionClass_Check(t))) {
            if (__Pyx_inner_PyErr_GivenExceptionMatches2(exc_type, NULL, t)) return 1;
        } else {
        }
    }
    return 0;
}
static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches(PyObject *err, PyObject* exc_type) {
    if (likely(err == exc_type)) return 1;
    if (likely(PyExceptionClass_Check(err))) {
        if (likely(PyExceptionClass_Check(exc_type))) {
            return __Pyx_inner_PyErr_GivenExceptionMatches2(err, NULL, exc_type);
        } else if (likely(PyTuple_Check(exc_type))) {
            return __Pyx_PyErr_GivenExceptionMatchesTuple(err, exc_type);
        } else {
        }
    }
    return PyErr_GivenExceptionMatches(err, exc_type);
}
static CYTHON_INLINE int __Pyx_PyErr_GivenExceptionMatches2(PyObject *err, PyObject *exc_type1, PyObject *exc_type2) {
    assert(PyExceptionClass_Check(exc_type1));
    assert(PyExceptionClass_Check(exc_type2));
    if (likely(err == exc_type1 || err == exc_type2)) return 1;
    if (likely(PyExceptionClass_Check(err))) {
        return __Pyx_inner_PyErr_GivenExceptionMatches2(err, exc_type1, exc_type2);
    }
    return (PyErr_GivenExceptionMatches(err, exc_type1) || PyErr_GivenExceptionMatches(err, exc_type2));
}
#endif

/* GetRuntimeVersion */
  static unsigned long __Pyx_get_runtime_version(void) {
#if __PYX_LIMITED_VERSION_HEX >= 0x030b0000
    return Py_Version & ~0xFFUL;
#else
    static unsigned long __Pyx_cached_runtime_version = 0;
    if (__Pyx_cached_runtime_version == 0) {
        const char* rt_version = Py_GetVersion();
        unsigned long version = 0;
        unsigned long factor = 0x01000000UL;
        unsigned int digit = 0;
        int i = 0;
        while (factor) {
            while ('0' <= rt_version[i] && rt_version[i] <= '9') {
                digit = digit * 10 + (unsigned int) (rt_version[i] - '0');
                ++i;
            }
            version += factor * digit;
            if (rt_version[i] != '.')
                break;
            digit = 0;
            factor >>= 8;
            ++i;
        }
        __Pyx_cached_runtime_version = version;
    }
    return __Pyx_cached_runtime_version;
#endif
}

/* CheckBinaryVersion */
  static int __Pyx_check_binary_version(unsigned long ct_version, unsigned long rt_version, int allow_newer) {
    const unsigned long MAJOR_MINOR = 0xFFFF0000UL;
    if ((rt_version & MAJOR_MINOR) == (ct_version & MAJOR_MINOR))
        return 0;
    if (likely(allow_newer && (rt_version & MAJOR_MINOR) > (ct_version & MAJOR_MINOR)))
        return 1;
    {
        char message[200];
        PyOS_snprintf(message, sizeof(message),
                      "compile time Python version %d.%d "
                      "of module '%.100s' "
                      "%s "
                      "runtime version %d.%d",
                       (int) (ct_version >> 24), (int) ((ct_version >> 16) & 0xFF),
                       __Pyx_MODULE_NAME,
                       (allow_newer) ? "was newer than" : "does not match",
                       (int) (rt_version >> 24), (int) ((rt_version >> 16) & 0xFF)
       );
        return PyErr_WarnEx(NULL, message, 1);
    }
}

/* FunctionExport */
  static int __Pyx_ExportFunction(const char *name, void (*f)(void), const char *sig) {
    PyObject *d = 0;
    PyObject *cobj = 0;
    union {
        void (*fp)(void);
        void *p;
    } tmp;
    d = PyObject_GetAttrString(__pyx_m, "__pyx_capi__");
    if (!d) {
        PyErr_Clear();
        d = PyDict_New();
        if (!d)
            goto bad;
        Py_INCREF(d);
        if (PyModule_AddObject(__pyx_m, "__pyx_capi__", d) < 0)
            goto bad;
    }
    tmp.fp = f;
    cobj = PyCapsule_New(tmp.p, sig, 0);
    if (!cobj)
        goto bad;
    if (PyDict_SetItemString(d, name, cobj) < 0)
        goto bad;
    Py_DECREF(cobj);
    Py_DECREF(d);
    return 0;
bad:
    Py_XDECREF(cobj);
    Py_XDECREF(d);
    return -1;
}

/* NewCodeObj */
  #if CYTHON_COMPILING_IN_LIMITED_API
    static PyObject* __Pyx__PyCode_New(int a, int p, int k, int l, int s, int f,
                                       PyObject *code, PyObject *c, PyObject* n, PyObject *v,
                                       PyObject *fv, PyObject *cell, PyObject* fn,
                                       PyObject *name, int fline, PyObject *lnos) {
        PyObject *exception_table = NULL;
        PyObject *types_module=NULL, *code_type=NULL, *result=NULL;
        #if __PYX_LIMITED_VERSION_HEX < 0x030b0000
        PyObject *version_info;
        PyObject *py_minor_version = NULL;
        #endif
        long minor_version = 0;
        PyObject *type, *value, *traceback;
        PyErr_Fetch(&type, &value, &traceback);
        #if __PYX_LIMITED_VERSION_HEX >= 0x030b0000
        minor_version = 11;
        #else
        if (!(version_info = PySys_GetObject("version_info"))) goto end;
        if (!(py_minor_version = PySequence_GetItem(version_info, 1))) goto end;
        minor_version = PyLong_AsLong(py_minor_version);
        Py_DECREF(py_minor_version);
        if (minor_version == -1 && PyErr_Occurred()) goto end;
        #endif
        if (!(types_module = PyImport_ImportModule("types"))) goto end;
        if (!(code_type = PyObject_GetAttrString(types_module, "CodeType"))) goto end;
        if (minor_version <= 7) {
            (void)p;
            result = PyObject_CallFunction(code_type, "iiiiiOOOOOOiOOO", a, k, l, s, f, code,
                          c, n, v, fn, name, fline, lnos, fv, cell);
        } else if (minor_version <= 10) {
            result = PyObject_CallFunction(code_type, "iiiiiiOOOOOOiOOO", a,p, k, l, s, f, code,
                          c, n, v, fn, name, fline, lnos, fv, cell);
        } else {
            if (!(exception_table = PyBytes_FromStringAndSize(NULL, 0))) goto end;
            result = PyObject_CallFunction(code_type, "iiiiiiOOOOOOOiOOOO", a,p, k, l, s, f, code,
                          c, n, v, fn, name, name, fline, lnos, exception_table, fv, cell);
        }
    end:
        Py_XDECREF(code_type);
        Py_XDECREF(exception_table);
        Py_XDECREF(types_module);
        if (type) {
            PyErr_Restore(type, value, traceback);
        }
        return result;
    }
#elif PY_VERSION_HEX >= 0x030B0000
  static PyCodeObject* __Pyx__PyCode_New(int a, int p, int k, int l, int s, int f,
                                         PyObject *code, PyObject *c, PyObject* n, PyObject *v,
                                         PyObject *fv, PyObject *cell, PyObject* fn,
                                         PyObject *name, int fline, PyObject *lnos) {
    PyCodeObject *result;
    result =
      #if PY_VERSION_HEX >= 0x030C0000
        PyUnstable_Code_NewWithPosOnlyArgs
      #else
        PyCode_NewWithPosOnlyArgs
      #endif
        (a, p, k, l, s, f, code, c, n, v, fv, cell, fn, name, name, fline, lnos, __pyx_mstate_global->__pyx_empty_bytes);
    return result;
  }
#elif PY_VERSION_HEX >= 0x030800B2 && !CYTHON_COMPILING_IN_PYPY
  #define __Pyx__PyCode_New(a, p, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
          PyCode_NewWithPosOnlyArgs(a, p, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
#else
  #define __Pyx__PyCode_New(a, p, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
          PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
#endif
static PyObject* __Pyx_PyCode_New(
        const __Pyx_PyCode_New_function_description descr,
        PyObject * const *varnames,
        PyObject *filename,
        PyObject *funcname,
        const char *line_table,
        PyObject *tuple_dedup_map
) {
    PyObject *code_obj = NULL, *varnames_tuple_dedup = NULL, *code_bytes = NULL, *line_table_bytes = NULL;
    Py_ssize_t var_count = (Py_ssize_t) descr.nlocals;
    PyObject *varnames_tuple = PyTuple_New(var_count);
    if (unlikely(!varnames_tuple)) return NULL;
    for (Py_ssize_t i=0; i < var_count; i++) {
        Py_INCREF(varnames[i]);
        if (__Pyx_PyTuple_SET_ITEM(varnames_tuple, i, varnames[i]) != (0)) goto done;
    }
    #if CYTHON_COMPILING_IN_LIMITED_API
    varnames_tuple_dedup = PyDict_GetItem(tuple_dedup_map, varnames_tuple);
    if (!varnames_tuple_dedup) {
        if (unlikely(PyDict_SetItem(tuple_dedup_map, varnames_tuple, varnames_tuple) < 0)) goto done;
        varnames_tuple_dedup = varnames_tuple;
    }
    #else
    varnames_tuple_dedup = PyDict_SetDefault(tuple_dedup_map, varnames_tuple, varnames_tuple);
    if (unlikely(!varnames_tuple_dedup)) goto done;
    #endif
    #if CYTHON_AVOID_BORROWED_REFS
    Py_INCREF(varnames_tuple_dedup);
    #endif
    if (__PYX_LIMITED_VERSION_HEX >= (0x030b0000) && line_table != NULL
        && !CYTHON_COMPILING_IN_GRAAL) {
        line_table_bytes = PyBytes_FromStringAndSize(line_table, descr.line_table_length);
        if (unlikely(!line_table_bytes)) goto done;
        Py_ssize_t code_len = (descr.line_table_length * 2 + 4) & ~3;
        code_bytes = PyBytes_FromStringAndSize(NULL, code_len);
        if (unlikely(!code_bytes)) goto done;
        char* c_code_bytes = PyBytes_AsString(code_bytes);
        if (unlikely(!c_code_bytes)) goto done;
        memset(c_code_bytes, 0, (size_t) code_len);
    }
    code_obj = (PyObject*) __Pyx__PyCode_New(
        (int) descr.argcount,
        (int) descr.num_posonly_args,
        (int) descr.num_kwonly_args,
        (int) descr.nlocals,
        0,
        (int) descr.flags,
        code_bytes ? code_bytes : __pyx_mstate_global->__pyx_empty_bytes,
        __pyx_mstate_global->__pyx_empty_tuple,
        __pyx_mstate_global->__pyx_empty_tuple,
        varnames_tuple_dedup,
        __pyx_mstate_global->__pyx_empty_tuple,
        __pyx_mstate_global->__pyx_empty_tuple,
        filename,
        funcname,
        (int) descr.first_line,
        (__PYX_LIMITED_VERSION_HEX >= (0x030b0000) && line_table_bytes) ? line_table_bytes : __pyx_mstate_global->__pyx_empty_bytes
    );
done:
    Py_XDECREF(code_bytes);
    Py_XDECREF(line_table_bytes);
    #if CYTHON_AVOID_BORROWED_REFS
    Py_XDECREF(varnames_tuple_dedup);
    #endif
    Py_DECREF(varnames_tuple);
    return code_obj;
}

/* InitStrings */
  static int __Pyx_InitStrings(__Pyx_StringTabEntry const *t, PyObject **target, const char* const* encoding_names) {
    while (t->s) {
        PyObject *str;
        if (t->is_unicode) {
            if (t->intern) {
                str = PyUnicode_InternFromString(t->s);
            } else if (t->encoding) {
                str = PyUnicode_Decode(t->s, t->n - 1, encoding_names[t->encoding], NULL);
            } else {
                str = PyUnicode_FromStringAndSize(t->s, t->n - 1);
            }
        } else {
            str = PyBytes_FromStringAndSize(t->s, t->n - 1);
        }
        if (!str)
            return -1;
        *target = str;
        if (PyObject_Hash(str) == -1)
            return -1;
        ++t;
        ++target;
    }
    return 0;
}

#include <string.h>
static CYTHON_INLINE Py_ssize_t __Pyx_ssize_strlen(const char *s) {
    size_t len = strlen(s);
    if (unlikely(len > (size_t) PY_SSIZE_T_MAX)) {
        PyErr_SetString(PyExc_OverflowError, "byte string is too long");
        return -1;
    }
    return (Py_ssize_t) len;
}
static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromString(const char* c_str) {
    Py_ssize_t len = __Pyx_ssize_strlen(c_str);
    if (unlikely(len < 0)) return NULL;
    return __Pyx_PyUnicode_FromStringAndSize(c_str, len);
}
static CYTHON_INLINE PyObject* __Pyx_PyByteArray_FromString(const char* c_str) {
    Py_ssize_t len = __Pyx_ssize_strlen(c_str);
    if (unlikely(len < 0)) return NULL;
    return PyByteArray_FromStringAndSize(c_str, len);
}
static CYTHON_INLINE const char* __Pyx_PyObject_AsString(PyObject* o) {
    Py_ssize_t ignore;
    return __Pyx_PyObject_AsStringAndSize(o, &ignore);
}
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_UTF8
static CYTHON_INLINE const char* __Pyx_PyUnicode_AsStringAndSize(PyObject* o, Py_ssize_t *length) {
    if (unlikely(__Pyx_PyUnicode_READY(o) == -1)) return NULL;
#if CYTHON_COMPILING_IN_LIMITED_API
    {
        const char* result;
        Py_ssize_t unicode_length;
        CYTHON_MAYBE_UNUSED_VAR(unicode_length); // only for __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
        #if __PYX_LIMITED_VERSION_HEX < 0x030A0000
        if (unlikely(PyArg_Parse(o, "s#", &result, length) < 0)) return NULL;
        #else
        result = PyUnicode_AsUTF8AndSize(o, length);
        #endif
        #if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
        unicode_length = PyUnicode_GetLength(o);
        if (unlikely(unicode_length < 0)) return NULL;
        if (unlikely(unicode_length != *length)) {
            PyUnicode_AsASCIIString(o);
            return NULL;
        }
        #endif
        return result;
    }
#else
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
    if (likely(PyUnicode_IS_ASCII(o))) {
        *length = PyUnicode_GET_LENGTH(o);
        return PyUnicode_AsUTF8(o);
    } else {
        PyUnicode_AsASCIIString(o);
        return NULL;
    }
#else
    return PyUnicode_AsUTF8AndSize(o, length);
#endif
#endif
}
#endif
static CYTHON_INLINE const char* __Pyx_PyObject_AsStringAndSize(PyObject* o, Py_ssize_t *length) {
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_UTF8
    if (PyUnicode_Check(o)) {
        return __Pyx_PyUnicode_AsStringAndSize(o, length);
    } else
#endif
    if (PyByteArray_Check(o)) {
#if (CYTHON_ASSUME_SAFE_SIZE && CYTHON_ASSUME_SAFE_MACROS) || (CYTHON_COMPILING_IN_PYPY && (defined(PyByteArray_AS_STRING) && defined(PyByteArray_GET_SIZE)))
        *length = PyByteArray_GET_SIZE(o);
        return PyByteArray_AS_STRING(o);
#else
        *length = PyByteArray_Size(o);
        if (*length == -1) return NULL;
        return PyByteArray_AsString(o);
#endif
    } else
    {
        char* result;
        int r = PyBytes_AsStringAndSize(o, &result, length);
        if (unlikely(r < 0)) {
            return NULL;
        } else {
            return result;
        }
    }
}
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
   int is_true = x == Py_True;
   if (is_true | (x == Py_False) | (x == Py_None)) return is_true;
   else return PyObject_IsTrue(x);
}
static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject* x) {
    int retval;
    if (unlikely(!x)) return -1;
    retval = __Pyx_PyObject_IsTrue(x);
    Py_DECREF(x);
    return retval;
}
static PyObject* __Pyx_PyNumber_LongWrongResultType(PyObject* result) {
    __Pyx_TypeName result_type_name = __Pyx_PyType_GetFullyQualifiedName(Py_TYPE(result));
    if (PyLong_Check(result)) {
        if (PyErr_WarnFormat(PyExc_DeprecationWarning, 1,
                "__int__ returned non-int (type " __Pyx_FMT_TYPENAME ").  "
                "The ability to return an instance of a strict subclass of int is deprecated, "
                "and may be removed in a future version of Python.",
                result_type_name)) {
            __Pyx_DECREF_TypeName(result_type_name);
            Py_DECREF(result);
            return NULL;
        }
        __Pyx_DECREF_TypeName(result_type_name);
        return result;
    }
    PyErr_Format(PyExc_TypeError,
                 "__int__ returned non-int (type " __Pyx_FMT_TYPENAME ")",
                 result_type_name);
    __Pyx_DECREF_TypeName(result_type_name);
    Py_DECREF(result);
    return NULL;
}
static CYTHON_INLINE PyObject* __Pyx_PyNumber_Long(PyObject* x) {
#if CYTHON_USE_TYPE_SLOTS
  PyNumberMethods *m;
#endif
  PyObject *res = NULL;
  if (likely(PyLong_Check(x)))
      return __Pyx_NewRef(x);
#if CYTHON_USE_TYPE_SLOTS
  m = Py_TYPE(x)->tp_as_number;
  if (likely(m && m->nb_int)) {
      res = m->nb_int(x);
  }
#else
  if (!PyBytes_CheckExact(x) && !PyUnicode_CheckExact(x)) {
      res = PyNumber_Long(x);
  }
#endif
  if (likely(res)) {
      if (unlikely(!PyLong_CheckExact(res))) {
          return __Pyx_PyNumber_LongWrongResultType(res);
      }
  }
  else if (!PyErr_Occurred()) {
      PyErr_SetString(PyExc_TypeError,
                      "an integer is required");
  }
  return res;
}
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject* b) {
  Py_ssize_t ival;
  PyObject *x;
  if (likely(PyLong_CheckExact(b))) {
    #if CYTHON_USE_PYLONG_INTERNALS
    if (likely(__Pyx_PyLong_IsCompact(b))) {
        return __Pyx_PyLong_CompactValue(b);
    } else {
      const digit* digits = __Pyx_PyLong_Digits(b);
      const Py_ssize_t size = __Pyx_PyLong_SignedDigitCount(b);
      switch (size) {
         case 2:
           if (8 * sizeof(Py_ssize_t) > 2 * PyLong_SHIFT) {
             return (Py_ssize_t) (((((size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case -2:
           if (8 * sizeof(Py_ssize_t) > 2 * PyLong_SHIFT) {
             return -(Py_ssize_t) (((((size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case 3:
           if (8 * sizeof(Py_ssize_t) > 3 * PyLong_SHIFT) {
             return (Py_ssize_t) (((((((size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case -3:
           if (8 * sizeof(Py_ssize_t) > 3 * PyLong_SHIFT) {
             return -(Py_ssize_t) (((((((size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case 4:
           if (8 * sizeof(Py_ssize_t) > 4 * PyLong_SHIFT) {
             return (Py_ssize_t) (((((((((size_t)digits[3]) << PyLong_SHIFT) | (size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case -4:
           if (8 * sizeof(Py_ssize_t) > 4 * PyLong_SHIFT) {
             return -(Py_ssize_t) (((((((((size_t)digits[3]) << PyLong_SHIFT) | (size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
      }
    }
    #endif
    return PyLong_AsSsize_t(b);
  }
  x = PyNumber_Index(b);
  if (!x) return -1;
  ival = PyLong_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}
static CYTHON_INLINE Py_hash_t __Pyx_PyIndex_AsHash_t(PyObject* o) {
  if (sizeof(Py_hash_t) == sizeof(Py_ssize_t)) {
    return (Py_hash_t) __Pyx_PyIndex_AsSsize_t(o);
  } else {
    Py_ssize_t ival;
    PyObject *x;
    x = PyNumber_Index(o);
    if (!x) return -1;
    ival = PyLong_AsLong(x);
    Py_DECREF(x);
    return ival;
  }
}
static CYTHON_INLINE PyObject *__Pyx_Owned_Py_None(int b) {
    CYTHON_UNUSED_VAR(b);
    return __Pyx_NewRef(Py_None);
}
static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b) {
  return b ? __Pyx_NewRef(Py_True) : __Pyx_NewRef(Py_False);
}
static CYTHON_INLINE PyObject * __Pyx_PyLong_FromSize_t(size_t ival) {
    return PyLong_FromSize_t(ival);
}


  /* MultiPhaseInitModuleState */
  #if CYTHON_PEP489_MULTI_PHASE_INIT && CYTHON_USE_MODULE_STATE
#ifndef CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE
#if (CYTHON_COMPILING_IN_LIMITED_API || PY_VERSION_HEX >= 0x030C0000)
  #define CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE 1
#else
  #define CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE 0
#endif
#endif
#if CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE && !CYTHON_ATOMICS
#error "Module state with PEP489 requires atomics. Currently that's one of\
 C11, C++11, gcc atomic intrinsics or MSVC atomic intrinsics"
#endif
#if !CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE
#define __Pyx_ModuleStateLookup_Lock()
#define __Pyx_ModuleStateLookup_Unlock()
#elif !CYTHON_COMPILING_IN_LIMITED_API && PY_VERSION_HEX >= 0x030d0000
static PyMutex __Pyx_ModuleStateLookup_mutex = {0};
#define __Pyx_ModuleStateLookup_Lock() PyMutex_Lock(&__Pyx_ModuleStateLookup_mutex)
#define __Pyx_ModuleStateLookup_Unlock() PyMutex_Unlock(&__Pyx_ModuleStateLookup_mutex)
#elif defined(__cplusplus) && __cplusplus >= 201103L
#include <mutex>
static std::mutex __Pyx_ModuleStateLookup_mutex;
#define __Pyx_ModuleStateLookup_Lock() __Pyx_ModuleStateLookup_mutex.lock()
#define __Pyx_ModuleStateLookup_Unlock() __Pyx_ModuleStateLookup_mutex.unlock()
#elif defined(__STDC_VERSION__) && (__STDC_VERSION__ > 201112L) && !defined(__STDC_NO_THREADS__)
#include <threads.h>
static mtx_t __Pyx_ModuleStateLookup_mutex;
static once_flag __Pyx_ModuleStateLookup_mutex_once_flag = ONCE_FLAG_INIT;
static void __Pyx_ModuleStateLookup_initialize_mutex(void) {
    mtx_init(&__Pyx_ModuleStateLookup_mutex, mtx_plain);
}
#define __Pyx_ModuleStateLookup_Lock()\
  call_once(&__Pyx_ModuleStateLookup_mutex_once_flag, __Pyx_ModuleStateLookup_initialize_mutex);\
  mtx_lock(&__Pyx_ModuleStateLookup_mutex)
#define __Pyx_ModuleStateLookup_Unlock() mtx_unlock(&__Pyx_ModuleStateLookup_mutex)
#elif defined(HAVE_PTHREAD_H)
#include <pthread.h>
static pthread_mutex_t __Pyx_ModuleStateLookup_mutex = PTHREAD_MUTEX_INITIALIZER;
#define __Pyx_ModuleStateLookup_Lock() pthread_mutex_lock(&__Pyx_ModuleStateLookup_mutex)
#define __Pyx_ModuleStateLookup_Unlock() pthread_mutex_unlock(&__Pyx_ModuleStateLookup_mutex)
#elif defined(_WIN32)
#include <Windows.h>  // synchapi.h on its own doesn't work
static SRWLOCK __Pyx_ModuleStateLookup_mutex = SRWLOCK_INIT;
#define __Pyx_ModuleStateLookup_Lock() AcquireSRWLockExclusive(&__Pyx_ModuleStateLookup_mutex)
#define __Pyx_ModuleStateLookup_Unlock() ReleaseSRWLockExclusive(&__Pyx_ModuleStateLookup_mutex)
#else
#error "No suitable lock available for CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE.\
 Requires C standard >= C11, or C++ standard >= C++11,\
 or pthreads, or the Windows 32 API, or Python >= 3.13."
#endif
typedef struct {
    int64_t id;
    PyObject *module;
} __Pyx_InterpreterIdAndModule;
typedef struct {
    char interpreter_id_as_index;
    Py_ssize_t count;
    Py_ssize_t allocated;
    __Pyx_InterpreterIdAndModule table[1];
} __Pyx_ModuleStateLookupData;
#define __PYX_MODULE_STATE_LOOKUP_SMALL_SIZE 32
#if CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE
static __pyx_atomic_int_type __Pyx_ModuleStateLookup_read_counter = 0;
#endif
#if CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE
static __pyx_atomic_ptr_type __Pyx_ModuleStateLookup_data = 0;
#else
static __Pyx_ModuleStateLookupData* __Pyx_ModuleStateLookup_data = NULL;
#endif
static __Pyx_InterpreterIdAndModule* __Pyx_State_FindModuleStateLookupTableLowerBound(
        __Pyx_InterpreterIdAndModule* table,
        Py_ssize_t count,
        int64_t interpreterId) {
    __Pyx_InterpreterIdAndModule* begin = table;
    __Pyx_InterpreterIdAndModule* end = begin + count;
    if (begin->id == interpreterId) {
        return begin;
    }
    while ((end - begin) > __PYX_MODULE_STATE_LOOKUP_SMALL_SIZE) {
        __Pyx_InterpreterIdAndModule* halfway = begin + (end - begin)/2;
        if (halfway->id == interpreterId) {
            return halfway;
        }
        if (halfway->id < interpreterId) {
            begin = halfway;
        } else {
            end = halfway;
        }
    }
    for (; begin < end; ++begin) {
        if (begin->id >= interpreterId) return begin;
    }
    return begin;
}
static PyObject *__Pyx_State_FindModule(CYTHON_UNUSED void* dummy) {
    int64_t interpreter_id = PyInterpreterState_GetID(__Pyx_PyInterpreterState_Get());
    if (interpreter_id == -1) return NULL;
#if CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE
    __Pyx_ModuleStateLookupData* data = (__Pyx_ModuleStateLookupData*)__pyx_atomic_pointer_load_relaxed(&__Pyx_ModuleStateLookup_data);
    {
        __pyx_atomic_incr_acq_rel(&__Pyx_ModuleStateLookup_read_counter);
        if (likely(data)) {
            __Pyx_ModuleStateLookupData* new_data = (__Pyx_ModuleStateLookupData*)__pyx_atomic_pointer_load_acquire(&__Pyx_ModuleStateLookup_data);
            if (likely(data == new_data)) {
                goto read_finished;
            }
        }
        __pyx_atomic_decr_acq_rel(&__Pyx_ModuleStateLookup_read_counter);
        __Pyx_ModuleStateLookup_Lock();
        __pyx_atomic_incr_relaxed(&__Pyx_ModuleStateLookup_read_counter);
        data = (__Pyx_ModuleStateLookupData*)__pyx_atomic_pointer_load_relaxed(&__Pyx_ModuleStateLookup_data);
        __Pyx_ModuleStateLookup_Unlock();
    }
  read_finished:;
#else
    __Pyx_ModuleStateLookupData* data = __Pyx_ModuleStateLookup_data;
#endif
    __Pyx_InterpreterIdAndModule* found = NULL;
    if (unlikely(!data)) goto end;
    if (data->interpreter_id_as_index) {
        if (interpreter_id < data->count) {
            found = data->table+interpreter_id;
        }
    } else {
        found = __Pyx_State_FindModuleStateLookupTableLowerBound(
            data->table, data->count, interpreter_id);
    }
  end:
    {
        PyObject *result=NULL;
        if (found && found->id == interpreter_id) {
            result = found->module;
        }
#if CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE
        __pyx_atomic_decr_acq_rel(&__Pyx_ModuleStateLookup_read_counter);
#endif
        return result;
    }
}
#if CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE
static void __Pyx_ModuleStateLookup_wait_until_no_readers(void) {
    while (__pyx_atomic_load(&__Pyx_ModuleStateLookup_read_counter) != 0);
}
#else
#define __Pyx_ModuleStateLookup_wait_until_no_readers()
#endif
static int __Pyx_State_AddModuleInterpIdAsIndex(__Pyx_ModuleStateLookupData **old_data, PyObject* module, int64_t interpreter_id) {
    Py_ssize_t to_allocate = (*old_data)->allocated;
    while (to_allocate <= interpreter_id) {
        if (to_allocate == 0) to_allocate = 1;
        else to_allocate *= 2;
    }
    __Pyx_ModuleStateLookupData *new_data = *old_data;
    if (to_allocate != (*old_data)->allocated) {
         new_data = (__Pyx_ModuleStateLookupData *)realloc(
            *old_data,
            sizeof(__Pyx_ModuleStateLookupData)+(to_allocate-1)*sizeof(__Pyx_InterpreterIdAndModule));
        if (!new_data) {
            PyErr_NoMemory();
            return -1;
        }
        for (Py_ssize_t i = new_data->allocated; i < to_allocate; ++i) {
            new_data->table[i].id = i;
            new_data->table[i].module = NULL;
        }
        new_data->allocated = to_allocate;
    }
    new_data->table[interpreter_id].module = module;
    if (new_data->count < interpreter_id+1) {
        new_data->count = interpreter_id+1;
    }
    *old_data = new_data;
    return 0;
}
static void __Pyx_State_ConvertFromInterpIdAsIndex(__Pyx_ModuleStateLookupData *data) {
    __Pyx_InterpreterIdAndModule *read = data->table;
    __Pyx_InterpreterIdAndModule *write = data->table;
    __Pyx_InterpreterIdAndModule *end = read + data->count;
    for (; read<end; ++read) {
        if (read->module) {
            write->id = read->id;
            write->module = read->module;
            ++write;
        }
    }
    data->count = write - data->table;
    for (; write<end; ++write) {
        write->id = 0;
        write->module = NULL;
    }
    data->interpreter_id_as_index = 0;
}
static int __Pyx_State_AddModule(PyObject* module, CYTHON_UNUSED void* dummy) {
    int64_t interpreter_id = PyInterpreterState_GetID(__Pyx_PyInterpreterState_Get());
    if (interpreter_id == -1) return -1;
    int result = 0;
    __Pyx_ModuleStateLookup_Lock();
#if CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE
    __Pyx_ModuleStateLookupData *old_data = (__Pyx_ModuleStateLookupData *)
            __pyx_atomic_pointer_exchange(&__Pyx_ModuleStateLookup_data, 0);
#else
    __Pyx_ModuleStateLookupData *old_data = __Pyx_ModuleStateLookup_data;
#endif
    __Pyx_ModuleStateLookupData *new_data = old_data;
    if (!new_data) {
        new_data = (__Pyx_ModuleStateLookupData *)calloc(1, sizeof(__Pyx_ModuleStateLookupData));
        if (!new_data) {
            result = -1;
            PyErr_NoMemory();
            goto end;
        }
        new_data->allocated = 1;
        new_data->interpreter_id_as_index = 1;
    }
    __Pyx_ModuleStateLookup_wait_until_no_readers();
    if (new_data->interpreter_id_as_index) {
        if (interpreter_id < __PYX_MODULE_STATE_LOOKUP_SMALL_SIZE) {
            result = __Pyx_State_AddModuleInterpIdAsIndex(&new_data, module, interpreter_id);
            goto end;
        }
        __Pyx_State_ConvertFromInterpIdAsIndex(new_data);
    }
    {
        Py_ssize_t insert_at = 0;
        {
            __Pyx_InterpreterIdAndModule* lower_bound = __Pyx_State_FindModuleStateLookupTableLowerBound(
                new_data->table, new_data->count, interpreter_id);
            assert(lower_bound);
            insert_at = lower_bound - new_data->table;
            if (unlikely(insert_at < new_data->count && lower_bound->id == interpreter_id)) {
                lower_bound->module = module;
                goto end;  // already in table, nothing more to do
            }
        }
        if (new_data->count+1 >= new_data->allocated) {
            Py_ssize_t to_allocate = (new_data->count+1)*2;
            new_data =
                (__Pyx_ModuleStateLookupData*)realloc(
                    new_data,
                    sizeof(__Pyx_ModuleStateLookupData) +
                    (to_allocate-1)*sizeof(__Pyx_InterpreterIdAndModule));
            if (!new_data) {
                result = -1;
                new_data = old_data;
                PyErr_NoMemory();
                goto end;
            }
            new_data->allocated = to_allocate;
        }
        ++new_data->count;
        int64_t last_id = interpreter_id;
        PyObject *last_module = module;
        for (Py_ssize_t i=insert_at; i<new_data->count; ++i) {
            int64_t current_id = new_data->table[i].id;
            new_data->table[i].id = last_id;
            last_id = current_id;
            PyObject *current_module = new_data->table[i].module;
            new_data->table[i].module = last_module;
            last_module = current_module;
        }
    }
  end:
#if CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE
    __pyx_atomic_pointer_exchange(&__Pyx_ModuleStateLookup_data, new_data);
#else
    __Pyx_ModuleStateLookup_data = new_data;
#endif
    __Pyx_ModuleStateLookup_Unlock();
    return result;
}
static int __Pyx_State_RemoveModule(CYTHON_UNUSED void* dummy) {
    int64_t interpreter_id = PyInterpreterState_GetID(__Pyx_PyInterpreterState_Get());
    if (interpreter_id == -1) return -1;
    __Pyx_ModuleStateLookup_Lock();
#if CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE
    __Pyx_ModuleStateLookupData *data = (__Pyx_ModuleStateLookupData *)
            __pyx_atomic_pointer_exchange(&__Pyx_ModuleStateLookup_data, 0);
#else
    __Pyx_ModuleStateLookupData *data = __Pyx_ModuleStateLookup_data;
#endif
    if (data->interpreter_id_as_index) {
        if (interpreter_id < data->count) {
            data->table[interpreter_id].module = NULL;
        }
        goto done;
    }
    {
        __Pyx_ModuleStateLookup_wait_until_no_readers();
        __Pyx_InterpreterIdAndModule* lower_bound = __Pyx_State_FindModuleStateLookupTableLowerBound(
            data->table, data->count, interpreter_id);
        if (!lower_bound) goto done;
        if (lower_bound->id != interpreter_id) goto done;
        __Pyx_InterpreterIdAndModule *end = data->table+data->count;
        for (;lower_bound<end-1; ++lower_bound) {
            lower_bound->id = (lower_bound+1)->id;
            lower_bound->module = (lower_bound+1)->module;
        }
    }
    --data->count;
    if (data->count == 0) {
        free(data);
        data = NULL;
    }
  done:
#if CYTHON_MODULE_STATE_LOOKUP_THREAD_SAFE
    __pyx_atomic_pointer_exchange(&__Pyx_ModuleStateLookup_data, data);
#else
    __Pyx_ModuleStateLookup_data = data;
#endif
    __Pyx_ModuleStateLookup_Unlock();
    return 0;
}
#endif

/* #### Code section: utility_code_pragmas_end ### */
#ifdef _MSC_VER
#pragma warning( pop )
#endif



/* #### Code section: end ### */
#endif /* Py_PYTHON_H */
